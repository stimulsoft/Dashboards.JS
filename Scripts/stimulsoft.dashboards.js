/*
Stimulsoft.Dashboards.JS
Version: 2025.3.1
Build date: 2025.06.25
License: https://www.stimulsoft.com/en/licensing/reports
*/
(t=>{var e;"undefined"!=typeof process&&process.__nwjs||"object"!=typeof exports||"undefined"==typeof module?"function"==typeof define&&define.amd?define(["./stimulsoft.reports"],e=>Object.assign(e,t(e.Stimulsoft))):window.Stimulsoft?window.Stimulsoft.Report&&window.Stimulsoft.Report.StiReport?Object.assign(window,t(window.Stimulsoft)):window.Stimulsoft.dashboardsFactory=t:window.Stimulsoft={dashboardsFactory:t}:module.exports=(e=require("./stimulsoft.reports"),Object.assign(e,t(e.Stimulsoft)))})(function(P){function p(e,t){for(var i in t)i in e?p(e[i],t[i]):e[i]=t[i];return e}P&&(P.__engineVersion&&"2025.3.1"!==P.__engineVersion?console.warn("Scripts versions mismatch: engine ver. = %s; dashboards ver. = 2025.3.1",P.__engineVersion):"2025.3.1"!==P.__reportsVersion&&console.warn("Scripts versions mismatch: reports ver. = %s; dashboards ver. = 2025.3.1",P.__reportsVersion));var P=p(P||{},{Dashboard:{Components:{Panel:{},Button:{},Cards:{},Helpers:{},Chart:{Design:{}},TreeViewBox:{},TreeView:{},Table:{Design:{}},RegionMap:{},Progress:{},PivotTable:{Design:{}},OnlineMap:{},ListBox:{},DatePicker:{},NumberBox:{},ComboBox:{},Gauge:{Design:{}},Indicator:{},Text:{Design:{}},Design:{},Image:{Design:{}},WebContent:{},Shape:{}},Export:{Settings:{},Tools:{},Helpers:{},Painters:{Table:{}}},Interactions:{Design:{}},Helpers:{},Render:{},Visuals:{Gauge:{},Cards:{},Indicator:{},Progress:{Helpers:{}}},Design:{Helpers:{}},Images:{},Options:{},Visualizers:{},Drawing:{Helpers:{},Painters:{}}},Designer:{Dashboards:{}},Reflection:{}}),R={},w,f,C,x,t,M,A,D,I,V,Z,Y,K,Q;R.a=P.Dashboard,R.b=P.Designer,R.c=P.Reflection,R.d=R.b.Dashboards,R.e=R.a.Components,R.f=R.a.Export,R.g=R.a.Interactions,R.h=R.a.Helpers,R.i=R.a.Render,R.j=R.a.Visuals,R.k=R.a.Design,R.l=R.a.Images,R.m=R.a.Options,R.n=R.a.Visualizers,R.o=R.a.Drawing,R.p=R.o.Helpers,R.q=R.o.Painters,R.r=R.k.Helpers,R.s=R.j.Gauge,R.t=R.j.Cards,R.u=R.j.Indicator,R.v=R.j.Progress,R.w=R.v.Helpers,R.x=R.g.Design,R.y=R.f.Settings,R.z=R.f.Tools,R.A=R.f.Helpers,R.B=R.f.Painters,R.C=R.B.Table,R.D=R.e.Panel,R.E=R.e.Button,R.F=R.e.Cards,R.G=R.e.Helpers,R.H=R.e.Chart,R.I=R.e.TreeViewBox,R.J=R.e.TreeView,R.K=R.e.Table,R.L=R.e.RegionMap,R.M=R.e.Progress,R.N=R.e.PivotTable,R.O=R.e.OnlineMap,R.P=R.e.ListBox,R.Q=R.e.DatePicker,R.R=R.e.NumberBox,R.S=R.e.ComboBox,R.T=R.e.Gauge,R.U=R.e.Indicator,R.V=R.e.Text,R.W=R.e.Design,R.X=R.e.Image,R.Y=R.e.WebContent,R.Z=R.e.Shape,R._=R.X.Design,R.aa=R.V.Design,R.ab=R.T.Design,R.ac=R.N.Design,R.ad=R.K.Design,R.ae=R.H.Design;{let e;(x=e=R.a.StiTextFormatState||(R.a.StiTextFormatState={}))[x["None"]=0]="None",x[x["DecimalDigits"]=1]="DecimalDigits",x[x["DecimalSeparator"]=2]="DecimalSeparator",x[x["GroupSeparator"]=4]="GroupSeparator",x[x["GroupSize"]=8]="GroupSize",x[x["PositivePattern"]=16]="PositivePattern",x[x["NegativePattern"]=32]="NegativePattern",x[x["CurrencySymbol"]=64]="CurrencySymbol",x[x["PercentageSymbol"]=128]="PercentageSymbol",x[x["Abbreviation"]=256]="Abbreviation",x[x["NegativeInRed"]=512]="NegativeInRed";let t;(C=t=R.a.StiFilterCondition||(R.a.StiFilterCondition={}))[C["EqualTo"]=0]="EqualTo",C[C["NotEqualTo"]=1]="NotEqualTo",C[C["GreaterThan"]=2]="GreaterThan",C[C["GreaterThanOrEqualTo"]=3]="GreaterThanOrEqualTo",C[C["LessThan"]=4]="LessThan",C[C["LessThanOrEqualTo"]=5]="LessThanOrEqualTo",C[C["Between"]=6]="Between",C[C["NotBetween"]=7]="NotBetween",C[C["Containing"]=8]="Containing",C[C["NotContaining"]=9]="NotContaining",C[C["BeginningWith"]=10]="BeginningWith",C[C["EndingWith"]=11]="EndingWith",C[C["IsNull"]=12]="IsNull",C[C["IsNotNull"]=13]="IsNotNull";let i;(f=i=R.a.StiFilterItem||(R.a.StiFilterItem={}))[f["Argument"]=0]="Argument",f[f["Value"]=1]="Value",f[f["ValueEnd"]=2]="ValueEnd",f[f["Expression"]=3]="Expression",f[f["ValueOpen"]=4]="ValueOpen",f[f["ValueClose"]=5]="ValueClose",f[f["ValueLow"]=6]="ValueLow",f[f["ValueHigh"]=7]="ValueHigh";let r;(w=r=R.a.StiFilterDataType||(R.a.StiFilterDataType={}))[w["String"]=0]="String",w[w["Numeric"]=1]="Numeric",w[w["DateTime"]=2]="DateTime",w[w["Boolean"]=3]="Boolean",w[w["Expression"]=4]="Expression"}{let e;(t=e=R.e.StiMeterIdent||(R.e.StiMeterIdent={}))[t["ArgumentChartMeter"]=1]="ArgumentChartMeter",t[t["SeriesChartMeter"]=2]="SeriesChartMeter",t[t["SortByChartMeter"]=3]="SortByChartMeter",t[t["ValueChartMeter"]=4]="ValueChartMeter",t[t["StartValueChartMeter"]=5]="StartValueChartMeter",t[t["EndValueChartMeter"]=6]="EndValueChartMeter",t[t["OpenValueChartMeter"]=7]="OpenValueChartMeter",t[t["CloseValueChartMeter"]=8]="CloseValueChartMeter",t[t["LowValueChartMeter"]=9]="LowValueChartMeter",t[t["HighValueChartMeter"]=10]="HighValueChartMeter",t[t["WeightChartMeter"]=11]="WeightChartMeter",t[t["XChartMeter"]=12]="XChartMeter",t[t["YChartMeter"]=13]="YChartMeter",t[t["IndicatorValueChartMeter"]=14]="IndicatorValueChartMeter",t[t["MaxGaugeMeter"]=15]="MaxGaugeMeter",t[t["MinGaugeMeter"]=16]="MinGaugeMeter",t[t["SeriesGaugeMeter"]=17]="SeriesGaugeMeter",t[t["ValueGaugeMeter"]=18]="ValueGaugeMeter",t[t["TargetGaugeMeter"]=19]="TargetGaugeMeter",t[t["SeriesIndicatorMeter"]=20]="SeriesIndicatorMeter",t[t["TargetIndicatorMeter"]=21]="TargetIndicatorMeter",t[t["ValueIndicatorMeter"]=22]="ValueIndicatorMeter",t[t["SeriesProgressMeter"]=23]="SeriesProgressMeter",t[t["TargetProgressMeter"]=24]="TargetProgressMeter",t[t["ValueProgressMeter"]=25]="ValueProgressMeter",t[t["LatitudeMapMeter"]=26]="LatitudeMapMeter",t[t["LongitudeMapMeter"]=27]="LongitudeMapMeter",t[t["LocationMapMeter"]=28]="LocationMapMeter",t[t["LocationValueMapMeter"]=29]="LocationValueMapMeter",t[t["LocationColorMapMeter"]=30]="LocationColorMapMeter",t[t["LocationArgumentMapMeter"]=31]="LocationArgumentMapMeter",t[t["KeyMapMeter"]=32]="KeyMapMeter",t[t["NameMapMeter"]=33]="NameMapMeter",t[t["ValueMapMeter"]=34]="ValueMapMeter",t[t["GroupMapMeter"]=35]="GroupMapMeter",t[t["ColorMapMeter"]=36]="ColorMapMeter",t[t["ColorScaleColumn"]=37]="ColorScaleColumn",t[t["DataBarsColumn"]=38]="DataBarsColumn",t[t["DimensionColumn"]=39]="DimensionColumn",t[t["IndicatorColumn"]=40]="IndicatorColumn",t[t["MeasureColumn"]=41]="MeasureColumn",t[t["SparklinesColumn"]=42]="SparklinesColumn",t[t["BubbleColumn"]=43]="BubbleColumn",t[t["ColorScaleCardsColumn"]=44]="ColorScaleCardsColumn",t[t["DataBarsCardsColumn"]=45]="DataBarsCardsColumn",t[t["DimensionCardsColumn"]=46]="DimensionCardsColumn",t[t["IndicatorCardsColumn"]=47]="IndicatorCardsColumn",t[t["MeasureCardsColumn"]=48]="MeasureCardsColumn",t[t["SparklinesCardsColumn"]=49]="SparklinesCardsColumn",t[t["BubbleCardsColumn"]=50]="BubbleCardsColumn",t[t["PivotColumn"]=51]="PivotColumn",t[t["PivotRow"]=52]="PivotRow",t[t["PivotSummary"]=53]="PivotSummary",t[t["NameListBoxMeter"]=54]="NameListBoxMeter",t[t["KeyListBoxMeter"]=55]="KeyListBoxMeter",t[t["KeyTreeViewMeter"]=56]="KeyTreeViewMeter",t[t["KeyTreeViewBoxMeter"]=57]="KeyTreeViewBoxMeter",t[t["NameComboBoxMeter"]=58]="NameComboBoxMeter",t[t["KeyComboBoxMeter"]=59]="KeyComboBoxMeter",t[t["ValueDatePickerMeter"]=60]="ValueDatePickerMeter",t[t["ValueNumberBoxMeter"]=61]="ValueNumberBoxMeter",t[t["TextMeter"]=62]="TextMeter",t[t["TextMeasureMeter"]=63]="TextMeasureMeter",t[t["ImageMeter"]=64]="ImageMeter",t[t["WebContentMeter"]=65]="WebContentMeter"}let q=P.Report.Dashboard.StiFilterInclusionMode,e=P.Base.Meta.StiEventMeta,_=P.Report.Helpers.StiBlocklyHelper,$=P.System.EventArgs,ee=P.Report.Components.StiContainer,te=P.Base.Drawing.StiBorder,i=P.Base.Meta.StiColorMeta,r=P.Base.Meta.StiEnumMeta,ie=P.Base.Meta.StiNumberMeta,s=P.Base.Meta.StiObjectMeta,re=P.Base.Meta.StiStringMeta,se=P.Base.Meta.StiRemoveMeta,l=P.Base.Meta.StiStringNullOrEmptyMeta,le=P.System.StiMath,ne=P.Report.Dashboard.ImplementsIStiDashboardWatermark,ae=P.Report.Dashboard.IStiDashboardWatermark,oe=P.Base.Drawing.StiAdvancedWatermark,ue=P.Report.Components.StiSurfaceViewMode,he=P.Report.Helpers.StiAppExpressionParser,me=P.Base.StiAppExpressionHelper,H=P.System.StiString,n=P.Base.JsonReportObject.IStiJsonReportObject,ce=P.Report.Dashboard.ImplementsIStiDashboard,a=P.Base.StiJsonReportObjectHelper,de=P.Base.StiKeyHelper,E=P.Base.Drawing.StiSolidBrush,ge=P.Base.Drawing.StiBrush,pe=P.Report.Units.StiUnit,Se=P.Report.Components.StiMargins,we=P.Data.Engine.StiDataSourcePicker,N=P.System.Drawing.Color,fe=P.Report.Dashboard.IStiSkipOwnFilter,be=P.Data.Engine.IStiUserFilters,ye=P.Report.Dashboard.Helpers.StiCrossLinkedFilterHelper,Ce=P.Report.Dashboard.IStiFilterElement,xe=P.Report.Dashboard.StiGroupElementHelper,ve=P.Report.Dashboard.IStiElement,j=P.System.Collections.List,o=P.Report.Dashboard.StiElementStyleIdent,z=P.System.Enum,Fe=P.Report.Dashboard.IStiDashboard,Te=P.Report.Components.StiPage,b=P.Base.Localization.StiLocalization,Me=P.System.Drawing.Size,Ae=P.Report.Components.StiDashboardViewMode,De=P.Report.Dashboard.IStiAltProperties,Ie=P.Report.Dashboard.IStiTitleElement,Re=P.System.Drawing.Rectangle,Ee=P.Report.Dashboard.StiDashboardContentAlignment,ke=P.Report.IStiGlobalizationProvider,u=(R.e.StiDashboard=class extends Te{implements(){let e=super.implements().concat([Fe,ae,ke,...ce,...ne,n]);return(this.implements=()=>e)()}clone(){let e,t,i,r=super.clone();return r.dashboardWatermark=null==(e=this.dashboardWatermark)?void 0:e.clone(),r.beginRenderEvent=null==(t=this.beginRenderEvent)?void 0:t.clone(),r.refreshingEvent=null==(i=this.refreshingEvent)?void 0:i.clone(),r}meta(){return[...super.meta(),new se(["Margins","MirrorMargins","PrintHeadersFootersFromPreviousPage","PrintOnPreviousPage","StopBeforePrint","LargeHeight","LargeHeightFactor","ResetPageNumber","Watermark","ExcelSheet","CanBreak","Interaction","PaperSourceFirstPage","PaperSourceOfFirstPage","PaperSourceOtherPages","PaperSourceOfOtherPages","ShrinkToFit","UseParentStyles","Conditions","PaperSize","NumberOfCopies","BeginRenderEvent","RenderingEvent","EndRenderEvent","GetToolTipEvent","GetTagEvent","GetBookmarkEvent","GetHyperlinkEvent","BeforePrintEvent","AfterPrintEvent","MouseEnterEvent","MouseLeaveEvent","ClickEvent","DoubleEvent","ColumnBeginRenderEvent","ColumnEndRenderEvent","GetExcelSheetEvent","GetDrillDownReportEvent"]),new ie("Width","",1200),new ie("Height","",600),new ie("DeviceWidth","",480),new r("Style","",o,o.Blue),new l("Border").get(()=>a.Serialize.jBorder(this.border)).set(e=>this.border=a.Deserialize.border(e.value)).setXml(e=>this.border=te.loadFromXml(e.textContent)),new i("BackColor","",N.transparent),new r("DashboardViewMode","",Ae,Ae.Desktop),new re("AltSize","",a.Serialize.sizeD(Me.empty)).get(()=>a.Serialize.sizeD(this.altSize)).set(e=>this.altSize=a.Deserialize.sizeD(e.value.toString())).setXml(e=>this.altSize=P.System.Drawing.Size.convertFromXml(e.textContent)),new r("ContentAlignment","",Ee,Ee.StretchXY),new r("AltContentAlignment","",Ee,Ee.StretchXY),new s("DashboardWatermark"),new e("BeginRenderEvent"),new e("RefreshingEvent")]}getMeters(e=!0,t=null){return this.getElements(e,t).selectMany(e=>e.getMeters())}getElements(t=!0,i=null){return null==i?(t?this.getComponentsList():this.components.list)[P.System.StiObject.stimulsoft]().toList().where(e=>e.is(ve)).cast():H.isNullOrWhiteSpace(i)?(t?this.getComponentsList():this.components.list)[P.System.StiObject.stimulsoft]().toList().where(e=>e.is(ve)).cast().where(e=>H.isNullOrWhiteSpace(xe.getGroup(e))).toList():this.report.pages.toList().where(e=>e.isDashboard).selectMany(e=>(t?e.getComponentsList():e.components.list)[P.System.StiObject.stimulsoft]().toList()).where(e=>e.is(ve)).cast().where(e=>xe.getGroup(e)==i)}getUserFilters(t){if(null==t)return null;let e=xe.getGroup(t),r=this.getElements(!0,e),s=t.as(Ce);if(null!=s){if(ye.isCrossLinkedFilter(s))return null;let e=r.where(e=>e.is(Ce)).cast().firstOrDefault(e=>e.getKey()==s.getParentKey());if(null==e)return null;let t=new j,i=e.is(be)?e.userFilters:null;return null!=i&&t.addRange(i),null!=(i=this.as(Fe).getUserFilters(e.as(ve)))&&t.addRange(i),t}return r.where(e=>e.is(be)&&(e!=t||!(e.is(fe)&&e.allowSkipOwnFilter))).cast().selectMany(this.getUserFilters3)}getUserFilters3(t){if(t.is(Ce)&&t.inclusionMode==q.Always&&(null==t.userFilters||!t.userFilters.any())){let e=t.getIdentityFilters();if(null!=e)return e}return t.userFilters.forEach(e=>e.elementKey=t.as(ve).key),t.userFilters}getUnplacedElements(){return this.getComponents().toList().where(e=>0==e.width||0==e.height).cast()}switchSurfaceViewMode(e){let n,t=e==ue.Desktop?Ae.Desktop:Ae.Mobile;if(this.dashboardViewMode==t)return;this.dashboardViewMode=t;let a=!1,o=(this.altSize.isEmpty&&e==ue.Mobile&&(this.altSize=new Me(480,800),a=!0,this.altContentAlignment=this.contentAlignment),this.getComponents());for(let l of o.list){let s=l.as(De);if(null!=s){let e=l.parent,t=(l.parent.components.remove(l),o.getComponentByGuid(s.altParentKey,this)||this),i=(null!=(n=t.as(ee))&&n.components.add(l),s.altParentKey=e.guid,l.clientRectangle.clone()),r=(l.clientRectangle=s.altClientRectangle.clone(),s.altClientRectangle=i,l.as(Ie));if(null!=(null==r?void 0:r.title)){let e=r.title.visible;a||(r.title.visible=s.altTitleVisible),s.altTitleVisible=e}}}let i=new Me(this.width,this.height),r=(this.width=this.altSize.width,this.height=this.altSize.height,this.altSize=i,this.contentAlignment);this.contentAlignment=this.altContentAlignment,this.altContentAlignment=r}removeMobileSurface(){this.altSize=Me.empty;let e=this.getComponents();for(let t of e.list){let e=t.as(De);null!=e&&(e.altClientRectangle=Re.empty)}this.altContentAlignment=Ee.StretchXY}get isMobileSurfaceSelected(){return this.dashboardViewMode==Ae.Mobile}get isDesktopSurfaceSelected(){return this.dashboardViewMode==Ae.Desktop}fetchAllMeters(){return new j}getNestedPages(){return new j}get isEnabled(){return me.isExpressionSpecified(this,"enabled")?he.parseBoolExpression(this,"enabled",!0):this.enabled}async isEnabledAsync(){return me.isExpressionSpecified(this,"enabled")?he.parseBoolExpressionAsync(this,"enabled",!0):this.enabled}get isDefined(){return 0<this.components.count}get isQuerable(){return!0}retrieveUsedDataNames(t){return this.getElements(!0,t).selectMany(e=>e.retrieveUsedDataNames(t)).distinct()}getDictionary(){return null!=this.report?this.report.dictionary:null}getDataSources(e){return we.fetch(this,null,e,null!=this.report?this.getDictionary().fetchDataSources():null)}setString(e,t){switch(e){case"Alias":this.alias=t;break}}getString(e){switch(e){case"Alias":return this.alias}throw new Error(`Property with name `+e)}getAllStrings(){return["Alias"]}get serviceCategory(){return b.get("Permissions","ItemDashboards")}get localizedName(){return b.get("Components","StiDashboard")}get gridSize(){return this.report.info.gridSizePoints}get unit(){return pe.HundredthsOfInch}get brush(){return new E(this.backColor)}set brush(e){this.backColor=ge.toColor(e)}get skip(){return!0}set skip(e){}convert(e,t,i=!1){}getKey(){return this.key}get key(){return this.guid}set key(e){this.guid=e}get style(){return this._style}set style(e){if(this._style==e)return;e==o.Auto&&(e=z.getValues(typeof o).find(e=>e!=o.Auto)),this._style=e}getApp(){return this.report}onRefreshing(e){}invokeRefreshing(){this.onRefreshing($.empty),_.invokeBlockly(this.report,this,this.refreshingEvent)}get width(){return this._width2}set width(e){this._width2=le.round2(e,2)}get height(){return this._height2}set height(e){this._height2=le.round2(e,2)}get altSize(){return this._altSize}set altSize(e){this._altSize=e}get dashboardViewMode(){return this._dashboardViewMode}set dashboardViewMode(e){this._dashboardViewMode=e}get contentAlignment(){return this._contentAlignment}set contentAlignment(e){this._contentAlignment=e}get altContentAlignment(){return this._altContentAlignment}set altContentAlignment(e){this._altContentAlignment=e}get deviceWidth(){return this._deviceWidth}set deviceWidth(e){this._deviceWidth=e}get isMobileSurfacePresent(){return!this.altSize.isEmpty}constructor(e=null){super(e),this.backColor=N.transparent,this.margins=new Se(10,10,10,10),this._style=o.Blue,this.customStyleName="",this.dashboardWatermark=new oe,this.refreshingEvent=null,this._width2=1200,this._height2=600,this._altSize=Me.empty,this._dashboardViewMode=Ae.Desktop,this._contentAlignment=Ee.StretchXY,this._altContentAlignment=Ee.StretchXY,this._deviceWidth=480,this.key=de.generateKey(),this.width=1200,this.height=600}},P.Base.Meta.StiMetaHelper),Oe=P.System.Type,Ve=P.Base.Meters.IStiLocalizedMeter,Ne=P.Base.Meters.IStiMeter,Le=P.Base.StiJsonSaveMode,Be=P.Base.StiJson,Pe=(R.e.StiMeter=class{is(e){if(e instanceof P.System.Interface)return-1!=this.implements().indexOf(e);if("function"==typeof e)return this instanceof e;if(null==e)throw new Error("Type for comparison is 'undefined'");return!1}is2(e){return this.is(e)}as(e){if(this.is(e))return this;return null}implements(){let e=[Ne,Ve,n];return(this.implements=()=>e)()}clone(e=!0,t=!0){let i=this[P.System.StiObject.stimulsoft]().memberwiseClone();return i.key=de.generateKey(),i}saveToString(){return this.saveToJsonObject(Le.Report).serialize()}loadFromString(e){let t=new Be;t.deserialize(e),this.loadFromJsonObject(t)}meta(){return[new r("Ident","",R.e.StiMeterIdent).set(()=>{}).setXml(()=>{}),new l("Key"),new l("Expression"),new l("Label")]}saveToJsonObject(e){return u.saveToJsonObject(e,this)}loadFromJsonObject(e){u.loadFromJsonObject(e,this)}loadFromXml(e){u.loadFromXml(e,this)}getUniqueCode(){let e=null!=this.expression?this.expression[P.System.StiObject.stimulsoft]().getHashCode():0;return e=397*(e=397*(e=397*e^Oe.getTypeName(this)[P.System.StiObject.stimulsoft]().getHashCode())^(null!=this.label?this.label[P.System.StiObject.stimulsoft]().getHashCode():0))^(null!=this.key?this.key[P.System.StiObject.stimulsoft]().getHashCode():0),Math.abs(e)}get localizedName(){return""}isDefault(){return null==this.key&&null!=this.expression&&0==this.expression.length&&null!=this.label&&0==this.label.length}toString(){let e=this[P.System.StiObject.stimulsoft]().getType()[P.System.StiObject.stimulsoft]().getTypeName();return H.isNullOrWhiteSpace(this.expression)?e:`${e}-"${this.expression}"`}constructor(e,t,i){this.expression="",this.label="",null==e&&(e=de.generateKey()),this.key=e,null!=t&&(this.expression=t),null!=i&&(this.label=i)}},P.Base.Meters.IStiDimensionMeter),He=(R.e.StiDimensionMeter=class extends R.e.StiMeter{implements(){let e=super.implements().concat([Pe]);return(this.implements=()=>e)()}constructor(e,t,i){super(e,t,i)}},P.System.Collections.Dictionary),je=P.System.Attribute;{class ht extends je{constructor(e){super(),this.exportToolTypeName=e}static add(e,t){this.attributes.add(e,new ht(t))}}ht.attributes=new He,R.f.StiExportToolAttribute=ht}let ze=P.Report.Dashboard.ImplementsIStiPanelElement,Xe=P.Report.Dashboard.IStiPanelElement,h=P.Base.Meta.StiBoolMeta,Ge=P.Report.Components.ImplementsIStiCornerRadius,Je=P.Report.Components.IStiCornerRadius,v=P.Base.Drawing.StiCornerRadius,We=P.Base.Drawing.StiSimpleShadow,Ue=P.Report.Components.IStiSimpleShadow,Ze=P.Report.Components.ImplementsIStiSimpleShadow,L=P.System.Drawing.Rectangle,Ye=P.Report.Dashboard.ImplementsIStiMargin,Ke=P.Report.Dashboard.ImplementsIStiPadding,Qe=P.Report.Dashboard.ImplementsIStiPanel,qe=P.Report.Dashboard.ImplementsIStiAltProperties,_e=P.Report.Components.StiComponentToolboxPosition,$e=P.Base.Drawing.StiEmptyBrush,et=P.Report.Components.StiToolboxCategory,T=P.Base.Localization.StiLocalization,tt=P.Base.Drawing.StiSimpleBorder,it=P.Report.Dashboard.StiPadding,rt=P.Report.Dashboard.StiMargin,st=P.Report.Dashboard.IStiGroupElement,lt=P.Report.Dashboard.IStiMargin,nt=P.Report.Dashboard.IStiPadding,at=P.Report.Dashboard.IStiPanel,ot=P.Report.Components.IStiSimpleBorder,ut=P.Report.Components.StiPanel,ht=R.f.StiExportToolAttribute,mt=(ht.add("StiPanelElement","Stimulsoft.Dashboard.Export.Tools.StiPanelElementExportTool"),R.D.StiPanelElement=class extends ut{implements(){let e=super.implements().concat([ot,Je,Ue,at,Xe,nt,lt,De,ae,...Qe,...Ge,...Ze,...Ke,...Ye,...qe,...ne,...ze,n]);return(this.implements=()=>e)()}clone(e){let t,i,r,s,l=super.clone(e);return l.margin=null==(t=this.margin)?void 0:t.clone(),l.padding=null==(i=this.padding)?void 0:i.clone(),l.border2=null==(r=this.border2)?void 0:r.clone(),l.dashboardWatermark=null==(s=this.dashboardWatermark)?void 0:s.clone()[P.System.StiObject.stimulsoft]().as(oe),l}meta(){return[...super.meta(),new se(["Border","UseParentStyles","MinSize","MaxSize","Interaction","PrintOn","GrowToHeight","ShiftMode","CanShrink","CanGrow","Printable","Bookmark","Hyperlink","Conditions","GetBookmarkEvent","GetHyperlinkEvent","GetTagEvent","GetToolTipEvent","BeforePrintEvent","AfterPrintEvent","ClickEvent","DoubleEvent","MouseEnterEvent","MouseLeaveEvent","GetDrillDownReportEvent"]),new s("Margin").get(e=>this.margin.saveToJsonObject(3,3,3,3)),new s("Padding").get(e=>this.padding.saveToJsonObject(0,0,0,0)),new l("Border","border2").get(()=>a.Serialize.jBorder2(this.border2)).set(e=>this.border2=a.Deserialize.simpleBorder(e.value)).setXml(e=>this.border2=a.Deserialize.simpleBorder(e.textContent)),new i("BackColor","",N.transparent),new re("AltClientRectangle","",a.Serialize.rectangleD(Re.empty)).get(()=>a.Serialize.rectangleD(this.altClientRectangle)).set(e=>this.altClientRectangle=a.Deserialize.rectangleD(e.value)).setXml(e=>this.altClientRectangle=this.loadRectangleDFromXml(e.textContent)),new h("AltTitleVisible","",!0),new l("AltParentKey"),new l("CornerRadius").get(()=>this.cornerRadius.toString()).set(e=>this.cornerRadius=v.tryParse(e.value.toString())).setXml(e=>this.cornerRadius=v.tryParse(e.textContent)),new l("Shadow").get(()=>a.Serialize.jShadow(this.shadow)).set(e=>this.shadow=a.Deserialize.simpleSahdow(e.value)).setXml(e=>this.shadow=We.loadFromXml(e.textContent)),new s("DashboardWatermark"),new l("Style"),new l("WatermarkStyle")]}getMeters(e=!0,t=null){return this.getElements(e,t).selectMany(e=>e.getMeters())}getElements(e=!0,t=null){let i=(e?this.getComponents():this.components).toList().where(e=>e.is(ve)).cast();return(null==t?i.where(e=>!e.is(st)||null==xe.getGroup(e)):i.where(e=>xe.getGroup(e)==t)).toList()}fetchAllMeters(){return new j}getMeters2(){return new j}getFilterRules(){return new j}getNestedPages(){return new j}get dashboard(){return this.page.as(Fe)}get isDefined(){return!0}get isQuerable(){return!1}async isEnabledAsync(){return me.isExpressionSpecified(this,"enabled")?he.parseBoolExpressionAsync(this,"enabled",!0):this.enabled}get zoom(){return null==this.report||null==this.report.info?1:this.report.info.zoom}retrieveUsedDataNames(e){return new j}getDictionary(){return null!=this.report?this.report.dictionary:null}getDataSources(e){var t;return we.fetch(this,null,e,null==(t=this.getDictionary())?void 0:t.fetchDataSources())}get watermarkStyle(){return this._watermarkStyle}set watermarkStyle(t){if(this._watermarkStyle!=t&&(this._watermarkStyle=t,null!=(null==this?void 0:this.report))&&null!=t){let e=this.report.styles.getByName(t);null!=e&&e.setStyleToComponent(this)}}getApp(){return this.report}get toolboxPosition(){return _e.TextElement}get localizedName(){return T.get("Components","StiPanel")}get brush(){return new E(this.backColor)}set brush(e){this.backColor=ge.toColor(e)}get style(){return this.componentStyle}set style(e){this.componentStyle=e}get serviceCategory(){return b.get("Permissions","ItemDashboards")}get localizedCategory(){return this.serviceCategory}get toolboxCategory(){return et.Dashboards}canContainIn(e){return e.is(R.e.StiDashboard)}get key(){return this.guid}set key(e){this.guid=e}constructor(e=L.empty){super(e),this.margin=rt.create(3),this.padding=it.create(0),this.border2=new tt,this.backColor=N.transparent,this.dashboardWatermark=new oe,this._watermarkStyle="",this.shadow=new We,this.cornerRadius=new v(0),this.altTitleVisible=!0,this.altClientRectangle=Re.empty,this.defaultClientRectangle=new L(0,0,300,300),this.helpUrl="user-manual/dashboards_panel.htm",this.key=de.generateKey(),this.brush=new $e,this.placeOnToolbox=!0}},P.Report.Dashboard.ImplementsIStiElement),ct=P.Report.Components.ImplementsIStiBackColor,dt=R.D.StiPanelElement,gt=P.Report.Components.IStiBackColor,pt=P.Report.Components.StiComponent,St=(R.e.StiElement=class extends pt{implements(){let e=super.implements().concat([ve,ot,gt,nt,lt,De,...mt,...ct,...Ke,...Ye,...qe,n]);return(this.implements=()=>e)()}meta(){return[...super.meta(),new se(["UseParentStyles","MinSize","MaxSize","Interaction","PrintOn","GrowToHeight","ShiftMode","CanShrink","CanGrow","Printable","Bookmark","Hyperlink","Conditions","GetBookmarkEvent","GetHyperlinkEvent","GetTagEvent","GetToolTipEvent","BeforePrintEvent","AfterPrintEvent","ClickEvent","DoubleEvent","MouseEnterEvent","MouseLeaveEvent","GetDrillDownReportEvent"]),new s("Margin").get(e=>this.margin.saveToJsonObject(3,3,3,3)),new s("Padding").get(e=>this.padding.saveToJsonObject(5,5,5,5)),new l("Border","border2").get(()=>a.Serialize.jBorder2(this.border2)).set(e=>this.border2=a.Deserialize.simpleBorder(e.value)).setXml(e=>this.border2=a.Deserialize.simpleBorder(e.textContent)),new i("BackColor","",N.transparent),new re("AltClientRectangle","",a.Serialize.rectangleD(Re.empty)).get(()=>a.Serialize.rectangleD(this.altClientRectangle)).set(e=>this.altClientRectangle=a.Deserialize.rectangleD(e.value)).setXml(e=>this.altClientRectangle=this.loadRectangleDFromXml(e.textContent)),new h("AltTitleVisible","",!0),new l("AltParentKey","")]}convert(e,t,i=!1){}fetchAllMeters(){return new j}getMeters(){return new j}get dashboard(){return this.page.as(Fe)}get isDefined(){return!0}get isQuerable(){return!0}async isEnabledAsync(){return me.isExpressionSpecified(this,"enabled")?he.parseBoolExpressionAsync(this,"enabled",!0):this.enabled}get zoom(){return null!=this.page?this.page.zoom:1}retrieveUsedDataNames2(e){return this.retrieveUsedDataNames()}retrieveUsedDataNames(){return new j}getDictionary(){return null!=this.report?this.report.dictionary:null}getDataSources(e){var t;return we.fetch(this,null,e,null==(t=this.getDictionary())?void 0:t.fetchDataSources())}clone(e){let t,i,r,s=super.clone(e);return s.border2=null==(t=this.border2)?void 0:t.clone(),s.margin=null==(i=this.margin)?void 0:i.clone(),s.padding=null==(r=this.padding)?void 0:r.clone(),s}get backColor(){return this._backColor}set backColor(e){this._backColor=e}get serviceCategory(){return b.get("Permissions","ItemDashboards")}canContainIn(e){return e.is(R.e.StiDashboard)||e.is(dt)}get localizedCategory(){return this.serviceCategory}get localizedName(){return b.get("Components","StiDashboard")}get key(){return this.guid}set key(e){this.guid=e}getNestedPages(){return null}constructor(e=L.empty){super(e),this.border2=new tt,this._backColor=N.transparent,this.margin=rt.create(3),this.padding=it.create(5),this.altTitleVisible=!0,this.altClientRectangle=Re.empty,this.toolboxCategory=et.Dashboards,this.defaultClientRectangle=new L(0,0,280,280),this.key=de.generateKey(),this.placeOnToolbox=!0}},P.Data.Engine.StiDataSorter),wt=P.System.Data.DataColumn,ft=P.Report.Dashboard.StiEmptyCellsAs,k=P.Report.Dashboard.StiReportParser,O=P.Base.Helpers.StiValueHelper,bt=P.Data.Engine.StiDataGrouper,yt=P.System.Data.DataTable,Ct=P.Data.Engine.StiDataTable,xt=P.Report.Helpers.StiStringsTableHelper;{class Xg{static getIndicatorDataTable(e,t){let i=xt.loadStringRowsFromCache(t),r=(null==i&&(i=xt.loadStringRowsFromPackedString(e,[this.columnValue,this.columnTarget,this.columnSeries])),new j);if(r.add(new R.U.StiValueIndicatorMeter(null,null,T.get("PropertyMain","Value"))),r.add(new R.U.StiTargetIndicatorMeter(null,null,T.get("PropertyMain","Target"))),r.add(new R.U.StiSeriesIndicatorMeter(null,null,T.get("Chart","Series"))),null==i)return new Ct(r,new j);let s=i[P.System.StiObject.stimulsoft]().toList().groupBy(e=>e[2]).select(e=>[e.sum(e=>this.parseDecimal(e[0],t)),this.sumNullable(e.select(e=>this.parseNullableDecimal(e[1],t)).toList()),this.parseString(e.key,t)]);return new Ct(r,s.toList())}static getProgressDataTable(e,t){let i=xt.loadStringRowsFromCache(t),r=(null==i&&(i=xt.loadStringRowsFromPackedString(e,[this.columnValue,this.columnTarget,this.columnSeries])),new j);if(r.add(new R.M.StiValueProgressMeter(null,null,T.get("PropertyMain","Value"))),r.add(new R.M.StiTargetProgressMeter(null,null,T.get("PropertyMain","Target"))),r.add(new R.M.StiSeriesProgressMeter(null,null,T.get("Chart","Series"))),null==i)return new Ct(r,new j);let s=i[P.System.StiObject.stimulsoft]().toList().groupBy(e=>e[2]).select(e=>[e.sum(e=>this.parseDecimal(e[0],t)),this.sumNullable(e.select(e=>this.parseNullableDecimal(e[1],t)).toList()),this.parseString(e.key,t)]);return new Ct(r,s.toList())}static getGaugeDataTable(e,t,i){let r=xt.loadStringRowsFromCache(i),s=(null==r&&(r=xt.loadStringRowsFromPackedString(e,[this.columnValue,this.columnTarget,this.columnSeries])),new j);if(s.add(new R.T.StiValueGaugeMeter(null,null,T.get("PropertyMain","Value"))),s.add(new R.T.StiTargetGaugeMeter(null,null,T.get("PropertyMain","Target"))),s.add(new R.T.StiSeriesGaugeMeter(null,null,T.get("Chart","Series"))),null==r)return new Ct(s,new j);let l;if(t){l=new j;let e=r.find(e=>!0);null!=e&&l.add([this.parseDateTime(e[0],i),this.parseDateTime(e[1],i),this.parseDateTime(e[2],i)])}else l=r[P.System.StiObject.stimulsoft]().toList().groupBy(e=>e[2]).select(e=>[e.sum(e=>this.parseDecimal(e[0],i)),this.sumNullable(e.select(e=>this.parseNullableDecimal(e[1],i)).toList()),this.parseString(e.key,i)]);return new Ct(s,l.toList())}static getChartDataTable(e,n){let t=n.as(R.H.StiChartElement),a={ref:[]},i=xt.loadColumnsAndStringRowsFromCache(n,a),o=(null==i&&(i=xt.loadColumnsAndStringRowsFromPackedString(e,a)),t.isBubbleChart),r=t.isScatterChart,s=t.isRange,l=t.isFinancial,u=t.isHeatmapChart,h=t.manuallyEnteredChartMeter,m=new j,c=new j;for(let t of a.ref){let e=c.length;switch(t){case this.columnValue:if(o)c.add(new R.H.StiYChartMeter("Value","T.Value","Y"));else if(u)c.add(new R.H.StiValueChartMeter("Value","T.Value",T.get("PropertyMain","Values"),h.seriesType));else if(s)c.add(new R.H.StiStartValueChartMeter("Value","Sum(T.Value)",T.get("PropertyMain","Values"),h.seriesType));else if(l)c.add(new R.H.StiOpenValueChartMeter("Value","Sum(T.Value)",T.get("PropertyMain","OpenValues"),h.seriesType));else{let e=h.clone().as(R.H.StiValueChartMeter);e.expression="Sum(T.Value)",e.label=T.get("PropertyMain","Values"),e.key="Value",e.showNulls=ft.ConnectPointsWithLine,e.showZeros=ft.ConnectPointsWithLine,c.add(e)}break;case this.columnEndValue:s&&c.add(new R.H.StiEndValueChartMeter("EndValue","Sum(T.EndValue)",T.get("PropertyMain","EndValues")));break;case this.columnCloseValue:l&&c.add(new R.H.StiCloseValueChartMeter("CloseValue","Sum(T.CloseValue)",T.get("PropertyMain","CloseValues")));break;case this.columnLowValue:l&&c.add(new R.H.StiLowValueChartMeter("LowValue","Sum(T.LowValue)",T.get("PropertyMain","LowValues")));break;case this.columnHighValue:l&&c.add(new R.H.StiHighValueChartMeter("HighValue","Sum(T.HighValue)",T.get("PropertyMain","HighValues")));break;case this.columnArgument:o?c.add(new R.H.StiXChartMeter("Argument","T.Argument","X")):u||c.add(new R.H.StiArgumentChartMeter("Argument","T.Argument",T.get("PropertyMain","Arguments")));break;case this.columnWeight:o&&c.add(new R.H.StiWeightChartMeter("Weight","Sum(T.Weight)",T.get("PropertyMain","Weights")));break;case this.columnSeries:u||c.add(new R.H.StiSeriesChartMeter("Series","T.Series",T.get("PropertyMain","Series")));break;case this.columnX:c.add(new R.H.StiXChartMeter("X","T.X","X"));break;case this.columnY:c.add(new R.H.StiYChartMeter("Y","T.Y","Y"));break}c.length!=e&&m.add(t)}if(null==i||!i.some(e=>!0))return new Ct(c,new j);let d=new yt;d.tableName="T";for(let l of i){let r=d.newRow(),s=0;for(let i of a.ref){let t=null;switch(i){case this.columnValue:t=this.parseDecimal(l[s],n);break;case this.columnEndValue:t=this.parseDecimal(l[s],n);break;case this.columnCloseValue:t=this.parseDecimal(l[s],n);break;case this.columnLowValue:t=this.parseDecimal(l[s],n);break;case this.columnHighValue:t=this.parseDecimal(l[s],n);break;case this.columnArgument:t=o?this.parseDecimal(l[s],n):this.parseString(l[s],n);break;case this.columnWeight:t=this.parseDecimal(l[s],n);break;case this.columnSeries:t=this.parseString(l[s],n);break;case this.columnX:t=this.parseString(l[s],n);break;case this.columnY:t=this.parseString(l[s],n);break}let e=m.indexOf(i);if(-1!=e){if(!d.columns.contains("T."+i)){let e=new wt("T."+i,"string"==typeof t?String:Number);d.columns.add(e)}r.sett(e,t)}s++}d.rows.add(r)}if(o||r||u){let e=d.rows.toList().select(e=>e.itemArray);return new Ct(c,e)}{let e=bt.group(n.getDictionary(),d,c.toList());return St.sort(e,t.userSorts,t.report,0)}}static sumNullable(e){if(null==e)return null;if(!(e=null==e?void 0:e.where(e=>null!=e)).any())return null;return e.sum()}static parseDateTime(e,t){return null!=e&&e.includes("{")?O.tryToDateTime(k.parse2(e,t.report)):O.tryToDateTime(e)}static parseDecimal(e,t){return null!=e&&0<=e.indexOf("{")?O.tryToNumber(k.parse2(e,t.report)):O.tryToNumber(e)}static parseNullableDecimal(e,t){return null!=e&&0<=e.indexOf("{")&&(e=k.parse2(e,t.report)),H.isNullOrWhiteSpace(e)?null:O.tryToNumber(e)}static parseString(e,t){if(null==e)return"";let i="string"==typeof e?e:null==e?void 0:e[P.System.StiObject.stimulsoft]().toString();return null!=i&&0<=i.indexOf("{")?k.parse2(i,t.report):i}}Xg.columnValue="Value",Xg.columnEndValue="EndValue",Xg.columnTarget="Target",Xg.columnCloseValue="CloseValue",Xg.columnLowValue="LowValue",Xg.columnHighValue="HighValue",Xg.columnArgument="Argument",Xg.columnX="X",Xg.columnY="Y",Xg.columnWeight="Weight",Xg.columnSeries="Series",R.e.StiManuallyEnteredDataParser=Xg}let vt=P.Base.Meters.IStiMeasureMeter,Ft=(R.e.StiMeasureMeter=class extends R.e.StiMeter{implements(){let e=super.implements().concat([vt]);return(this.implements=()=>e)()}constructor(e,t,i){super(e,t,i)}},P.Report.Dashboard.StiTitlePadding),Tt=P.Report.Dashboard.IStiTitlePadding,Mt=P.Report.Dashboard.StiTextSizeMode,At=P.Base.Meta.StiFontMeta,Dt=P.Report.Dashboard.ImplementsIStiTitle,It=P.Report.Dashboard.IStiTitle,Rt=P.System.ICloneable,B=P.System.Drawing.Font,X=P.Base.Drawing.StiHorAlignment;{class _l{implements(){let e=[Rt,n,It,Tt,...Dt];return(this.implements=()=>e)()}meta(){return[new re("Text"),new i("ForeColor","",N.transparent),new i("BackColor","",N.transparent),new h("Visible","",!0),new At("Font","","Arial",11),new r("HorAlignment","",X,X.Left),new r("SizeMode","",Mt,Mt.Fit),new s("Padding").get(e=>this.padding.saveToJsonObject(0,0,0,0))]}saveToJsonObject(e){return u.saveToJsonObject(e,this)}loadFromJsonObject(e){u.loadFromJsonObject(e,this)}loadFromXml(e){u.loadFromXml(e,this)}static createFromJsonObject(e){let t=new _l;return t.loadFromJsonObject(e),t}static createFromXml(e){let t=new _l;return t.loadFromXml(e),t}clone(){return this[P.System.StiObject.stimulsoft]().memberwiseClone()}constructor(e,t,i,r,s,l,n,a){this.padding=Ft.create(0),this.horAlignment=X.Left,this.font=new B("Arial",11),this.backColor=N.transparent,this.foreColor=N.transparent,this.text="",this.visible=!0,this.sizeMode=Mt.Fit,null!=e&&(this.text=e),null!=t&&(this.foreColor=t),null!=i&&(this.backColor=i),null!=r&&(this.font=r),null!=s&&(this.horAlignment=s),null!=l&&(this.visible=l),null!=n&&(this.sizeMode=n),null!=a&&(this.padding=a)}}R.e.StiTitle=_l}let Et=P.Report.Helpers.StiFontIcons,kt=P.Report.Dashboard.IStiButtonElementIconSet;{class Nt{implements(){let e=[kt,Rt];return(this.implements=()=>e)()}meta(){return[new r("Icon","",Et).check(()=>null!=this.icon),new r("CheckedIcon","",Et).check(()=>null!=this.checkedIcon),new r("UncheckedIcon","",Et).check(()=>null!=this.uncheckedIcon)]}saveToJsonObject(e){return u.saveToJsonObject(e,this)}loadFromJsonObject(e){u.loadFromJsonObject(e,this)}loadFromXml(e){u.loadFromXml(e,this)}static createFromJsonObject(e){let t=new Nt;return t.loadFromJsonObject(e),t}static createFromXml(e){let t=new Nt;return t.loadFromXml(e),t}clone(){return this[P.System.StiObject.stimulsoft]().memberwiseClone()}isDefault(){return null==this.icon&&null==this.checkedIcon&&null==this.uncheckedIcon}constructor(e,t){this.icon=null,this.checkedIcon=null,this.uncheckedIcon=null,null!=e&&(this.checkedIcon=e),null!=t&&(this.uncheckedIcon=t)}}R.E.StiButtonElementIconSet=Nt}let Ot=P.Data.Engine.StiDataFilterCondition,Vt=P.Base.Meta.StiBrushMeta,Nt=R.E.StiButtonElementIconSet,G=P.Report.Dashboard.StiIconAlignment,Lt=P.Base.StiAlignValue,Bt=P.Report.Design.StiCopyStyleExtHub,Pt=P.Base.Drawing.StiStyleBrush,Ht=P.Base.Drawing.StiVertAlignment,J=P.Base.Drawing.StiBorderSides,jt=P.Base.Drawing.StiTextHorAlignment,zt=P.Report.Components.TextFormats.StiGeneralFormatService,y=P.Data.Engine.StiDataFilterRule,Xt=P.Report.Dashboard.StiButtonType,Gt=P.System.StiNumber,Jt=P.Base.Drawing.StiButtonShapeType,Wt=P.Report.Dashboard.StiButtonStretch,Ut=P.Report.Dashboard.ImplementsIStiButtonElement,Zt=P.Report.Design.IStiCopyStyleExt,Yt=P.Report.Components.IStiWordWrap,Kt=P.Report.Components.IStiTextBrush,Qt=P.Report.Dashboard.IStiButtonElement,qt=P.Report.Dashboard.ImplementsIStiFixedHeightElement,_t=P.Report.Components.ImplementsIStiFont,$t=P.Report.Components.ImplementsIStiVertAlignment,ei=P.Report.Components.ImplementsIStiTextHorAlignment,ti=P.Report.Components.IStiBrush,ii=P.Report.Dashboard.IStiFixedHeightElement,ri=P.Report.Components.IStiFont,si=P.Report.Components.IStiVertAlignment,li=P.Report.Components.IStiTextHorAlignment;{let t=P.Base.Drawing.SizeD,i=P.Base.Drawing.RectangleD;R.E.StiButtonElement=class extends R.e.StiElement{implements(){let e=super.implements().concat([Qt,Zt,li,si,Yt,ri,ii,ti,Kt,n,...Ut,...ei,...$t,..._t,...qt]);return(this.implements=()=>e)()}clone(e){let t,i,r,s,l,n,a,o,u,h=super.clone(e);return h.brush=null==(t=this.brush)?void 0:t.clone(),h.textBrush=null==(i=this.textBrush)?void 0:i.clone(),h.iconBrush=null==(r=this.iconBrush)?void 0:r.clone(),h.iconSet=null==(s=this.iconSet)?void 0:s.clone(),h.shadow=null==(l=this.shadow)?void 0:l.clone(),h.font=null==(n=this.font)?void 0:n.clone(),h.cornerRadius=null==(a=this.cornerRadius)?void 0:a.clone(),h.visualStates=this.visualStates.clone(),h.clickEvent=null==(o=this.clickEvent)?void 0:o.clone(),h.checkedChangedEvent=null==(u=this.checkedChangedEvent)?void 0:u.clone(),h}meta(){return[...super.meta(),new s("UserFilters").get(e=>a.Serialize.objectArray(this.userFilters,e)).set(e=>this.userFilters.addRange(e.value.properties().select(e=>y.loadFromJson(e.value)))).setXml(e=>this.userFilters.addRange(e.childNodes.map(e=>y.loadFromXml(e)))),new re("Text","","Button"),new r("Style","",o,o.Auto),new r("Type","",Xt,Xt.Button),new r("ShapeType","",Jt,Jt.Rectangle),new r("Stretch","",Wt,Wt.StretchXY),new l("CustomStyleName"),new l("Group"),new r("HorAlignment","",jt,jt.Center),new r("VertAlignment","",Ht,Ht.Center),new r("IconAlignment","",G,G.Left),new h("WordWrap","",!0),new l("CornerRadius").get(()=>this.cornerRadius.toString()).set(e=>this.cornerRadius=v.tryParse(e.value.toString())).setXml(e=>this.cornerRadius=v.tryParse(e.textContent)),new l("Shadow").get(()=>a.Serialize.jShadow(this.shadow)).set(e=>this.shadow=a.Deserialize.simpleSahdow(e.value)).setXml(e=>this.shadow=We.loadFromXml(e.textContent)),new Vt("Brush"),new Vt("TextBrush"),new Vt("IconBrush"),new At("Font","","Arial",10),new h("Checked"),new s("IconSet").check(()=>null!=this.iconSet&&!this.iconSet.isDefault()).get(()=>this.iconSet.saveToJsonObject(Le.Report)).set(e=>this.iconSet=Nt.createFromJsonObject(e.value)).setXml(e=>this.iconSet=Nt.createFromXml(e)),new s("VisualStates").check(()=>null!=this.visualStates).get(()=>this.visualStates.saveToJsonObject(Le.Report)).set(e=>this.visualStates=R.E.StiButtonVisualStates.createFromJsonObject(e.value)).setXml(e=>this.visualStates=R.E.StiButtonVisualStates.createFromXml(e)),new e("ClickEvent"),new e("CheckedChangedEvent"),new r("InclusionMode","",q,q.SelectionOnly)]}get isFixedHeight(){return this.stretch==Wt.StretchX}get checked(){return this.checkedValue}set checked(e){this.checkedValue!=e&&(this.checkedValue=e)}get stretch(){return this._stretch}set stretch(e){if(this._stretch!=e&&(this._stretch=e)==Wt.StretchX&&this.isDesigning){let e=this.getFixedHeight();null!=e&&(this.height=Gt.getValueOrDefault(e))}}getIconSet(){return this.iconSet}getVisualStates(){return this.visualStates}get style(){return this._style}set style(e){this._style!=e&&(this._style=e)!=o.Custom&&(this.customStyleName="")}get customStyleName(){return this._customStyleName}set customStyleName(e){this._customStyleName!=e&&(this._customStyleName=e,H.isNullOrWhiteSpace(e)||(this._style=o.Custom))}convertFrom(e){}getParentKey(){return""}setParentKey(e){}async applyDefaultFilters(){}getIdentityFilters(){let e=new y;return e.condition=Ot.Any,e.elementKey=this.key,e.toList()}getFonts(){let e=super.getFonts();return e.push(new B(this.font.name,this.font.size,this.font.style,this.font.unit)),e.push(...this.visualStates.getFonts()),e.filter((e,t,i)=>i.indexOf(e)===t)}get backColor(){return ge.toColor(this.brush)}set backColor(e){this.brush=new E(e)}get foreColor(){return ge.toColor(this.textBrush)}set foreColor(e){this.textBrush=new E(e)}invokeSetCopyStyle(){null!=Bt.visualStateDefault&&this.loadFromJsonObject(Bt.visualStateDefault),this.visualStates.invokeSetCopyStyle()}invokeGetCopyStyle(){Bt.visualStateDefault=this.saveToJsonObject(Le.Report),this.visualStates.invokeGetCopyStyle()}get toolboxPosition(){return _e.ButtonElement}get localizedName(){return T.get("Components","StiButton")}getFixedHeight(){let e,t=null==(e=this.report)?void 0:e.getCurrentPage();if(null==t)return null;return Lt.alignToMaxGrid(this.defaultClientRectangle.height,t.gridSize,!0)}get visualStates(){return this._visualStates}set visualStates(e){e!=this._visualStates&&null!=(this._visualStates=e)&&(e.parent=this)}get isChecked(){return me.isExpressionSpecified(this,"checked")?he.parseBoolExpression(this,"checked",!0):this.checked}getMinSize(){if(!this.isFixedHeight)return super.getMinSize();let e=this.getFixedHeight();if(null==e)return t.empty;return new t(0,Gt.getValueOrDefault(e))}setMinSize(e){this.isFixedHeight||super.setMinSize(e)}getMaxSize(){if(!this.isFixedHeight)return super.getMaxSize();let e=this.getFixedHeight();if(null==e)return t.empty;return new t(0,Gt.getValueOrDefault(e))}setMaxSize(e){this.isFixedHeight||super.setMaxSize(e)}invokeCheckedChanged(e,t){}constructor(e=L.empty){super(e),this.checkedValue=!1,this.shapeType=Jt.Rectangle,this._stretch=Wt.StretchXY,this.type=Xt.Button,this.shadow=new We,this._style=o.Auto,this._customStyleName="",this.userFilters=new j,this.textFormat=new zt,this.font=new B("Arial",10),this.inclusionMode=q.SelectionOnly,this.cornerRadius=new v,this.horAlignment=jt.Center,this.vertAlignment=Ht.Center,this.wordWrap=!0,this.brush=new Pt,this.textBrush=new Pt,this.defaultClientRectangle=new i(0,0,140,40),this.helpUrl="user-manual/dashboards_data_filtering_button.htm",this.text="Button",this.group="",this.iconAlignment=G.Left,this.iconBrush=new Pt,this.checkedChangedEvent=null,this.iconSet=new Nt,this.visualStates=new R.E.StiButtonVisualStates,this.border2.side=J.All,this.border2.size=2}}}let ni=P.Base.Drawing.StiDefaultBrush,ai=P.Report.Dashboard.IStiButtonVisualState;{class Gg{constructor(){this.font=null,this.brush=new ni,this.textBrush=new ni,this.border=null,this.iconSet=new R.E.StiButtonElementIconSet,this.iconBrush=new ni}implements(){let e=[ai,Rt];return(this.implements=()=>e)()}meta(){return[new Vt("Brush").check(()=>null!=this.brush),new Vt("TextBrush").check(()=>null!=this.textBrush),new Vt("IconBrush").check(()=>null!=this.iconBrush),new l("Font").check(()=>null!=this.font).get(()=>a.Serialize.font(this.font)).set(e=>this.font=a.Deserialize.font(e.value,null)).setXml(e=>this.font=P.System.Convert.toFont(e.textContent)),new l("Border").check(()=>null!=this.border).get(()=>a.Serialize.jBorder2(this.border)).set(e=>this.border=a.Deserialize.simpleBorder(e.value)).setXml(e=>this.border=a.Deserialize.simpleBorder(e.textContent)),new s("IconSet").check(()=>null!=this.iconSet&&!this.iconSet.isDefault()).get(()=>this.iconSet.saveToJsonObject(Le.Report)).set(e=>this.iconSet=R.E.StiButtonElementIconSet.createFromJsonObject(e.value)).setXml(e=>this.iconSet=R.E.StiButtonElementIconSet.createFromXml(e))]}saveToJsonObject(e){return u.saveToJsonObject(e,this)}loadFromJsonObject(e){u.loadFromJsonObject(e,this)}loadFromXml(e){u.loadFromXml(e,this)}static createFromJsonObject(e){let t=new Gg;return t.loadFromJsonObject(e),t}static createFromXml(e){let t=new Gg;return t.loadFromXml(e),t}clone(){let e,t,i,r,s,l,n=this[P.System.StiObject.stimulsoft]().memberwiseClone();return n.border=null==(e=this.border)?void 0:e.clone(),n.brush=null==(t=this.brush)?void 0:t.clone(),n.textBrush=null==(i=this.textBrush)?void 0:i.clone(),n.iconBrush=null==(r=this.iconBrush)?void 0:r.clone(),n.font=null==(s=this.font)?void 0:s.clone(),n.iconSet=null==(l=this.iconSet)?void 0:l.clone(),n}getIconSet(){return this.iconSet}}R.E.StiButtonVisualState=Gg}let oi=P.Base.IStiGetFonts,ui=P.Report.Dashboard.IStiButtonVisualStates;{class Jg{implements(){let e=[ui,Rt,oi,Zt];return(this.implements=()=>e)()}meta(){return[new s("Hover").check(()=>null!=this.hover).get(()=>this.hover.saveToJsonObject(Le.Report)).set(e=>this.hover=R.E.StiButtonVisualState.createFromJsonObject(e.value)).setXml(e=>this.hover=R.E.StiButtonVisualState.createFromXml(e)),new s("Pressed").check(()=>null!=this.pressed).get(()=>this.pressed.saveToJsonObject(Le.Report)).set(e=>this.pressed=R.E.StiButtonVisualState.createFromJsonObject(e.value)).setXml(e=>this.pressed=R.E.StiButtonVisualState.createFromXml(e)),new s("Checked").check(()=>null!=this.checked).get(()=>this.checked.saveToJsonObject(Le.Report)).set(e=>this.checked=R.E.StiButtonVisualState.createFromJsonObject(e.value)).setXml(e=>this.checked=R.E.StiButtonVisualState.createFromXml(e))]}saveToJsonObject(e){return u.saveToJsonObject(e,this)}loadFromJsonObject(e){u.loadFromJsonObject(e,this)}loadFromXml(e){u.loadFromXml(e,this)}static createFromJsonObject(e){let t=new Jg;return t.loadFromJsonObject(e),t}static createFromXml(e){let t=new Jg;return t.loadFromXml(e),t}clone(){let e=this[P.System.StiObject.stimulsoft]().memberwiseClone();return e.hover=this.hover.clone(),e.pressed=this.pressed.clone(),e.checked=this.checked.clone(),e}getFonts(){let e=new j;return e.add(this.hover.font),e.add(this.pressed.font),e.add(this.checked.font),e.distinct().toList()}invokeSetCopyStyle(){null!=Bt.visualStateHover&&(this.hover=new R.E.StiButtonVisualState,this.hover.loadFromJsonObject(Bt.visualStateHover)),null!=Bt.visualStatePressed&&(this.pressed=new R.E.StiButtonVisualState,this.pressed.loadFromJsonObject(Bt.visualStatePressed)),null!=Bt.visualStateChecked&&(this.checked=new R.E.StiButtonVisualState,this.checked.loadFromJsonObject(Bt.visualStateDisabled))}invokeGetCopyStyle(){Bt.visualStateHover=this.hover.saveToJsonObject(Le.Report),Bt.visualStatePressed=this.pressed.saveToJsonObject(Le.Report),Bt.visualStateChecked=this.checked.saveToJsonObject(Le.Report)}getHoverState(){return this.hover}getPressedState(){return this.pressed}getCheckedState(){return this.checked}get hover(){return this._hover}set hover(e){this._hover!=e&&null!=(this._hover=e)&&(e.parent=this.parent)}get pressed(){return this._pressed}set pressed(e){this._pressed!=e&&null!=(this._pressed=e)&&(e.parent=this.parent)}get checked(){return this._checked}set checked(e){this._checked!=e&&null!=(this._checked=e)&&(e.parent=this.parent)}constructor(){this.hover=new R.E.StiButtonVisualState,this.pressed=new R.E.StiButtonVisualState,this.checked=new R.E.StiButtonVisualState}}R.E.StiButtonVisualStates=Jg}let hi=P.Base.StiActivator,mi=(R.x.StiDashboardInteractionLoader=class{static loadInteractionFromJsonObject(e){let t=e.properties().firstOrDefault(e=>"Ident"==e.name).value.toString(),i=R.x.StiDashboardInteractionCreator.new2(t);return i.loadFromJsonObject(e),i}static loadInteractionFromXml(i){let e=i.attributes.getNamedItem("type");if(null!=e){let t=i.attributes.getNamedItem("type").value;if(!H.isNullOrEmpty(t)){let e=hi.createObject2(t);if(null!=e)return e.loadFromXml(i),e}}return null}},P.Report.Dashboard.IStiDashboardInteraction),ci=P.Report.Dashboard.StiInteractionOnHover,di=P.Report.Dashboard.StiInteractionOnClick,gi=P.Report.Dashboard.StiInteractionOpenHyperlinkDestination,pi=P.Report.Dashboard.StiInteractionIdent,Si=P.Report.Dashboard.StiAvailableInteractionOnClick,wi=P.Report.Dashboard.StiAvailableInteractionOnHover,fi=P.Report.Dashboard.StiAvailableInteractionOnDataManipulation,bi=(R.g.StiDashboardInteraction=class{implements(){let e=[mi,n];return(this.implements=()=>e)()}is(e){if(e instanceof P.System.Interface)return-1!=this.implements().indexOf(e);if("function"==typeof e)return this instanceof e;if(null==e)throw new Error("Type for comparison is 'undefined'");return!1}is2(e){return this.is(e)}as(e){if(this.is(e))return this;return null}clone(e=!0,t=!0){return this[P.System.StiObject.stimulsoft]().memberwiseClone()}meta(){return[new r("Ident","",pi),new r("OnHover","",ci),new r("OnClick","",di),new r("HyperlinkDestination","",gi),new l("ToolTip"),new l("DrillDownPageKey"),new l("Hyperlink"),new s("DrillDownParameters").get(e=>a.Serialize.objectArray(this.drillDownParameters,e)).set(e=>this.drillDownParameters.addRange(e.value.properties().select(e=>R.g.StiDashboardDrillDownParameter.loadFromJson(e.value)))).setXml(e=>this.drillDownParameters.addRange(e.childNodes.map(e=>R.g.StiDashboardDrillDownParameter.loadFromXml(e))))]}saveToJsonObject(e){return u.saveToJsonObject(e,this)}loadFromJsonObject(e){u.loadFromJsonObject(e,this)}loadFromXml(e){u.loadFromXml(e,this)}isDefault(){return this.onHover==ci.ShowToolTip&&this.onClick==di.ApplyFilter&&this.hyperlinkDestination==gi.NewTab&&H.isNullOrEmpty(this.hyperlink)&&H.isNullOrEmpty(this.drillDownPageKey)&&null!=this.drillDownParameters&&0==this.drillDownParameters.length&&H.isNullOrEmpty(this.toolTip)}getDrillDownParameters(){return this.drillDownParameters.cast().toList()}setDrillDownParameters(e){this.drillDownParameters=new j,null!=e&&e.forEach(e=>{let t=new R.g.StiDashboardDrillDownParameter;t.name=e["name"],t.expression=e["expression"],this.drillDownParameters.add(t)})}constructor(e,t,i,r,s,l,n){this.availableOnClick=Si.All,this.availableOnHover=wi.All,this.availableOnDataManipulation=fi.None,this.onHover=ci.ShowToolTip,this.onClick=di.ApplyFilter,this.hyperlinkDestination=gi.NewTab,this.toolTip="",this.hyperlink="",this.drillDownPageKey="",this.drillDownParameters=new j,null!=e&&(this.onHover=e),null!=t&&(this.onClick=t),null!=i&&(this.hyperlinkDestination=i),null!=r&&(this.toolTip=r),null!=s&&(this.hyperlink=s),null!=l&&(this.drillDownPageKey=l),null!=n&&(this.drillDownParameters=n)}},R.g.StiCardsColumnDashboardInteraction=class extends R.g.StiDashboardInteraction{isDefault(){return this.onHover==ci.None&&this.onClick==di.None&&this.hyperlinkDestination==gi.NewTab&&H.isNullOrEmpty(this.hyperlink)&&H.isNullOrEmpty(this.drillDownPageKey)&&null!=this.drillDownParameters&&0==this.drillDownParameters.length&&H.isNullOrEmpty(this.toolTip)}constructor(e,t,i,r,s,l,n){super(e,t,i,r,s,l,n),this.ident=pi.CardsColumn,this.availableOnClick=Si.OpenHyperlink|Si.ShowDashboard,this.onHover=ci.None,this.onClick=di.None}},R.x.StiDashboardInteractionLoader),yi=R.g.StiCardsColumnDashboardInteraction,Ci=P.Report.Dashboard.IStiElementInteraction,xi=P.Base.Meters.IStiCardsColumn,vi=P.Base.Drawing.StiCardsColumnVisibility,Fi=P.Report.Components.ImplementsIStiForeColor,Ti=P.Report.Components.ImplementsIStiHorAlignment,Mi=P.Report.Components.TextFormats.StiFormatService,Ai=P.Report.Components.IStiForeColor,Di=P.Report.Components.IStiTextFormat,Ii=P.Report.Components.IStiHorAlignment,Ri=P.Data.Engine.IStiDataTopN,Ei=P.Data.Engine.StiDataTopN,ki=(R.F.StiCardsColumn=class extends R.e.StiMeter{implements(){let e=super.implements().concat([xi,Ii,si,Ai,Di,ri,Yt,Ri,Ci,...Ti,...Fi,..._t]);return(this.implements=()=>e)()}meta(){return[...super.meta(),new r("HorAlignment","",X,X.Center),new r("VertAlignment","",Ht,Ht.Center),new ie("Height",""),new h("WrapLine","",!0),new s("TextFormat").check(()=>!(this.textFormat.is(zt)||null==this.textFormat)).set(e=>this.textFormat=Mi.createFromJsonObject(e.value)).setXml(e=>{let t=Mi.loadFormatFromXml(e);null!=t&&(this.textFormat=t)}),new s("TopN").check(()=>null!=this.topN).set(e=>this.topN=Ei.createFromJsonObject(e.value)).setXml(e=>this.topN=Ei.createFromXml(e)),new i("ForeColor","",N.transparent),new r("Visibility","",vi,vi.True),new At("Font","","Arial",10),new l("VisibilityExpression").check(()=>null!=this.visibilityExpression),new h("WordWrap",""),new s("DashboardInteraction").check(()=>null!=this.dashboardInteraction.as(yi)).set(e=>{let t,i=null==(t=bi.loadInteractionFromJsonObject(e.value))?void 0:t.as(yi);null!=i&&(this.dashboardInteraction=i)}).setXml(e=>{let t,i=null==(t=bi.loadInteractionFromXml(e))?void 0:t.as(yi);null!=i&&(this.dashboardInteraction=i)})]}clone(){let e=super.clone();return e.textFormat=this.textFormat.clone(),e.dashboardInteraction=this.dashboardInteraction.clone(),e.topN=this.topN.clone(),e}getUniqueCode(){let e=super.getUniqueCode();return e=397*(e=397*(e=397*(e=397*(e=397*(e=397*(e=397*(e=397*e^this.horAlignment)^this.vertAlignment)^(null!=this.textFormat?this.textFormat[P.System.StiObject.stimulsoft]().getHashCode():0))^this.visibility[P.System.StiObject.stimulsoft]().getHashCode())^this.wrapLine[P.System.StiObject.stimulsoft]().getHashCode())^this.wordWrap[P.System.StiObject.stimulsoft]().getHashCode())^this.height[P.System.StiObject.stimulsoft]().getHashCode())^(null!=this.topN?this.topN[P.System.StiObject.stimulsoft]().getHashCode():0),null!=this.visibilityExpression&&(e=397*e^this.visibilityExpression[P.System.StiObject.stimulsoft]().getHashCode()),Math.abs(e)}constructor(e,t,i,r,s,l,n,a,o,u,h,m,c,d){super(e,t,i),this.horAlignment=X.Center,this.vertAlignment=Ht.Center,this.textFormat=new zt,this.topN=new Ei,this.font=new B("Arial",10),this.foreColor=N.transparent,this.dashboardInteraction=new yi,this.wrapLine=!0,this.height=0,this.wordWrap=!1,this.visibility=vi.True,this.visibilityExpression=null,null!=r&&(this.horAlignment=r),null!=s&&(this.vertAlignment=s),null!=n&&(this.textFormat=n),null!=a&&(this.visibility=a),null!=o&&(this.visibilityExpression=o),null!=u&&(this.foreColor=u),null!=l&&(this.height=l),null!=h&&(this.wrapLine=h),null!=m&&(this.wordWrap=m),null!=c&&(this.dashboardInteraction=c),null!=d&&(this.topN=d)}},P.Base.Meters.IStiMeasureCardsColumn),Oi=R.F.StiCardsColumn,Vi=P.Base.Meters.IStiMeasureColumn,Ni=(R.F.StiMeasureCardsColumn=class extends Oi{implements(){let e=super.implements().concat([vt,Vi,ki]);return(this.implements=()=>e)()}get localizedName(){return b.get("Dashboard","Measure")}constructor(e,t,i,r,s,l,n,a,o,u,h){super(e,t,i,r,s,l,n,a,o,u,h),this.ident=R.e.StiMeterIdent.MeasureCardsColumn}},R.F.StiMeasureCardsColumn),Li=P.Base.Drawing.StiColor,Bi=P.Base.Meters.IStiBubbleColumn,Pi=(R.F.StiBubbleCardsColumn=class extends Ni{implements(){let e=super.implements().concat([Bi,n]);return(this.implements=()=>e)()}meta(){return[...super.meta(),new r("HorAlignment","",X,X.Center),new h("AllowCustomColors"),new i("PositiveColor","",Li.get("537eb6")),new i("NegativeColor","",Li.get("ff0000"))]}getUniqueCode(){let e=super.getUniqueCode();return e=397*e^this.horAlignment[P.System.StiObject.stimulsoft]().getHashCode(),Math.abs(e)}get localizedName(){return b.get("Chart","Bubble")}constructor(e,t,i,r,s,l,n,a,o,u,h,m,c,d){super(e,t,i,r,s,l,n,a,o,u,d),this.ident=R.e.StiMeterIdent.BubbleCardsColumn,this.allowCustomColors=!1,this.positiveColor=Li.get("537eb6"),this.negativeColor=Li.get("ff0000"),this.horAlignment=X.Center,null!=h&&(this.allowCustomColors=h),null!=m&&(this.positiveColor=m),null!=c&&(this.negativeColor=c)}},P.Base.Meters.IStiDimensionCardsColumn),Hi=(R.F.StiDimensionCardsColumn=class extends Oi{implements(){let e=super.implements().concat([Pe,Pi]);return(this.implements=()=>e)()}get localizedName(){return b.get("Dashboard","Dimension")}constructor(e,t,i,r,s,l,n,a,o,u,h){super(e,t,i,r,s,l,n,a,o,u,h),this.ident=R.e.StiMeterIdent.DimensionCardsColumn}},R.G.StiMeterLoader=class{static loadFromJson2(e){let t=new j;return e.forEach(e=>t.add(this.loadFromJson(e))),t.where(e=>null!=e)}static loadFromJson(i){let r=i.properties().firstOrDefault(e=>"Ident"==e.name);if(null!=r){let e=r.value.toString(),t=R.G.StiMeterCreator.neww(e);if(null!=t)return t.loadFromJsonObject(i),t}return null}static loadFromXml(i){let e=i.attributes.getNamedItem("type");if(null!=e){let t=i.attributes.getNamedItem("type").value;if(!H.isNullOrEmpty(t)){let e=hi.createObject2(t);if(null!=e)return e.loadFromXml(i),e}}return null}},R.H.StiIndicatorValueChartMeter=class extends R.e.StiMeasureMeter{get localizedName(){return b.get("PropertyMain","IndicatorValue")}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.IndicatorValueChartMeter}},P.Base.Meters.IStiArgumentMeter),ji=(R.H.StiArgumentChartMeter=class extends R.e.StiDimensionMeter{implements(){let e=super.implements().concat([Hi]);return(this.implements=()=>e)()}get localizedName(){return b.get("PropertyMain","Argument")}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.ArgumentChartMeter}},P.Base.Meters.IStiValueMeter),zi=(R.I.StiKeyTreeViewBoxMeter=class extends R.e.StiDimensionMeter{implements(){let e=super.implements().concat([ji]);return(this.implements=()=>e)()}get localizedName(){return b.get("PropertyMain","Key")}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.KeyTreeViewBoxMeter}},R.J.StiKeyTreeViewMeter=class extends R.e.StiDimensionMeter{implements(){let e=super.implements().concat([ji]);return(this.implements=()=>e)()}get localizedName(){return b.get("PropertyMain","Key")}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.KeyTreeViewMeter}},R.g.StiTableColumnDashboardInteraction=class extends R.g.StiDashboardInteraction{isDefault(){return this.onHover==ci.None&&this.onClick==di.None&&this.hyperlinkDestination==gi.NewTab&&H.isNullOrEmpty(this.hyperlink)&&H.isNullOrEmpty(this.drillDownPageKey)&&null!=this.drillDownParameters&&0==this.drillDownParameters.length&&H.isNullOrEmpty(this.toolTip)}constructor(e,t,i,r,s,l,n){super(e,t,i,r,s,l,n),this.ident=pi.TableColumn,this.availableOnClick=Si.ApplyFilter|Si.ShowDashboard,this.onHover=ci.None,this.onClick=di.None}},P.Base.Drawing.StiTableColumnVisibility),Xi=P.Data.Engine.IStiDataFormat,Gi=P.Report.Components.TextFormats.StiTimeFormatService,Ji=P.Report.Components.TextFormats.StiDateFormatService,Wi=P.Report.Components.TextFormats.StiNumberFormatService,Ui=P.Report.Components.TextFormats.StiCurrencyFormatService,Zi=P.Report.Components.TextFormats.StiPercentageFormatService,Yi=P.Report.Components.TextFormats.StiBooleanFormatService,Ki=P.Data.Engine.StiDataFormatKind,Qi=P.Base.StiSummaryColumnType,qi=R.g.StiTableColumnDashboardInteraction,_i=P.Report.Components.ImplementsIStiTextFormat,$i=P.Base.Meters.IStiTableColumn,er=(R.K.StiTableColumn=class extends R.e.StiMeter{implements(){let e=super.implements().concat([Ii,Di,$i,Xi,Ai,Ri,...Ti,..._i,...Fi,n,Ci]);return(this.implements=()=>e)()}meta(){return[...super.meta(),new r("HorAlignment","",X,X.Left),new r("SummaryAlignment","",X,X.Right),new r("HeaderAlignment","",X,X.Center),new s("TextFormat").check(()=>!(this.textFormat.is(zt)||null==this.textFormat)).set(e=>this.textFormat=Mi.createFromJsonObject(e.value)).setXml(e=>{let t=Mi.loadFormatFromXml(e);null!=t&&(this.textFormat=t)}),new i("ForeColor","",N.transparent),new h("ShowTotalSummary"),new r("SummaryType","",Qi,Qi.Sum),new h("Visible","",!0).check(()=>!1),new r("Visibility","",zi,zi.True),new l("VisibilityExpression").check(()=>null!=this.visibilityExpression),new s("TopN").check(()=>null!=this.topN).set(e=>this.topN=Ei.createFromJsonObject(e.value)).setXml(e=>this.topN=Ei.createFromXml(e)),new s("DashboardInteraction").check(()=>null!=this.dashboardInteraction.as(qi)).set(e=>{let t,i=null==(t=bi.loadInteractionFromJsonObject(e.value))?void 0:t.as(qi);null!=i&&(this.dashboardInteraction=i)}).setXml(e=>{let t,i=null==(t=bi.loadInteractionFromXml(e))?void 0:t.as(qi);null!=i&&(this.dashboardInteraction=i)})]}clone(){let e=super.clone();return e.textFormat=this.textFormat.clone(),e.dashboardInteraction=this.dashboardInteraction.clone(),e.topN=this.topN.clone(),e}getDataFormat(){if(this.textFormat.is(Yi))return Ki.Boolean;if(this.textFormat.is(Zi))return Ki.Percentage;if(this.textFormat.is(Ui))return Ki.Currency;if(this.textFormat.is(Wi))return Ki.Number;if(this.textFormat.is(Ji))return Ki.Date;if(this.textFormat.is(Gi))return Ki.Time;return Ki.General}getUniqueCode(){let e=super.getUniqueCode();return e=397*(e=397*(e=397*(e=397*(e=397*(e=397*(e=397*e^this.horAlignment)^this.summaryAlignment)^this.headerAlignment)^this.summaryType)^(null!=this.textFormat?this.textFormat[P.System.StiObject.stimulsoft]().getHashCode():0))^this.visibility[P.System.StiObject.stimulsoft]().getHashCode())^(null!=this.topN?this.topN[P.System.StiObject.stimulsoft]().getHashCode():0),null!=this.visibilityExpression&&(e=397*e^this.visibilityExpression[P.System.StiObject.stimulsoft]().getHashCode()),Math.abs(e)}get visible(){return this.visibility==zi.True}set visible(e){this.visibility=e?zi.True:zi.False}constructor(e,t,i,r,s,l,n,a,o,u,h,m,c,d){super(e,t,i),this.horAlignment=X.Left,this.textFormat=new zt,this.topN=new Ei,this.foreColor=N.transparent,this.dashboardInteraction=new qi,this.visibility=zi.True,this.visibilityExpression=null,this.showTotalSummary=!1,this.summaryType=Qi.Sum,this.summaryAlignment=X.Right,this.headerAlignment=X.Center,null!=r&&(this.horAlignment=r),null!=s&&(this.textFormat=s),null!=l&&(this.visibility=l),null!=n&&(this.visibilityExpression=n),null!=o&&(this.showTotalSummary=o),null!=h&&(this.summaryAlignment=h),null!=m&&(this.headerAlignment=m),null!=u&&(this.summaryType=u),null!=a&&(this.foreColor=a),null!=c&&(this.dashboardInteraction=c),null!=d&&(this.topN=d)}},R.K.StiMeasureColumn=class extends R.K.StiTableColumn{implements(){let e=super.implements().concat([vt,Vi]);return(this.implements=()=>e)()}get localizedName(){return b.get("Dashboard","Indicator")}constructor(e,t,i,r,s,l,n,a,o,u,h,m,c){super(e,t,i,r,s,l,n,a,o,u,h,m,c),this.ident=R.e.StiMeterIdent.MeasureColumn}},P.Base.Meters.IStiIndicatorColumn),tr=(R.K.StiIndicatorColumn=class extends R.K.StiMeasureColumn{implements(){let e=super.implements().concat([er]);return(this.implements=()=>e)()}get localizedName(){return b.get("Dashboard","Dimension")}constructor(e,t,i,r,s,l,n,a,o,u,h){super(e,t,i,r,s,l,n,a,o,u,h),this.ident=R.e.StiMeterIdent.IndicatorColumn}},P.Base.Meters.IStiColorScaleColumn),ir=(R.K.StiColorScaleColumn=class extends R.K.StiMeasureColumn{implements(){let e=super.implements().concat([tr,n]);return(this.implements=()=>e)()}meta(){return[...super.meta(),new i("MinimumColor","",N.red),new i("MaximumColor","",N.green)]}getUniqueCode(){let e=super.getUniqueCode();return e=397*(e=397*e^this.minimumColor[P.System.StiObject.stimulsoft]().getHashCode())^this.maximumColor[P.System.StiObject.stimulsoft]().getHashCode(),Math.abs(e)}get localizedName(){return b.get("Dashboard","ColorScale")}constructor(e,t,i,r,s,l,n,a,o,u,h,m,c){super(e,t,i,r,s,l,n,a,o,u,h),this.ident=R.e.StiMeterIdent.ColorScaleColumn,this.minimumColor=N.red,this.maximumColor=N.green,null!=m&&(this.minimumColor=m),null!=c&&(this.maximumColor=c)}},P.Base.Meters.IStiDataBarsColumn),rr=(R.K.StiDataBarsColumn=class extends R.K.StiMeasureColumn{implements(){let e=super.implements().concat([ir,n]);return(this.implements=()=>e)()}meta(){return[...super.meta(),new r("HorAlignment","",X,X.Center),new ie("Width","",0),new re("Minimum"),new re("Maximum"),new i("PositiveColor","",N.transparent),new i("NegativeColor","",N.transparent),new i("OverlappedColor","",N.transparent),new i("FillColor","",N.transparent)]}getUniqueCode(){let e=super.getUniqueCode();return e=397*(e=397*(e=397*(e=397*(e=397*(e=397*(e=397*(e=397*e^this.width[P.System.StiObject.stimulsoft]().getHashCode())^this.horAlignment)^this.positiveColor.getHashCode())^this.negativeColor.getHashCode())^this.overlappedColor.getHashCode())^this.fillColor.getHashCode())^(null!=this.minimum?this.minimum[P.System.StiObject.stimulsoft]().getHashCode():0))^(null!=this.maximum?this.maximum[P.System.StiObject.stimulsoft]().getHashCode():0)}get localizedName(){return b.get("Dashboard","DataBars")}constructor(e,t,i,r,s,l,n,a,o,u,h,m,c,d,g,p,S,w,f){super(e,t,i,r,s,l,n,a,c,d,g),this.ident=R.e.StiMeterIdent.DataBarsColumn,this.width=0,this.positiveColor=N.transparent,this.negativeColor=N.transparent,this.overlappedColor=N.transparent,this.fillColor=N.transparent,this.minimum="",this.maximum="",null!=p&&(this.headerAlignment=p),null!=o&&(this.positiveColor=o),null!=u&&(this.negativeColor=u),null!=h&&(this.overlappedColor=h),null!=m&&(this.fillColor=m),null!=S&&(this.width=S),null!=w&&(this.minimum=w),null!=f&&(this.maximum=f)}},P.Base.Meters.IStiSparklinesColumn),sr=(R.K.StiSparklinesColumn=class extends R.K.StiMeasureColumn{implements(){let e=super.implements().concat([rr,n]);return(this.implements=()=>e)()}meta(){return[...super.meta(),new r("Type","",R.K.StiSparklinesType,R.K.StiSparklinesType.Area),new h("ShowHighLowPoints"),new h("ShowFirstLastPoints","",!0),new h("AllowCustomColors"),new i("PositiveColor","",Li.get("537eb6")),new i("NegativeColor","",Li.get("ff0000"))]}getUniqueCode(){let e=super.getUniqueCode();return e=397*(e=397*(e=397*(e=397*(e=397*(e=397*e^this.type[P.System.StiObject.stimulsoft]().getHashCode())^this.showHighLowPoints[P.System.StiObject.stimulsoft]().getHashCode())^this.showFirstLastPoints[P.System.StiObject.stimulsoft]().getHashCode())^this.allowCustomColors[P.System.StiObject.stimulsoft]().getHashCode())^this.positiveColor[P.System.StiObject.stimulsoft]().getHashCode())^this.negativeColor[P.System.StiObject.stimulsoft]().getHashCode(),Math.abs(e)}get localizedName(){return b.get("Dashboard","Sparklines")}constructor(e,t,i,r,s,l,n,a,o,u,h,m,c,d,g,p,S){super(e,t,i,r,s,o,u,h,m,c,d),this.type=R.K.StiSparklinesType.Area,this.showHighLowPoints=!1,this.showFirstLastPoints=!0,this.allowCustomColors=!1,this.positiveColor=Li.get("537eb6"),this.negativeColor=Li.get("ff0000"),this.ident=R.e.StiMeterIdent.SparklinesColumn,null!=l&&(this.type=l),null!=n&&(this.showHighLowPoints=n),null!=a&&(this.showFirstLastPoints=a),null!=g&&(this.allowCustomColors=g),null!=p&&(this.positiveColor=p),null!=S&&(this.negativeColor=S)}},R.K.StiBubbleColumn=class extends R.K.StiMeasureColumn{implements(){let e=super.implements().concat([Bi,n]);return(this.implements=()=>e)()}meta(){return[...super.meta(),new r("HorAlignment","",X,X.Center),new h("AllowCustomColors"),new i("PositiveColor","",Li.get("537eb6")),new i("NegativeColor","",Li.get("ff0000"))]}getUniqueCode(){let e=super.getUniqueCode();return e=397*(e=397*(e=397*e^this.allowCustomColors[P.System.StiObject.stimulsoft]().getHashCode())^this.positiveColor[P.System.StiObject.stimulsoft]().getHashCode())^this.negativeColor[P.System.StiObject.stimulsoft]().getHashCode(),Math.abs(e)}get localizedName(){return b.get("Chart","Bubble")}constructor(e,t,i,r,s,l,n,a,o,u,h,m,c,d){super(e,t,i,r,s,l,n,a,o,u,h),this.ident=R.e.StiMeterIdent.BubbleColumn,this.allowCustomColors=!1,this.positiveColor=Li.get("537eb6"),this.negativeColor=Li.get("ff0000"),this.horAlignment=X.Center,null!=m&&(this.allowCustomColors=m),null!=c&&(this.positiveColor=c),null!=d&&(this.negativeColor=d)}},P.System.Globalization.CultureInfo),lr=(R.h.StiCultureHelper=class{static set(e){let t=null==e?void 0:e.getParsedCulture();if(H.isNullOrWhiteSpace(t))return null;let i=sr.currentCulture;try{H.isNullOrEmpty(t)||null==sr.cultures[t]||(sr.currentCulture=sr.cultures[t])}catch(e){}return i}static restore(e){if(null==e)return;sr.currentCulture=e}},R.a.StiTextFormatState),nr=P.Data.Functions.StiExtValueConverter,ar=R.h.StiCultureHelper,or=P.Report.Dictionary.StiDataColumn,ur=P.Data.Helpers.StiMoneyNameHelper,hr=P.System.TimeSpan;{class ls{static get defaultGeneralFormat(){return null==this._defaultGeneralFormat&&(this._defaultGeneralFormat=new zt),this._defaultGeneralFormat}static get defaultCurrencyFormat(){return null==this._defaultCurrencyFormat&&(this._defaultCurrencyFormat=new Ui),this._defaultCurrencyFormat}static get defaultPercentageFormat(){return null==this._defaultPercentageFormat&&(this._defaultPercentageFormat=new Zi,this._defaultPercentageFormat.positivePattern=1,this._defaultPercentageFormat.negativePattern=1,this._defaultPercentageFormat.decimalDigits=0,this._defaultPercentageFormat.groupSize=100,this._defaultPercentageFormat.state=lr.DecimalDigits|lr.GroupSize|lr.PositivePattern|lr.NegativePattern),this._defaultPercentageFormat}static get defaultNumberFormat(){return null==this._defaultNumberFormat&&(this._defaultNumberFormat=new Wi),this._defaultNumberFormat}static get defaultIntegerFormat(){return null==this._defaultIntegerFormat&&(this._defaultIntegerFormat=new Wi,this._defaultIntegerFormat.decimalDigits=0,this._defaultIntegerFormat.useGroupSeparator=!1,this._defaultIntegerFormat.useLocalSetting=!1),this._defaultIntegerFormat}static get defaultDateFormat(){return null==this._defaultDateFormat&&(this._defaultDateFormat=new Ji),this._defaultDateFormat}static get defaultBooleanFormat(){return null==this._defaultBooleanFormat&&(this._defaultBooleanFormat=new Yi),this._defaultBooleanFormat}static formatBasedOnColumnType(e,t,i){let r=t.cache[i];return null==r&&(r=ls.formatBasedOnColumnType2(e,t.textFormat,t,i),t.cache[i]=r),r}static formatBasedOnColumnType2(t,i,r,s){var l;this.storedCulture=ar.set(t.report);try{if(null==s)return"";if(null==r)return s.toString();let e=null==(l=null==t?void 0:t.report)?void 0:l.getParsedCulture();if(nr.isEligable(s,e))return nr.convert(s,e);if(null==i||i instanceof zt){let e=typeof s;if("number"==e&&ur.isMoneyName(r.label))return this.defaultCurrencyFormat.format(s);if("number"==e)return this.defaultNumberFormat.format(s);if("boolean"==e)return this.defaultBooleanFormat.format(s);if("object"==e){let e=Oe.getType(s);if(Oe.isDateType(e))return this.defaultDateFormat.format(s)}}if(null!=i&&i instanceof Gi){if(s instanceof hr)return i.format(s);let e=typeof s;if("number"==e){let e=hr.fromMilliseconds(s);return i.format(e)}if("string"==e){let{successfully:e,result:t}=Gt.tryParse(s);if(e){let e=hr.fromMilliseconds(t);return i.format(e)}}}return i.format(s)}catch(e){return s.toString()}finally{R.h.StiCultureHelper.restore(this.storedCulture)}}static format(e,t,i){this.storedCulture=ar.set(e);try{if(null==i)return"";return null!=t?t.format(i):i.toString()}catch(e){return i.toString()}finally{R.h.StiCultureHelper.restore(this.storedCulture)}}static formatAsPercentage(e,t){this.storedCulture=ar.set(e);try{if(null==t)return"";return this.defaultPercentageFormat.format(t)}catch(e){return t.toString()}finally{R.h.StiCultureHelper.restore(this.storedCulture)}}static formatAsPercentage2(e,t,i){this.storedCulture=ar.set(e);try{if(null==i)return"";if(null==t||t.is(zt))return this.defaultPercentageFormat.format(i);return t.format(i)}catch(e){return i.toString()}finally{R.h.StiCultureHelper.restore(this.storedCulture)}}static getDefaultFormatForColumn(e){let t=R.h.StiMeterHelper.toDataType(e);if(null==t)return this.defaultGeneralFormat;if(Oe.isNumericType(t)){if(ur.isMoneyName(e.as(or).nameInSource))return this.defaultCurrencyFormat;if(Oe.isIntegerType(t))return this.defaultIntegerFormat;return this.defaultNumberFormat}if(Oe.isDateType(t))return this.defaultDateFormat;if(t==Boolean)return this.defaultBooleanFormat;return this.defaultGeneralFormat}}R.h.StiTextFormatHelper=ls}let mr=P.Report.Dashboard.StiTableColumnSize,cr=P.Report.Dashboard.IStiTableColumnSize,dr=P.Base.Meters.IStiDimensionColumn,gr=(R.K.StiDimensionColumn=class extends R.K.StiTableColumn{implements(){let e=super.implements().concat([Pe,dr,cr]);return(this.implements=()=>e)()}meta(){return[...super.meta(),new h("ShowHyperlink"),new l("HyperlinkPattern"),new s("Size").check(()=>null!=this.size).set(e=>this.size=mr.createFromJsonObject(e.value)).setXml(e=>this.size=mr.createFromXml(e))]}clone(){let e,t=super.clone();return t.size=null==(e=this.size)?void 0:e.clone(),t}get localizedName(){return b.get("Dashboard","Dimension")}checkRules(){var e;null!=(e=this.size)&&e.checkRules()}getUniqueCode(){let e=super.getUniqueCode();return e=397*(e=397*(e=397*e^this.showHyperlink[P.System.StiObject.stimulsoft]().getHashCode())^this.hyperlinkPattern[P.System.StiObject.stimulsoft]().getHashCode())^this.size[P.System.StiObject.stimulsoft]().getHashCode(),Math.abs(e)}constructor(e,t,i,r,s,l,n,a,o,u,h,m,c,d,g){super(e,t,i,r,s,l,n,o,m,c,d),this.ident=R.e.StiMeterIdent.DimensionColumn,this.showHyperlink=!1,this.hyperlinkPattern="",this.size=new mr,null!=u&&(this.showHyperlink=u),null!=h&&(this.hyperlinkPattern=h),null!=g&&(this.size=g)}},P.Base.Meters.IStiColorMapMeter),pr=(R.L.StiColorMapMeter=class extends R.e.StiDimensionMeter{implements(){let e=super.implements().concat([gr]);return(this.implements=()=>e)()}get localizedName(){return b.get("PropertyMain","Color")}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.ColorMapMeter}},P.Base.Meters.IStiValueMapMeter),Sr=(R.L.StiValueMapMeter=class extends R.e.StiMeasureMeter{implements(){let e=super.implements().concat([pr]);return(this.implements=()=>e)()}get localizedName(){return b.get("PropertyMain","Value")}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.ValueMapMeter}},P.Base.Meters.IStiGroupMapMeter),wr=(R.L.StiGroupMapMeter=class extends R.e.StiDimensionMeter{implements(){let e=super.implements().concat([Sr]);return(this.implements=()=>e)()}get localizedName(){return b.get("PropertyMain","Group")}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.GroupMapMeter}},P.Base.Meters.IStiNameMapMeter),fr=(R.L.StiNameMapMeter=class extends R.e.StiDimensionMeter{implements(){let e=super.implements().concat([wr]);return(this.implements=()=>e)()}get localizedName(){return b.get("PropertyMain","Name")}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.NameMapMeter}},P.Base.Meters.IStiKeyMapMeter),br=(R.L.StiKeyMapMeter=class extends R.e.StiDimensionMeter{implements(){let e=super.implements().concat([fr]);return(this.implements=()=>e)()}get localizedName(){return b.get("PropertyMain","Key")}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.KeyMapMeter}},R.M.StiValueProgressMeter=class extends R.e.StiMeasureMeter{implements(){let e=super.implements().concat([ji]);return(this.implements=()=>e)()}get localizedName(){return b.get("PropertyMain","Value")}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.ValueProgressMeter}},R.M.StiTargetProgressMeter=class extends R.e.StiMeasureMeter{implements(){let e=super.implements().concat([ji]);return(this.implements=()=>e)()}get localizedName(){return b.get("PropertyMain","Target")}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.TargetProgressMeter}},R.M.StiSeriesProgressMeter=class extends R.e.StiDimensionMeter{implements(){let e=super.implements().concat([ji]);return(this.implements=()=>e)()}get localizedName(){return b.get("PropertyMain","Series")}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.SeriesProgressMeter}},R.g.StiPivotTableItemDashboardInteraction=class extends R.g.StiDashboardInteraction{isDefault(){return this.onHover==ci.None&&this.onClick==di.None&&this.hyperlinkDestination==gi.NewTab&&H.isNullOrEmpty(this.hyperlink)&&H.isNullOrEmpty(this.drillDownPageKey)&&null!=this.drillDownParameters&&0==this.drillDownParameters.length&&H.isNullOrEmpty(this.toolTip)}constructor(e,t,i,r,s,l,n){super(e,t,i,r,s,l,n),this.ident=pi.PivotTableItem,this.availableOnClick=Si.ShowDashboard,this.availableOnHover=wi.None,this.onHover=ci.None,this.onClick=di.None}},R.g.StiPivotTableItemDashboardInteraction),yr=P.Report.Dashboard.ImplementsIStiPivotItem,Cr=P.Report.Dashboard.IStiPivotItem,xr=P.Report.CrossTab.Core.StiSortDirection,vr=P.Report.Dashboard.IStiMeterRules,Fr=P.Report.Dashboard.ImplementsIStiTableColumnSize,Tr=P.Base.Meters.IStiPivotColumn,Mr=(R.N.StiPivotColumn=class extends R.e.StiMeter{implements(){let e=super.implements().concat([Pe,Ii,Di,cr,Tr,Cr,Ri,vr,...Ti,..._i,...Fr,...yr,n,Ci]);return(this.implements=()=>e)()}clone(){let e,t=super.clone();return t.textFormat=this.textFormat.clone(),t.topN=this.topN.clone(),t.size=null==(e=this.size)?void 0:e.clone(),t.horAlignment=this.horAlignment,t.showTotal=this.showTotal,t.totalLabel=this.totalLabel,t.sortDirection=this.sortDirection,t.expandExpression=this.expandExpression,t.visibility=this.visibility,t.visibilityExpression=this.visibilityExpression,t.dashboardInteraction=this.dashboardInteraction.clone(),t}meta(){return[...super.meta(),new r("HorAlignment","",X,X.Center),new h("ShowTotal","",!0),new l("TotalLabel"),new s("TextFormat").check(()=>!(this.textFormat.is(zt)||null==this.textFormat)).set(e=>this.textFormat=Mi.createFromJsonObject(e.value)).setXml(e=>this.textFormat=Mi.loadFormatFromXml(e)),new s("TopN").check(()=>null!=this.topN).set(e=>this.topN=Ei.createFromJsonObject(e.value)).setXml(e=>this.topN=Ei.createFromXml(e)),new s("Size").check(()=>null!=this.size).set(e=>this.size=mr.createFromJsonObject(e.value)).setXml(e=>this.size=mr.createFromXml(e)),new r("SortDirection","",xr,xr.Asc),new l("ExpandExpression"),new r("Visibility","",zi,zi.True),new l("VisibilityExpression").check(()=>null!=this.visibilityExpression),new s("DashboardInteraction").check(()=>null!=this.dashboardInteraction.as(br)).set(e=>{let t,i=null==(t=bi.loadInteractionFromJsonObject(e.value))?void 0:t.as(br);null!=i&&(this.dashboardInteraction=i)}).setXml(e=>{let t,i=null==(t=bi.loadInteractionFromXml(e))?void 0:t.as(br);null!=i&&(this.dashboardInteraction=i)})]}checkRules(){var e;null!=(e=this.size)&&e.checkRules()}get strSortDirection(){return``+z.getName(xr,this.sortDirection)+(this.sortDirection!=xr.None?"ending":"")}set strSortDirection(e){this.sortDirection=z.parse(xr,e.replace("ending",""))}getUniqueCode(){let e=super.getUniqueCode();return e=397*(e=397*(e=397*(e=397*(e=397*(e=397*(e=397*(e=397*(e=397*(e=397*e^this.horAlignment)^this.sortDirection)^(null!=this.textFormat?this.textFormat[P.System.StiObject.stimulsoft]().getHashCode():0))^(null!=this.topN?this.topN[P.System.StiObject.stimulsoft]().getHashCode():0))^(null!=this.size?this.size[P.System.StiObject.stimulsoft]().getHashCode():0))^(null!=this.showTotal?this.showTotal[P.System.StiObject.stimulsoft]().getHashCode():0))^(null!=this.totalLabel?this.totalLabel[P.System.StiObject.stimulsoft]().getHashCode():0))^(null!=this.expandExpression?this.expandExpression[P.System.StiObject.stimulsoft]().getHashCode():0))^(null!=this.visibility?this.visibility[P.System.StiObject.stimulsoft]().getHashCode():0))^(null!=this.visibilityExpression?this.visibilityExpression[P.System.StiObject.stimulsoft]().getHashCode():0),Math.abs(e)}get localizedName(){return b.get("Components","StiPivotColumn")}constructor(e,t,i,r,s,l,n,a,o,u,h,m,c,d){super(e,t,i),this.horAlignment=X.Center,this.showTotal=!0,this.totalLabel="",this.textFormat=new zt,this.size=new mr,this.visibility=zi.True,this.visibilityExpression="",this.expandExpression="",this.dashboardInteraction=new br,this.topN=new Ei,this.sortDirection=xr.Asc,this.ident=R.e.StiMeterIdent.PivotColumn,null!=r&&(this.horAlignment=r),null!=s&&(this.textFormat=s),null!=l&&(this.topN=l),null!=o&&(this.size=o),null!=n&&(this.showTotal=n),null!=a&&(this.totalLabel=a),null!=u&&(this.sortDirection=u),null!=h&&(this.expandExpression=h),null!=m&&(this.visibility=m),null!=c&&(this.visibilityExpression=c),null!=d&&(this.dashboardInteraction=d)}},P.Base.Meters.IStiPivotRow),Ar=(R.N.StiPivotRow=class extends R.e.StiMeter{implements(){let e=super.implements().concat([Pe,Ii,Di,cr,Mr,Cr,Ri,vr,...Ti,..._i,...Fr,...yr,n,Ci]);return(this.implements=()=>e)()}clone(){let e,t=super.clone();return t.textFormat=this.textFormat.clone(),t.topN=this.topN.clone(),t.size=null==(e=this.size)?void 0:e.clone(),t.horAlignment=this.horAlignment,t.showTotal=this.showTotal,t.totalLabel=this.totalLabel,t.sortDirection=this.sortDirection,t.expandExpression=this.expandExpression,t.visibility=this.visibility,t.visibilityExpression=this.visibilityExpression,t.dashboardInteraction=this.dashboardInteraction.clone(),t}meta(){return[...super.meta(),new r("HorAlignment","",X,X.Center),new h("ShowTotal","",!0),new l("TotalLabel"),new s("TextFormat").check(()=>!(this.textFormat.is(zt)||null==this.textFormat)).set(e=>this.textFormat=Mi.createFromJsonObject(e.value)).setXml(e=>this.textFormat=Mi.loadFormatFromXml(e)),new s("TopN").check(()=>null!=this.topN).set(e=>this.topN=Ei.createFromJsonObject(e.value)).setXml(e=>this.topN=Ei.createFromXml(e)),new s("Size").check(()=>null!=this.size).set(e=>this.size=mr.createFromJsonObject(e.value)).setXml(e=>this.size=mr.createFromXml(e)),new r("SortDirection","",xr,xr.Asc),new l("ExpandExpression"),new r("Visibility","",zi,zi.True),new l("VisibilityExpression").check(()=>null!=this.visibilityExpression),new s("DashboardInteraction").check(()=>null!=this.dashboardInteraction.as(br)).set(e=>{let t,i=null==(t=bi.loadInteractionFromJsonObject(e.value))?void 0:t.as(br);null!=i&&(this.dashboardInteraction=i)}).setXml(e=>{let t,i=null==(t=bi.loadInteractionFromXml(e))?void 0:t.as(br);null!=i&&(this.dashboardInteraction=i)})]}checkRules(){var e;null!=(e=this.size)&&e.checkRules()}get strSortDirection(){return``+z.getName(xr,this.sortDirection)+(this.sortDirection!=xr.None?"ending":"")}set strSortDirection(e){this.sortDirection=z.parse(xr,e.replace("ending",""))}getUniqueCode(){let e=super.getUniqueCode();return e=397*(e=397*(e=397*(e=397*(e=397*(e=397*(e=397*(e=397*(e=397*(e=397*e^this.horAlignment)^this.sortDirection)^(null!=this.textFormat?this.textFormat[P.System.StiObject.stimulsoft]().getHashCode():0))^(null!=this.topN?this.topN[P.System.StiObject.stimulsoft]().getHashCode():0))^(null!=this.size?this.size[P.System.StiObject.stimulsoft]().getHashCode():0))^(null!=this.showTotal?this.showTotal[P.System.StiObject.stimulsoft]().getHashCode():0))^(null!=this.totalLabel?this.totalLabel[P.System.StiObject.stimulsoft]().getHashCode():0))^(null!=this.expandExpression?this.expandExpression[P.System.StiObject.stimulsoft]().getHashCode():0))^(null!=this.visibility?this.visibility[P.System.StiObject.stimulsoft]().getHashCode():0))^(null!=this.visibilityExpression?this.visibilityExpression[P.System.StiObject.stimulsoft]().getHashCode():0),Math.abs(e)}get localizedName(){return b.get("Components","StiPivotRow")}constructor(e,t,i,r,s,l,n,a,o,u,h,m,c,d){super(e,t,i),this.horAlignment=X.Center,this.showTotal=!0,this.totalLabel="",this.textFormat=new zt,this.size=new mr,this.visibility=zi.True,this.visibilityExpression="",this.expandExpression="",this.dashboardInteraction=new br,this.topN=new Ei,this.sortDirection=xr.Asc,this.ident=R.e.StiMeterIdent.PivotRow,null!=r&&(this.horAlignment=r),null!=s&&(this.textFormat=s),null!=l&&(this.topN=l),null!=o&&(this.size=o),null!=n&&(this.showTotal=n),null!=a&&(this.totalLabel=a),null!=u&&(this.sortDirection=u),null!=h&&(this.expandExpression=h),null!=m&&(this.visibility=m),null!=c&&(this.visibilityExpression=c),null!=d&&(this.dashboardInteraction=d)}},P.Base.Meters.IStiPivotSummary),Dr=(R.N.StiPivotSummary=class extends R.e.StiMeasureMeter{implements(){let e=super.implements().concat([Ii,Di,cr,Ar,Cr,vr,...Ti,..._i,...Fr,...yr,n,Ci]);return(this.implements=()=>e)()}clone(){let e,t=super.clone();return t.textFormat=this.textFormat.clone(),t.size=null==(e=this.size)?void 0:e.clone(),t.hideZeros=this.hideZeros,t.horAlignment=this.horAlignment,t.visibility=this.visibility,t.visibilityExpression=this.visibilityExpression,t.dashboardInteraction=this.dashboardInteraction.clone(),t}meta(){return[...super.meta(),new r("HorAlignment","",X,X.Center),new s("TextFormat").check(()=>!(this.textFormat.is(zt)||null==this.textFormat)).set(e=>this.textFormat=Mi.createFromJsonObject(e.value)).setXml(e=>this.textFormat=Mi.loadFormatFromXml(e)),new s("Size").check(()=>null!=this.size).set(e=>this.size=mr.createFromJsonObject(e.value)).setXml(e=>this.size=mr.createFromXml(e)),new h("HideZeros","",!0),new r("Visibility","",zi,zi.True),new l("VisibilityExpression").check(()=>null!=this.visibilityExpression),new s("DashboardInteraction").check(()=>null!=this.dashboardInteraction.as(br)).set(e=>{let t,i=null==(t=bi.loadInteractionFromJsonObject(e.value))?void 0:t.as(br);null!=i&&(this.dashboardInteraction=i)}).setXml(e=>{let t,i=null==(t=bi.loadInteractionFromXml(e))?void 0:t.as(br);null!=i&&(this.dashboardInteraction=i)})]}checkRules(){var e;null!=(e=this.size)&&e.checkRules()}getUniqueCode(){let e=super.getUniqueCode();return e=397*(e=397*(e=397*(e=397*(e=397*(e=397*e^this.horAlignment)^(null!=this.textFormat?this.textFormat[P.System.StiObject.stimulsoft]().getHashCode():0))^(null!=this.size?this.size[P.System.StiObject.stimulsoft]().getHashCode():0))^(null!=this.hideZeros?this.hideZeros[P.System.StiObject.stimulsoft]().getHashCode():0))^(null!=this.visibility?this.visibility[P.System.StiObject.stimulsoft]().getHashCode():0))^(null!=this.visibilityExpression?this.visibilityExpression[P.System.StiObject.stimulsoft]().getHashCode():0),Math.abs(e)}get localizedName(){return b.get("Components","StiPivotSummary")}constructor(e,t,i,r,s,l,n,a,o,u){super(e,t,i),this.horAlignment=X.Center,this.textFormat=new zt,this.size=new mr,this.visibility=zi.True,this.visibilityExpression="",this.hideZeros=!0,this.dashboardInteraction=new br,this.ident=R.e.StiMeterIdent.PivotSummary,null!=r&&(this.horAlignment=r),null!=s&&(this.textFormat=s),null!=l&&(this.size=l),null!=n&&(this.hideZeros=n),null!=a&&(this.visibility=a),null!=o&&(this.visibilityExpression=o),null!=u&&(this.dashboardInteraction=u)}},R.O.StiLatitudeMapMeter=class extends R.e.StiDimensionMeter{get localizedName(){return b.get("PropertyMain","Latitude")}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.LatitudeMapMeter}},R.O.StiLongitudeMapMeter=class extends R.e.StiDimensionMeter{get localizedName(){return b.get("PropertyMain","Longitude")}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.LongitudeMapMeter}},R.P.StiKeyListBoxMeter=class extends R.e.StiDimensionMeter{implements(){let e=super.implements().concat([ji]);return(this.implements=()=>e)()}get localizedName(){return b.get("PropertyMain","Key")}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.KeyListBoxMeter}},R.P.StiNameListBoxMeter=class extends R.e.StiDimensionMeter{implements(){let e=super.implements().concat([Hi]);return(this.implements=()=>e)()}get localizedName(){return b.get("PropertyMain","Name")}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.NameListBoxMeter}},R.Q.StiValueDatePickerMeter=class extends R.e.StiDimensionMeter{implements(){let e=super.implements().concat([ji]);return(this.implements=()=>e)()}get localizedName(){return b.get("PropertyMain","Value")}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.ValueDatePickerMeter}},R.R.StiValueNumberBoxMeter=class extends R.e.StiDimensionMeter{implements(){let e=super.implements().concat([ji]);return(this.implements=()=>e)()}get localizedName(){return b.get("PropertyMain","Value")}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.ValueNumberBoxMeter}},R.H.StiEndValueChartMeter=class extends R.e.StiMeasureMeter{get localizedName(){return b.get("PropertyMain","ValueEnd")}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.EndValueChartMeter}},R.S.StiNameComboBoxMeter=class extends R.e.StiDimensionMeter{implements(){let e=super.implements().concat([Hi]);return(this.implements=()=>e)()}get localizedName(){return b.get("PropertyMain","Name")}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.NameComboBoxMeter}},R.S.StiKeyComboBoxMeter=class extends R.e.StiDimensionMeter{implements(){let e=super.implements().concat([ji]);return(this.implements=()=>e)()}get localizedName(){return b.get("PropertyMain","Key")}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.KeyComboBoxMeter}},P.Base.Meters.IStiSeriesMeter),Ir=(R.T.StiSeriesGaugeMeter=class extends R.e.StiDimensionMeter{implements(){let e=super.implements().concat([Dr]);return(this.implements=()=>e)()}get localizedName(){return b.get("PropertyMain","Series")}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.SeriesGaugeMeter}},R.T.StiValueGaugeMeter=class extends R.e.StiMeasureMeter{implements(){let e=super.implements().concat([ji]);return(this.implements=()=>e)()}get localizedName(){return b.get("PropertyMain","Value")}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.ValueGaugeMeter}},P.Base.Meters.IStiTargetMeter),m=(R.T.StiTargetGaugeMeter=class extends R.e.StiMeasureMeter{implements(){let e=super.implements().concat([Ir]);return(this.implements=()=>e)()}get localizedName(){return b.get("PropertyMain","Target")}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.TargetGaugeMeter}},R.U.StiSeriesIndicatorMeter=class extends R.e.StiDimensionMeter{implements(){let e=super.implements().concat([Dr]);return(this.implements=()=>e)()}get localizedName(){return b.get("PropertyMain","Series")}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.SeriesIndicatorMeter}},R.U.StiValueIndicatorMeter=class extends R.e.StiMeasureMeter{implements(){let e=super.implements().concat([ji]);return(this.implements=()=>e)()}get localizedName(){return b.get("PropertyMain","Value")}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.ValueIndicatorMeter}},R.U.StiTargetIndicatorMeter=class extends R.e.StiMeasureMeter{implements(){let e=super.implements().concat([Ir]);return(this.implements=()=>e)()}get localizedName(){return b.get("PropertyMain","Target")}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.TargetIndicatorMeter}},R.H.StiWeightChartMeter=class extends R.e.StiMeasureMeter{get localizedName(){return b.get("PropertyMain","Weight")}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.WeightChartMeter}},P.Report.Dashboard.StiChartSeriesType),Rr=P.Base.Drawing.StiPenStyle,Er=P.Report.Chart.StiSeriesYAxis,kr=(R.H.StiValueChartMeter=class extends R.e.StiMeasureMeter{implements(){let e=super.implements().concat([ji,n]);return(this.implements=()=>e)()}meta(){return[...super.meta(),new r("SeriesType","",m,m.ClusteredColumn),new r("YAxis","",Er,Er.LeftYAxis),new r("LineStyle","",Rr,Rr.Solid),new ie("LineWidth","",2),new r("ShowZeros","",ft,ft.Zero),new r("ShowNulls","",ft,ft.Zero)]}getUniqueCode(){let e=super.getUniqueCode();return e=397*(e=397*(e=397*(e=397*(e=397*(e=397*e^this.seriesType)^this.yAxis)^this.lineStyle)^this.lineWidth)^this.showNulls)^this.showZeros,Math.abs(e)}get localizedName(){return b.get("PropertyMain","Value")}constructor(e,t,i,r,s,l,n,a,o){super(e,t,i),this.seriesType=m.ClusteredColumn,this.yAxis=Er.LeftYAxis,this.lineStyle=Rr.Solid,this.lineWidth=2,this.showZeros=ft.Zero,this.showNulls=ft.Zero,this.ident=R.e.StiMeterIdent.ValueChartMeter,null!=r&&(this.seriesType=r),null!=s&&(this.yAxis=s),null!=l&&(this.lineStyle=l),null!=n&&(this.lineWidth=n),null!=o&&(this.showNulls=o),null!=a&&(this.showZeros=a)}},R.H.StiOpenValueChartMeter=class extends R.H.StiValueChartMeter{get localizedName(){return b.get("PropertyMain","ValueOpen")}constructor(e,t,i,r){super(e,t,i,r),this.ident=R.e.StiMeterIdent.OpenValueChartMeter,this.seriesType=m.Candlestick,null!=r&&(this.seriesType=r)}},R.H.StiCloseValueChartMeter=class extends R.e.StiMeasureMeter{get localizedName(){return b.get("PropertyMain","ValueClose")}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.CloseValueChartMeter}},R.H.StiLowValueChartMeter=class extends R.e.StiMeasureMeter{get localizedName(){return b.get("PropertyMain","ValueLow")}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.LowValueChartMeter}},R.H.StiHighValueChartMeter=class extends R.e.StiMeasureMeter{get localizedName(){return b.get("PropertyMain","ValueHigh")}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.HighValueChartMeter}},R.H.StiSeriesChartMeter=class extends R.e.StiDimensionMeter{implements(){let e=super.implements().concat([Dr]);return(this.implements=()=>e)()}get localizedName(){return b.get("PropertyMain","Series")}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.SeriesChartMeter}},R.H.StiSortByChartMeter=class extends R.e.StiDimensionMeter{implements(){let e=super.implements().concat([Dr]);return(this.implements=()=>e)()}get localizedName(){return b.get("PropertyMain","SortBy")}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.SortByChartMeter}},R.H.StiXChartMeter=class extends R.e.StiDimensionMeter{get localizedName(){return`X`+b.get("PropertyMain","Value")}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.XChartMeter}},R.H.StiYChartMeter=class extends R.e.StiDimensionMeter{get localizedName(){return`Y`+b.get("PropertyMain","Value")}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.YChartMeter}},R.O.StiLocationMapMeter=class extends R.e.StiDimensionMeter{get localizedName(){return b.get("PropertyMain","Location")}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.LocationMapMeter}},R.O.StiLocationColorMapMeter=class extends R.e.StiDimensionMeter{get localizedName(){return b.get("PropertyMain","Group")}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.LocationColorMapMeter}},R.O.StiLocationValueMapMeter=class extends R.e.StiDimensionMeter{get localizedName(){return b.get("PropertyMain","Value")}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.LocationValueMapMeter}},R.O.StiLocationArgumentMapMeter=class extends R.e.StiDimensionMeter{get localizedName(){return b.get("PropertyMain","Argument")}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.LocationArgumentMapMeter}},R.F.StiIndicatorCardsColumn=class extends R.F.StiMeasureCardsColumn{implements(){let e=super.implements().concat([er]);return(this.implements=()=>e)()}get localizedName(){return b.get("Dashboard","Dimension")}constructor(e,t,i,r,s,l,n,a,o,u,h){super(e,t,i,r,s,l,n,a,o,u,h),this.ident=R.e.StiMeterIdent.IndicatorCardsColumn}},R.F.StiColorScaleCardsColumn=class extends R.F.StiMeasureCardsColumn{implements(){let e=super.implements().concat([tr,n]);return(this.implements=()=>e)()}meta(){return[...super.meta(),new i("MinimumColor","",N.red),new i("MaximumColor","",N.green)]}getUniqueCode(){let e=super.getUniqueCode();return e=397*(e=397*e^this.minimumColor[P.System.StiObject.stimulsoft]().getHashCode())^this.maximumColor[P.System.StiObject.stimulsoft]().getHashCode(),Math.abs(e)}get localizedName(){return b.get("Dashboard","ColorScale")}constructor(e,t,i,r,s,l,n,a,o,u,h,m,c){super(e,t,i,r,s,l,n,a,o,u,c),this.ident=R.e.StiMeterIdent.ColorScaleCardsColumn,this.minimumColor=N.red,this.maximumColor=N.green,null!=h&&(this.minimumColor=h),null!=m&&(this.maximumColor=m)}},R.F.StiDataBarsCardsColumn=class extends R.F.StiMeasureCardsColumn{implements(){let e=super.implements().concat([ir,n]);return(this.implements=()=>e)()}meta(){return[...super.meta(),new ie("Width"),new re("Minimum"),new re("Maximum"),new i("PositiveColor","",N.transparent),new i("NegativeColor","",N.transparent),new i("OverlappedColor","",N.transparent),new i("FillColor","",N.transparent)]}get localizedName(){return b.get("Dashboard","DataBars")}constructor(e,t,i,r,s,l,n,a,o,u,h){super(e,t,i,r,s,l,n,a,o,u,h),this.ident=R.e.StiMeterIdent.DataBarsCardsColumn,this.width=0,this.positiveColor=N.transparent,this.negativeColor=N.transparent,this.overlappedColor=N.transparent,this.fillColor=N.transparent,this.minimum="",this.maximum=""}},R.F.StiSparklinesCardsColumn=class extends R.F.StiMeasureCardsColumn{implements(){let e=super.implements().concat([rr,n]);return(this.implements=()=>e)()}meta(){return[...super.meta(),new r("Type","",R.K.StiSparklinesType,R.K.StiSparklinesType.Area),new h("ShowHighLowPoints"),new h("ShowFirstLastPoints","",!0),new h("AllowCustomColors"),new ie("Height"),new i("PositiveColor","",Li.get("537eb6")),new i("NegativeColor","",Li.get("ff0000"))]}getUniqueCode(){let e=super.getUniqueCode();return e=397*(e=397*(e=397*(e=397*(e=397*(e=397*e^this.type[P.System.StiObject.stimulsoft]().getHashCode())^this.showHighLowPoints[P.System.StiObject.stimulsoft]().getHashCode())^this.showFirstLastPoints[P.System.StiObject.stimulsoft]().getHashCode())^this.allowCustomColors[P.System.StiObject.stimulsoft]().getHashCode())^this.positiveColor[P.System.StiObject.stimulsoft]().getHashCode())^this.negativeColor[P.System.StiObject.stimulsoft]().getHashCode(),Math.abs(e)}get localizedName(){return b.get("Dashboard","Sparklines")}constructor(e,t,i,r,s,l,n,a,o,u,h,m,c,d,g,p,S){super(e,t,i,r,s,l,n,h,m,c,S),this.type=R.K.StiSparklinesType.Area,this.showHighLowPoints=!1,this.showFirstLastPoints=!0,this.allowCustomColors=!1,this.positiveColor=Li.get("537eb6"),this.negativeColor=Li.get("ff0000"),this.height=0,this.ident=R.e.StiMeterIdent.SparklinesCardsColumn,null!=a&&(this.type=a),null!=o&&(this.showHighLowPoints=o),null!=u&&(this.showFirstLastPoints=u),null!=d&&(this.allowCustomColors=d),null!=g&&(this.positiveColor=g),null!=p&&(this.negativeColor=p)}},P.Report.StiNameValidator),Or=P.Data.Helpers.StiExpressionHelper,Vr=(R.V.StiTextMeasureMeter=class extends R.e.StiMeasureMeter{implements(){let e=super.implements().concat([ji]);return(this.implements=()=>e)()}getUniqueName(){if(!H.isNullOrWhiteSpace(this.label))return kr.correctName(this.label,!0,null);if(!H.isNullOrWhiteSpace(this.expression)){let e=this.expression,t=Or.getFirstArgumentFromExpression(this.expression);return null!=t&&t.includes(".")&&(e=t.substring(t.indexOf(".")+1)),kr.correctName(e,!0,null)}return"Measure"}static getUniqueNames(e){let s=new He;for(let r of e){let e=r.getUniqueName(),t=e,i=2;while(1){if(!s.containsKey(t)){s.add(t,r);break}t=e+i,i++}}return s}get localizedName(){return b.get("PropertyMain","Text")}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.TextMeasureMeter}},R.V.StiTextMeasureMeter),Nr=R.H.StiYChartMeter,Lr=R.H.StiXChartMeter,Br=R.R.StiValueNumberBoxMeter,Pr=R.H.StiIndicatorValueChartMeter,Hr=R.H.StiSortByChartMeter,jr=R.F.StiIndicatorCardsColumn,zr=R.F.StiBubbleCardsColumn,Xr=R.F.StiColorScaleCardsColumn,Gr=R.F.StiDataBarsCardsColumn,Jr=R.F.StiSparklinesCardsColumn,Wr=R.F.StiDimensionCardsColumn,Ur=P.Report.Dictionary.StiDataColumnExt,Zr=R.K.StiBubbleColumn,Yr=R.O.StiLocationArgumentMapMeter,Kr=R.O.StiLocationMapMeter,Qr=R.O.StiLocationColorMapMeter,qr=R.O.StiLocationValueMapMeter,_r=R.I.StiKeyTreeViewBoxMeter,$r=R.J.StiKeyTreeViewMeter,es=R.K.StiIndicatorColumn,ts=R.K.StiColorScaleColumn,is=R.K.StiDataBarsColumn,rs=R.K.StiSparklinesColumn,ss=P.Data.Functions.Funcs,ls=R.h.StiTextFormatHelper,ns=R.K.StiDimensionColumn,as=R.K.StiMeasureColumn,os=R.L.StiColorMapMeter,us=R.L.StiValueMapMeter,hs=R.L.StiGroupMapMeter,ms=R.L.StiNameMapMeter,cs=R.L.StiKeyMapMeter,ds=R.M.StiValueProgressMeter,gs=R.M.StiTargetProgressMeter,ps=R.M.StiSeriesProgressMeter,Ss=R.N.StiPivotColumn,ws=R.N.StiPivotRow,fs=R.N.StiPivotSummary,bs=R.O.StiLatitudeMapMeter,ys=R.O.StiLongitudeMapMeter,Cs=R.P.StiKeyListBoxMeter,xs=R.P.StiNameListBoxMeter,vs=R.Q.StiValueDatePickerMeter,Fs=P.Data.Engine.StiDataExpressionHelper,Ts=R.K.StiTableColumn,F=P.System.DateTime,Ms=R.S.StiNameComboBoxMeter,As=R.S.StiKeyComboBoxMeter,Ds=R.T.StiSeriesGaugeMeter,Is=R.T.StiValueGaugeMeter,Rs=R.T.StiTargetGaugeMeter,Es=R.U.StiSeriesIndicatorMeter,ks=R.U.StiValueIndicatorMeter,Os=R.U.StiTargetIndicatorMeter,Vs=R.H.StiWeightChartMeter,Ns=R.H.StiOpenValueChartMeter,Ls=R.H.StiCloseValueChartMeter,Bs=R.H.StiLowValueChartMeter,Ps=R.H.StiHighValueChartMeter,Hs=R.H.StiArgumentChartMeter,js=R.H.StiValueChartMeter,zs=R.H.StiSeriesChartMeter,Xs=R.H.StiEndValueChartMeter,Gs=P.Base.IStiAppAlias,Js=P.Report.Dictionary.StiVariable;{class Wg{static getValue(e){if(e.is(js))return e;let t=new js;return t.expression=c.toTotalExpression(e),t.label=e.label,t}static getGanttStartValue(e){let t=new js;return t.expression=c.toExpression(e),t.label=c.toAlias(e),t.seriesType=m.Gantt,t}static getGanttEndValue(e){let t=new Xs;return t.expression=c.toExpression(e),t.label=c.toAlias(e),t}static getEndValue(e){if(e.is2(Xs))return e;let t=new Xs;return t.expression=c.toTotalExpression(e),t.label=e.label,t}static getOpenValue(e){if(e.is(Ns))return e;let t=new Ns;return t.expression=c.toTotalExpression(e),t.label=e.label,t}static getCloseValue(e){if(e.is2(Ls))return e;let t=new Ls;return t.expression=c.toTotalExpression(e),t.label=e.label,t}static getLowValue(e){if(e.is2(Bs))return e;let t=new Bs;return t.expression=c.toTotalExpression(e),t.label=e.label,t}static getHighValue(e){if(e.is2(Ps))return e;let t=new Ps;return t.expression=c.toTotalExpression(e),t.label=e.label,t}static getValue2(e,t){let i=new js;return i.expression=c.toTotalExpression2(e),i.seriesType=null!=t.values&&0<t.values.length?t.values.firstOrDefault().seriesType:m.ClusteredColumn,i.label=c.toAlias(e),i}static getEndValue2(e){let t=new Xs;return t.expression=c.toTotalExpression2(e),t.label=c.toAlias(e),t}static getCloseValue2(e){let t=new Ls;return t.expression=c.toTotalExpression2(e),t.label=c.toAlias(e),t}static getLowValue2(e){let t=new Bs;return t.expression=c.toTotalExpression2(e),t.label=c.toAlias(e),t}static getHighValue2(e){let t=new Ps;return t.expression=c.toTotalExpression2(e),t.label=c.toAlias(e),t}static getWeight(e){if(e.is2(Vs))return e;let t=new Vs;return t.expression=c.toTotalExpression(e),t.label=e.label,t}static getWeight2(e){let t=new Vs;return t.expression=c.toTotalExpression2(e),t.label=c.toAlias(e),t}static getArgument(e){if(e.is2(Hs))return e;let t=new Hs;return t.expression=Or.removeFunction(e.expression),t.label=e.label,t}static getArgument2(e){let t=new Hs;return t.expression=c.toExpression(e),t.label=c.toAlias(e),t}static getX2(e){let t=new Hs;return t.expression=c.toExpression(e),t.label=c.toAlias(e),t}static getXValue2(e){let t=new Lr;return t.expression=c.toExpression(e),t.label=c.toAlias(e),t}static getX(e){if(e.is2(Hs))return e;let t=new Hs;return t.expression=Or.removeFunction(e.expression),t.label=e.label,t}static getXValue(e){if(e.is2(Lr))return e;let t=new Lr;return t.expression=Or.removeFunction(e.expression),t.label=e.label,t}static getY2(e){let t=new js;return t.expression=c.toExpression(e),t.label=c.toAlias(e),t}static getYValue2(e){let t=new Nr;return t.expression=c.toExpression(e),t.label=c.toAlias(e),t}static getY(e){if(e.is(js))return e;let t=new js;return t.expression=Or.removeFunction(e.expression),t.label=e.label,t}static getYValue(e){if(e.is2(Nr))return e;let t=new Nr;return t.expression=Or.removeFunction(e.expression),t.label=e.label,t}static getSeries(e){if(e.is2(zs))return e;let t=new zs;return t.expression=Or.removeFunction(e.expression),t.label=e.label,t}static getSortBy(e){if(e.is2(Hr))return e;let t=new Hr;return t.expression=Or.removeFunction(e.expression),t.label=e.label,t}static getSeries2(e){let t=new zs;return t.expression=c.toExpression(e),t.label=c.toAlias(e),t}static getSortBy2(e){let t=new Hr;return t.expression=c.toExpression(e),t.label=c.toAlias(e),t}static getIndicatorValue(e){if(e.is2(Pr))return e;let t=new Pr;return t.expression=Or.removeFunction(e.expression),t.label=e.label,t}static getIndicatorValue2(e){let t=new Pr;return t.expression=c.toExpression(e),t.label=c.toAlias(e),t}}R.h.Chart=Wg;class Ug{static getName(e){if(e.is2(Ms))return e;let t=new Ms;return t.expression=e.expression,t.label=e.label,t}static getName2(e){let t=new Ms;return t.expression=c.toExpression(e),t.label=c.toAlias(e),t}static getKey(e){if(e.is2(As))return e;let t=new As;return t.expression=e.expression,t.label=e.label,t}static getKey2(e){let t=new As;return t.expression=c.toExpression(e),t.label=c.toAlias(e),t}}R.h.ComboBox=Ug;class Zg{static getFilter2(e){let t="",i=(null!=e&&null!=e.type&&(Oe.isDateType(e.type)?t=F.now.toString("MM/dd/yyyy"):Oe.isNumericType(e.type)&&(t="0")),new y);return i.key=de.generateKey(),i.condition=Ot.EqualTo,i.path=c.toExpression(e),i.value=t,i.value2=t,i}static getFilter(e,t){let i=Fs.getDataColumnFromExpression(t.page.as(R.e.StiDashboard),e.expression),r="",s=(null!=i&&null!=i.getDataType()&&(Oe.isDateType(i.getDataType())?r=F.now.toString("MM/dd/yyyy"):Oe.isNumericType(i.getDataType())&&(r="0")),new y);return s.key=de.generateKey(),s.condition=Ot.EqualTo,s.path=Or.removeFunction(e.expression),s.value=r,s.value2=r,s}}R.h.DataFilter=Zg;class Yg{static getValue(e){if(e.is2(vs))return e;let t=new vs;return t.expression=e.expression,t.label=e.label,t}static getValue2(e){let t=new vs;return t.expression=c.toExpression(e),t.label=c.toAlias(e),t}}R.h.DatePicker=Yg;class Kg{static getValue(e){if(e.is2(Br))return e;let t=new Br;return t.expression=e.expression,t.label=e.label,t}static getValue2(e){let t=new Br;return t.expression=c.toExpression(e),t.label=c.toAlias(e),t}}R.h.NumberBox=Kg;class Qg{static getSeries(e){if(e.is2(Ds))return e;let t=new Ds;return t.expression=Or.removeFunction(e.expression),t.label=e.label,t}static getSeries2(e){let t=new Ds;return t.expression=c.toExpression(e),t.label=c.toAlias(e),t}static getValue(e){if(e.is2(Is))return e;let t=new Is;return t.expression=c.toTotalExpression(e),t.label=e.label,t}static getValue2(e){let t=new Is;return t.expression=c.toTotalExpression2(e),t.label=c.toAlias(e),t}static getTarget(e){if(e.is2(Rs))return e;let t=new Rs;return t.expression=c.toTotalExpression(e),t.label=e.label,t}static getTarget2(e){let t=new Rs;return t.expression=c.toTotalExpression2(e),t.label=c.toAlias(e),t}}R.h.Gauge=Qg;class qg{static getSeries(e){if(e.is2(Es))return e;let t=new Es;return t.expression=Or.removeFunction(e.expression),t.label=e.label,t}static getSeries2(e){let t=new Es;return t.expression=c.toExpression(e),t.label=c.toAlias(e),t}static getValue(e){if(e.is2(ks))return e;let t=new ks;return t.expression=c.toTotalExpression(e),t.label=e.label,t}static getValue2(e){let t=new ks;return t.expression=c.toTotalExpression2(e),t.label=c.toAlias(e),t}static getTarget(e){if(e.is2(Os))return e;let t=new Os;return t.expression=c.toTotalExpression(e),t.label=e.label,t}static getTarget2(e){let t=new Os;return t.expression=c.toTotalExpression2(e),t.label=c.toAlias(e),t}}R.h.Indicator=qg;class _g{static getName(e){if(e.is2(xs))return e;let t=new xs;return t.expression=e.expression,t.label=e.label,t}static getName2(e){let t=new xs;return t.expression=c.toExpression(e),t.label=c.toAlias(e),t}static getKey(e){if(e.is2(Cs))return e;let t=new Cs;return t.expression=e.expression,t.label=e.label,t}static getKey2(e){let t=new Cs;return t.expression=c.toExpression(e),t.label=c.toAlias(e),t}}R.h.ListBox=_g;class $g{static getLatitude(e){if(e.is2(bs))return e;let t=new bs;return t.expression=e.expression,t.label=e.label,t}static getLongitude(e){if(e.is2(ys))return e;let t=new ys;return t.expression=e.expression,t.label=e.label,t}static getLocation(e){if(e.is2(Kr))return e;return new Kr(null,e.expression,e.label)}static getLocationColor(e){if(e.is2(Qr))return e;return new Qr(null,e.expression,e.label)}static getLocationValue(e){if(e.is2(qr))return e;return new qr(null,e.expression,e.label)}static getLocationArgument(e){if(e.is2(Yr))return e;return new Yr(null,e.expression,e.label)}static getLatitude2(e){let t=new bs;return t.expression=c.toExpression(e),t.label=c.toAlias(e),t}static getLongitude2(e){let t=new ys;return t.expression=c.toExpression(e),t.label=c.toAlias(e),t}static getLocation2(e){return new Kr(null,c.toExpression(e),c.toAlias(e))}static getLocationColor2(e){return new Qr(null,c.toExpression(e),c.toAlias(e))}static getLocationValue2(e){return new qr(null,c.toExpression(e),c.toAlias(e))}static getLocationArgument2(e){return new Yr(null,c.toExpression(e),c.toAlias(e))}}R.h.OnlineMap=$g;class ep{static getColumn(e){if(e.is(Ss))return e;let t=new Ss;return t.key=e.key,t.expression=e.expression,t.label=e.label,t.textFormat=this.getFormat(e),t.topN=this.getTopN(e),t.horAlignment=e.is(Ii)?e.as(Ii).horAlignment:X.Center,t.size=e.is(cr)?e.size:new mr,t.totalLabel=this.getTotalLabel(e),t.showTotal=this.getShowTotal(e),t.sortDirection=this.getSortDirection(e),t.expandExpression=this.getExpandExpression(e),t}static getRow(e){if(e.is(ws))return e;let t=new ws;return t.key=e.key,t.expression=e.expression,t.label=e.label,t.textFormat=this.getFormat(e),t.topN=this.getTopN(e),t.horAlignment=e.is(Ii)?e.as(Ii).horAlignment:X.Center,t.size=e.is(cr)?e.size:new mr,t.totalLabel=this.getTotalLabel(e),t.showTotal=this.getShowTotal(e),t.sortDirection=this.getSortDirection(e),t.expandExpression=this.getExpandExpression(e),t}static getShowTotal(e){return e.is(Mr)?e.as(Mr).showTotal:!e.is(Tr)||e.as(Tr).showTotal}static getTotalLabel(e){return e.is(Mr)?e.as(Mr).totalLabel:e.is(Tr)?e.as(Tr).totalLabel:""}static getSortDirection(e){return e.is(Mr)?e.as(Mr).strSortDirection:e.is(Tr)?e.as(Tr).strSortDirection:"None"}static getExpandExpression(e){return e.is(Mr)?e.as(Mr).expandExpression:e.is(Tr)?e.as(Tr).expandExpression:""}static getSummary(e){if(e.is(fs))return e;let t=new fs;return t.key=e.key,t.expression=c.toTotalExpression(e),t.label=e.label,t.textFormat=this.getFormat(e),t}static getSummary3(e,t){if(e.is(fs))return e;let i=new fs;return i.expression=c.toTotalExpression3(e,t),i.label=e.label,i.textFormat=this.getFormat(e),i}static getColumn2(e){let t=new Ss;return t.expression=c.toExpression(e),t.label=c.toAlias(e),t}static getRow2(e){let t=new ws;return t.expression=c.toExpression(e),t.label=c.toAlias(e),t}static getSummary2(e){let t=new fs;return t.expression=c.toTotalExpression2(e),t.label=c.toAlias(e),t}static getFormat(e){if(e.is(Ss))return e.textFormat;if(e.is(ws))return e.textFormat;if(e.is(fs))return e.textFormat;return new zt}static getTopN(e){if(e.is(Ss))return e.topN;if(e.is(ws))return e.topN;return new Ei}}R.h.Pivot=ep;class tp{static getSeries(e){if(e.is2(ps))return e;let t=new ps;return t.expression=Or.removeFunction(e.expression),t.label=e.label,t}static getSeries2(e){let t=new ps;return t.expression=c.toExpression(e),t.label=c.toAlias(e),t}static getValue(e){if(e.is2(ds))return e;let t=new ds;return t.expression=c.toTotalExpression(e),t.label=e.label,t}static getValue2(e){let t=new ds;return t.expression=c.toTotalExpression2(e),t.label=c.toAlias(e),t}static getTarget(e){if(e.is2(gs))return e;let t=new gs;return t.expression=c.toTotalExpression(e),t.label=e.label,t}static getTarget2(e){let t=new gs;return t.expression=c.toTotalExpression2(e),t.label=c.toAlias(e),t}}R.h.Progress=tp;class ip{static getKey(e){if(e.is2(cs))return e;let t=new cs;return t.expression=e.expression,t.label=e.label,t}static getName(e){if(e.is2(ms))return e;let t=new ms;return t.expression=e.expression,t.label=e.label,t}static getGroup(e){if(e.is2(hs))return e;let t=new hs;return t.expression=e.expression,t.label=e.label,t}static getValue(e,t){let i=new us,r=(i.loadFromString(e.saveToString()),Fs.isNumericDataColumnInExpression(t,i.expression)?"Sum":"Count");return i.expression=Or.replaceFunction(i.expression,r),i}static getColor(e){if(e.is2(os))return e;let t=new os;return t.expression=e.expression,t.label=e.label,t}static getKey2(e){let t=new cs;return t.expression=c.toExpression(e),t.label=c.toAlias(e),t}static getName2(e){let t=new ms;return t.expression=c.toExpression(e),t.label=c.toAlias(e),t}static getValue2(e){let t=new us;return t.expression=c.toTotalExpression2(e),t.label=c.toAlias(e),t}static getGroup2(e){let t=new hs;return t.expression=c.toExpression(e),t.label=c.toAlias(e),t}static getColor2(e){let t=new os;return t.expression=c.toExpression(e),t.label=c.toAlias(e),t}}R.h.RegionMap=ip;class rp{static getColumn(e){let t=e.as(Ts);return(t=null==t?new(e.is(vt)?as:ns):t).loadFromString(e.saveToString()),t}static getDimension(e){let t=new ns;return t.loadFromString(e.saveToString()),ss.isMeasureFunction(t.expression)&&(t.expression=Or.removeFunction(t.expression)),t}static getDimension2(e){let t=new ns;return t.textFormat=ls.getDefaultFormatForColumn(e),t.expression=c.toExpression(e),t.horAlignment=R.h.StiTableAlignmentHelper.getHorAlign(e),t.label=c.toAlias(e),t}static getMeasure(e,t){let i=new as;if(i.loadFromString(e.saveToString()),e.is(ns)||e.is(rs)){let e=Fs.isNumericDataColumnInExpression(t,i.expression)?"Sum":"Count";i.expression=Or.replaceFunction(i.expression,e)}return i}static getMeasure2(e){let t=new as;return t.textFormat=ls.getDefaultFormatForColumn(e),t.expression=c.toTotalExpression2(e),t.horAlignment=R.h.StiTableAlignmentHelper.getHorAlign(e),t.label=c.toAlias(e),t}static getDataBars(e,t){let i=new is;if(i.loadFromString(e.saveToString()),e.is(ns)||e.is(rs)){let e=Fs.isNumericDataColumnInExpression(t,i.expression)?"Sum":"First";i.expression=Or.replaceFunction(i.expression,e)}return i}static getColorScale(e,t){let i=new ts;if(i.loadFromString(e.saveToString()),e.is(ns)||e.is(rs)){let e=Fs.isNumericDataColumnInExpression(t,i.expression)?"Sum":"Count";i.expression=Or.replaceFunction(i.expression,e)}return i}static getSparklines(e){let t=new rs;return t.loadFromString(e.saveToString()),ss.isMeasureFunction(t.expression)&&(t.expression=Or.removeFunction(t.expression)),t}static getBubble(e,t){let i=new Zr;if(i.loadFromString(e.saveToString()),e.is(ns)||e.is(rs)){let e=Fs.isNumericDataColumnInExpression(t,i.expression)?"Sum":"Count";i.expression=Or.replaceFunction(i.expression,e)}return i}static getIndicator(e,t){let i=new es;if(i.loadFromString(e.saveToString()),e.is(ns)||e.is(rs)){let e=Fs.isNumericDataColumnInExpression(t,i.expression)?"Sum":"Count";i.expression=Or.replaceFunction(i.expression,e)}return i.horAlignment=X.Right,i}}R.h.Table=rp;class sp{static getMeter(e){let t=new Vr;return t.loadFromJsonObject(e.saveToJsonObject(Le.Report)),t}static getMeter2(e){let t=new Vr;return t.expression=c.toTotalExpression2(e),t.label=c.toAlias(e),t}}R.h.Text=sp;class lp{static getColumn(e){let t=e.as(Oi);return(t=null==t?new(e.is(vt)?Ni:Wr):t).loadFromString(e.saveToString()),t}static getDimension(e){let t=new Wr;return t.loadFromString(e.saveToString()),ss.isMeasureFunction(t.expression)&&(t.expression=Or.removeFunction(t.expression)),t}static getDimension2(e){let t=new Wr;return t.textFormat=ls.getDefaultFormatForColumn(e),t.expression=c.toExpression(e),t.horAlignment=R.h.StiTableAlignmentHelper.getHorAlign(e),t.label=c.toAlias(e),t}static getMeasure(e,t){let i=new Ni;if(i.loadFromString(e.saveToString()),e.is2(Wr)||e.is2(Jr)){let e=Fs.isNumericDataColumnInExpression(t,i.expression)?"Sum":"Count";i.expression=Or.replaceFunction(i.expression,e)}return i}static getMeasure2(e){let t=new Ni;return t.textFormat=ls.getDefaultFormatForColumn(e),t.expression=c.toTotalExpression2(e),t.horAlignment=R.h.StiTableAlignmentHelper.getHorAlign(e),t.label=c.toAlias(e),t}static getDataBars(e,t){let i=new Gr;if(i.loadFromString(e.saveToString()),e.is2(Wr)||e.is2(Jr)){let e=Fs.isNumericDataColumnInExpression(t,i.expression)?"Sum":"First";i.expression=Or.replaceFunction(i.expression,e)}return i}static getColorScale(e,t){let i=new Xr;if(i.loadFromString(e.saveToString()),e.is2(Wr)||e.is2(Jr)){let e=Fs.isNumericDataColumnInExpression(t,i.expression)?"Sum":"Count";i.expression=Or.replaceFunction(i.expression,e)}return i}static getSparklines(e){let t=new Jr;return t.loadFromString(e.saveToString()),ss.isMeasureFunction(t.expression)&&(t.expression=Or.removeFunction(t.expression)),t}static getBubble(e,t){let i=new zr;if(i.loadFromString(e.saveToString()),e.is2(Wr)||e.is2(Jr)){let e=Fs.isNumericDataColumnInExpression(t,i.expression)?"Sum":"Count";i.expression=Or.replaceFunction(i.expression,e)}return i}static getIndicator(e,t){let i=new jr;if(i.loadFromString(e.saveToString()),e.is2(Wr)||e.is2(Jr)){let e=Fs.isNumericDataColumnInExpression(t,i.expression)?"Sum":"Count";i.expression=Or.replaceFunction(i.expression,e)}return i.horAlignment=X.Right,i}}R.h.Cards=lp;class np{static getKey(e){if(e.is2($r))return e;let t=new $r;return t.expression=e.expression,t.label=e.label,t}static getKey2(e){let t=new $r;return t.expression=c.toExpression(e),t.label=c.toAlias(e),t}}R.h.TreeView=np;class ap{static getKey(e){if(e.is2(_r))return e;let t=new _r;return t.expression=e.expression,t.label=e.label,t}static getKey2(e){let t=new _r;return t.expression=c.toExpression(e),t.label=c.toAlias(e),t}}R.h.TreeViewBox=ap;class c{static toTotalExpression2(e){let t=null==e?void 0:e.as(or);if(null!=t)return Ur.isNumericType(t)?this.toSumExpression2(t):this.toCountExpression2(t);return null==e?void 0:e.getName()}static toTotalExpression(e){if(Or.isFunctionPresent(e.expression))return e.expression;return this.toCountExpression(e.expression)}static toTotalExpression3(e,t){if(Or.isFunctionPresent(e.expression))return e.expression;return Fs.isNumericDataColumnInExpression(t,e.expression)?this.toSumExpression(e.expression):this.toCountExpression(e.expression)}static toSumExpression2(e){return`Sum(${this.toExpression(e)})`}static toSumExpression(e){return`Sum(${e})`}static toCountExpression2(e){return`Count(${this.toExpression(e)})`}static toCountExpression(e){return`Count(${e})`}static toExpression(e){let t=null==e?void 0:e.as(or);if(null!=t)return ss.toExpression2(t.dataSource.name,t.name);return ss.toExpression(null==e?void 0:e.getName())}static toAlias(e){let t=e.as(Gs);if(null!=t)return t.getAlias();return null==e?void 0:e.getName()}static toDataType(e){let t,i,r=null==(t=null==e?void 0:e.as(or))?void 0:t.type;if(null!=r)return r;return null==(i=null==e?void 0:e.as(Js))?void 0:i.type}}c.Chart=Wg,c.ComboBox=Ug,c.DataFilter=Zg,c.DatePicker=Yg,c.NumberBox=Kg,c.Gauge=Qg,c.Indicator=qg,c.ListBox=_g,c.OnlineMap=$g,c.Pivot=ep,c.Progress=tp,c.RegionMap=ip,c.Table=rp,c.Cards=lp,c.TreeView=np,c.TreeViewBox=ap,c.Text=sp,R.h.StiMeterHelper=c}R.F.StiCardsItem=class{constructor(){this.cornerRadius=new v(0),this.margin=new rt(12,12,12,12),this.padding=new it(12,12,12,12),this.colorEach=!1}meta(){return[new s("Margin").get(e=>this.margin.saveToJsonObject(12,12,12,12)),new s("Padding").get(e=>this.padding.saveToJsonObject(12,12,12,12)),new l("CornerRadius").get(()=>this.cornerRadius.toString()).set(e=>this.cornerRadius=v.tryParse(e.value.toString())).setXml(e=>this.cornerRadius=v.tryParse(e.textContent)),new h("ColorEach")]}saveToJsonObject(e){return u.saveToJsonObject(e,this)}loadFromJsonObject(e){u.loadFromJsonObject(e,this)}loadFromXml(e){u.loadFromXml(e,this)}clone(){return this[P.System.StiObject.stimulsoft]().memberwiseClone()}isDefaultMargin(){return 12==this.margin.left&&12==this.margin.top&&12==this.margin.right&&12==this.margin.bottom}isDefaultPadding(){return 12==this.padding.left&&12==this.padding.top&&12==this.padding.right&&12==this.padding.bottom}};let Ws=P.Report.Dashboard.IStiInteractionLayout,Us=(R.g.StiCardsDashboardInteraction=class extends R.g.StiDashboardInteraction{implements(){let e=super.implements().concat([n,Ws]);return(this.implements=()=>e)()}meta(){return[...super.meta(),new h("ShowFullScreenButton","",!0),new h("ShowSaveButton","",!0),new h("ShowViewDataButton","",!0)]}get isDefaultLayout(){return this.showFullScreenButton&&this.showSaveButton&&this.showViewDataButton&&null==this.fileName&&null==this.headerText&&null==this.footerText}isDefault(){return this.isDefaultLayout}constructor(e,t,i){super(),this.ident=pi.Cards,this.availableOnClick=Si.None,this.availableOnHover=wi.None,this.showFullScreenButton=!0,this.showSaveButton=!0,this.showViewDataButton=!0,this.fileName=null,this.headerText=null,this.footerText=null,null!=e&&(this.showFullScreenButton=e),null!=t&&(this.showSaveButton=t),null!=i&&(this.showViewDataButton=i)}},P.Report.Components.IStiShowBlanks),Zs=R.g.StiCardsDashboardInteraction,c=R.h.StiMeterHelper,Ys=P.System.Text.StiReportObjectStringConverter,Ks=P.Report.Dashboard.IStiSeriesColors,Qs=R.F.StiCardsItem,d=R.G.StiMeterLoader,qs=P.Report.Dashboard.StiItemOrientation,_s=P.Report.Dashboard.ImplementsIStiCardsElement,$s=P.Report.Dashboard.ImplementsIStiElementLayout,el=P.Report.Dashboard.IStiElementLayout,tl=P.Report.Dashboard.StiElementLayout,il=P.Report.Dashboard.ImplementsIStiTitleElement,rl=P.Data.Helpers.StiUsedDataHelper,sl=P.Report.Dashboard.IStiCardsElement,ll=P.Data.Engine.StiDataSortRule,nl=P.Data.Engine.StiDataActionRule;{class Jm extends R.e.StiElement{implements(){let e=super.implements().concat([sl,Ue,Ie,el,Ci,Je,Ks,ke,Us,..._s,...il,...$s,...Ge,n]);return(this.implements=()=>e)()}clone(e){let t,i,r,s=super.clone(e);return s.transformActions=this.transformActions.select(e=>e.clone()).toList(),s.transformFilters=this.transformFilters.select(e=>e.clone()).toList(),s.transformSorts=this.transformSorts.select(e=>e.clone()).toList(),s.columns=this.columns.select(e=>e.clone()).toList(),s.dashboardInteraction=null==(t=this.dashboardInteraction)?void 0:t.clone(),s.dataFilters=this.dataFilters.select(e=>e.clone()).toList(),s.title=null!=this.title?this.title.clone():null,s.seriesColors=null!=this.seriesColors?this.seriesColors.slice():null,s.cornerRadius=null==(i=this.cornerRadius)?void 0:i.clone(),s.shadow=null==(r=this.shadow)?void 0:r.clone(),s}meta(){return[...super.meta(),new s("Columns").get(e=>a.Serialize.objectArray(this.columns,e)).set(e=>this.columns.addRange(e.value.properties().select(e=>d.loadFromJson(e.value).as(Oi)).where(e=>null!=e))).setXml(e=>this.columns.addRange(e.childNodes.map(e=>d.loadFromXml(e)).filter(e=>null!=e))),new r("Orientation","",qs,qs.Horizontal),new s("Title").check(()=>null!=this.title).set(e=>this.title=R.e.StiTitle.createFromJsonObject(e.value)).setXml(e=>this.title=R.e.StiTitle.createFromXml(e)),new s("Layout").check(()=>null!=this.layout).set(e=>this.layout=tl.createFromJsonObject(e.value)).setXml(e=>this.layout=tl.createFromXml(e)),new r("Style","",o,o.Auto),new l("CustomStyleName"),new ie("ColumnCount","",0),new l("Group"),new h("CrossFiltering","",!0),new s("TransformActions").get(e=>a.Serialize.objectArray(this.transformActions,e)).set(e=>this.transformActions.addRange(e.value.properties().select(e=>nl.loadFromJson(e.value)))).setXml(e=>this.transformActions.addRange(e.childNodes.map(e=>nl.loadFromXml(e)))),new s("TransformFilters").get(e=>a.Serialize.objectArray(this.transformFilters,e)).set(e=>this.transformFilters.addRange(e.value.properties().select(e=>y.loadFromJson(e.value)))).setXml(e=>this.transformFilters.addRange(e.childNodes.map(e=>y.loadFromXml(e)))),new s("TransformSorts").get(e=>a.Serialize.objectArray(this.transformSorts,e)).set(e=>this.transformSorts.addRange(e.value.properties().select(e=>ll.loadFromJson(e.value)))).setXml(e=>this.transformSorts.addRange(e.childNodes.map(e=>ll.loadFromXml(e)))),new s("DataFilters").get(e=>a.Serialize.objectArray(this.dataFilters,e)).set(e=>this.dataFilters.addRange(e.value.properties().select(e=>y.loadFromJson(e.value)))).setXml(e=>this.dataFilters.addRange(e.childNodes.map(e=>y.loadFromXml(e)))),new s("Cards").get(e=>this.cards.saveToJsonObject(e)),new l("CornerRadius").get(()=>this.cornerRadius.toString()).set(e=>this.cornerRadius=v.tryParse(e.value.toString())).setXml(e=>this.cornerRadius=v.tryParse(e.textContent)),new l("Shadow").get(()=>a.Serialize.jShadow(this.shadow)).set(e=>this.shadow=a.Deserialize.simpleSahdow(e.value)).setXml(e=>this.shadow=We.loadFromXml(e.textContent)),new s("SeriesColors").get(()=>a.Serialize.colorArray(this.seriesColors)).set(e=>this.seriesColors=a.Deserialize.colorArray(e.value)).setXml(e=>this.seriesColors=Ys.convertStringToColorArray(e.textContent)),new h("ShowBlanks"),new s("DashboardInteraction").check(()=>null!=this.dashboardInteraction.as(Zs)).set(e=>{let t,i=null==(t=bi.loadInteractionFromJsonObject(e.value))?void 0:t.as(Zs);null!=i&&(this.dashboardInteraction=i)}).setXml(e=>{let t,i=null==(t=bi.loadInteractionFromXml(e))?void 0:t.as(Zs);null!=i&&(this.dashboardInteraction=i)})]}get toolboxPosition(){return _e.CardsElement}get localizedName(){return T.get("Components","StiCards")}convertFrom(e){let t=e.fetchAllMeters();if(this.columns.clear(),null==t)return;t.cast().forEach(e=>{let t=null;e.is2(Pe)?t=new Wr:e.is2(rr)?t=new R.F.StiSparklinesCardsColumn:e.is2(ir)?t=new R.F.StiDataBarsCardsColumn:e.is2(er)?t=new R.F.StiIndicatorCardsColumn:e.is2(tr)?t=new R.F.StiColorScaleCardsColumn:e.is2(Bi)?t=new R.F.StiBubbleCardsColumn:e.is2(vt)&&((t=new Ni).horAlignment=X.Right),null!=t&&(t.loadFromJsonObject(e.saveToJsonObject(Le.Report)),this.columns.add(t))},this),null==this.dashboardInteraction&&(this.dashboardInteraction=new Zs)}createMeters(e){let t=e.as(Jm);this.columns.clear();for(let e of t.columns)this.columns.add(e)}createMeters2(t){this.columns.clear();for(let e of t.columns.list)null!=e&&null!=e.type&&Oe.isNumericType(e.type)?this.columns.add(c.Cards.getMeasure2(e)):this.columns.add(c.Cards.getDimension2(e))}createMeter(e){let t=e.as(or),i=e.as(Js),r=null!=t?t.type:null==i?void 0:i.type;if(null!=r&&Oe.isNumericType(r)){let e=c.Cards.getMeasure2(t);this.columns.add(e)}else this.columns.add(c.Cards.getDimension2(e))}removeMeter(e){e<this.columns.length&&this.columns.removeAt(e)}removeAllMeters(){this.columns.clear()}insertMeter(e,t){let i=t.as(Oi);if(null==i)return;0<=e&&e<this.columns.length?this.columns.insert(e,i):this.columns.add(i)}insertNewDimension(e){let t=new Wr;t.horAlignment=X.Left,this.insertMeter(e,t)}insertNewMeasure(e){let t=new Ni;t.expression="Sum()",t.horAlignment=X.Right,this.insertMeter(e,t)}getMeasure(e){return c.Cards.getMeasure2(e)}getDimension(e){return c.Cards.getDimension2(e)}getCards(){return this.cards}fetchAllMeters(){return this.columns.cast()}getMeters(){return this.columns.cast()}retrieveUsedDataNames(){return rl.getMany2(this.columns)}get isDefined(){return null!=this.columns&&0<this.columns.length}setString(e,t){switch(e){case"Title.Text":this.title.text=t;break}}getString(e){switch(e){case"Title.Text":return this.title.text}throw new Error(`Property with name `+e)}getAllStrings(){let e=["Title.Text"];return e}get style(){return this._style}set style(e){(this._style=e)!=o.Custom&&(this.customStyleName="")}getNestedPages(){let e,t,i=new j,r="";if(null!=this.dashboardInteraction&&this.dashboardInteraction.onClick==di.ShowDashboard&&(r=null==(e=this.dashboardInteraction)?void 0:e.drillDownPageKey,de.isKey(r))){let e=this.report.pages.toList().firstOrDefault(e=>e.guid==r);null!=e&&i.add(e)}for(let e of this.columns)if(null!=(null==e?void 0:e.dashboardInteraction)&&e.dashboardInteraction.onClick==di.ShowDashboard&&(r=null==(t=null==e?void 0:e.dashboardInteraction)?void 0:t.drillDownPageKey,de.isKey(r))){let e=this.report.pages.toList().firstOrDefault(e=>e.guid==r);null!=e&&i.add(e)}return 0==i.length?null:i.distinct()}constructor(e=L.empty){super(e),this.helpUrl="user-manual/dashboards_cards.htm",this.dataFilters=new j,this.transformActions=new j,this.transformFilters=new j,this.transformSorts=new j,this.dataTransformation={},this.group="",this.title=new R.e.StiTitle,this.crossFiltering=!0,this.shadow=new We,this.layout=new tl,this.cornerRadius=new v(0),this.showBlanks=!1,this._style=o.Auto,this.customStyleName="",this.seriesColors=[],this.orientation=qs.Horizontal,this.columns=new j,this.cards=new Qs,this.columnCount=0,this.title.text=this.localizedName,this.dashboardInteraction=new Zs}}R.F.StiCardsElement=Jm}{let e;(A=e=R.H.StiChartLabelsStyle||(R.H.StiChartLabelsStyle={}))[A["Value"]=0]="Value",A[A["PercentOfTotal"]=1]="PercentOfTotal",A[A["Category"]=2]="Category",A[A["CategoryValue"]=3]="CategoryValue",A[A["CategoryPercentOfTotal"]=4]="CategoryPercentOfTotal";let t;(M=t=R.H.StiLegendVisibility||(R.H.StiLegendVisibility={}))[M["False"]=0]="False",M[M["Auto"]=1]="Auto",M[M["Always"]=2]="Always"}R.H.StiChartAreaIndicator=class{implements(){let e=[n,Rt];return(this.implements=()=>e)()}meta(){return[new s("Value"),new s("Title")]}saveToJsonObject(e){return u.saveToJsonObject(e,this)}loadFromJsonObject(e){u.loadFromJsonObject(e,this)}loadFromXml(e){u.loadFromXml(e,this)}clone(){let e=this[P.System.StiObject.stimulsoft]().memberwiseClone();return e.value=this.value.clone(),e.title=this.title.clone(),e}constructor(){this.value=new R.H.StiChartAreaIndicatorValue,this.title=new R.H.StiChartAreaIndicatorTitle}};let al=R.H.StiChartAreaIndicator,ol=P.Report.Dashboard.IStiChartArea,ul=(R.H.StiChartArea=class{implements(){let e=[ol,n];return(this.implements=()=>e)()}meta(){return[new h("ColorEach"),new h("SideBySide","",!1,!0),new s("GridLinesHor"),new s("GridLinesVert"),new s("InterlacingHor"),new s("InterlacingVert"),new h("ReverseHor"),new h("ReverseVert"),new s("XAxis").check(()=>!1),new s("XTopAxis").check(()=>!1),new s("YAxis").check(()=>!1),new s("YRightAxis").check(()=>!1),new s("Indicator"),new ie("HorSpacing","",6),new ie("VertSpacing","",6)]}saveToJsonObject(e){return u.saveToJsonObject(e,this)}loadFromJsonObject(e){u.loadFromJsonObject(e,this)}loadFromXml(e){u.loadFromXml(e,this)}clone(){let e=this[P.System.StiObject.stimulsoft]().memberwiseClone();return e.gridLinesHor=null!=this.gridLinesHor?this.gridLinesHor.clone():null,e.gridLinesVert=null!=this.gridLinesVert?this.gridLinesVert.clone():null,e.interlacingHor=null!=this.interlacingHor?this.interlacingHor.clone():null,e.interlacingVert=null!=this.interlacingVert?this.interlacingVert.clone():null,e.indicator=null!=this.indicator?this.indicator.clone():null,e}get horSpacing(){return this._horSpacing}set horSpacing(e){0<=e&&(this._horSpacing=e)}get vertSpacing(){return this._vertSpacing}set vertSpacing(e){0<=e&&(this._vertSpacing=e)}constructor(e,t,i,r,s,l,n,a,o,u,h,m){this.sideBySide=!0,this.colorEach=!1,this.reverseHor=!1,this.reverseVert=!1,this.interlacingHor=new R.H.StiHorChartInterlacing,this.interlacingVert=new R.H.StiVertChartInterlacing,this.gridLinesHor=new R.H.StiHorChartGridLines,this.gridLinesVert=new R.H.StiVertChartGridLines,this.xAxis=new R.H.StiXChartAxis,this.xTopAxis=new R.H.StiXTopChartAxis,this.yAxis=new R.H.StiYChartAxis,this.yRightAxis=new R.H.StiYRightChartAxis,this.indicator=new al,this._horSpacing=6,this._vertSpacing=6,null!=e&&(this.colorEach=e),null!=t&&(this.reverseHor=t),null!=i&&(this.reverseVert=i),null!=r&&(this.gridLinesHor=r),null!=s&&(this.gridLinesVert=s),null!=s&&(this.interlacingHor=l),null!=n&&(this.interlacingVert=n),null!=a&&(this.xAxis=a),null!=o&&(this.yAxis=o),null!=u&&(this.xTopAxis=u),null!=h&&(this.yRightAxis=h),null!=m&&(this.indicator=m)}},R.H.StiChartAreaIndicatorTitle=class{constructor(){this.text="",this.color=N.transparent}implements(){let e=[n,Rt];return(this.implements=()=>e)()}meta(){return[new re("Text"),new i("Color","",N.transparent)]}saveToJsonObject(e){return u.saveToJsonObject(e,this)}loadFromJsonObject(e){u.loadFromJsonObject(e,this)}loadFromXml(e){u.loadFromXml(e,this)}clone(){let e=this[P.System.StiObject.stimulsoft]().memberwiseClone();return e}},R.H.StiChartAreaIndicatorValue=class{constructor(){this.color=N.transparent}implements(){let e=[n,Rt];return(this.implements=()=>e)()}meta(){return[new i("Color","",N.transparent)]}saveToJsonObject(e){return u.saveToJsonObject(e,this)}loadFromJsonObject(e){u.loadFromJsonObject(e,this)}loadFromXml(e){u.loadFromXml(e,this)}clone(){let e=this[P.System.StiObject.stimulsoft]().memberwiseClone();return e}},P.Report.Chart.StiLabelsPlacement),hl=(R.H.StiChartAxisLabels=class{implements(){let e=[Rt,ri,..._t,n];return(this.implements=()=>e)()}meta(){return[new ie("Angle","",0),new l("TextBefore"),new l("TextAfter"),new At("Font","","Arial",8),new r("Placement","",ul,ul.AutoRotation),new i("Color","",N.transparent),new r("TextAlignment","",X,X.Right),new ie("Step","",0),new h("WordWrap"),new ie("Width")]}saveToJsonObject(e){return u.saveToJsonObject(e,this)}loadFromJsonObject(e){u.loadFromJsonObject(e,this)}loadFromXml(e){u.loadFromXml(e,this)}clone(){let e=this[P.System.StiObject.stimulsoft]().memberwiseClone();return e.font=this.font.clone(),e}constructor(e,t,i,r,s,l,n,a,o){this.angle=0,this.color=N.transparent,this.font=new B("Arial",8),this.placement=ul.AutoRotation,this.textAlignment=X.Right,this.textAfter="",this.textBefore="",this.step=0,this.wordWrap=!1,this.width=0,null!=e&&(this.textBefore=e),null!=t&&(this.textAfter=t),null!=i&&(this.angle=i),null!=r&&(this.font=r),null!=s&&(this.placement=s),null!=l&&(this.color=l),null!=n&&(this.textAlignment=n),null!=a&&(this.width=a),null!=o&&(this.wordWrap=o)}},R.H.StiChartAxisLabels),ml=(R.H.StiChartAxis=class{implements(){let e=[n,Rt];return(this.implements=()=>e)()}is(e){if(e instanceof P.System.Interface)return-1!=this.implements().indexOf(e);if("function"==typeof e)return this instanceof e;if(null==e)throw new Error("Type for comparison is 'undefined'");return!1}is2(e){return this.is(e)}as(e){if(this.is(e))return this;return null}clone(){let e=this[P.System.StiObject.stimulsoft]().memberwiseClone();return e.labels=this.labels.clone(),e.range=this.range.clone(),e}meta(){return[new s("Labels").check(()=>null!=this.labels),new s("Range").check(()=>null!=this.range),new h("Visible","",!0)]}saveToJsonObject(e){return u.saveToJsonObject(e,this)}loadFromJsonObject(e){u.loadFromJsonObject(e,this)}loadFromXml(e){u.loadFromXml(e,this)}constructor(e,t,i){this.labels=new hl,this.range=new R.H.StiChartAxisRange,this.visible=!0,null!=e&&(this.labels=e),null!=t&&(this.range=t),null!=i&&(this.visible=i)}},R.H.StiChartAxisRange=class{implements(){let e=[n,Rt];return(this.implements=()=>e)()}meta(){return[new ie("Minimum","",0),new ie("Maximum","",0),new h("Auto","",!0)]}saveToJsonObject(e){return u.saveToJsonObject(e,this)}loadFromJsonObject(e){u.loadFromJsonObject(e,this)}loadFromXml(e){u.loadFromXml(e,this)}clone(){return this[P.System.StiObject.stimulsoft]().memberwiseClone()}get minimum(){return this._minimum}set minimum(e){this._minimum=e}constructor(e,t,i){this._minimum=0,this.maximum=0,this.auto=!0,null!=e&&(this.auto=e),null!=t&&(this.minimum=t),null!=i&&(this.maximum=i)}},P.Report.Chart.StiTitlePosition),cl=P.System.Drawing.FontStyle,dl=P.System.Drawing.StringAlignment;{let e;(D=e=R.H.Order||(R.H.Order={}))[D["Alignment"]=1]="Alignment",D[D["Color"]=2]="Color",D[D["Direction"]=3]="Direction",D[D["Font"]=4]="Font",D[D["Placement"]=5]="Placement",D[D["Position"]=6]="Position",D[D["Text"]=7]="Text",D[D["Visible"]=8]="Visible",R.H.StiChartAxisTitle=class{implements(){let e=[n];return(this.implements=()=>e)()}is(e){if(e instanceof P.System.Interface)return-1!=this.implements().indexOf(e);if("function"==typeof e)return this instanceof e;if(null==e)throw new Error("Type for comparison is 'undefined'");return!1}is2(e){return this.is(e)}as(e){if(this.is(e))return this;return null}meta(){return[new At("Font","","Arial",12,cl.Bold),new l("Text"),new i("Color","",N.transparent),new r("Alignment","",dl,dl.Center),new r("Position","",ml,ml.Outside),new h("Visible","",!0)]}saveToJsonObject(e){return u.saveToJsonObject(e,this)}loadFromJsonObject(e){u.loadFromJsonObject(e,this)}loadFromXml(e){u.loadFromXml(e,this)}clone(){let e=this[P.System.StiObject.stimulsoft]().memberwiseClone();return e.font=this.font.clone(),e}constructor(e,t,i,r,s,l){this.visible=!0,this.alignment=dl.Center,this.color=N.transparent,this.font=new B("Arial",12,cl.Bold),this.position=ml.Outside,this.text="",null!=e&&(this.font=e),null!=t&&(this.text=t),null!=i&&(this.color=i),null!=r&&(this.alignment=r),null!=s&&(this.position=s),null!=l&&(this.visible=l)}}}let gl=P.Report.Chart.StiConstantLines_StiTextPosition,pl=P.Report.Dashboard.IStiChartConstantLines;{class op{implements(){let e=[Rt,pl,n];return(this.implements=()=>e)()}meta(){return[new l("Text"),new i("LineColor"),new r("LineStyle","",Rr,Rr.Solid),new ie("LineWidth","",1),new re("AxisValue","","1"),new r("Position","",gl,gl.LeftTop)]}saveToJsonObject(e){return u.saveToJsonObject(e,this)}loadFromJsonObject(e){u.loadFromJsonObject(e,this)}loadFromXml(e){u.loadFromXml(e,this)}clone(){return this[P.System.StiObject.stimulsoft]().memberwiseClone()}static createFromJson(e){let t=new op;return t.loadFromJsonObject(e),t}static createFromXml(e){let t=new op;return t.loadFromXml(e),t}constructor(e,t,i,r,s,l){this.text="",this.lineStyle=Rr.Solid,this.lineColor=N.black,this.axisValue="1",this.lineWidth=1,this.position=gl.LeftTop,null!=e&&(this.text=e),null!=t&&(this.axisValue=t),null!=i&&(this.lineColor=i),null!=r&&(this.lineStyle=r),null!=s&&(this.lineWidth=s),null!=l&&(this.position=l)}}R.H.StiChartConstantLines=op}let Sl=P.Report.Chart.StiMarkerType,wl=P.Report.Chart.StiExtendedStyleBool,fl=(R.H.StiChartMarker=class{implements(){let e=[Rt,n];return(this.implements=()=>e)()}meta(){return[new ie("Size","",7),new ie("Angle","",0),new r("Type","",Sl,Sl.Circle),new r("Visible","",wl,wl.FromStyle)]}saveToJsonObject(e){return u.saveToJsonObject(e,this)}loadFromJsonObject(e){u.loadFromJsonObject(e,this)}loadFromXml(e){u.loadFromXml(e,this)}clone(){return this[P.System.StiObject.stimulsoft]().memberwiseClone()}static createFromJson(e){let t=new R.H.StiChartConstantLines;return t.loadFromJsonObject(e),t}static createFromXml(e){let t=new R.H.StiChartConstantLines;return t.loadFromXml(e),t}constructor(e){this.size=7,this.angle=0,this.type=Sl.Circle,this.visible=wl.FromStyle,null!=e&&(this.size=e)}},R.H.StiChartLegendTitle=class{meta(){return[new At("Font","","Arial",12,cl.Bold),new l("Text"),new i("Color","",N.transparent)]}saveToJsonObject(e){return u.saveToJsonObject(e,this)}loadFromJsonObject(e){u.loadFromJsonObject(e,this)}loadFromXml(e){u.loadFromXml(e,this)}clone(){let e=this[P.System.StiObject.stimulsoft]().memberwiseClone();return e.font=this.font.clone(),e}constructor(e,t,i){this.color=N.transparent,this.font=new B("Arial",12,cl.Bold),this.text="",null!=e&&(this.font=e),null!=t&&(this.text=t),null!=i&&(this.color=i)}},P.Report.Chart.StiSeriesLabelsValueType),bl=(R.H.StiChartLegendLabels=class{implements(){let e=[Rt,ri,..._t,n];return(this.implements=()=>e)()}meta(){return[new At("Font","","Arial",8),new i("Color","",N.transparent),new r("ValueType","",fl)]}saveToJsonObject(e){return u.saveToJsonObject(e,this)}loadFromJsonObject(e){u.loadFromJsonObject(e,this)}loadFromXml(e){u.loadFromXml(e,this)}clone(){let e=this[P.System.StiObject.stimulsoft]().memberwiseClone();return e.font=this.font.clone(),e}constructor(e,t,i){this.color=N.transparent,this.font=new B("Arial",8),this.valueType=null,null!=e&&(this.font=e),null!=t&&(this.color=t),null!=i&&(this.valueType=i)}},P.Report.Chart.StiLegendDirection),yl=R.H.StiChartLegendTitle,Cl=R.H.StiChartLegendLabels,xl=P.Report.Chart.StiLegendVertAlignment,vl=P.Report.Chart.StiLegendHorAlignment;{let e;(I=e=R.H.Order||(R.H.Order={}))[I["HorAlignment"]=1]="HorAlignment",I[I["Labels"]=2]="Labels",I[I["Title"]=3]="Title",I[I["VertAlignment"]=4]="VertAlignment",R.H.StiChartLegend=class{implements(){let e=[n];return(this.implements=()=>e)()}meta(){return[new s("Title"),new s("Labels"),new r("HorAlignment","",vl,vl.Left),new r("VertAlignment","",xl,xl.TopOutside),new h("Visible","",!0),new r("Visibility","",R.H.StiLegendVisibility,R.H.StiLegendVisibility.Auto),new r("Direction","",bl,bl.TopToBottom),new ie("Columns")]}saveToJsonObject(e){return u.saveToJsonObject(e,this)}loadFromJsonObject(e){u.loadFromJsonObject(e,this)}loadFromXml(e){u.loadFromXml(e,this)}clone(){let e=this[P.System.StiObject.stimulsoft]().memberwiseClone();return e.title=this.title.clone(),e.labels=this.labels.clone(),e.horAlignment=this.horAlignment,e.vertAlignment=this.vertAlignment,e.visible=this.visible,e.direction=this.direction,e.columns=this.columns,e.visibility=this.visibility,e}get visible(){return this.visibility==R.H.StiLegendVisibility.Auto}set visible(e){this.visibility=e?R.H.StiLegendVisibility.Auto:R.H.StiLegendVisibility.False}constructor(e,t,i,r,s,l,n){this.horAlignment=vl.Left,this.vertAlignment=xl.TopOutside,this.visibility=R.H.StiLegendVisibility.Auto,this.direction=bl.TopToBottom,this.columns=0,this.labels=new Cl,this.title=new yl,null!=e&&(this.title=e),null!=t&&(this.labels=t),null!=i&&(this.horAlignment=i),null!=r&&(this.vertAlignment=r),null!=s&&(this.visibility=s),null!=l&&(this.direction=l),null!=n&&(this.columns=n)}}}let Fl=P.Report.Chart.StiDirection,Tl=(R.H.StiYChartAxisTitle=class extends R.H.StiChartAxisTitle{meta(){return[...super.meta(),new r("Direction","",Fl,Fl.BottomToTop)]}constructor(e,t,i,r,s,l,n){super(e,t,i,r,l,n),this.direction=Fl.BottomToTop,null!=s&&(this.direction=s)}},R.H.StiYChartAxisTitle),Ml=(R.H.StiYChartAxis=class extends R.H.StiChartAxis{clone(){let e,t=super.clone();return t.title=this.title.clone(),t.range=null==(e=this.range)?void 0:e.clone(),t}meta(){return[...super.meta(),new s("Title"),new h("StartFromZero","",!0)]}constructor(e,t,i,r){super(e),this.title=new Tl,this.startFromZero=!0,null!=e&&(this.labels=e),null!=t&&(this.title=t),null!=i&&(this.visible=i),null!=r&&(this.startFromZero=r)}},P.Base.StiAutoBool),Al=(R.H.StiXChartAxis=class extends R.H.StiChartAxis{clone(){let e=super.clone();return e.title=this.title.clone(),e}meta(){return[...super.meta(),new s("Title").check(()=>null!=this.title),new r("ShowEdgeValues","",Ml,Ml.Auto),new r("StartFromZero","",Ml,Ml.Auto)]}constructor(e,t,i,r,s){super(e),this.title=new R.H.StiXChartAxisTitle,this.showEdgeValues=Ml.Auto,this.startFromZero=Ml.Auto,null!=e&&(this.labels=e),null!=t&&(this.title=t),null!=i&&(this.visible=i),null!=r&&(this.startFromZero=r),null!=s&&(this.showEdgeValues=s)}},P.Report.Dashboard.IStiChartDashboardInteraction),Dl=P.Report.Dashboard.StiInteractionViewsState,Il=P.Report.Dashboard.IStiAllowUserSortingDashboardInteraction,Rl=P.Report.Dashboard.IStiAllowUserDrillDownDashboardInteraction,El=(R.g.StiChartDashboardInteraction=class extends R.g.StiDashboardInteraction{implements(){let e=super.implements().concat([Al,Rl,Il,n,Ws]);return(this.implements=()=>e)()}meta(){return[...super.meta(),new h("AllowUserDrillDown"),new h("AllowUserSorting","",!0),new h("ShowFullScreenButton","",!0),new h("ShowSaveButton","",!0),new h("ShowViewDataButton","",!0),new l("FileName"),new l("HeaderText"),new l("FooterText"),new r("ViewsState","",Dl,Dl.OnHover)]}get isDefaultLayout(){return this.showFullScreenButton&&this.showSaveButton&&this.showViewDataButton&&null==this.fileName&&null==this.headerText&&null==this.footerText}isDefault(){return this.onHover==ci.ShowToolTip&&this.onClick==di.ApplyFilter&&this.hyperlinkDestination==gi.NewTab&&H.isNullOrEmpty(this.hyperlink)&&H.isNullOrEmpty(this.drillDownPageKey)&&null!=this.drillDownParameters&&0==this.drillDownParameters.length&&H.isNullOrEmpty(this.toolTip)&&!this.allowUserDrillDown&&this.allowUserSorting&&this.isDefaultLayout}constructor(e,t,i,r,s,l,n,a,o,u,h,m,c,d,g){super(e,t,i,r,s,l,n),this.ident=pi.Chart,this.allowUserDrillDown=!1,this.allowUserSorting=!0,this.availableOnClick=Si.ApplyFilter|Si.OpenHyperlink|Si.ShowDashboard|Si.DrillDown,this.availableOnDataManipulation=fi.AllowDrillDown|fi.AllowSorting,this.viewsState=Dl.OnHover,this.showFullScreenButton=!0,this.showSaveButton=!0,this.showViewDataButton=!0,this.fileName=null,this.headerText=null,this.footerText=null,null!=a&&(this.allowUserDrillDown=a),null!=o&&(this.fileName=o),null!=u&&(this.headerText=u),null!=h&&(this.footerText=h),null!=m&&(this.showFullScreenButton=m),null!=c&&(this.showSaveButton=c),null!=d&&(this.showViewDataButton=d),null!=g&&(this.viewsState=g)}},P.Data.Engine.IStiDrillDownElement),kl=(R.g.StiDrillDownHelper=class{static isDrillAvailable(e){let t=e.is(Ci)?e.dashboardInteraction.as(Rl):null;if(null==t||!t.allowUserDrillDown)return!1;let i=e.as(El);return null!=i}static isDrillUpAvailable(e){if(!this.isDrillAvailable(e))return!1;let t=e.as(El);return 0<t.drillDownCurrentLevel}static isDrillDownAvailable(e){if(!this.isDrillAvailable(e))return!1;let t=e.as(El);return t.drillDownCurrentLevel<t.drillDownLevelCount-1}static drillUp(e){let t=e.as(El);t.drillDownCurrentLevel--,t.drillDownFilters=t.drillDownFiltersList[t.drillDownCurrentLevel],t.drillDownFiltersList.removeAt(t.drillDownFiltersList.length-1)}static drillDown(e,t=null){let i=e.as(El);i.drillDownFiltersList.add(i.drillDownFilters),i.drillDownFilters=t,i.drillDownCurrentLevel++}},P.Report.Dashboard.StiChartTrendLineType);{class rn{implements(){let e=[Rt,pl,n];return(this.implements=()=>e)()}meta(){return[new l("KeyValueMeter"),new r("Type","",kl,kl.None),new r("LineStyle","",Rr,Rr.Solid),new i("LineColor","",N.black),new ie("LineWidth","",1)]}saveToJsonObject(e){return u.saveToJsonObject(e,this)}loadFromJsonObject(e){u.loadFromJsonObject(e,this)}loadFromXml(e){u.loadFromXml(e,this)}clone(){return this[P.System.StiObject.stimulsoft]().memberwiseClone()}static createFromJson(e){let t=new rn;return t.loadFromJsonObject(e),t}static createFromXml(e){let t=new rn;return t.loadFromXml(e),t}constructor(e,t,i,r,s){this.type=kl.None,this.lineStyle=Rr.Solid,this.lineColor=N.black,this.lineWidth=1,null!=e&&(this.keyValueMeter=e),null!=t&&(this.type=t),null!=i&&(this.lineColor=i),null!=r&&(this.lineStyle=r),null!=s&&(this.lineWidth=s)}}R.H.StiChartTrendLine=rn}let Ol=P.Report.Chart.StiColumnShape3D,Vl=P.Report.Chart.StiPie3dOptions,Nl=P.Report.StiDataMode,Ll=P.Report.Dashboard.StiUserViewState,Bl=P.Report.Dashboard.IStiUserViewStates,Pl=P.System.StiArray,Hl=P.Report.Dashboard.StiChartSeriesCreator,jl=R.H.StiChartMarker,zl=R.g.StiDrillDownHelper,Xl=R.g.StiChartDashboardInteraction,Gl=P.Report.Dashboard.IStiNegativeSeriesColors,Jl=P.Report.Dashboard.IStiParetoSeriesColors,Wl=P.Report.Dashboard.ImplementsIStiSeriesColors,Ul=P.Report.Dashboard.ImplementsIStiNegativeSeriesColors,Zl=P.Report.Dashboard.ImplementsIStiParetoSeriesColors,Yl=P.Report.Dashboard.ImplementsIStiUserViewStates,Kl=P.Report.Dashboard.ImplementsIStiSkipOwnFilter,Ql=P.Report.Dashboard.ImplementsIStiChartElement,ql=R.H.StiChartLegend,_l=R.e.StiTitle,$l=P.Report.Dashboard.StiChartGroups,en=P.Report.Dashboard.IStiChartElement,tn=P.Data.Engine.ImplementsIStiDrillDownElement,rn=R.H.StiChartTrendLine,sn=P.Report.Chart.IStiShowNullsSeries;{let t=P.Report.Components.StiTextFormatState;ht.add("StiChartElement","Stimulsoft.Dashboard.Export.Tools.StiChartElementExportTool");class Qm extends R.e.StiElement{implements(){let e=super.implements().concat([en,Ue,Je,Bl,fe,Ie,el,ke,Ks,Gl,Jl,Us,...Ql,...Ze,...Ge,...Yl,...Kl,...il,...$s,...Wl,...Ul,...Zl,...tn,n,Ci,El]);return(this.implements=()=>e)()}clone(e){let t,i,r,s,l,n=super.clone(e),a=(n.values=this.values.select(e=>e.clone()).toList(),n.endValues=this.endValues.select(e=>e.clone()).toList(),n.closeValues=this.closeValues.select(e=>e.clone()).toList(),n.lowValues=this.lowValues.select(e=>e.clone()).toList(),n.highValues=this.highValues.select(e=>e.clone()).toList(),n.arguments=this.arguments.select(e=>e.clone()).toList(),n.weights=this.weights.select(e=>e.clone()).toList(),n.xValues=this.xValues.select(e=>e.clone()).toList(),n.yValues=this.yValues.select(e=>e.clone()).toList(),n.series=null!=this.series?this.series.clone():null,n.sortBy=null!=this.sortBy?this.sortBy.clone():null,n.indicatorValue=null==(t=this.indicatorValue)?void 0:t.clone(),n.userFilters=this.userFilters.select(e=>e.clone()).toList(),n.userSorts=this.userSorts.select(e=>e.clone()).toList(),n.userViewStates=this.userViewStates.select(e=>e.clone()).toList(),n.transformActions=this.transformActions.select(e=>e.clone()).toList(),n.transformFilters=this.transformFilters.select(e=>e.clone()).toList(),n.transformSorts=this.transformSorts.select(e=>e.clone()).toList(),n.dataFilters=this.dataFilters.select(e=>e.clone()).toList(),n.topN=this.topN.clone(),n.argumentFormat=null!=this.argumentFormat?this.argumentFormat.clone():null,n.valueFormat=null!=this.valueFormat?this.valueFormat.clone():null,n.title=null!=this.title?this.title.clone():null,n.layout=null!=this.layout?this.layout.clone():null,n.dashboardInteraction=this.dashboardInteraction.clone(),n.xAxis=null!=this.xAxis?this.xAxis.clone():null,n.xTopAxis=null==(i=this.xTopAxis)?void 0:i.clone(),n.yAxis=null!=this.yAxis?this.yAxis.clone():null,n.yRightAxis=null==(r=this.yRightAxis)?void 0:r.clone(),n.legend=null!=this.legend?this.legend.clone():null,n.area=null!=this.area?this.area.clone():null,n.seriesColors=null!=this.seriesColors?this.seriesColors.slice():null,n.negativeSeriesColors=null!=this.negativeSeriesColors?this.negativeSeriesColors.slice():null,n.paretoSeriesColors=null!=this.paretoSeriesColors?this.paretoSeriesColors.slice():null,n.marker=null!=this.marker?this.marker.clone():null,n.constantLines=this.constantLines.select(e=>e.clone()).toList(),n.trendLines=this.trendLines.select(e=>e.clone()).toList(),n.chartConditions=this.chartConditions.select(e=>e.clone()).toList(),{}),o=this.getMeters(),u=n.getMeters();for(let i=0;i<o.length;i++){let e=o[i].key,t=u[i].key;a[e]=t}for(let e of n.chartConditions)e.keyValueMeter in a.hasOwnProperty&&(e.keyValueMeter=a[e.keyValueMeter]);return n.shadow=null==(s=this.shadow)?void 0:s.clone(),n.cornerRadius=null==(l=this.cornerRadius)?void 0:l.clone(),n}meta(){return[...super.meta(),new s("UserFilters").get(e=>a.Serialize.objectArray(this.userFilters,e)).set(e=>this.userFilters.addRange(e.value.properties().select(e=>y.loadFromJson(e.value)))).setXml(e=>this.userFilters.addRange(e.childNodes.map(e=>y.loadFromXml(e)))),new s("UserSorts").get(e=>a.Serialize.objectArray(this.userSorts,e)).set(e=>this.userSorts.addRange(e.value.properties().select(e=>ll.loadFromJson(e.value)))).setXml(e=>this.userSorts.addRange(e.childNodes.map(e=>ll.loadFromXml(e)))),new s("TransformActions").get(e=>a.Serialize.objectArray(this.transformActions,e)).set(e=>this.transformActions.addRange(e.value.properties().select(e=>nl.loadFromJson(e.value)))).setXml(e=>this.transformActions.addRange(e.childNodes.map(e=>nl.loadFromXml(e)))),new s("TransformFilters").get(e=>a.Serialize.objectArray(this.transformFilters,e)).set(e=>this.transformFilters.addRange(e.value.properties().select(e=>y.loadFromJson(e.value)))).setXml(e=>this.transformFilters.addRange(e.childNodes.map(e=>y.loadFromXml(e)))),new s("TransformSorts").get(e=>a.Serialize.objectArray(this.transformSorts,e)).set(e=>this.transformSorts.addRange(e.value.properties().select(e=>ll.loadFromJson(e.value)))).setXml(e=>this.transformSorts.addRange(e.childNodes.map(e=>ll.loadFromXml(e)))),new s("DataFilters").get(e=>a.Serialize.objectArray(this.dataFilters,e)).set(e=>this.dataFilters.addRange(e.value.properties().select(e=>y.loadFromJson(e.value)))).setXml(e=>this.dataFilters.addRange(e.childNodes.map(e=>y.loadFromXml(e)))),new s("Values").get(e=>a.Serialize.objectArray(this.values,e)).set(e=>this.values.addRange(e.value.properties().select(e=>d.loadFromJson(e.value)))).setXml(e=>this.values.addRange(e.childNodes.map(e=>d.loadFromXml(e)))),new s("EndValues").get(e=>a.Serialize.objectArray(this.endValues,e)).set(e=>this.endValues.addRange(e.value.properties().select(e=>d.loadFromJson(e.value)))).setXml(e=>this.endValues.addRange(e.childNodes.map(e=>d.loadFromXml(e)))),new s("CloseValues").get(e=>a.Serialize.objectArray(this.closeValues,e)).set(e=>this.closeValues.addRange(e.value.properties().select(e=>d.loadFromJson(e.value)))).setXml(e=>this.closeValues.addRange(e.childNodes.map(e=>d.loadFromXml(e)))),new s("LowValues").get(e=>a.Serialize.objectArray(this.lowValues,e)).set(e=>this.lowValues.addRange(e.value.properties().select(e=>d.loadFromJson(e.value)))).setXml(e=>this.lowValues.addRange(e.childNodes.map(e=>d.loadFromXml(e)))),new s("HighValues").get(e=>a.Serialize.objectArray(this.highValues,e)).set(e=>this.highValues.addRange(e.value.properties().select(e=>d.loadFromJson(e.value)))).setXml(e=>this.highValues.addRange(e.childNodes.map(e=>d.loadFromXml(e)))),new s("Arguments").get(e=>a.Serialize.objectArray(this.arguments,e)).set(e=>this.arguments.addRange(e.value.properties().select(e=>d.loadFromJson(e.value)))).setXml(e=>this.arguments.addRange(e.childNodes.map(e=>d.loadFromXml(e)))),new s("Weights").get(e=>a.Serialize.objectArray(this.weights,e)).set(e=>this.weights.addRange(e.value.properties().select(e=>d.loadFromJson(e.value)))).setXml(e=>this.weights.addRange(e.childNodes.map(e=>d.loadFromXml(e)))),new s("XValues").get(e=>a.Serialize.objectArray(this.xValues,e)).set(e=>this.xValues.addRange(e.value.properties().select(e=>d.loadFromJson(e.value)))).setXml(e=>this.xValues.addRange(e.childNodes.map(e=>d.loadFromXml(e)))),new s("YValues").get(e=>a.Serialize.objectArray(this.yValues,e)).set(e=>this.yValues.addRange(e.value.properties().select(e=>d.loadFromJson(e.value)))).setXml(e=>this.yValues.addRange(e.childNodes.map(e=>d.loadFromXml(e)))),new s("UserViewStates").get(e=>a.Serialize.objectArray(this.userViewStates,e)).set(e=>this.userViewStates.addRange(e.value.properties().select(e=>Ll.loadFromJson(e.value)))).setXml(e=>this.userViewStates.addRange(e.childNodes.map(e=>Ll.loadFromXml(e)))),new h("ColorEach"),new h("ShowViewTitle"),new h("CrossFiltering","",!0),new s("TopN").check(()=>null!=this.topN).set(e=>this.topN=Ei.createFromJsonObject(e.value)).setXml(e=>this.topN=Ei.createFromXml(e)),new s("DashboardInteraction").check(()=>null!=this.dashboardInteraction.as(Xl)).set(e=>{let t,i=null==(t=bi.loadInteractionFromJsonObject(e.value))?void 0:t.as(Xl);null!=i&&(this.dashboardInteraction=i)}).setXml(e=>{let t,i=null==(t=bi.loadInteractionFromXml(e))?void 0:t.as(Xl);null!=i&&(this.dashboardInteraction=i)}),new s("Title").check(()=>null!=this.title).set(e=>this.title=_l.createFromJsonObject(e.value)).setXml(e=>this.title=_l.createFromXml(e)),new s("Layout").check(()=>null!=this.layout).set(e=>this.layout=tl.createFromJsonObject(e.value)).setXml(e=>this.layout=tl.createFromXml(e)),new s("ManuallyEnteredChartMeter").check(()=>null!=this.manuallyEnteredChartMeter).set(e=>{let t=d.loadFromJson(e.value).as(R.H.StiValueChartMeter);null!=t&&(this.manuallyEnteredChartMeter=t)}).setXml(e=>{let t=d.loadFromXml(e).as(R.H.StiValueChartMeter);null!=t&&(this.manuallyEnteredChartMeter=t)}),new s("Series").check(()=>null!=this.series).set(e=>{let t=d.loadFromJson(e.value).as(zs);null!=t&&(this.series=t)}).setXml(e=>{let t=d.loadFromXml(e).as(zs);null!=t&&(this.series=t)}),new s("SortBy").check(()=>null!=this.sortBy).set(e=>{let t=d.loadFromJson(e.value).as(R.H.StiSortByChartMeter);null!=t&&(this.sortBy=t)}).setXml(e=>{let t=d.loadFromXml(e).as(R.H.StiSortByChartMeter);null!=t&&(this.sortBy=t)}),new s("IndicatorValue").check(()=>null!=this.indicatorValue).set(e=>{let t=d.loadFromJson(e.value).as(R.H.StiIndicatorValueChartMeter);null!=t&&(this.indicatorValue=t)}).setXml(e=>{let t=d.loadFromXml(e).as(R.H.StiIndicatorValueChartMeter);null!=t&&(this.indicatorValue=t)}),new s("ArgumentFormat").check(()=>null!=this.argumentFormat).set(e=>this.argumentFormat=Mi.createFromJsonObject(e.value)).setXml(e=>this.argumentFormat=Mi.loadFormatFromXml(e,this.report)),new s("ValueFormat").check(()=>null!=this.valueFormat).set(e=>this.valueFormat=Mi.createFromJsonObject(e.value)).setXml(e=>this.valueFormat=Mi.loadFormatFromXml(e,this.report)),new s("XAxis").check(()=>null!=this.xAxis),new s("XTopAxis").check(()=>null!=this.xTopAxis),new s("YAxis").check(()=>null!=this.yAxis),new s("YRightAxis").check(()=>null!=this.yRightAxis),new s("Legend").check(()=>null!=this.legend),new s("Area").check(()=>null!=this.area),new s("Marker").check(()=>null!=this.marker),new s("Labels").check(()=>null!=this.labels),new s("Options3D").check(()=>null!=this.options3D),new s("SeriesColors").get(()=>a.Serialize.colorArray(this.seriesColors)).set(e=>this.seriesColors=a.Deserialize.colorArray(e.value)).setXml(e=>this.seriesColors=Ys.convertStringToColorArray(e.textContent)),new s("NegativeSeriesColors").get(()=>a.Serialize.colorArray(this.negativeSeriesColors)).set(e=>this.negativeSeriesColors=a.Deserialize.colorArray(e.value)).setXml(e=>this.negativeSeriesColors=Ys.convertStringToColorArray(e.textContent)),new s("ParetoSeriesColors").get(()=>a.Serialize.colorArray(this.paretoSeriesColors)).set(e=>this.paretoSeriesColors=a.Deserialize.colorArray(e.value)).setXml(e=>this.paretoSeriesColors=Ys.convertStringToColorArray(e.textContent)),new r("Style","",o,o.Auto),new l("Group"),new l("CustomStyleName"),new s("ConstantLines").get(e=>a.Serialize.objectArray(this.constantLines,e)).set(e=>this.constantLines.addRange(e.value.properties().select(e=>R.H.StiChartConstantLines.createFromJson(e.value)))).setXml(e=>this.constantLines.addRange(e.childNodes.map(e=>R.H.StiChartConstantLines.createFromXml(e)))),new s("TrendLines").get(e=>a.Serialize.objectArray(this.trendLines,e)).set(e=>this.trendLines.addRange(e.value.properties().select(e=>rn.createFromJson(e.value)))).setXml(e=>this.trendLines.addRange(e.childNodes.map(e=>rn.createFromXml(e)))),new s("ChartConditions").get(e=>a.Serialize.objectArray(this.chartConditions,e)).set(e=>this.chartConditions.addRange(e.value.properties().select(e=>R.H.StiChartElementCondition.createFromJson(e.value)))).setXml(e=>this.chartConditions.addRange(e.childNodes.map(e=>R.H.StiChartElementCondition.createFromXml(e)))),new l("CornerRadius").get(()=>this.cornerRadius.toString()).set(e=>this.cornerRadius=v.tryParse(e.value.toString())).setXml(e=>this.cornerRadius=v.tryParse(e.textContent)),new l("Shadow").get(()=>a.Serialize.jShadow(this.shadow)).set(e=>this.shadow=a.Deserialize.simpleSahdow(e.value)).setXml(e=>this.shadow=We.loadFromXml(e.textContent)),new r("DataMode","",Nl,Nl.UsingDataFields),new l("ManuallyEnteredData"),new r("Icon","",Et).check(()=>null!=this.icon),new h("RoundValues","",!0),new l("SelectedViewStateKey").check(()=>null!=this.selectedViewStateKey),new r("ColumnShape","",Ol,Ol.Box),new h("ShowBlanks")]}convertToBubble(){null!=this.arguments&&this.arguments.where(e=>null!=e).toList().forEach(e=>{e.expression=Or.replaceFunction(e.expression,"Sum")})}convertFromBubble(){null!=this.arguments&&this.arguments.where(e=>null!=e).toList().forEach(e=>{e.expression=Or.removeFunction(e.expression)}),null!=this.weights&&this.weights.clear()}convertToGantt(){var e;null!=this.values&&null!=(e=this.values)&&e.where(e=>null!=e).toList().forEach(e=>{e.expression=Or.removeFunction(e.expression)})}getChartSeriesTypes(i){let r=new j;if(1<this.values.length){let e=z.parse(m,i),t=$l.getGroup(e);if(null!=t)for(let e of t)r.add(z.getName(m,e))}return r}getManuallyEnteredChartMeter(){return this.manuallyEnteredChartMeter}addValue(e){null!=e&&this.values.add(c.Chart.getValue2(e,this))}getValue2(e){return null!=e?c.Chart.getValue2(e,this):null}getValue(e){return null!=e?c.Chart.getValue(e.as(R.e.StiMeter)):null}getGanttStartValue(e){return null!=e?c.Chart.getGanttStartValue(e):null}getGanttEndValue(e){return null!=e?c.Chart.getGanttEndValue(e):null}getY(e){return null!=e?c.Chart.getY2(e):null}getX(e){return null!=e?c.Chart.getX2(e):null}fetchAllValues(){return this.values.cast().toList()}fetchAllXValues(){return this.xValues.cast().toList()}fetchAllYValues(){return this.yValues.cast().toList()}getValueByIndex(e){return e<this.values.length?this.values[e]:null}insertValue(e,t){let i=t.as(R.H.StiValueChartMeter);null!=i&&(0<=e&&e<this.values.length?this.values.insert(e,i):this.values.add(i))}removeValue(e){e<this.values.length&&this.values.removeAt(e)}removeAllValues(){this.values.clear()}createNewValue(){let e=new R.H.StiValueChartMeter;return e.expression="Sum()",this.values.add(e),e}addEndValue(e){null!=e&&this.endValues.add(c.Chart.getEndValue2(e))}getEndValue2(e){return null!=e?c.Chart.getEndValue2(e):null}getEndValue(e){return null!=e?c.Chart.getEndValue(e.as(R.e.StiMeter)):null}getEndValueByIndex(e){return e<this.endValues.length?this.endValues[e]:null}insertEndValue(e,t){let i=t.as(Xs);null!=i&&(0<=e&&e<this.endValues.length?this.endValues.insert(e,i):this.endValues.add(i))}removeEndValue(e){e<this.endValues.length&&this.endValues.removeAt(e)}removeAllEndValues(){this.endValues.clear()}createNewEndValue(){let e=new Xs;return e.expression="Sum()",this.endValues.add(e),e}addCloseValue(e){null!=e&&this.closeValues.add(c.Chart.getCloseValue2(e))}getCloseValue2(e){return null!=e?c.Chart.getCloseValue2(e):null}getCloseValue(e){return null!=e?c.Chart.getCloseValue(e.as(R.e.StiMeter)):null}getCloseValueByIndex(e){return e<this.closeValues.length?this.closeValues[e]:null}insertCloseValue(e,t){let i=t.as(Ls);null!=i&&(0<=e&&e<this.closeValues.length?this.closeValues.insert(e,i):this.closeValues.add(i))}removeCloseValue(e){e<this.closeValues.length&&this.closeValues.removeAt(e)}removeAllCloseValues(){this.closeValues.clear()}createNewCloseValue(){let e=new Ls;return e.expression="Sum()",this.closeValues.add(e),e}addLowValue(e){null!=e&&this.lowValues.add(c.Chart.getLowValue2(e))}getLowValue2(e){return null!=e?c.Chart.getLowValue2(e):null}getLowValue(e){return null!=e?c.Chart.getLowValue(e.as(R.e.StiMeter)):null}getLowValueByIndex(e){return e<this.lowValues.length?this.lowValues[e]:null}insertLowValue(e,t){let i=t.as(Bs);null!=i&&(0<=e&&e<this.lowValues.length?this.lowValues.insert(e,i):this.lowValues.add(i))}removeLowValue(e){e<this.lowValues.length&&this.lowValues.removeAt(e)}removeAllLowValues(){this.lowValues.clear()}createNewLowValue(){let e=new Bs;return e.expression="Sum()",this.lowValues.add(e),e}addHighalue(e){null!=e&&this.highValues.add(c.Chart.getHighValue2(e))}getHighValue2(e){return null!=e?c.Chart.getHighValue2(e):null}getHighValue(e){return null!=e?c.Chart.getHighValue(e.as(R.e.StiMeter)):null}getHighValueByIndex(e){return e<this.highValues.length?this.highValues[e]:null}insertHighValue(e,t){let i=t.as(Ps);null!=i&&(0<=e&&e<this.highValues.length?this.highValues.insert(e,i):this.highValues.add(i))}removeHighValue(e){e<this.highValues.length&&this.highValues.removeAt(e)}removeAllHighValues(){this.highValues.clear()}createNewHighValue(){let e=new Ps;return e.expression="Sum()",this.highValues.add(e),e}addXValue(e){null!=e&&this.xValues.add(c.Chart.getXValue2(e))}getXValue2(e){return null!=e?c.Chart.getXValue2(e):null}getXValue(e){return null!=e?c.Chart.getXValue(e.as(R.e.StiMeter)):null}getXValueByIndex(e){return e<this.xValues.length?this.xValues[e]:null}insertXValue(e,t){let i=t.as(R.H.StiXChartMeter);null!=i&&(0<=e&&e<this.xValues.length?this.xValues.insert(e,i):this.xValues.add(i))}removeXValue(e){e<this.xValues.length&&this.xValues.removeAt(e)}removeAllXValues(){this.xValues.clear()}createNewXValue(){let e=new R.H.StiXChartMeter;return this.xValues.add(e),e}addYValue(e){null!=e&&this.xValues.add(c.Chart.getYValue2(e))}getYValue2(e){return null!=e?c.Chart.getYValue2(e):null}getYValue(e){return null!=e?c.Chart.getYValue(e.as(R.e.StiMeter)):null}getYValueByIndex(e){return e<this.yValues.length?this.yValues[e]:null}insertYValue(e,t){let i=t.as(Nr);null!=i&&(0<=e&&e<this.yValues.length?this.yValues.insert(e,i):this.yValues.add(i))}removeYValue(e){e<this.yValues.length&&this.yValues.removeAt(e)}removeAllYValues(){this.yValues.clear()}createNewYValue(){let e=new Nr;return this.yValues.add(e),e}addArgument(e){null!=e&&this.arguments.add(c.Chart.getArgument2(e))}getArgument2(e){return null!=e?c.Chart.getArgument2(e):null}getArgument(e){return null!=e?c.Chart.getArgument(e.as(R.e.StiMeter)):null}fetchAllArguments(){return this.arguments.cast().toList()}getArgumentByIndex(e){return e<this.arguments.length?this.arguments[e]:null}insertArgument(e,t){let i=t.as(Hs);null!=i&&(0<=e&&e<this.arguments.length?this.arguments.insert(e,i):this.arguments.add(i))}removeArgument(e){e<this.arguments.length&&this.arguments.removeAt(e)}removeAllArguments(){this.arguments.clear()}createNewArgument(){this.arguments.add(new Hs)}addWeight(e){null!=e&&this.weights.add(c.Chart.getWeight2(e))}getWeight2(e){return null!=e?c.Chart.getWeight2(e):null}getWeight(e){return null!=e?c.Chart.getWeight(e.as(R.e.StiMeter)):null}getWeightByIndex(e){return e<this.weights.length?this.weights[e]:null}insertWeight(e,t){let i=t.as(Vs);null!=i&&(0<=e&&e<this.weights.length?this.weights.insert(e,i):this.weights.add(i))}removeWeight(e){e<this.weights.length&&this.weights.removeAt(e)}removeAllWeights(){this.weights.clear()}createNewWeight(){let e=new Vs;e.expression="Sum()",this.weights.add(e)}addSeries(e){this.series=null!=e?c.Chart.getSeries2(e):null}getSeries2(e){return null!=e?c.Chart.getSeries2(e):null}getSeries(e){return null!=e?c.Chart.getSeries(e.as(R.e.StiMeter)):null}getSeries3(){return this.series}insertSeries(e){this.series=e.as(zs)}removeSeries(){this.series=null}createNewSeries(){this.series=new zs}addSortBy(e){this.sortBy=null!=e?c.Chart.getSortBy2(e):null}getSortBy2(e){return null!=e?c.Chart.getSortBy2(e):null}getSortBy(e){return null!=e?c.Chart.getSortBy(e.as(R.e.StiMeter)):null}getSortBy3(){return this.sortBy}insertSortBy(e){this.sortBy=e.as(R.H.StiSortByChartMeter)}removeSortBy(){this.sortBy=null}createNewSortBy(){this.sortBy=new R.H.StiSortByChartMeter}addIndicatorValue(e){this.indicatorValue=null!=e?c.Chart.getIndicatorValue2(e):null}getIndicatorValue2(e){return null!=e?c.Chart.getIndicatorValue2(e):null}getIndicatorValue(e){return null!=e?c.Chart.getIndicatorValue(e.as(R.e.StiMeter)):null}getIndicatorValue3(){return this.indicatorValue}insertIndicatorValue(e){this.indicatorValue=e.as(R.H.StiIndicatorValueChartMeter)}removeIndicatorValue(){this.indicatorValue=null}createNewIndicatorValue(){this.indicatorValue=new R.H.StiIndicatorValueChartMeter}fetchConstantLines(){let e=new j;return null!=this.constantLines&&e.addRange(this.constantLines),e}addConstantLine(){this.constantLines.add(new R.H.StiChartConstantLines)}removeConstantLine(e){0<=e&&e<this.constantLines.length&&this.constantLines.removeAt(e)}moveConstantLine(t,i){if(0<=t&&t<this.constantLines.length){let e=this.constantLines[t];this.constantLines.removeAt(t),this.constantLines.insert(i,e)}}addTrendLines(e,t,i,r,s){this.trendLines.add(new rn(e,t,i,r,s))}fetchTrendLines(){let e=new j;return null!=e&&e.addRange(this.trendLines),e}clearTrendLines(){this.trendLines.clear()}addChartCondition(e,t,i,r,s,l,n,a,o){this.chartConditions.add(new R.H.StiChartElementCondition(e,s,t,i,r,l,n,a,o))}fetchChartConditions(){let e=new j;return null!=this.chartConditions&&e.addRange(this.chartConditions),e}clearChartConditions(){this.chartConditions.clear()}convertFrom(e){let t=e.fetchAllMeters();if(this.values.clear(),this.arguments.clear(),null==t)return;t.where(e=>(e.is2(ji)||e.is2(vt))&&!e.is2(Dr)).cast().forEach(e=>{let t=new R.H.StiValueChartMeter;t.loadFromJsonObject(e.saveToJsonObject(Le.Report)),this.values.add(t)},this),t.where(e=>e.is(Dr)).cast().forEach(e=>{let t=new Hs;t.loadFromJsonObject(e.saveToJsonObject(Le.Report)),this.arguments.add(t)},this),null==this.dashboardInteraction&&(this.dashboardInteraction=new Xl)}fetchAllMeters(){let e=new j;return this.dataMode==Nl.UsingDataFields&&(null!=this.values&&e.addRange(this.values),null!=this.endValues&&e.addRange(this.endValues),null!=this.closeValues&&e.addRange(this.closeValues),null!=this.lowValues&&e.addRange(this.lowValues),null!=this.highValues&&e.addRange(this.highValues),null!=this.arguments&&e.addRange(this.arguments),null!=this.weights&&e.addRange(this.weights),null!=this.series&&e.add(this.series),null!=this.sortBy&&e.add(this.sortBy),null!=this.indicatorValue&&e.add(this.indicatorValue),null!=this.xValues&&e.addRange(this.xValues),null!=this.yValues)&&e.addRange(this.yValues),e}getMeters(){let r=new j;if(this.dataMode==Nl.UsingDataFields){for(let i of this.values)if(this.isBubbleChart){let e=new Nr;e.key=i.key,e.expression=i.expression,e.label=i.label,r.add(e)}else if(this.isFinancial){let e=new R.H.StiOpenValueChartMeter;e.seriesType=i.seriesType,e.key=i.key,e.expression=i.expression,e.label=i.label,r.add(e)}else if(this.isRange){let e=new R.H.StiStartValueChartMeter;e.seriesType=i.seriesType,e.key=i.key,e.expression=i.expression,e.label=i.label,e.lineStyle=i.lineStyle,e.showNulls=i.showNulls,r.add(e)}else if(i.showZeros==ft.Zero&&i.showNulls==ft.Zero||!Hl.neww2(i.seriesType).is(sn))r.add(i);else{let e=Or.getFunction(i.expression),t=null;if("sum"==(e=null!=e?e.toLowerCase():e)?t="sumnulls":"avg"==e&&(t="avgnulls"),null!=t){let e=i.clone();e.key=i.key,e.expression=Or.replaceFunction(i.expression,t),r.add(e)}else r.add(i)}if(this.isRange)for(let e of this.endValues)r.add(e);if(this.isFinancial)for(let e of this.closeValues)r.add(e);if(this.isFinancial)for(let e of this.lowValues)r.add(e);if(this.isFinancial)for(let e of this.highValues)r.add(e);let e=zl.isDrillAvailable(this)&&this.drillDownCurrentLevel<this.drillDownLevelCount?this.arguments.getRange(this.drillDownCurrentLevel,1):this.arguments;for(let t of e)if(this.isBubbleChart){let e=new R.H.StiXChartMeter;e.key=t.key,e.expression=t.expression,e.label=t.label,r.add(e)}else r.add(t);if(this.isBubbleChart)for(let e of this.weights)r.add(e);if(null!=this.series&&r.add(this.series),null!=this.sortBy&&r.add(this.sortBy),null!=this.indicatorValue&&r.add(this.indicatorValue),this.isHeatmapChart)for(let e of this.xValues)r.add(e);if(this.isHeatmapChart)for(let e of this.yValues)r.add(e)}return r}retrieveUsedDataNames(){let e=new j;return this.dataMode==Nl.UsingDataFields&&(e.addRange(rl.getMany2(this.values)),e.addRange(rl.getMany2(this.arguments)),e.addRange(rl.getMany2(this.weights)),e.addRange(rl.getMany(this.series)),e.addRange(rl.getMany(this.sortBy)),e.addRange(rl.getMany(this.indicatorValue)),e.addRange(rl.getMany2(this.xValues)),e.addRange(rl.getMany2(this.yValues))),e.distinct()}get isDefined(){return null!=this.values&&0<this.values.length||null!=this.weights&&0<this.weights.length&&this.isBubbleChart||null!=this.arguments&&0<this.arguments.length||null!=this.series||this.dataMode==Nl.ManuallyEnteringData}get allowSkipOwnFilter(){return!0}get style(){return this._style}set style(e){(this._style=e)!=o.Custom&&(this.customStyleName="")}get customStyleName(){return this._customStyleName}set customStyleName(e){this._customStyleName!=e&&(this._customStyleName=e,H.isNullOrWhiteSpace(e)||(this.style=o.Custom))}switchSelectedViewState(e){R.H.StiChartUserViewStatesHelper.switchSelectedViewState(this,e)}saveToJsonForViewState(){return R.H.StiChartUserViewStatesHelper.saveToJsonObject(this)}loadFromJsonForViewState(e){R.H.StiChartUserViewStatesHelper.loadFromJsonObject(this,e)}setString(i,r){switch(i){case"Title.Text":this.title.text=r;break;case"Legend.Title.Text":this.legend.title.text=r;break;case"XAxis.Labels.TextAfter":this.xAxis.labels.textAfter=r;break;case"XAxis.Labels.TextBefore":this.xAxis.labels.textBefore=r;break;case"XAxis.Title.Text":this.xAxis.title.text=r;break;case"XTopAxis.Labels.TextAfter":this.xTopAxis.labels.textAfter=r;break;case"XTopAxis.Labels.TextBefore":this.xTopAxis.labels.textBefore=r;break;case"XTopAxis.Title.Text":this.xTopAxis.title.text=r;break;case"YAxis.Labels.TextAfter":this.yAxis.labels.textAfter=r;break;case"YAxis.Labels.TextBefore":this.yAxis.labels.textBefore=r;break;case"YAxis.Title.Text":this.yAxis.title.text=r;break;case"YRightAxis.Labels.TextAfter":this.yRightAxis.labels.textAfter=r;break;case"YRightAxis.Labels.TextBefore":this.yRightAxis.labels.textBefore=r;break;case"YRightAxis.Title.Text":this.yRightAxis.title.text=r;break}let s=0;for(let t of this.values){let e=`Value${s++}.Label`;i==e&&(t.label=r)}s=0;for(let t of this.arguments){let e=`Argument${s++}.Label`;i==e&&(t.label=r)}}getString(i){switch(i){case"Title.Text":return this.title.text;case"Legend.Title.Text":return this.legend.title.text;case"XAxis.Labels.TextAfter":return this.xAxis.labels.textAfter;case"XAxis.Labels.TextBefore":return this.xAxis.labels.textBefore;case"XAxis.Title.Text":return this.xAxis.title.text;case"XTopAxis.Labels.TextAfter":return this.xTopAxis.labels.textAfter;case"XTopAxis.Labels.TextBefore":return this.xTopAxis.labels.textBefore;case"XTopAxis.Title.Text":return this.xTopAxis.title.text;case"YAxis.Labels.TextAfter":return this.yAxis.labels.textAfter;case"YAxis.Labels.TextBefore":return this.yAxis.labels.textBefore;case"YAxis.Title.Text":return this.yAxis.title.text;case"YRightAxis.Labels.TextAfter":return this.yRightAxis.labels.textAfter;case"YRightAxis.Labels.TextBefore":return this.yRightAxis.labels.textBefore;case"YRightAxis.Title.Text":return this.yRightAxis.title.text}let r=0;for(let t of this.values){let e=`Value${r++}.Label`;if(i==e)return t.label}r=0;for(let t of this.arguments){let e=`Argument${r++}.Label`;if(i==e)return t.label}throw new Error(`Property with name `+i)}getAllStrings(){let t=["Title.Text","Legend.Title.Text"],i=(this.isAxisAreaChart&&(t.push("XAxis.Labels.TextAfter"),t.push("XAxis.Labels.TextBefore"),t.push("XAxis.Title.Text"),t.push("XTopAxis.Labels.TextAfter"),t.push("XTopAxis.Labels.TextBefore"),t.push("XTopAxis.Title.Text"),t.push("YAxis.Labels.TextAfter"),t.push("YAxis.Labels.TextBefore"),t.push("YAxis.Title.Text"),t.push("YRightAxis.Labels.TextAfter"),t.push("YRightAxis.Labels.TextBefore"),t.push("YRightAxis.Title.Text")),0);return this.values.forEach(e=>t.push(`Value${i++}.Label`)),i=0,this.arguments.forEach(e=>t.push(`Argument${i++}.Label`)),t}getFonts(){let e=super.getFonts();return e.push(this.title.font),e.push(this.labels.font),e.push(this.legend.labels.font),e.push(this.legend.title.font),e.push(this.xAxis.labels.font),e.push(this.xAxis.title.font),e.push(this.xTopAxis.labels.font),e.push(this.xTopAxis.title.font),e.push(this.yAxis.labels.font),e.push(this.yAxis.title.font),e.push(this.yRightAxis.labels.font),e.push(this.yRightAxis.title.font),Pl.distinct(e)}get toolboxPosition(){return _e.ChartElement}get localizedName(){return T.get("Components","StiChart")}get colorEach(){return null!=this.area&&this.area.colorEach}set colorEach(e){null!=this.area&&(this.area.colorEach=e)}get xAxis(){var e;return null==(e=this.area)?void 0:e.xAxis}set xAxis(e){null!=this.area&&(this.area.xAxis=e)}get xTopAxis(){var e;return null==(e=this.area)?void 0:e.xTopAxis}set xTopAxis(e){null!=this.area&&(this.area.xTopAxis=e)}get yAxis(){var e;return null==(e=this.area)?void 0:e.yAxis}set yAxis(e){null!=this.area&&(this.area.yAxis=e)}get yRightAxis(){var e;return null==(e=this.area)?void 0:e.yRightAxis}set yRightAxis(e){null!=this.area&&(this.area.yRightAxis=e)}get labels(){return this._labels}set labels(e){null!=e&&(e.element=this),this._labels=e}static getValueFormatDefault(){let e=new Wi;return e.decimalDigits=0,e.state=t.DecimalDigits|t.Abbreviation,e}getManuallyEnteredDataTable(){if(this.dataMode!=Nl.ManuallyEnteringData)return null;return R.e.StiManuallyEnteredDataParser.getChartDataTable(this.manuallyEnteredData,this)}get isAxisAreaChart(){return this.chartValuesList().any(e=>null!=e&&(e.seriesType==m.ClusteredBar||e.seriesType==m.ClusteredColumn||e.seriesType==m.Ribbon||e.seriesType==m.Pareto||e.seriesType==m.Histogram||e.seriesType==m.FullStackedArea||e.seriesType==m.FullStackedBar||e.seriesType==m.FullStackedColumn||e.seriesType==m.FullStackedLine||e.seriesType==m.FullStackedSpline||e.seriesType==m.FullStackedSplineArea||e.seriesType==m.StackedBar||e.seriesType==m.StackedColumn||e.seriesType==m.StackedLine||e.seriesType==m.StackedSpline||e.seriesType==m.StackedArea||e.seriesType==m.StackedSplineArea||e.seriesType==m.Scatter||e.seriesType==m.ScatterLine||e.seriesType==m.ScatterSpline||e.seriesType==m.Candlestick||e.seriesType==m.Stock||e.seriesType==m.Gantt||e.seriesType==m.Bubble||e.seriesType==m.Area||e.seriesType==m.Line||e.seriesType==m.Spline||e.seriesType==m.SplineArea||e.seriesType==m.SplineRange||e.seriesType==m.Range||e.seriesType==m.RangeBar||e.seriesType==m.SteppedArea||e.seriesType==m.SteppedLine||e.seriesType==m.SteppedRange||e.seriesType==m.BoxAndWhisker||e.seriesType==m.Heatmap))}get isStackedChart(){return this.chartValuesList().any(e=>null!=e&&(e.seriesType==m.StackedBar||e.seriesType==m.StackedColumn||e.seriesType==m.StackedLine||e.seriesType==m.StackedSpline||e.seriesType==m.StackedArea||e.seriesType==m.StackedSplineArea))}get isScatterChart(){return this.chartValuesList().any(e=>null!=e&&(e.seriesType==m.Scatter||e.seriesType==m.ScatterLine||e.seriesType==m.ScatterSpline||e.seriesType==m.Bubble))}get isLinesChart(){return this.chartValuesList().any(e=>null!=e&&(e.seriesType==m.FullStackedArea||e.seriesType==m.FullStackedLine||e.seriesType==m.FullStackedSpline||e.seriesType==m.FullStackedSplineArea||e.seriesType==m.StackedLine||e.seriesType==m.StackedSpline||e.seriesType==m.StackedArea||e.seriesType==m.StackedSplineArea||e.seriesType==m.Scatter||e.seriesType==m.ScatterLine||e.seriesType==m.ScatterSpline||e.seriesType==m.Area||e.seriesType==m.Line||e.seriesType==m.Spline||e.seriesType==m.SplineArea||e.seriesType==m.SplineRange||e.seriesType==m.Range||e.seriesType==m.SteppedArea||e.seriesType==m.SteppedLine||e.seriesType==m.SteppedRange))}get isBubbleChart(){return this.chartValuesList().any(e=>null!=e&&e.seriesType==m.Bubble)}get isBarChart(){return this.chartValuesList().any(e=>null!=e&&(e.seriesType==m.ClusteredBar||e.seriesType==m.FullStackedBar||e.seriesType==m.StackedBar||e.seriesType==m.Gantt))}get isRange(){return this.chartValuesList().any(e=>null!=e&&(e.seriesType==m.Range||e.seriesType==m.RangeBar||e.seriesType==m.SteppedRange||e.seriesType==m.SplineRange||e.seriesType==m.Gantt))}get isFinancial(){return this.chartValuesList().any(e=>null!=e&&(e.seriesType==m.Candlestick||e.seriesType==m.Stock))}get isPieChart(){return this.chartValuesList().any(e=>null!=e&&e.seriesType==m.Pie)}get isPie3dChart(){return this.chartValuesList().any(e=>null!=e&&e.seriesType==m.Pie3d)}get isDoughnutChart(){return this.chartValuesList().any(e=>null!=e&&e.seriesType==m.Doughnut)}get isFunnelChart(){return this.chartValuesList().any(e=>null!=e&&(e.seriesType==m.Funnel||e.seriesType==m.FunnelWeightedSlices))}get isPictorialStackedChart(){return this.chartValuesList().any(e=>null!=e&&e.seriesType==m.PictorialStacked)}get isPictorialChart(){return this.chartValuesList().any(e=>null!=e&&e.seriesType==m.Pictorial)}get isHeatmapChart(){return this.chartValuesList().any(e=>null!=e&&e.seriesType==m.Heatmap)}get isTreemapChart(){return this.chartValuesList().any(e=>null!=e&&e.seriesType==m.Treemap)}get isParetoChart(){return this.chartValuesList().any(e=>null!=e&&e.seriesType==m.Pareto)}get isRibbonChart(){return this.chartValuesList().any(e=>null!=e&&e.seriesType==m.Ribbon)}get isSunburstChart(){return this.chartValuesList().any(e=>null!=e&&e.seriesType==m.Sunburst)}get isFullStackedChart(){return this.chartValuesList().any(e=>null!=e&&(e.seriesType==m.FullStackedArea||e.seriesType==m.FullStackedBar||e.seriesType==m.FullStackedColumn||e.seriesType==m.FullStackedLine||e.seriesType==m.FullStackedSpline||e.seriesType==m.FullStackedSplineArea))}get isWaterfallChart(){return this.chartValuesList().any(e=>null!=e&&e.seriesType==m.Waterfall)}get isRadarChart(){return this.chartValuesList().any(e=>null!=e&&(e.seriesType==m.RadarPoint||e.seriesType==m.RadarArea||e.seriesType==m.RadarLine))}get isAxisAreaChart3D(){return this.chartValuesList().any(e=>null!=e&&(e.seriesType==m.ClusteredColumn3D||e.seriesType==m.StackedColumn3D||e.seriesType==m.FullStackedColumn3D||e.seriesType==m.Line3D))}get isClusteredColumnChart3D(){return this.chartValuesList().any(e=>null!=e&&e.seriesType==m.ClusteredColumn3D)}get isClusteredColumnChart(){return this.chartValuesList().any(e=>null!=e&&e.seriesType==m.ClusteredColumn)}get isClusteredBarChart(){return this.chartValuesList().any(e=>null!=e&&e.seriesType==m.ClusteredBar)}get isLineChart3D(){return this.chartValuesList().any(e=>null!=e&&e.seriesType==m.Line3D)}getNestedPages(){if(null==this.dashboardInteraction||this.dashboardInteraction.onClick!=di.ShowDashboard)return null;let t=this.dashboardInteraction.drillDownPageKey;if(de.isEmptyKey(t))return null;let e=this.report.pages.toList().firstOrDefault(e=>e.guid==t);if(null==e)return null;return new j([e])}get drillDownLevelCount(){return null!=this.arguments?this.arguments.length:0}checkBrowsableProperties(){this.isRange?(this.setBrowsableProperty("Weights",!1),this.setBrowsableProperty("EndValues",!0),this.setBrowsableProperty("CloseValues",!1),this.setBrowsableProperty("LowValues",!1),this.setBrowsableProperty("HighValues",!1)):this.isFinancial?(this.setBrowsableProperty("Weights",!1),this.setBrowsableProperty("EndValues",!1),this.setBrowsableProperty("CloseValues",!0),this.setBrowsableProperty("LowValues",!0),this.setBrowsableProperty("HighValues",!0)):(this.isBubbleChart?this.setBrowsableProperty("Weights",!0):this.setBrowsableProperty("Weights",!1),this.setBrowsableProperty("EndValues",!1),this.setBrowsableProperty("CloseValues",!1),this.setBrowsableProperty("LowValues",!1),this.setBrowsableProperty("HighValues",!1))}setBrowsableProperty(e,t){}getChartSeries(){let e=m.ClusteredColumn;return this.chartValuesList().any()&&(e=this.chartValuesList().first().seriesType),Hl.neww2(e)}chartValuesList(){if(this.dataMode==Nl.UsingDataFields)return null==this.values?new j:this.values.where(e=>null!=e).toList();{let e=new j;return null!=this.manuallyEnteredChartMeter&&e.add(this.manuallyEnteredChartMeter),e}}constructor(e=L.empty){super(e),this.title=new _l,this.layout=new tl,this.group="",this.crossFiltering=!0,this._style=o.Auto,this._customStyleName="",this.userFilters=new j,this.userSorts=new j,this.userViewStates=new j,this.transformActions=new j,this.transformFilters=new j,this.transformSorts=new j,this.topN=new Ei,this.dataTransformation={},this.dataFilters=new j,this.seriesColors=[],this.negativeSeriesColors=[],this.paretoSeriesColors=[],this.cornerRadius=new v(0),this.showBlanks=!1,this.shadow=new We,this.helpUrl="user-manual/dashboards_chart.htm",this.manuallyEnteredChartMeter=new R.H.StiValueChartMeter,this.showViewTitle=!1,this.values=new j,this.endValues=new j,this.closeValues=new j,this.lowValues=new j,this.highValues=new j,this.arguments=new j,this.weights=new j,this.xValues=new j,this.yValues=new j,this.legend=new ql,this.area=new R.H.StiChartArea,this._labels=new R.H.StiChartLabels,this.argumentFormat=new zt,this.valueFormat=Qm.getValueFormatDefault(),this.trendLines=new j,this.constantLines=new j,this.chartConditions=new j,this.marker=new jl,this.icon=null,this.roundValues=!0,this.columnShape=Ol.Box,this.dataMode=Nl.UsingDataFields,this.drillDownFiltersList=new j,this.drillDownFilters=new j,this.drillDownCurrentLevel=0,this.title.text=this.localizedName,this.dashboardInteraction=new Xl,this.labels=new R.H.StiChartLabels,this.previousAnimations=new j,this.options3D=new Vl}}R.H.StiChartElement=Qm}let ln=P.Report.Dashboard.IStiChartElementCondition,nn=P.Report.Components.StiFilterCondition,an=P.Report.Components.StiFilterDataType,on=P.Report.Chart.StiChartConditionalField;{class up{implements(){let e=[Rt,ln,n];return(this.implements=()=>e)()}meta(){return[new re("Ident").get(()=>this[P.System.StiObject.stimulsoft]().getType()[P.System.StiObject.stimulsoft]().getTypeName()),new l("KeyValueMeter"),new r("Condition","",nn,nn.EqualTo),new r("DataType","",an,an.Numeric),new r("Field","",on,on.Value),new l("Value"),new i("Color","",N.white),new r("MarkerType","",Sl,Sl.Circle),new ie("MarkerAngle","",0),new h("IsExpression")]}saveToJsonObject(e){return u.saveToJsonObject(e,this)}loadFromJsonObject(e){u.loadFromJsonObject(e,this)}loadFromXml(e){u.loadFromXml(e,this)}clone(){return this[P.System.StiObject.stimulsoft]().memberwiseClone()}static createFromJson(e){let t=new up;return t.loadFromJsonObject(e),t}static createFromXml(e){let t=new up;return t.loadFromXml(e),t}constructor(e,t,i,r,s,l,n,a,o){this.color=N.white,this.markerAngle=0,this.markerType=Sl.Circle,this.condition=nn.EqualTo,this.dataType=an.Numeric,this.value="",this.keyValueMeter="",this.field=on.Value,this.isExpression=!1,null!=e&&(this.keyValueMeter=e),null!=t&&(this.color=t),null!=i&&(this.dataType=i),null!=r&&(this.condition=r),null!=s&&(this.value=s),null!=l&&(this.markerType=l),null!=n&&(this.markerAngle=n),null!=a&&(this.field=a),null!=o&&(this.isExpression=o)}}R.H.StiChartElementCondition=up}R.H.StiChartGridLines=class{constructor(){this.color=N.transparent}implements(){let e=[Rt,n];return(this.implements=()=>e)()}meta(){return[new i("Color"),new h("Visible")]}saveToJsonObject(e){return u.saveToJsonObject(e,this)}loadFromJsonObject(e){u.loadFromJsonObject(e,this)}loadFromXml(e){u.loadFromXml(e,this)}clone(){return this[P.System.StiObject.stimulsoft]().memberwiseClone()}},R.H.StiChartInterlacing=class{meta(){return[new i("Color"),new h("Visible")]}saveToJsonObject(e){return u.saveToJsonObject(e,this)}loadFromJsonObject(e){u.loadFromJsonObject(e,this)}loadFromXml(e){u.loadFromXml(e,this)}clone(){return this[P.System.StiObject.stimulsoft]().memberwiseClone()}constructor(e,t){this.color=N.transparent,this.visible=!1,null!=e&&(this.color=e),null!=e&&(this.visible=t)}};let un=P.Report.Dashboard.IStiChartLabels,S=P.Report.Dashboard.StiChartLabelsPosition,hn=(R.H.StiChartLabels=class{implements(){let e=[un,n];return(this.implements=()=>e)()}meta(){return[new At("Font","","Arial",8),new l("TextAfter"),new l("TextBefore"),new i("ForeColor","",N.transparent),new r("AxisPosition","",S,S.None),new r("PiePosition","",S,S.Center),new r("Pie3dPosition","",S,S.Center),new r("DoughnutPosition","",S,S.Center),new r("FunnelPosition","",S,S.Center),new r("PictorialStackedPosition","",S,S.Right),new r("TreemapPosition","",S,S.Center),new r("HeatmapPosition","",S,S.Center),new r("RadarPosition","",S,S.None),new r("ClusteredColumn3dPosition","",S,S.Center),new r("Line3dPosition","",S,S.Center),new r("Position","",S),new r("Style","",R.H.StiChartLabelsStyle,R.H.StiChartLabelsStyle.CategoryValue),new h("AutoRotate"),new h("WordWrap"),new ie("Width")]}saveToJsonObject(e){return u.saveToJsonObject(e,this)}loadFromJsonObject(e){u.loadFromJsonObject(e,this)}loadFromXml(e){u.loadFromXml(e,this)}clone(){let e=this[P.System.StiObject.stimulsoft]().memberwiseClone();return e.font=this.font.clone(),e}get position(){return this.element.isStackedChart||this.axisPosition!=S.Total||(this.axisPosition=S.None),this.element.isPieChart?this.piePosition:this.element.isPie3dChart?this.pie3dPosition:this.element.isDoughnutChart||this.element.isSunburstChart?this.doughnutPosition:this.element.isFunnelChart?this.funnelPosition:this.element.isPictorialStackedChart?this.pictorialStackedPosition:this.element.isHeatmapChart?this.heatmapPosition:this.element.isTreemapChart?this.treemapPosition:this.element.isRadarChart?this.radarPosition:this.element.isAxisAreaChart3D?this.clusteredColumn3dPosition:this.element.isLineChart3D?this.line3dPosition:this.axisPosition}set position(e){this.element.isPieChart?this.piePosition=e:this.element.isPie3dChart?this.pie3dPosition=e:this.element.isDoughnutChart||this.element.isSunburstChart?this.doughnutPosition=e:this.element.isFunnelChart?this.funnelPosition=e:this.element.isPictorialStackedChart?this.pictorialStackedPosition=e:this.element.isHeatmapChart?this.heatmapPosition=e:this.element.isTreemapChart?this.treemapPosition=e:this.element.isRadarChart?this.radarPosition=e:this.element.isAxisAreaChart3D?this.clusteredColumn3dPosition=e:this.element.isLineChart3D?this.line3dPosition=e:this.axisPosition=e}constructor(e,t,i,r,s,l,n,a,o,u,h,m,c,d,g,p){this.axisPosition=S.None,this.piePosition=S.Center,this.pie3dPosition=S.Center,this.clusteredColumn3dPosition=S.Center,this.line3dPosition=S.Center,this.doughnutPosition=S.Center,this.funnelPosition=S.Center,this.pictorialStackedPosition=S.Right,this.heatmapPosition=S.Center,this.treemapPosition=S.Center,this.radarPosition=S.None,this.foreColor=N.transparent,this.font=new B("Arial",8),this.autoRotate=!1,this.style=R.H.StiChartLabelsStyle.CategoryValue,this.textAfter="",this.textBefore="",this.wordWrap=!1,this.width=0,null!=e&&(this.axisPosition=e),null!=t&&(this.piePosition=t),null!=i&&(this.doughnutPosition=i),null!=r&&(this.funnelPosition=r),null!=s&&(this.treemapPosition=s),null!=l&&(this.heatmapPosition=l),null!=n&&(this.radarPosition=n),null!=a&&(this.clusteredColumn3dPosition=a),null!=o&&(this.style=o),null!=u&&(this.font=u),null!=h&&(this.foreColor=h),null!=m&&(this.textBefore=m),null!=c&&(this.textAfter=c),null!=d&&(this.autoRotate=d),null!=g&&(this.width=g),null!=p&&(this.wordWrap=p)}},P.System.Text.Encoding),mn=P.Base.StiPacker,cn=(R.H.StiChartUserViewStatesHelper=class{static saveToJsonObject(e){let t=new Be,i=Le.Report;return t.addPropertyJObject("UserFilters",a.Serialize.objectArray(e.userFilters,i)),t.addPropertyJObject("UserSorts",a.Serialize.objectArray(e.userSorts,i)),t.addPropertyJObject("Values",a.Serialize.objectArray(e.values,i)),t.addPropertyJObject("EndValues",a.Serialize.objectArray(e.endValues,i)),t.addPropertyJObject("CloseValues",a.Serialize.objectArray(e.closeValues,i)),t.addPropertyJObject("LowValues",a.Serialize.objectArray(e.lowValues,i)),t.addPropertyJObject("HighValues",a.Serialize.objectArray(e.highValues,i)),t.addPropertyJObject("Arguments",a.Serialize.objectArray(e.arguments,i)),t.addPropertyJObject("XValues",a.Serialize.objectArray(e.xValues,i)),t.addPropertyJObject("YValues",a.Serialize.objectArray(e.yValues,i)),t.addPropertyJObject("Weights",a.Serialize.objectArray(e.weights,i)),null!=e.series&&t.addPropertyJObject("Series",e.series.saveToJsonObject(i)),null!=e.sortBy&&t.addPropertyJObject("SortBy",e.sortBy.saveToJsonObject(i)),null!=e.indicatorValue&&t.addPropertyJObject("IndicatorValue",e.indicatorValue.saveToJsonObject(i)),null!=e.icon&&t.addPropertyEnum("Icon",Et,e.icon),t.addPropertyBool("RoundValues",e.roundValues,!0),t.addPropertyEnum("ColumnShape",Ol,e.columnShape,Ol.Box),t}static loadFromJsonObject(i,e){for(let t of e.properties())switch(t.name){case"UserFilters":i.userFilters.clear(),i.userFilters.addRange(t.value.properties().select(e=>y.loadFromJson(e.value)));break;case"UserSorts":i.userSorts.clear(),i.userSorts.addRange(t.value.properties().select(e=>ll.loadFromJson(e.value)));break;case"Values":i.values.clear(),i.values.addRange(t.value.properties().select(e=>d.loadFromJson(e.value)));break;case"EndValues":i.endValues.clear(),i.endValues.addRange(t.value.properties().select(e=>d.loadFromJson(e.value)));break;case"CloseValues":i.closeValues.clear(),i.closeValues.addRange(t.value.properties().select(e=>d.loadFromJson(e.value)));break;case"LowValues":i.lowValues.clear(),i.lowValues.addRange(t.value.properties().select(e=>d.loadFromJson(e.value)));break;case"HighValues":i.highValues.clear(),i.highValues.addRange(t.value.properties().select(e=>d.loadFromJson(e.value)));break;case"Arguments":i.arguments.clear(),i.arguments.addRange(t.value.properties().select(e=>d.loadFromJson(e.value)));break;case"Weights":i.weights.clear(),i.weights.addRange(t.value.properties().select(e=>d.loadFromJson(e.value)));break;case"XValues":i.xValues.clear(),i.xValues.addRange(t.value.properties().select(e=>d.loadFromJson(e.value)));break;case"YValues":i.yValues.clear(),i.yValues.addRange(t.value.properties().select(e=>d.loadFromJson(e.value)));break;case"Series":{let e=d.loadFromJson(t.value).as(R.H.StiSeriesChartMeter);null!=e&&(i.series=e);break}case"SortBy":{let e=d.loadFromJson(t.value).as(R.H.StiSortByChartMeter);null!=e&&(i.sortBy=e);break}case"IndicatorValue":{let e=d.loadFromJson(t.value).as(Pr);null!=e&&(i.indicatorValue=e);break}case"Icon":i.icon=z.parse(Et,t.value.toString());break;case"RoundValues":i.roundValues=t.value[P.System.StiObject.stimulsoft]().toBoolean();break;case"ColumnShape":i.columnShape=z.parse(Ol,t.value.toString());break}}static clearVisualState(e){e.values.clear(),e.endValues.clear(),e.closeValues.clear(),e.lowValues.clear(),e.highValues.clear(),e.arguments.clear(),e.xValues.clear(),e.yValues.clear(),e.weights.clear(),e.series=null,e.sortBy=null,e.icon=null}static switchSelectedViewState(e,t){let i,r=e.selectedViewStateKey;H.isNullOrWhiteSpace(r)&&(r=null==(i=e.userViewStates.firstOrDefault())?void 0:i.key),this.saveVisualState(e,r),this.loadVisualState(e,t),e.selectedViewStateKey=t}static saveVisualState(e,t){if(H.isNullOrWhiteSpace(t))return;let i=e.userViewStates.firstOrDefault(e=>e.key==t);if(null==i)return;let r=this.saveToJsonObject(e);i.state=mn.packToString(hn.UTF8.getBytes(r.serialize()))}static loadVisualState(e,t){if(this.clearVisualState(e),H.isNullOrWhiteSpace(t))return;let i=e.userViewStates.firstOrDefault(e=>e.key==t);if(H.isNullOrWhiteSpace(null==i?void 0:i.state))return;let r=hn.UTF8.getString(mn.unpackFromString(i.state)),s=new Be;s.deserialize(r),this.loadFromJsonObject(e,s)}},R.H.StiChartYRightAxisLabels=class extends R.H.StiChartAxisLabels{meta(){return[...super.meta(),new se("TextAlignment"),new r("TextAlignment","",X,X.Left)]}constructor(e,t,i,r,s,l,n){super(e,t,i,r,s,l,n),this.textAlignment=X.Left}},R.H.StiHorChartGridLines=class extends R.H.StiChartGridLines{meta(){return[...super.meta(),new i("Color"),new h("Visible","",!0)]}constructor(e,t){super(),this.visible=!0,null!=e&&(this.color=e),null!=t&&(this.visible=t)}},R.H.StiHorChartInterlacing=class extends R.H.StiChartInterlacing{constructor(e,t){super(e,t)}},R.H.StiStartValueChartMeter=class extends R.H.StiValueChartMeter{get localizedName(){return b.get("PropertyMain","StartValue")}constructor(e,t,i,r){super(e,t,i,r),this.seriesType=m.Gantt,this.ident=R.e.StiMeterIdent.StartValueChartMeter,null!=r&&(this.seriesType=r)}},R.H.StiVertChartGridLines=class extends R.H.StiChartGridLines{meta(){return[...super.meta(),new i("Color"),new h("Visible")]}constructor(e,t){super(),this.visible=!1,null!=e&&(this.color=e),null!=t&&(this.visible=t)}},R.H.StiVertChartInterlacing=class extends R.H.StiChartInterlacing{constructor(e,t){super(e,t)}},R.H.StiXChartAxisTitle=class extends R.H.StiChartAxisTitle{meta(){return[...super.meta(),new r("Direction","",Fl,Fl.LeftToRight)]}constructor(e,t,i,r,s,l,n){super(e,t,i,r,l,n),this.direction=Fl.LeftToRight,null!=s&&(this.direction=s)}},R.H.StiXTopChartAxis=class extends R.H.StiXChartAxis{meta(){return[...super.meta(),new se(["Range","Visible"]),new h("Visible")]}constructor(e,t,i){super(e,t,i),this.visible=!1}},R.H.StiYRightChartAxis=class extends R.H.StiYChartAxis{meta(){return[...super.meta(),new se(["Range","Visible"]),new h("Visible")]}constructor(e,t,i){super(e,t,i),this.visible=!1,this.labels=new R.H.StiChartYRightAxisLabels}},R.W.StiMeterConverter=class{},R.W.StiMeterConverter),dn=(R.ae.StiValueChartMeterConverter=class extends cn{},R.ae.StiXChartAxisConverter=class{},R.ae.StiYChartAxisConverter=class{},R.g.StiFilterDashboardInteraction=class extends R.g.StiDashboardInteraction{constructor(e,t,i,r){super(),this.ident=pi.Filter,this.availableOnHover=wi.ShowToolTip,this.availableOnClick=Si.ApplyFilter,this.availableOnDataManipulation=fi.None,null!=e&&(this.onHover=e),null!=t&&(this.onClick=t),null!=i&&(this.toolTip=i),null!=r&&(this.drillDownParameters=r)}},R.g.StiFilterDashboardInteraction),gn=P.Report.Dashboard.ImplementsIStiComboBoxElement,W=P.System.Drawing.Size,pn=P.Report.Dashboard.StiItemSelectionMode,Sn=P.Report.Dashboard.IStiComboBoxElement,wn=(ht.add("StiComboBoxElement","Stimulsoft.Dashboard.Export.Tools.StiComboBoxElementExportTool"),R.S.StiComboBoxElement=class extends R.e.StiElement{implements(){let e=super.implements().concat([Sn,Ue,Je,ii,Ci,...gn,...Ze,...Ge,...qt,n]);return(this.implements=()=>e)()}meta(){return[new h("FixedHeight","",!0),...super.meta(),new l("ParentKey"),new l("InitialValue"),new s("UserFilters").get(e=>a.Serialize.objectArray(this.userFilters,e)).set(e=>this.userFilters.addRange(e.value.properties().select(e=>y.loadFromJson(e.value)))).setXml(e=>this.userFilters.addRange(e.childNodes.map(e=>y.loadFromXml(e)))),new s("TransformActions").get(e=>a.Serialize.objectArray(this.transformActions,e)).set(e=>this.transformActions.addRange(e.value.properties().select(e=>nl.loadFromJson(e.value)))).setXml(e=>this.transformActions.addRange(e.childNodes.map(e=>nl.loadFromXml(e)))),new s("TransformFilters").get(e=>a.Serialize.objectArray(this.transformFilters,e)).set(e=>this.transformFilters.addRange(e.value.properties().select(e=>y.loadFromJson(e.value)))).setXml(e=>this.transformFilters.addRange(e.childNodes.map(e=>y.loadFromXml(e)))),new s("TransformSorts").get(e=>a.Serialize.objectArray(this.transformSorts,e)).set(e=>this.transformSorts.addRange(e.value.properties().select(e=>ll.loadFromJson(e.value)))).setXml(e=>this.transformSorts.addRange(e.childNodes.map(e=>ll.loadFromXml(e)))),new s("DataFilters").get(e=>a.Serialize.objectArray(this.dataFilters,e)).set(e=>this.dataFilters.addRange(e.value.properties().select(e=>y.loadFromJson(e.value)))).setXml(e=>this.dataFilters.addRange(e.childNodes.map(e=>y.loadFromXml(e)))),new i("ForeColor","",N.transparent),new l("Font").get(()=>a.Serialize.fontArial8(this.font)).set(e=>this.font=a.Deserialize.font(e.value,this.font)).setXml(e=>this.font=P.System.Convert.toFont(e.textContent)),new h("ShowAllValue"),new h("ShowBlanks"),new r("InclusionMode","",q,q.SelectionOnly),new r("SelectionMode","",pn,pn.One).set(e=>{let t=z.parse(pn,e.value);null!=t&&(this.selectionMode=t)}).setXml(e=>{let t=z.parse(pn,e.textContent);null!=t&&(this.selectionMode=t)}),new s("NameMeter").check(()=>null!=this.nameMeter).set(e=>{let t=d.loadFromJson(e.value).as(R.S.StiNameComboBoxMeter);null!=t&&(this.nameMeter=t)}).setXml(e=>{let t=d.loadFromXml(e).as(R.S.StiNameComboBoxMeter);null!=t&&(this.nameMeter=t)}),new s("KeyMeter").check(()=>null!=this.keyMeter).set(e=>{let t=d.loadFromJson(e.value).as(R.S.StiKeyComboBoxMeter);null!=t&&(this.keyMeter=t)}).setXml(e=>{let t=d.loadFromXml(e).as(R.S.StiKeyComboBoxMeter);null!=t&&(this.keyMeter=t)}),new r("Style","",o,o.Auto),new l("Group"),new l("CustomStyleName"),new l("CornerRadius").get(()=>this.cornerRadius.toString()).set(e=>this.cornerRadius=v.tryParse(e.value.toString())).setXml(e=>this.cornerRadius=v.tryParse(e.textContent)),new l("Shadow").get(()=>a.Serialize.jShadow(this.shadow)).set(e=>this.shadow=a.Deserialize.simpleSahdow(e.value)).setXml(e=>this.shadow=We.loadFromXml(e.textContent)),new s("TextFormat").check(()=>!(this.textFormat.is(zt)||null==this.textFormat)).set(e=>this.textFormat=Mi.createFromJsonObject(e.value)).setXml(e=>this.textFormat=Mi.loadFormatFromXml(e,this.report)),new se("MinSize"),new se("MaxSize"),new s("DashboardInteraction").check(()=>null!=this.dashboardInteraction).set(e=>{let t,i=null==(t=bi.loadInteractionFromJsonObject(e.value))?void 0:t.as(dn);null!=i&&(this.dashboardInteraction=i)}).setXml(e=>{let t,i=null==(t=bi.loadInteractionFromXml(e))?void 0:t.as(dn);null!=i&&(this.dashboardInteraction=i)})]}clone(e){let t,i,r,s=super.clone(e);return s.nameMeter=null!=this.nameMeter?this.nameMeter.clone():null,s.keyMeter=null!=this.keyMeter?this.keyMeter.clone():null,s.userFilters=this.userFilters.select(e=>e.clone()).toList(),s.transformActions=this.transformActions.select(e=>e.clone()).toList(),s.transformFilters=this.transformFilters.select(e=>e.clone()).toList(),s.transformSorts=this.transformSorts.select(e=>e.clone()).toList(),s.dataFilters=this.dataFilters.select(e=>e.clone()).toList(),s.textFormat=this.textFormat.clone(),s.shadow=null==(t=this.shadow)?void 0:t.clone(),s.cornerRadius=null==(i=this.cornerRadius)?void 0:i.clone(),s.dashboardInteraction=null==(r=this.dashboardInteraction)?void 0:r.clone(),s}get isFixedHeight(){return this.fixedHeight}getParentKey(){return this.parentKey}setParentKey(e){this.parentKey=e}async applyDefaultFilters(){let e=await R.S.StiComboBoxHelper.fetchDefaultUserFilters(this);null!=e&&(this.userFilters=e)}getIdentityFilters(){let e=new y;return e.condition=Ot.Any,e.elementKey=this.key,e.path=R.S.StiComboBoxHelper.getKeyMeterExpression(this),e.toList()}get style(){return this._style}set style(e){(this._style=e)!=o.Custom&&(this.customStyleName="")}fetchAllMeters(){let e=new j;return null!=this.nameMeter&&e.add(this.nameMeter),null!=this.keyMeter&&e.add(this.keyMeter),e}getMeters(){let e=new j;return null!=this.nameMeter&&e.add(this.nameMeter),null!=this.keyMeter&&e.add(this.keyMeter),e}retrieveUsedDataNames(){return rl.getMany(this.nameMeter,this.keyMeter)}get isDefined(){return null!=this.nameMeter||null!=this.keyMeter}addKeyMeter2(e){this.keyMeter=null!=e?c.ComboBox.getKey2(e):null}addKeyMeter(e){this.keyMeter=null!=e?c.ComboBox.getKey(e.as(R.e.StiMeter)):null}getKeyMeter(){return this.keyMeter}removeKeyMeter(){this.keyMeter=null}createNewKeyMeter(){this.keyMeter=new R.S.StiKeyComboBoxMeter}addNameMeter2(e){this.nameMeter=null!=e?c.ComboBox.getName2(e):null}addNameMeter(e){this.nameMeter=null!=e?c.ComboBox.getName(e.as(R.e.StiMeter)):null}getNameMeter(){return this.nameMeter}removeNameMeter(){this.nameMeter=null}createNewNameMeter(){this.nameMeter=new R.S.StiNameComboBoxMeter}createNextMeter(e){null!=this.keyMeter&&null==this.nameMeter?this.nameMeter=c.ComboBox.getName2(e):this.keyMeter=c.ComboBox.getKey2(e)}convertFrom(e){let t=e.fetchAllMeters();if(null==t)return;let i=t.firstOrDefault(e=>e.is(ji)),r=(null!=(i=null==i?t.firstOrDefault(e=>e.is(vt)):i)&&(this.keyMeter=null==this.keyMeter?new R.S.StiKeyComboBoxMeter:this.keyMeter,this.keyMeter.loadFromJsonObject(i.saveToJsonObject(Le.Report))),t.firstOrDefault(e=>e.is(ji)));null!=(r=null==r?t.firstOrDefault(e=>e.is(Pe)):r)&&(this.nameMeter=null==this.nameMeter?new R.S.StiNameComboBoxMeter:this.nameMeter,this.nameMeter.loadFromJsonObject(r.saveToJsonObject(Le.Report)))}get toolboxPosition(){return _e.ComboBoxElement}get localizedName(){return T.get("Components","StiComboBox")}getMinSize(){let e=null!=this.report?this.report.getCurrentPage():null;if(null==e)return W.empty;let t=Lt.alignToMaxGrid(this.defaultClientRectangle.height,e.gridSize,!0);return new W(0,t)}setMinSize(e){}getMaxSize(){if(!this.fixedHeight)return super.getMaxSize();let e=null!=this.report?this.report.getCurrentPage():null;if(null==e)return W.empty;let t=Lt.alignToMaxGrid(this.defaultClientRectangle.height,e.gridSize,!0);return new W(0,t)}setMaxSize(e){this.fixedHeight||super.setMaxSize(e)}get fixedHeight(){return this._fixedHeight}set fixedHeight(e){var t;this._fixedHeight!=e&&(this._fixedHeight=e)&&(this.height=Lt.alignToMaxGrid(this.defaultClientRectangle.height,null==(t=this.page)?void 0:t.gridSize,!0))}constructor(e=L.empty){super(e),this.group="",this.inclusionMode=q.SelectionOnly,this.userFilters=new j,this.transformActions=new j,this.transformFilters=new j,this.transformSorts=new j,this.dataTransformation={},this.dataFilters=new j,this._style=o.Auto,this.customStyleName="",this.font=new B("Arial",8),this.shadow=new We,this.cornerRadius=new v(0),this.foreColor=N.transparent,this.showAllValue=!1,this.showBlanks=!1,this.selectionMode=pn.One,this.textFormat=new zt,this.defaultClientRectangle=new L(0,0,200,40),this.helpUrl="user-manual/dashboards_data_filtering_combo_box.htm",this._fixedHeight=!0,this.dashboardInteraction=new dn}},P.Report.Components.TextFormats.StiCustomFormatService),fn=P.Report.Dashboard.StiDataFilterCreator,bn=P.System.Data.DBNull,yn=P.Report.Dashboard.StiElementDataCache,Cn=(R.S.StiComboBoxHelper=class{static fetchItems(r,e,s){if(null==e||e==Ct.nullTable||0==e.rows.length)return null;let l=this.getNameMeterIndex(e),n=this.getKeyMeterIndex(e);if(-1==l&&1==n)return null;-1==n&&(n=l),-1==l&&(l=n);let a=new j;for(let i of e.rows){let e=i[n];if(null==e)continue;let t=i[l];!s&&this.isBlank(t)||a.add(new R.S.StiComboBoxItem(this.format(r,t),e))}return a}static isBlank(e){return null==e||e==bn.value||"string"==typeof e&&H.isNullOrEmpty(e)}static async fetchDefaultUserFilters(t){let e=!H.isNullOrEmpty(t.initialValue);if(t.showAllValue&&!e)return null;if(t.selectionMode==pn.Multi&&!e)return null;let i=this.getKeyMeterExpression(t);if(null==i)return null;let r=await yn.getOrCreate(t),s=this.fetchItems(t,r,t.showBlanks);if(null==s||0==s.length)return null;return this.fetchInitialValues(t,s).select(e=>fn.createEqualBasedOnValue(e.value,i,t)).toList()}static fetchInitialValues(e,r){if(!H.isNullOrEmpty(e.initialValue)){let i=this.getInitialValues(e),t=r[P.System.StiObject.stimulsoft]().toList().where(e=>{var t;return i.contains(null==(t=e.value)?void 0:t.toString())});if(e.selectionMode==pn.One&&t.any()){let e=new j;return e.add(t.firstOrDefault()),e}return t.toList()}let t=new j;return t.add(r[P.System.StiObject.stimulsoft]().toList().firstOrDefault()),t}static getInitialValues(e){if(H.isNullOrEmpty(e.initialValue))return new j;let t=k.parse2(e.initialValue,e.report);return t.split(";")[P.System.StiObject.stimulsoft]().toList().select(e=>e.trim()).toList()}static getNameMeterIndex(e){if(null==e)return-1;let t=e.meters.firstOrDefault(e=>e.is(R.S.StiNameComboBoxMeter));return null!=t?e.meters.indexOf(t):-1}static getKeyMeterIndex(e){if(null==e)return-1;let t=e.meters.firstOrDefault(e=>e.is(R.S.StiKeyComboBoxMeter));return null!=t?e.meters.indexOf(t):-1}static getKeyMeterExpression(e){if(null!=e.keyMeter)return e.keyMeter.expression;if(null!=e.nameMeter)return e.nameMeter.expression;return null}static format(e,t){let i,r=e.as(Di);if(t instanceof F&&!(r.textFormat.is2(Ji)||r.textFormat.is2(Gi)||r.textFormat.is2(wn)))return t.toShortDateString();let s=null==(i=null==e?void 0:e.report)?void 0:i.culture;if(nr.isEligable(t,s))return nr.convert(t,s);return r.textFormat.format(t)}},R.S.StiComboBoxItem=class{toString(){return null!=this.label?this.label:this.value.toString()}constructor(e,t=e){this.label=e,this.value=t}},P.Report.Dashboard.ImplementsIStiGroupElement),xn=P.Report.Dashboard.ImplementsIStiDatePickerElement,vn=P.Report.Dashboard.StiInitialDateRangeSelection,Fn=P.Report.Dashboard.StiInitialDateRangeSelectionSource,Tn=P.Report.Dashboard.StiDateSelectionMode,Mn=P.Report.Dashboard.StiDateCondition,An=P.Report.Dashboard.IStiDatePickerElement,Dn=P.Report.DateTimeRange,In=P.Report.Range,Rn=P.Report.Engine.StiVariableHelper,En=(ht.add("StiDatePickerElement","Stimulsoft.Dashboard.Export.Tools.StiDatePickerElementExportTool"),R.Q.StiDatePickerElement=class extends R.e.StiElement{implements(){let e=super.implements().concat([An,Ue,Je,ii,st,...xn,...Ze,...Ge,...qt,...Cn,n]);return(this.implements=()=>e)()}meta(){return[new h("FixedHeight","",!0),...super.meta(),new s("UserFilters").get(e=>a.Serialize.objectArray(this.userFilters,e)).set(e=>this.userFilters.addRange(e.value.properties().select(e=>y.loadFromJson(e.value)))).setXml(e=>this.userFilters.addRange(e.childNodes.map(e=>y.loadFromXml(e)))),new s("DataFilters").get(e=>a.Serialize.objectArray(this.dataFilters,e)).set(e=>this.dataFilters.addRange(e.value.properties().select(e=>y.loadFromJson(e.value)))).setXml(e=>this.dataFilters.addRange(e.childNodes.map(e=>y.loadFromXml(e)))),new i("ForeColor","",N.transparent),new l("Font").get(()=>a.Serialize.fontArial8(this.font)).set(e=>this.font=a.Deserialize.font(e.value,this.font)).setXml(e=>this.font=P.System.Convert.toFont(e.textContent)),new r("Condition","",Mn,Mn.GreaterThanOrEqualTo),new r("SelectionMode","",Tn,Tn.Single).set(e=>{let t=z.parse(Tn,e.value);null!=t&&(this.selectionMode=t)}).setXml(e=>{let t=z.parse(Tn,e.textContent);null!=t&&(this.selectionMode=t)}),new r("InitialRangeSelection","",vn,vn.MonthPrevious),new r("InitialRangeSelectionSource","",Fn,Fn.Variable),new s("ValueMeter").check(()=>null!=this.valueMeter).set(e=>{let t=d.loadFromJson(e.value).as(vs);null!=t&&(this.valueMeter=t)}).setXml(e=>{let t=d.loadFromXml(e).as(vs);null!=t&&(this.valueMeter=t)}),new r("Style","",o,o.Auto),new l("Group"),new l("CustomStyleName"),new l("CornerRadius").get(()=>this.cornerRadius.toString()).set(e=>this.cornerRadius=v.tryParse(e.value.toString())).setXml(e=>this.cornerRadius=v.tryParse(e.textContent)),new l("Shadow").get(()=>a.Serialize.jShadow(this.shadow)).set(e=>this.shadow=a.Deserialize.simpleSahdow(e.value)).setXml(e=>this.shadow=We.loadFromXml(e.textContent)),new s("TextFormat").check(()=>!(this.textFormat.is(zt)||null==this.textFormat)).set(e=>this.textFormat=Mi.createFromJsonObject(e.value)).setXml(e=>this.textFormat=Mi.loadFormatFromXml(e,this.report)),new se("MinSize"),new se("MaxSize"),new r("InclusionMode","",q,q.SelectionOnly)]}clone(e){let t,i,r=super.clone(e);return r.valueMeter=null!=this.valueMeter?this.valueMeter.clone():null,r.userFilters=this.userFilters.select(e=>e.clone()).toList(),r.dataFilters=this.dataFilters.select(e=>e.clone()).toList(),r.textFormat=this.textFormat.clone(),r.shadow=null==(t=this.shadow)?void 0:t.clone(),r.cornerRadius=null==(i=this.cornerRadius)?void 0:i.clone(),r}get isFixedHeight(){return this.fixedHeight}getParentKey(){return null}setParentKey(e){}async applyDefaultFilters(){let e,r=null==(e=R.Q.StiDatePickerHelper.getVariableSpecifiedAsValue(this.as(An)))?void 0:e.as(Js);if(null==r){let e=await R.Q.StiDatePickerHelper.fetchDefaultUserFilters(this);null!=e&&(this.userFilters=e)}else if(In.isRangeType(r.type)&&this.initialRangeSelectionSource==Fn.Selection){let e={ref:null},t={ref:null},i=(R.Q.StiDatePickerHelper.calculateRangeFromInitial(this.initialRangeSelection,e,t),new Dn(e.ref,t.ref));Rn.setVariableValue(this.report,r,i),r.valueObject=i}}getIdentityFilters(){let e=new y;return e.condition=Ot.Any,e.elementKey=this.key,e.path=R.Q.StiDatePickerHelper.getValueMeterExpression(this),e.toList()}get style(){return this._style}set style(e){(this._style=e)!=o.Custom&&(this.customStyleName="")}fetchAllMeters(){let e=new j;return null!=this.valueMeter&&e.add(this.valueMeter),e}getMeters(){let e=new j;return(R.Q.StiDatePickerHelper.isVariableSpecifiedAsValue(this)||null!=this.valueMeter&&this.selectionMode==Tn.AutoRange)&&e.add(this.valueMeter),e}retrieveUsedDataNames(){return null!=this.valueMeter&&this.selectionMode==Tn.AutoRange?rl.getMany(this.valueMeter):super.retrieveUsedDataNames()}get isDefined(){return null!=this.valueMeter}addValueMeter2(e){this.valueMeter=null!=e?c.DatePicker.getValue2(e):null}addValueMeter(e){this.valueMeter=null!=e?c.DatePicker.getValue(e.as(R.e.StiMeter)):null}getValueMeter(){return this.valueMeter}removeValueMeter(){this.valueMeter=null}createNewValueMeter(){this.valueMeter=new vs}convertFrom(e){let t=e.fetchAllMeters();if(null==t)return;let i=t.firstOrDefault(e=>e.is(ji));null!=(i=null==i?t.firstOrDefault(e=>e.is(vt)):i)&&(this.valueMeter=null==this.valueMeter?new vs:this.valueMeter,this.valueMeter.loadFromJsonObject(i.saveToJsonObject(Le.Report)))}get toolboxPosition(){return _e.DatePickerElement}get localizedName(){return T.get("Components","StiDatePicker")}getMinSize(){let e=null!=this.report?this.report.getCurrentPage():null;if(null==e)return W.empty;let t=Lt.alignToMaxGrid(this.defaultClientRectangle.height,e.gridSize,!0);return new W(0,t)}setMinSize(e){}getMaxSize(){if(!this.fixedHeight)return super.getMaxSize();let e=null!=this.report?this.report.getCurrentPage():null;if(null==e)return W.empty;let t=Lt.alignToMaxGrid(this.defaultClientRectangle.height,e.gridSize,!0);return new W(0,t)}setMaxSize(e){this.fixedHeight||super.setMaxSize(e)}get fixedHeight(){return this._fixedHeight}set fixedHeight(e){var t;this._fixedHeight!=e&&(this._fixedHeight=e)&&(this.height=Lt.alignToMaxGrid(this.defaultClientRectangle.height,null==(t=this.page)?void 0:t.gridSize,!0))}constructor(e=L.empty){super(e),this.group="",this.inclusionMode=q.SelectionOnly,this.userFilters=new j,this.dataFilters=new j,this._style=o.Auto,this.customStyleName="",this.font=new B("Arial",8),this.foreColor=N.transparent,this.shadow=new We,this.cornerRadius=new v(0),this.textFormat=new Ji,this.defaultClientRectangle=new L(0,0,200,40),this.helpUrl="user-manual/dashboards_data_filtering_date_picker.htm",this._fixedHeight=!0,this.condition=Mn.GreaterThanOrEqualTo,this.selectionMode=Tn.Single,this.initialRangeSelection=vn.MonthPrevious,this.initialRangeSelectionSource=Fn.Variable}},P.Report.Engine.StiParser.StiParser),kn=P.Report.Dictionary.StiVariableInitBy,On=P.Report.StiVariableExpressionHelper,Vn=P.System.StimulsoftDateTimeRange,Nn=P.System.NullableDateTime,Ln=(R.Q.StiDatePickerHelper=class{static calculateRangeFromInitial(e,t,i){switch(e){case vn.DayTomorrow:t.ref=F.today.addDays(1),i.ref=F.today.addDays(1);break;case vn.DayToday:t.ref=F.today,i.ref=F.today;break;case vn.DayYesterday:t.ref=F.today.addDays(-1),i.ref=F.today.addDays(-1);break;case vn.Last7Days:t.ref=F.today.addDays(-7),i.ref=F.today;break;case vn.Last14Days:t.ref=F.today.addDays(-14),i.ref=F.today;break;case vn.Last30Days:t.ref=F.today.addDays(-30),i.ref=F.today;break;case vn.WeekNext:t.ref=F.today.addDays(7).firstDayOfWeek(),i.ref=F.today.addDays(7).lastDayOfWeek();break;case vn.WeekCurrent:t.ref=F.today.firstDayOfWeek(),i.ref=F.today.lastDayOfWeek();break;case vn.WeekPrevious:t.ref=F.today.addDays(-7).firstDayOfWeek(),i.ref=F.today.addDays(-7).lastDayOfWeek();break;case vn.MonthNext:t.ref=F.today.addMonths(1).firstDayOfMonth(),i.ref=F.today.addMonths(1).lastDayOfMonth();break;case vn.MonthCurrent:t.ref=F.today.firstDayOfMonth(),i.ref=F.today.lastDayOfMonth();break;case vn.MonthPrevious:t.ref=F.today.addMonths(-1).firstDayOfMonth(),i.ref=F.today.addMonths(-1).lastDayOfMonth();break;case vn.QuarterNext:t.ref=F.today.addMonths(3).firstDayOfQuarter(),i.ref=F.today.addMonths(3).lastDayOfQuarter();break;case vn.QuarterCurrent:t.ref=F.today.firstDayOfQuarter(),i.ref=F.today.lastDayOfQuarter();break;case vn.QuarterPrevious:t.ref=F.today.addMonths(-3).firstDayOfQuarter(),i.ref=F.today.addMonths(-3).lastDayOfQuarter();break;case vn.QuarterFirst:t.ref=F.today.firstDayOfFirthQuarter(),i.ref=F.today.lastDayOfFirthQuarter();break;case vn.QuarterSecond:t.ref=F.today.firstDayOfSecondQuarter(),i.ref=F.today.lastDayOfSecondQuarter();break;case vn.QuarterThird:t.ref=F.today.firstDayOfThirdQuarter(),i.ref=F.today.lastDayOfThirdQuarter();break;case vn.QuarterFourth:t.ref=F.today.firstDayOfFourthQuarter(),i.ref=F.today.lastDayOfFourthQuarter();break;case vn.YearNext:t.ref=F.today.addYears(1).firstDayOfYear(),i.ref=F.today.addYears(1).lastDayOfYear();break;case vn.YearCurrent:t.ref=F.today.firstDayOfYear(),i.ref=F.today.lastDayOfYear();break;case vn.YearPrevious:t.ref=F.today.addYears(-1).firstDayOfYear(),i.ref=F.today.addYears(-1).lastDayOfYear();break;case vn.DateToWeek:t.ref=F.today.firstDayOfWeek(),i.ref=F.today;break;case vn.DateToMonth:t.ref=F.today.firstDayOfMonth(),i.ref=F.today;break;case vn.DateToQuarter:t.ref=F.today.firstDayOfQuarter(),i.ref=F.today;break;case vn.DateToYear:t.ref=F.today.firstDayOfYear(),i.ref=F.today;break;default:t.ref=F.now,i.ref=F.now;break}}static async fetchDefaultUserFilters(e){let t=this.getValueMeterExpression(e);if(e.selectionMode==Tn.Single)return this.getSingleDefaultUserFilters(e,t);if(e.selectionMode==Tn.Range)return this.getRangeDefaultUserFilters(e.initialRangeSelection,t);if(e.selectionMode==Tn.AutoRange)return this.getAutoRangeDefaultUserFilters(e,t);return null}static getSingleDefaultUserFilters(e,t){let i=this.getFormatedDate(F.now);return new y(null,t,this.getCondition(e),i).toList()}static getRangeDefaultUserFilters(e,t){let i={ref:null},r={ref:null},s=(this.calculateRangeFromInitial(e,i,r),this.getFormatedDate(i.ref)),l=this.getFormatedDate(r.ref);return new y("",t,Ot.Between,s,l,!0,!1).toList()}static async getAutoRangeDefaultUserFilters(e,t){let i=await yn.getOrCreate(e);if(null==i)return null;let r=i.rows.select(e=>e[0]).where(e=>e instanceof F);if(null==r||!r.any())return null;let s=r.where(e=>e instanceof F).cast().min(),l=r.where(e=>e instanceof F).cast().max(),n=this.getFormatedDate(s),a=this.getFormatedDate(l);return new y("",t,Ot.Between,n,a,!0,!1).toList()}static getValueMeterExpression(e){return null!=e.valueMeter?e.valueMeter.expression:null}static getCondition(e){switch(e.condition){case Mn.EqualTo:return Ot.EqualTo;case Mn.NotEqualTo:return Ot.NotEqualTo;case Mn.GreaterThan:return Ot.GreaterThan;case Mn.GreaterThanOrEqualTo:return Ot.GreaterThanOrEqualTo;case Mn.LessThan:return Ot.LessThan;case Mn.LessThanOrEqualTo:return Ot.LessThanOrEqualTo;default:return Ot.EqualTo}}static getFormatedDate(e){return e.toString("MM/dd/yyyy")}static getVariableSpecifiedAsValue(e){var t;return On.getVariableSpecifiedAsExpression(e,null==(t=e.getValueMeter())?void 0:t.expression)}static isVariableSpecifiedAsValue(e){var t;return On.isVariableSpecifiedAsExpression(e,null==(t=e.getValueMeter())?void 0:t.expression)}static getDefaultValue(t){let e,i=null==(e=this.getVariableSpecifiedAsValue(t))?void 0:e.as(Js);if(null!=i){let e=t.report.dictionary.getVariableValueByName(i.name);if(i.initBy!=kn.Expression||H.isNullOrEmpty(e)||(e=En.parseTextValue(`{${e}}`,t)),i.type==F||i.type==Nn)return O.tryToDateTime(e);if(i.type==Dn||i.type==Vn)return e[P.System.StiObject.stimulsoft]().is(Dn)?e:new Dn}return F.now}},R.W.StiElementEditorConsts=class{constructor(){this.elementEditor="Stimulsoft.Dashboard.Design.Components.StiElementEditor, Stimulsoft.Dashboard.Design, "+P.StiVersion.versionInfo,this.textFormatEditor="Stimulsoft.Report.Components.TextFormats.Design.StiTextFormatEditor, Stimulsoft.Report.Design, "+P.StiVersion.versionInfo}},R.W.StiElementLayoutConverter=class{},R.W.StiElementStyleConverter=class{},R.W.StiMeterListConverter=class{},R.W.StiTitleConverter=class{},P.Report.StiAbbreviationNumberFormatHelper),Bn=(R.i.StiElementBuilder=class{getSeriesKeysLimitCount(e){let t=null;return t=e.isDesigning?100:t}getSeries(e,t,i,r,s=!1){if(null==e||-1==t)return null;let l=e.rows.whereFirstOrDefaultArrayItemStringEqualsTo(t,i),n=null!=l&&0<l.length?l[t]:null;if(null!=n&&n instanceof F)return n.toShortDateString();if(s&&null!=n){if("number"==typeof n)return Ln.format(n,null==r?void 0:r.culture);if("string"==typeof n){let e=Gt.tryParse(n);if(e.successfully)return Ln.format(e.result,null==r?void 0:r.culture)}}return this.toString(n)}getValue(t,i,e,r,s,l=!1){if(null==t||-1==i)return 0;if(r<2){if(l){let e=t.rows.getArrayItem(i).firstOrDefaultAsNullableDateTime();if(null!=e)return e.ticks;return 0}return t.rows.getArrayItem(i).firstOrDefaultAsNumber()}let n=t.rows.whereFirstOrDefaultArrayItemStringEqualsTo(e,s);if(null!=n&&0<n.length){if(l)return O.tryToDateTime(n[i]).ticks;return O.tryToNumber(n[i])}return 0}getTarget(t,i,e,r,s,l=!1){if(null==t||-1==i)return null;if(r<2){if(l){let e=t.rows.getArrayItem(i).firstOrDefaultAsNullableDateTime();if(null!=e)return e.ticks;return null}return t.rows.getArrayItem(i).firstOrDefaultAsNumber()}let n=t.rows.whereFirstOrDefaultArrayItemStringEqualsTo(e,s);if(null!=n&&0<n.length){if(l)return O.tryToDateTime(n[i]).ticks;return O.tryToNumber(n[i])}return 0}getNullableTarget(t,i,e,r,s,l=!1){if(null==t||-1==i)return null;if(r<2){if(l){let e=t.rows.getArrayItem(i).firstOrDefaultAsNullableDateTime();if(null!=e)return e.ticks;return 0}return t.rows.getArrayItem(i).firstOrDefaultAsNullableNumber()}let n=t.rows.whereFirstOrDefaultArrayItemStringEqualsTo(e,s);if(null!=n&&0<n.length){if(l){if(l)return O.tryToDateTime(n[i]).ticks;return 0}return O.tryToNumber(n[i])}return null}getNullableValue(e,t,i,r,s){if(null==e||-1==t)return null;if(r<2)return e.rows.getArrayItem(t).firstOrDefaultAsNullableNumber();let l=e.rows.whereFirstOrDefaultArrayItemStringEqualsTo(i,s);return null!=l&&0<l.length?O.tryToNullableNumber(l[t]):null}getSeriesKeyValues(e,t,i){if(null==e||-1==t)return new j([""]);let r=null!=i?e.rows.getArrayItem(t).distinct().select(this.replaceDbNull).where(e=>null!=e).take(i):e.rows.getArrayItem(t).distinct().select(this.replaceDbNull).where(e=>null!=e);return r.any()?r:new j([""])}getSeriesKeys(e,t,i){let r=this.getSeriesKeyValues(e,t,i);return null==r?new j([""]):r.select(this.toString)}replaceDbNull(e){return e}toString(e){return null==e?"":e.toString()}toReadableString(e,t){let i=null==t?void 0:t.getParsedCulture();if(nr.isEligable(e,i))return nr.convert(e,i);return this.toString(e)}},P.Base.Meters.IStiMinGaugeMeter),Pn=(R.T.StiMinGaugeMeter=class extends R.e.StiMeasureMeter{implements(){let e=super.implements().concat([Bn]);return(this.implements=()=>e)()}get localizedName(){return"Min"}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.MinGaugeMeter}},P.Base.Meters.IStiMaxGaugeMeter),Hn=(R.T.StiMaxGaugeMeter=class extends R.e.StiMeasureMeter{implements(){let e=super.implements().concat([Pn]);return(this.implements=()=>e)()}get localizedName(){return"Max"}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.MaxGaugeMeter}},R.s.StiGaugeIteration=class{},P.Base.Drawing.StiFontUtils),jn=P.Report.Components.Gauge.StiLinearTickLabelCustom,zn=P.Report.Components.Gauge.StiRadialTickLabelCustom,Xn=P.Report.Dashboard.Helpers.StiDashboardExpressionHelper,Gn=P.Report.Gauge.StiLabelRotationMode,Jn=P.Report.Components.Gauge.Primitives.StiIndicatorBase,Wn=P.Report.Components.Gauge.StiRadialRange,Un=P.Report.Components.Gauge.StiRadialRangeList,Zn=P.Report.Components.Gauge.StiLinearMarker,Yn=P.Report.Components.Gauge.StiLinearTickMarkMajor,Kn=P.Report.Components.Gauge.StiLinearTickLabelMajor,Qn=P.Report.Gauge.StiRadiusMode,qn=P.System.Drawing.Point,_n=P.Report.Components.Gauge.StiNeedle,$n=P.Report.Components.Gauge.StiRadialBar,ea=P.Report.Gauge.StiTickMarkSkin,ta=P.Report.Gauge.StiGaugeType,ia=P.Report.Components.StiGauge,ra=P.Report.Gauge.StiPlacement,sa=P.Report.Components.Gauge.StiLinearRange,la=P.Report.Components.Gauge.StiLinearRangeList,na=P.Report.Gauge.StiGaugeRangeMode,aa=P.Report.Components.Gauge.StiLinearScale,oa=P.Report.Gauge.StiGaugeRangeType,ua=P.Report.Gauge.StiGaugeCalculationMode,ha=R.T.StiMinGaugeMeter,ma=R.T.StiMaxGaugeMeter,ca=P.Report.Components.Gauge.StiRadialTickLabelMajor,da=P.Report.Components.Gauge.StiRadialTickMarkMajor,ga=P.Report.Components.Gauge.StiRadialScale,pa=P.Data.Exceptions.StiTypeNotRecognizedException,U=P.Report.Dashboard.Styles.StiDashboardStyleHelper,Sa=R.s.StiGaugeIteration,wa=P.Report.Gauge.StiMarkerSkin,fa=P.Report.Components.Gauge.StiLinearTickMarkCustom,ba=P.Report.Components.Gauge.StiLinearBar,ya=P.Report.Components.Gauge.StiRadialTickMarkCustom,Ca=P.Report.Dashboard.StiLabelPlacement;{class Ra extends R.i.StiElementBuilder{findMinMaxValues(t,i,r,s,c,d,g,p,S,w,f,e,l){let b,y,C,x,v=!1;for(let e of r){let l=this.getValue(s,d,g,p,this.toString(e),c),n=this.getTarget(s,S,g,p,this.toString(e),c),a=0,o=0;if(c){let e=new F(l);if(0==l&&(e=F.now),null!=n){let e=Math.min(l,Gt.getValueOrDefault(n)),t=Math.max(l,Gt.getValueOrDefault(n)),i=.4*(t-e);a=new F(e).addTicks(-i).ticks,o=new F(t).addTicks(i).ticks}else a=e.addMonths(-1).ticks,o=e.addMonths(1).ticks}else l==w&&l==f&&(o=0==l?(a=-50,50):(a=l-l,l+l));let u=5;switch(t.type){case ta.FullCircular:case ta.HalfCircular:{let e=Math.min(i.width,i.height);u=e<330?2:e<450?5:e<650?7:10}break;case ta.Linear:{let e=i.height;u=e<330?2:e<450?5:e<650?7:10}break;case ta.HorizontalLinear:{let e=i.width;u=e<330?2:e<500?5:e<650?8:10}break;case ta.Bullet:{let e=i.width;u=e<330?2:5}break}let h=0,m=0;if(t.calculationMode==ua.Auto){l<0&&(v=!0);let t=this.getSummary(l,a,o,c);if(l<=a&&(a=Math.round(l-.3*t)),l>=o&&(o=Math.round(l+.3*t)),null!=n){let e=n;e<a&&(a=Math.round(e-.3*t)),e>o&&(o=Math.round(e+.3*t))}if(h=a,m=o,-1<l&&l<1){(null==C||h<C)&&(C=h),(null==x||m>x)&&(x=m);continue}let e=h%5,i=(0!=e&&(h-=e),m-h),r=i/u,s=(0<r-r&&(r+=1),r%5);0!=s&&(r+=5-s),i=r*u,m=h+i}else m=t.dateTimeMode?(h=null==(b=t.minimumDateTime)?void 0:b.ticks,null==(y=t.maximumDateTime)?void 0:y.ticks):(h=t.getMinimumValue(),t.getMaximumValue());(null==C||h<C)&&(C=h),(null==x||m>x)&&(x=m)}e.ref=C,l.ref=x,e.ref<0&&t.calculationMode==ua.Auto&&!v&&(e.ref=0)}async render(e,t,i){return this.render2(e,t,i)()}render2(C,x,v){this.storedCulture=ar.set(C.report);try{let d=this.getValueMeterIndex(v),g=this.getSeriesMeterIndex(v),p=this.getTargetMeterIndex(v),e=this.getMinMeterIndex(v),t=this.getMaxMeterIndex(v),i=this.getSeriesKeyValues(v,g,this.getSeriesKeysLimitCount(C)),S=i.count2(),w=C.dateTimeMode,r=this.getMinValue(C,w,v,e),s=this.getMaxValue(C,w,v,t),f={ref:null},l={ref:null},b=(this.findMinMaxValues(C,x,i,v,w,d,g,S,p,r,s,f,l),f.ref),y=l.ref;return async()=>i.selectAsync(async e=>{let t=this.getValue(v,d,g,S,this.toString(e),w),i=this.getNullableTarget(v,p,g,S,this.toString(e),w),r={ref:null},s={ref:null},l={ref:null},n=(this.fundActualValues(C,x,w,t,b,y,r,s,l),r.ref),a=f.ref,o=l.ref,u=await this.createScale(C,w,o,x,b,y,i),h=(u.seriesKey=e,u.items.toList().where(e=>e.is(Jn)).cast());for(let e of h)e.valueObj=t;if(u.minimum=b,u.maximum=y,u.majorInterval=n,u.minorInterval=a,C.type==ta.Linear||C.type==ta.HorizontalLinear||C.type==ta.Bullet){let e=u.items.toList().where(e=>e.is(la)).cast().firstOrDefault();null!=e&&1==e.ranges.length&&(e.ranges.getByIndex(0).startValue=u.minimum,e.ranges.getByIndex(0).endValue=u.maximum)}let m=new ia(C.clientRectangle),c=(m.allowApplyStyle=!0,m.shortValue=C.shortValue,m.previousAnimations=C.previousAnimations,Ra.setStyle(C,m),m.scales.add(u),m.applyStyle(m.style),new Sa);return c.gauge=m,c.value=t,c.series=this.getSeries(v,g,e,C.report,C.shortValue),c},this)}finally{R.h.StiCultureHelper.restore(this.storedCulture)}}fundActualValues(e,t,i,r,s,l,n,a,o){let u=n.ref,h=a.ref,m=o.ref,c=5;switch(m=!1,e.type){case ta.FullCircular:case ta.HalfCircular:{let e=Math.min(t.width,t.height);e<330?(c=2,m=!0):c=e<450?5:e<650?7:10}break;case ta.Linear:{let e=t.height;e<330?(c=2,m=!0):c=e<450?5:e<650?7:10}break;case ta.HorizontalLinear:{let e=t.width;e<330?(c=2,m=!0):c=e<500?5:e<650?8:10}break;case ta.Bullet:{let e=t.width;e<330?(c=2,m=!0):c=5}break}if(e.calculationMode!=ua.Auto)return 0==(u=Math.abs(Math.round((l-s)/c)))&&(u=1),h=u/2,n.ref=u,a.ref=h,void(o.ref=m);{let e=this.getSummary(r,s,l,i);u=Math.abs(Math.round(e/c)),h=u/2,n.ref=u,a.ref=h}if(-1<r&&r<1)return;let d=l-s,g=d/c,p=(0<g-g&&(g+=1),g%5);0!=p&&(g+=5-p),d=g*c,u=Math.abs(d/c),h=u/2,n.ref=u,a.ref=h,o.ref=m}getSummary(i,r,s,e){if(e){let e=s-r;return e=0==e?new F(1,1,1).ticks:e}{let e=Math.round(s-r),t=Math.max(i,e);return t=Math.max(t,r),t=0==(t=Math.max(t,s))?100:t}}static setStyle(e,t){if(e.style!=o.Custom)return void(t.style=U.getGaugeStyle(e));let i=e.report.styles.getCustomGaugeStyle(e.customStyleName);if(null!=i)return t.style=i,t.customStyleName=e.customStyleName,t.brush=new E(U.getBackColor(e)),void(t.allowApplyStyle=!1);t.style=U.getGaugeStyle2(o.Blue)}static getTargetBrush(e){if(e.style!=o.Custom)return new E(U.getGaugeStyle(e).core.targetColor);let t=e.report.styles.getCustomGaugeStyle(e.customStyleName);if(null!=t&&null!=t.core)return new E(t.core.targetColor);return new E(U.getGaugeStyle2(o.Blue).core.targetColor)}static getTickMarkBrush(e){if(e.style!=o.Custom)return U.getGaugeStyle(e).core.tickMarkMajorBrush;let t=e.report.styles.getCustomGaugeStyle(e.customStyleName);if(null!=t&&null!=t.core)return t.core.tickMarkMajorBrush;return U.getGaugeStyle2(o.Blue).core.tickMarkMajorBrush}static getTickLabelBrush(e){if(e.style!=o.Custom)return U.getGaugeStyle(e).core.tickLabelMajorTextBrush;let t=e.report.styles.getCustomGaugeStyle(e.customStyleName);if(null!=t&&null!=t.core)return t.core.tickLabelMajorTextBrush;return U.getGaugeStyle2(o.Blue).core.tickLabelMajorTextBrush}async createScale(e,t,i,r,s,l,n=null){switch(e.type){case ta.FullCircular:return this.createFullCircularScale(e,t,i,r,s,l,n);case ta.HalfCircular:return this.createHalfCircularScale(e,t,i,r,s,l,n);case ta.Linear:return this.createLinearScale(e,t,s,l,!1,n);case ta.HorizontalLinear:return this.createLinearScale(e,t,s,l,!0,n);case ta.Bullet:return this.createBullet(e,t,s,l,n);default:throw new pa(e.type)}}static calculateMinorInterval(e,t){if(e<0&&t<0)return Math.abs((e-t)/5);if(e<0)return(t+Math.abs(e))/5;return(t-e)/5}async createFullCircularScale(t,e,i,r,s,l,n=null){let a=Math.min(r.width,r.height),o=a<150,u=a<75,h=new ga,m=(h.dateTimeMode=e,h.allowApplyStyle=!1,h.radius=!t.labels.visible||t.labels.placement==Ca.Inside?.8:.63,h.startAngle=120,h.sweepAngle=300,h.startWidth=.05,h.endWidth=.05,h.minimum=0,h.maximum=180,h.majorInterval=Ra.calculateMinorInterval(s,l),h.borderBrush=new $e,h.brush=new $e,await Ra.addRadialRanges(t,s,l,h)),c=new $n,d=(c.startWidth=.1,c.endWidth=.1,c.offset=.1,c.placement=ra.Outside,c.valueObj=90,h.items.add(c),new _n);if(d.relativeHeight=.3,d.relativeWidth=.4,d.startWidth=.1,d.endWidth=1,d.capBrush=new $e,d.brush=new $e,d.valueObj=90,h.items.add(d),t.labels.visible&&!u){let e=new da;e.relativeWidth=.03,e.relativeHeight=.006,e.skin=ea.Rectangle,e.brush=Ra.getTickMarkBrush(t),t.labels.placement==Ca.Inside?(e.placement=ra.Inside,e.offset=m?0:-.1):(e.placement=ra.Outside,e.offset=.2),h.items.add(e)}if(t.labels.visible&&!o){let e=new ca;e.allowApplyStyle=!1,e.textBrush=Ra.getTickLabelBrush(t),e.labelRotationMode=i?Gn.None:t.labels.rotationMode,e.formatService=t.valueFormat,null!=n&&(e.skipValuesObj=[Gt.getValueOrDefault(n)]),u&&(e.font=Ra.getSmallElementFont(t)),t.labels.placement==Ca.Inside?(e.placement=ra.Inside,e.offset=m?.07:-.03):(e.placement=ra.Outside,e.offset=.27),h.items.add(e)}if(null!=n){let e=new ya;if(e.placement=ra.Overlay,e.offset=-.15,e.relativeWidth=.1,e.relativeHeight=.02,e.borderWidth=0,e.brush=Ra.getTargetBrush(t),e.valueObj=n[P.System.StiObject.stimulsoft]().toNumber(),h.items.add(e),t.targetSettings.showLabel){let e=new zn;switch(e.allowApplyStyle=!1,e.formatService=t.valueFormat,e.textBrush=Ra.getTargetBrush(t),e.labelRotationMode=i?Gn.None:t.labels.rotationMode,e.placement=t.targetSettings.placement,e.valueObj=Gt.getValueOrDefault(n),e.textObj=Gt.getValueOrDefault(n).toString(),e.font=Ra.getSmallElementFont(t),t.targetSettings.placement){case ra.Overlay:e.offset=-.12;break;case ra.Outside:e.offset=.18;break}h.items.add(e)}}return h}async createHalfCircularScale(t,e,i,r,s,l,n=null){let a=Math.min(r.width,r.height),o=a<150,u=a<75,h=new ga,m=(h.dateTimeMode=e,h.startAngle=180,h.sweepAngle=180,h.startWidth=.05,h.endWidth=.05,h.minimum=0,h.maximum=180,h.radius=.92,h.majorInterval=Ra.calculateMinorInterval(s,l),h.center=new qn(.5,.7),h.radiusMode=Qn.Auto,h.brush=new E(N.fromArgb2(238,238,238)),new $n);if(m.startWidth=.05,m.endWidth=.05,m.offset=.1,m.valueObj=135,m.placement=ra.Overlay,m.brush=new E(N.red),h.items.add(m),await Ra.addRadialRanges(t,s,l,h),t.labels.visible){if(!u){let e=new da;e.offset=.05,e.relativeWidth=.03,e.relativeHeight=.006,e.skin=ea.Rectangle,e.brush=Ra.getTickMarkBrush(t),t.labels.placement==Ca.Inside?e.placement=ra.Inside:e.placement=ra.Outside,h.items.add(e)}if(!o){let e=new ca;e.allowApplyStyle=!1,e.textBrush=Ra.getTickLabelBrush(t),e.labelRotationMode=i?Gn.None:t.labels.rotationMode,e.formatService=t.valueFormat,e.font=Ra.getSmallElementFont(t),null!=n&&(e.skipValuesObj=[Gt.getValueOrDefault(n)]),t.labels.placement==Ca.Inside?(e.placement=ra.Inside,e.offset=.12):(e.placement=ra.Outside,e.offset=.1),h.items.add(e)}}if(null!=n){let e=new ya;if(e.placement=ra.Overlay,e.relativeWidth=.1,e.relativeHeight=.02,e.borderWidth=0,e.brush=Ra.getTargetBrush(t),e.valueObj=n[P.System.StiObject.stimulsoft]().toNumber(),h.items.add(e),t.targetSettings.showLabel){let e=new zn;switch(e.allowApplyStyle=!1,e.formatService=t.valueFormat,e.textBrush=Ra.getTargetBrush(t),e.labelRotationMode=i?Gn.None:t.labels.rotationMode,e.placement=t.targetSettings.placement,e.valueObj=Gt.getValueOrDefault(n),e.textObj=Gt.getValueOrDefault(n).toString(),t.targetSettings.placement){case ra.Inside:e.offset=.12;break;case ra.Outside:e.offset=.05;break}h.items.add(e)}}let c=new _n;return c.relativeHeight=.05,c.relativeWidth=.4,c.startWidth=.1,c.endWidth=.2,c.capBrush=new E(N.white),c.capBorderBrush=new E(N.fromArgb2(0,150,136)),c.capBorderWidth=2,c.brush=new E(N.fromArgb2(0,150,136)),c.borderWidth=0,c.textBrush=new E(N.fromArgb2(0,150,136)),c.valueObj=135,h.items.add(c),h}async createLinearScale(r,e,t,i,s,l){let n=U.getGaugeStyle(r),a=new aa;if(a.dateTimeMode=e,a.relativeHeight=s?.9:.92,a.orientation=s?P.System.Drawing.Orientation.Horizontal:P.System.Drawing.Orientation.Vertical,a.startWidth=.1,a.endWidth=.1,a.maximum=100,a.majorInterval=Ra.calculateMinorInterval(t,i),a.borderBrush=new $e,a.brush=n.core.linearScaleBrush,r.labels.visible){let e=new Kn,t=(e.formatService=r.valueFormat,e.font=Ra.getSmallElementFont(r),e.allowApplyStyle=!1,e.textBrush=Ra.getTickLabelBrush(r),null!=l&&(e.skipValuesObj=[Gt.getValueOrDefault(l)]),Xn.getForeColor(r,r.foreColor)),i=(N.transparent.equals(t)||(e.allowApplyStyle=!1,e.textBrush=new E(t)),new Yn);i.relativeHeight=s?.03:.003,i.relativeWidth=s?.003:.03,i.borderBrush=new $e,i.borderWidth=0,i.brush=Ra.getTickMarkBrush(r),r.labels.placement==Ca.Inside?(i.placement=ra.Inside,e.placement=ra.Inside):(i.placement=ra.Outside,e.placement=ra.Outside),e.offset=.04,a.items.add(e),a.items.add(i)}if(await Ra.addLinearRanges(r,t,i,a),null!=l){let e=new fa;if(e.placement=ra.Overlay,e.relativeWidth=s?.012:.1,e.relativeHeight=s?.1:.012,e.borderWidth=0,e.brush=Ra.getTargetBrush(r),e.valueObj=null!=l?l[P.System.StiObject.stimulsoft]().toNumber():0,a.items.add(e),r.targetSettings.showLabel){let e=new jn;e.allowApplyStyle=!1,e.formatService=r.valueFormat,e.textBrush=Ra.getTargetBrush(r),e.placement=r.targetSettings.placement,e.offset=.04,e.valueObj=Gt.getValueOrDefault(l),e.textObj=Gt.getValueOrDefault(l).toString(),a.items.add(e)}}let o=new Zn;return o.skin=s?wa.TriangleBottom:wa.TriangleRight,o.relativeWidth=s?.04:.1,o.relativeHeight=s?.1:.04,o.placement=ra.Overlay,o.valueObj=60,o.brush=new E(N.fromArgb2(205,220,57)),a.items.add(o),a}static async addRadialRanges(a,o,u,e){if(0<a.ranges.length&&a.rangeType==oa.Color){let n=new Un;if(a.rangeMode==na.Percentage)for(let l of a.ranges){let e=O.parseNumber(await k.parseAsync(l.startExpression,a)),t=O.parseNumber(await k.parseAsync(l.endExpression,a)),i=o+(u-o)/100*e,r=o+(u-o)/100*t,s=new Wn;s.placement=ra.Overlay,s.startValue=i,s.endValue=r,s.startWidth=.05,s.endWidth=.05,s.borderBrush=new $e,s.brush=new E(l.color),n.ranges.add(s)}else for(let r of a.ranges){let e=O.parseNumber(await k.parseAsync(r.startExpression,a)),t=O.parseNumber(await k.parseAsync(r.endExpression,a)),i=new Wn;i.placement=ra.Overlay,i.startValue=e,i.endValue=t,i.startWidth=.05,i.endWidth=.05,i.borderBrush=new $e,i.brush=new E(r.color),n.ranges.add(i)}return e.items.add(n),0<n.ranges.length}return!1}async createBullet(i,e,t,r,s=null){let l=new aa;if(l.dateTimeMode=e,l.orientation=P.System.Drawing.Orientation.Horizontal,l.relativeHeight=.85,l.startWidth=.01,l.endWidth=.01,l.maximum=100,l.majorInterval=Ra.calculateMinorInterval(t,r),l.borderBrush=new $e,l.brush=new $e,await Ra.addLinearRanges(i,t,r,l),i.labels.visible){let e=new Kn,t=(e.formatService=i.valueFormat,e.textBrush=Ra.getTickLabelBrush(i),e.font=Ra.getSmallElementFont(i),null!=s&&(e.skipValuesObj=[Gt.getValueOrDefault(s)]),new Yn);t.relativeHeight=.03,t.relativeWidth=.003,t.borderBrush=new $e,t.borderWidth=0,t.brush=Ra.getTickMarkBrush(i),i.labels.placement==Ca.Inside?(e.placement=ra.Inside,e.offset=.2,t.placement=ra.Inside):(e.placement=ra.Outside,e.offset=.2,t.placement=ra.Outside),t.offset=.15,l.items.add(t),l.items.add(e)}if(null!=s){let e=new fa;if(e.placement=ra.Overlay,e.relativeWidth=.008,e.relativeHeight=.1,e.borderWidth=0,e.brush=Ra.getTargetBrush(i),e.valueObj=s[P.System.StiObject.stimulsoft]().toNumber(),l.items.add(e),i.targetSettings.showLabel){let e=new jn;e.allowApplyStyle=!1,e.formatService=i.valueFormat,e.textBrush=Ra.getTargetBrush(i),e.placement=i.targetSettings.placement,e.offset=.25,e.valueObj=Gt.getValueOrDefault(s),e.textObj=Gt.getValueOrDefault(s).toString(),l.items.add(e)}}let n=new ba;return n.valueObj=60,n.startWidth=.15,n.endWidth=.15,n.brush=new E(N.fromArgb2(205,220,57)),l.items.add(n),l}static async addLinearRanges(o,u,h,e,m=!1){if(0<o.ranges.length&&o.rangeType==oa.Color){let n=new la,a=o.type==ta.Bullet?.3:.05;if(o.rangeMode==na.Percentage)for(let l of o.ranges){let e=O.parseNumber(await k.parseAsync(l.startExpression,o)),t=O.parseNumber(await k.parseAsync(l.endExpression,o)),i=u+(h-u)/100*e,r=u+(h-u)/100*t,s=new sa;s.placement=ra.Overlay,s.startValue=i,s.endValue=r,s.startWidth=a,s.endWidth=a,s.borderBrush=new $e,s.brush=new E(l.color),m&&(s.borderBrush=new E(N.fromArgb(150,139,138,135))),n.ranges.add(s)}else for(let r of o.ranges){let e=O.parseNumber(await k.parseAsync(r.startExpression,o)),t=O.parseNumber(await k.parseAsync(r.endExpression,o)),i=new sa;i.placement=ra.Overlay,i.startValue=e,i.endValue=t,i.startWidth=a,i.endWidth=a,i.borderBrush=new $e,i.brush=new E(r.color),m&&(i.borderBrush=new E(N.fromArgb(150,139,138,135))),n.ranges.add(i)}e.items.add(n)}}getMinValue(t,e,i,r){if(-1==r)return e?t.minimumDateTime.ticks:t.getMinimumValue();if(e){let e;return null==(e=t.calculationMode==ua.Auto?i.rows.getArrayItem(r).firstOrDefaultAsNullableDateTime():t.minimumDateTime)?t.minimumDateTime.ticks:null==e?void 0:e.ticks}{let e=t.calculationMode==ua.Auto?i.rows.getArrayItem(r).firstOrDefaultAsNullableNumber():t.getMinimumValue();return null!=e?e:t.getMinimumValue()}}getMaxValue(t,e,i,r){if(-1==r)return e?t.maximumDateTime.ticks:t.getMaximumValue();if(e){let e;return null==(e=t.calculationMode==ua.Auto?i.rows.getArrayItem(r).firstOrDefaultAsNullableDateTime():t.maximumDateTime)?t.maximumDateTime.ticks:null==e?void 0:e.ticks}{let e=t.calculationMode==ua.Auto?i.rows.getArrayItem(r).firstOrDefaultAsNullableNumber():t.getMaximumValue();return null!=e?e:t.getMaximumValue()}}getValueMeterIndex(e){if(null==e)return-1;let t=e.meters.firstOrDefault(e=>e.is(Is));return null!=t?e.meters.indexOf(t):-1}getMinMeterIndex(e){if(null==e)return-1;let t=e.meters.firstOrDefault(e=>e.is(ha));return null!=t?e.meters.indexOf(t):-1}getMaxMeterIndex(e){if(null==e)return-1;let t=e.meters.firstOrDefault(e=>e.is(ma));return null!=t?e.meters.indexOf(t):-1}getSeriesMeterIndex(e){if(null==e)return-1;let t=e.meters.firstOrDefault(e=>e.is(Ds));return null!=t?e.meters.indexOf(t):-1}getTargetMeterIndex(e){if(null==e)return-1;let t=e.meters.firstOrDefault(e=>e.is(Rs));return null!=t?e.meters.indexOf(t):-1}static getSmallElementFont(e){let t=U.getElementFontFromStyle(e);if(null==t)return e.font;let i=U.getElementFontFromStyle(e),r=8*i.size/13,s=e.cachedSmallFont;if(null!=s&&s.name==i.name&&s.style==i.style&&s.size==r)return s;return e.cachedSmallFont=Hn.changeFontSize(i,r),e.cachedSmallFont}}R.i.StiGaugeElementBuilder=Ra}let xa=P.Report.Dashboard.ImplementsIStiGaugeRange,va=P.Report.Dashboard.IStiGaugeRange;{class Da{implements(){let e=[n,va,...xa,Rt];return(this.implements=()=>e)()}clone(){return this[P.System.StiObject.stimulsoft]().memberwiseClone()}meta(){return[new i("Color","",N.red),new l("StartExpression"),new l("EndExpression")]}saveToJsonObject(e){return u.saveToJsonObject(e,this)}loadFromJsonObject(e){u.loadFromJsonObject(e,this)}loadFromXml(e){u.loadFromXml(e,this)}get start(){return O.tryToNumber(this.startExpression)}set start(e){this.currentCulture=sr.currentCulture;try{sr.currentCulture=sr.cultures["en-US"],this.startExpression=e.toString()}finally{sr.currentCulture=this.currentCulture}}get end(){return O.tryToNumber(this.endExpression)}set end(e){this.currentCulture=sr.currentCulture;try{sr.currentCulture=sr.cultures["en-US"],this.endExpression=e.toString()}finally{sr.currentCulture=this.currentCulture}}static loadFromJson(e){let t=new Da;return t.loadFromJsonObject(e),t}static loadFromXml(e){let t=new Da;return t.loadFromXml(e),t}saveToString(){return this.saveToJsonObject(Le.Report).serialize()}getStringRepresentation(){return this.start+` - `+this.end}constructor(e,t,i){this.color=N.red,this.startExpression="0",this.endExpression="100",null!=e&&(this.color=e),null!=t&&(this.startExpression=t),null!=i&&(this.endExpression=i)}}R.T.StiGaugeRange=Da}R.g.StiGaugeDashboardInteraction=class extends R.g.StiDashboardInteraction{implements(){let e=super.implements().concat([Il,n,Ws]);return(this.implements=()=>e)()}meta(){return[...super.meta(),new h("AllowUserSorting","",!0),new h("AllowUserDrillDown"),new h("ShowFullScreenButton","",!0),new h("ShowSaveButton","",!0),new h("ShowViewDataButton","",!0),new l("FileName"),new l("HeaderText"),new l("FooterText")]}get isDefaultLayout(){return this.showFullScreenButton&&this.showSaveButton&&this.showViewDataButton&&null==this.fileName&&null==this.headerText&&null==this.footerText}isDefault(){return this.isDefaultLayout&&this.hyperlinkDestination==gi.NewTab&&H.isNullOrEmpty(this.hyperlink)&&H.isNullOrEmpty(this.drillDownPageKey)&&null!=this.drillDownParameters&&0==this.drillDownParameters.length&&H.isNullOrEmpty(this.toolTip)&&!this.allowUserDrillDown&&this.allowUserSorting}constructor(e,t,i,r,s,l,n){super(),this.ident=pi.Gauge,this.availableOnClick=Si.None,this.availableOnHover=wi.None,this.availableOnDataManipulation=fi.AllowSorting,this.allowUserSorting=!0,this.allowUserDrillDown=!1,this.showFullScreenButton=!0,this.showSaveButton=!0,this.showViewDataButton=!0,this.fileName=null,this.headerText=null,this.footerText=null,null!=e&&(this.fileName=e),null!=t&&(this.headerText=t),null!=i&&(this.footerText=i),null!=r&&(this.showFullScreenButton=r),null!=s&&(this.showSaveButton=s),null!=l&&(this.allowUserSorting=l),null!=n&&(this.showViewDataButton=n)}};let Fa=P.Report.Dashboard.IStiGaugeLabels,Ta=(R.T.StiGaugeLabels=class{implements(){let e=[Fa,n];return(this.implements=()=>e)()}meta(){return[new h("Visible","",!0),new r("Placement","",Ca,Ca.Inside),new r("RotationMode","",Gn,Gn.Automatic)]}saveToJsonObject(e){return u.saveToJsonObject(e,this)}loadFromJsonObject(e){u.loadFromJsonObject(e,this)}loadFromXml(e){u.loadFromXml(e,this)}clone(){return this[P.System.StiObject.stimulsoft]().memberwiseClone()}constructor(e,t,i){this.visible=!0,this.placement=Ca.Inside,this.rotationMode=Gn.Automatic,null!=e&&(this.visible=e),null!=t&&(this.placement=t),null!=i&&(this.rotationMode=i)}},P.Report.Dashboard.IStiGaugeTarget),Ma=(R.T.StiGaugeTarget=class{implements(){let e=[Ta,n];return(this.implements=()=>e)()}meta(){return[new h("ShowLabel","",!0),new r("Placement","",ra,ra.Inside)]}saveToJsonObject(e){return u.saveToJsonObject(e,this)}loadFromJsonObject(e){u.loadFromJsonObject(e,this)}loadFromXml(e){u.loadFromXml(e,this)}clone(){return this[P.System.StiObject.stimulsoft]().memberwiseClone()}constructor(e,t){this.showLabel=!0,this.placement=ra.Inside,null!=e&&(this.showLabel=e),null!=t&&(this.placement=t)}},R.T.StiGaugeTarget),Aa=R.g.StiGaugeDashboardInteraction,Da=R.T.StiGaugeRange,Ia=P.Report.Dashboard.ImplementsIStiGaugeElement,Ra=R.i.StiGaugeElementBuilder,Ea=P.Report.Dashboard.IStiGaugeElement,ka=R.T.StiGaugeLabels,Oa=P.Report.Components.IStiNumberFormat;{ht.add("StiGaugeElement","Stimulsoft.Dashboard.Export.Tools.StiGaugeElementExportTool");class Km extends R.e.StiElement{implements(){let e=super.implements().concat([Ea,Ue,Je,Ie,ri,Ai,el,Ci,ke,...Ia,...Ze,...Ge,...il,..._t,...Fi,...$s,n,Us,Oa]);return(this.implements=()=>e)()}clone(e){let t,i,r,s,l=super.clone(e);return l.value=null!=this.value?this.value.clone():null,l.series=null!=this.series?this.series.clone():null,l.target=null!=this.target?this.target.clone():null,l.valueFormat=null!=this.valueFormat?this.valueFormat.clone():null,l.userSorts=this.userSorts.select(e=>e.clone()).toList(),l.transformActions=this.transformActions.select(e=>e.clone()).toList(),l.transformFilters=this.transformFilters.select(e=>e.clone()).toList(),l.transformSorts=this.transformSorts.select(e=>e.clone()).toList(),l.dataFilters=this.dataFilters.select(e=>e.clone()).toList(),l.title=null!=this.title?this.title.clone():null,l.layout=null!=this.layout?this.layout.clone():null,l.dashboardInteraction=this.dashboardInteraction.clone(),l.labels=null==(t=this.labels)?void 0:t.clone(),l.targetSettings=null==(i=this.targetSettings)?void 0:i.clone(),l.shadow=null==(r=this.shadow)?void 0:r.clone(),l.cornerRadius=null==(s=this.cornerRadius)?void 0:s.clone(),l}meta(){return[...super.meta(),new s("UserSorts").get(e=>a.Serialize.objectArray(this.userSorts,e)).set(e=>this.userSorts.addRange(e.value.properties().select(e=>ll.loadFromJson(e.value)))).setXml(e=>this.userSorts.addRange(e.childNodes.map(e=>ll.loadFromXml(e)))),new s("TransformActions").get(e=>a.Serialize.objectArray(this.transformActions,e)).set(e=>this.transformActions.addRange(e.value.properties().select(e=>nl.loadFromJson(e.value)))).setXml(e=>this.transformActions.addRange(e.childNodes.map(e=>nl.loadFromXml(e)))),new s("TransformFilters").get(e=>a.Serialize.objectArray(this.transformFilters,e)).set(e=>this.transformFilters.addRange(e.value.properties().select(e=>y.loadFromJson(e.value)))).setXml(e=>this.transformFilters.addRange(e.childNodes.map(e=>y.loadFromXml(e)))),new s("TransformSorts").get(e=>a.Serialize.objectArray(this.transformSorts,e)).set(e=>this.transformSorts.addRange(e.value.properties().select(e=>ll.loadFromJson(e.value)))).setXml(e=>this.transformSorts.addRange(e.childNodes.map(e=>ll.loadFromXml(e)))),new s("DataFilters").get(e=>a.Serialize.objectArray(this.dataFilters,e)).set(e=>this.dataFilters.addRange(e.value.properties().select(e=>y.loadFromJson(e.value)))).setXml(e=>this.dataFilters.addRange(e.childNodes.map(e=>y.loadFromXml(e)))),new s("Ranges").get(e=>a.Serialize.objectArray(this.ranges,e)).set(e=>this.ranges.addRange(e.value.properties().select(e=>Da.loadFromJson(e.value)))).setXml(e=>this.ranges.addRange(e.childNodes.map(e=>Da.loadFromXml(e)))),new ie("Minimum","",0),new ie("Maximum","",100),new re("MinimumValue","","0"),new re("MaximumValue","","100"),new l("MinimumDateTime").get(()=>this.minimumDateTime.toString()).set(e=>this.minimumDateTime=Be.jsonDateFormatToDate(e.value)).setXml(e=>this.minimumDateTime=F.tryParse(e.textContent).result),new l("MaximumDateTime").get(()=>this.maximumDateTime.toString()).set(e=>this.maximumDateTime=Be.jsonDateFormatToDate(e.value)).setXml(e=>this.maximumDateTime=F.tryParse(e.textContent).result),new r("CalculationMode","",P.Report["Gauge"].StiGaugeCalculationMode,P.Report["Gauge"].StiGaugeCalculationMode.Auto),new r("RangeMode","",P.Report["Gauge"].StiGaugeRangeMode,P.Report["Gauge"].StiGaugeRangeMode.Percentage),new r("Type","",P.Report["Gauge"].StiGaugeType,P.Report["Gauge"].StiGaugeType.FullCircular),new r("RangeType","",P.Report["Gauge"].StiGaugeRangeType,P.Report["Gauge"].StiGaugeRangeType.None),new h("ShortValue","",!0),new h("CrossFiltering","",!0),new h("ShowBlanks"),new h("DateTimeMode"),new l("CornerRadius").get(()=>this.cornerRadius.toString()).set(e=>this.cornerRadius=v.tryParse(e.value.toString())).setXml(e=>this.cornerRadius=v.tryParse(e.textContent)),new s("Labels").check(()=>null!=this.labels),new s("TargetSettings").check(()=>null!=this.targetSettings),new s("Value").check(()=>null!=this.value).set(e=>{let t=d.loadFromJson(e.value).as(R.T.StiValueGaugeMeter);null!=t&&(this.value=t)}).setXml(e=>{let t=d.loadFromXml(e).as(R.T.StiValueGaugeMeter);null!=t&&(this.value=t)}),new s("Series").check(()=>null!=this.series).set(e=>{let t=d.loadFromJson(e.value).as(Ds);null!=t&&(this.series=t)}).setXml(e=>{let t=d.loadFromXml(e).as(Ds);null!=t&&(this.series=t)}),new s("Target").check(()=>null!=this.target).set(e=>{let t=d.loadFromJson(e.value).as(R.T.StiTargetGaugeMeter);null!=t&&(this.target=t)}).setXml(e=>{let t=d.loadFromXml(e).as(R.T.StiTargetGaugeMeter);null!=t&&(this.target=t)}),new s("Title").check(()=>null!=this.title).set(e=>this.title=_l.createFromJsonObject(e.value)).setXml(e=>this.title=_l.createFromXml(e)),new s("Layout").check(()=>null!=this.layout).set(e=>this.layout=tl.createFromJsonObject(e.value)).setXml(e=>this.layout=tl.createFromXml(e)),new i("ForeColor","",N.transparent),new l("Font").get(()=>a.Serialize.fontArial8(this.font)).set(e=>this.font=a.Deserialize.font(e.value,this.font)).setXml(e=>this.font=P.System.Convert.toFont(e.textContent)),new r("DataMode","",Nl,Nl.UsingDataFields),new l("ManuallyEnteredData"),new r("Style","",o,o.Auto),new l("Group"),new l("CustomStyleName"),new l("Shadow").get(()=>a.Serialize.jShadow(this.shadow)).set(e=>this.shadow=a.Deserialize.simpleSahdow(e.value)).setXml(e=>this.shadow=We.loadFromXml(e.textContent)),new s("ValueFormat").check(()=>null!=this.valueFormat).set(e=>this.valueFormat=Mi.createFromJsonObject(e.value)).setXml(e=>this.valueFormat=Mi.loadFormatFromXml(e,this.report)),new s("DashboardInteraction").check(()=>null!=this.dashboardInteraction.as(Aa)).set(e=>{let t,i=null==(t=bi.loadInteractionFromJsonObject(e.value))?void 0:t.as(Aa);null!=i&&(this.dashboardInteraction=i)}).setXml(e=>{let t,i=null==(t=bi.loadInteractionFromXml(e))?void 0:t.as(Aa);null!=i&&(this.dashboardInteraction=i)})]}addValue2(e){this.value=null!=e?c.Gauge.getValue2(e):null}addValue(e){this.value=c.Gauge.getValue(e.as(R.e.StiMeter))}removeValue(){this.value=null}getValue(){return this.value}getValue2(e){return null!=e?c.Gauge.getValue(e.as(R.e.StiMeter)):null}createNewValue(){this.value=new R.T.StiValueGaugeMeter,this.value.expression="Sum()"}addSeries2(e){this.series=null!=e?c.Gauge.getSeries2(e):null}addSeries(e){this.series=c.Gauge.getSeries(e.as(R.e.StiMeter))}removeSeries(){this.series=null}getSeries(){return this.series}getSeries2(e){return null!=e?c.Gauge.getSeries(e.as(R.e.StiMeter)):null}createNewSeries(){this.series=new Ds}addTarget2(e){this.target=null!=e?c.Gauge.getTarget2(e):null}addTarget(e){this.target=c.Gauge.getTarget(e.as(R.e.StiMeter))}removeTarget(){this.target=null}getTarget(){return this.target}getTarget2(e){return null!=e?c.Gauge.getTarget(e.as(R.e.StiMeter)):null}createNewTarget(){this.target=new R.T.StiTargetGaugeMeter}getRanges(){let e=new j;return e.addRange(this.ranges),e}getPreferedColor(){if(this.ranges.all(e=>!N.green.equals(e.color)))return N.green;if(this.ranges.all(e=>!N.yellow.equals(e.color)))return N.yellow;if(this.ranges.all(e=>!N.red.equals(e.color)))return N.red;return N.orange}addRange(){let e=new Da;return e.color=this.getPreferedColor(),this.ranges.add(e),e}removeRange(e){e<this.ranges.length&&this.ranges.removeAt(e)}createdDefaultRanges(){this.ranges.clear(),this.ranges.add(new Da(N.red,"0","33")),this.ranges.add(new Da(N.yellow,"33","66")),this.ranges.add(new Da(N.green,"66","100"))}getManuallyEnteredDataTable(){if(this.dataMode!=Nl.ManuallyEnteringData)return null;return R.e.StiManuallyEnteredDataParser.getGaugeDataTable(this.manuallyEnteredData,this.dateTimeMode,this)}async getGaugeComponent(e=null){let t=await yn.getOrCreate(this),i=(new Ra).render2(this,null!=e?e:this.clientRectangle.size,t),r=new P.Report.Components.StiGauge;return 1==(await i()).count2()&&((r=(await i()).firstOrDefault().gauge).report=this.report,r.page=this.page,r.name=this.name+`_Content`,r.clientRectangle=null!=e?new L(0,0,e.width,e.height):this.clientRectangle.clone(),r.brush=new E(this.backColor)),r}convertFrom(e){let t=e.fetchAllMeters();if(null==t)return;let i=t.firstOrDefault(e=>e.is(ji)),r=(null!=(i=null==i?i=t.firstOrDefault(e=>e.is(vt)):i)&&(this.value=null==this.value?new R.T.StiValueGaugeMeter:this.value,this.value.loadFromJsonObject(i.saveToJsonObject(Le.Report))),t.firstOrDefault(e=>e.is(Dr))),s=(null!=(r=null==r?t.firstOrDefault(e=>e.is(Pe)):r)&&(this.series=null==this.series?new Ds:this.series,this.series.loadFromJsonObject(r.saveToJsonObject(Le.Report))),t.firstOrDefault(e=>e.is(Ir)));null!=s&&(this.target=null==this.target?new R.T.StiTargetGaugeMeter:this.target,this.target.loadFromJsonObject(s.saveToJsonObject(Le.Report))),null==this.dashboardInteraction&&(this.dashboardInteraction=new Aa)}fetchAllMeters(){let e=new j;return this.dataMode==Nl.UsingDataFields&&(null!=this.value&&e.add(this.value),null!=this.series&&e.add(this.series),null!=this.target)&&e.add(this.target),e}getMeters(){let i=new j;if(this.dataMode==Nl.UsingDataFields){if(null!=this.value&&(this.value.key=de.getOrGeneratedKey(this.value.key),i.add(this.value),this.calculationMode==P.Report["Gauge"].StiGaugeCalculationMode.Auto)){let e=new R.T.StiMinGaugeMeter,t=(e.key=this.value.key,e.expression=Or.replaceFunction(this.value.expression,"Min"),i.add(e),new R.T.StiMaxGaugeMeter);t.key=this.value.key,t.expression=Or.replaceFunction(this.value.expression,"Max"),i.add(t)}null!=this.series&&i.add(this.series),null!=this.target&&i.add(this.target)}return i}retrieveUsedDataNames(){return this.dataMode==Nl.UsingDataFields?rl.getMany(this.value,this.series,this.target):null}get isDefined(){return null!=this.value||null!=this.series||null!=this.target||this.dataMode==Nl.ManuallyEnteringData}get style(){return this._style}set style(e){(this._style=e)!=o.Custom&&(this.customStyleName="")}setString(e,t){switch(e){case"Title.Text":this.title.text=t;break}}getString(e){switch(e){case"Title.Text":return this.title.text}throw new Error(`Property with name `+e)}getAllStrings(){return["Title.Text"]}get toolboxPosition(){return _e.GaugeElement}get localizedName(){return T.get("Components","StiGauge")}static getValueFormatDefault(){let e=new Wi;return e.decimalDigits=0,e.state=R.a.StiTextFormatState.DecimalDigits|R.a.StiTextFormatState.Abbreviation,e}get minimum(){return O.tryToNumber(this.minimumValue)}set minimum(e){let t=sr.currentCulture;sr.currentCulture=sr.getCultureInfo("en-US"),this.minimumValue=O.tryToString(e),sr.currentCulture=t}get maximum(){return O.tryToNumber(this.maximumValue)}set maximum(e){let t=sr.currentCulture;sr.currentCulture=sr.getCultureInfo("en-US"),this.maximumValue=O.tryToString(e),sr.currentCulture=t}getMinimumValue(){return k.parseNumber(this.minimumValue,this.report,!0,null,!0,!0)}getMaximumValue(){return k.parseNumber(this.maximumValue,this.report,!0,null,!0,!0)}getNestedPages(){if(null==this.dashboardInteraction||this.dashboardInteraction.onClick!=di.ShowDashboard)return null;let t=this.dashboardInteraction.drillDownPageKey;if(de.isEmptyKey(t))return null;let e=this.report.pages.toList().firstOrDefault(e=>e.guid==t);if(null==e)return null;return new j([e])}constructor(e=L.empty){super(e),this.dataMode=Nl.UsingDataFields,this.group="",this.title=new _l,this.layout=new tl,this.crossFiltering=!0,this.shadow=new We,this.cornerRadius=new v(0),this.showBlanks=!1,this.dateTimeMode=!1,this.font=new B("Arial",13),this.foreColor=N.transparent,this.transformActions=new j,this.transformFilters=new j,this.transformSorts=new j,this.dataTransformation={},this.dataFilters=new j,this.userSorts=new j,this._style=o.Auto,this.customStyleName="",this.helpUrl="user-manual/dashboards_gauge.htm",this.valueFormat=Km.getValueFormatDefault(),this.shortValue=!0,this.labels=new ka,this.targetSettings=new Ma,this.minimumValue="0",this.maximumValue="100",this.minimumDateTime=F.now,this.maximumDateTime=F.now.addYears(1),this.calculationMode=P.Report["Gauge"].StiGaugeCalculationMode.Auto,this.rangeMode=P.Report["Gauge"].StiGaugeRangeMode.Percentage,this.rangeType=P.Report["Gauge"].StiGaugeRangeType.None,this.type=P.Report["Gauge"].StiGaugeType.FullCircular,this.ranges=new j,this.isSampleForStyles=!1,this.title.text=this.localizedName,this.dashboardInteraction=new Aa,this.previousAnimations=new j}}R.T.StiGaugeElement=Km}R.ab.StiGaugeRangeConverter=class{},R.V.StiTextMeter=class extends R.e.StiDimensionMeter{implements(){let e=super.implements().concat([ji]);return(this.implements=()=>e)()}get localizedName(){return b.get("PropertyMain","Text")}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.TextMeter}},R.X.StiImageMeter=class extends R.e.StiDimensionMeter{implements(){let e=super.implements().concat([ji]);return(this.implements=()=>e)()}get localizedName(){return b.get("PropertyMain","Image")}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.ImageMeter}},R.Y.StiWebContentMeter=class extends R.e.StiDimensionMeter{get localizedName(){return b.get("Components","StiWebContent")}constructor(e,t,i){super(e,t,i),this.ident=R.e.StiMeterIdent.WebContentMeter}};let Va=R.X.StiImageMeter,Na=R.Y.StiWebContentMeter,La=R.V.StiTextMeter,Ba=R.H.StiStartValueChartMeter,Pa=(R.G.StiMeterCreator=class{static neww(e){if(H.isNullOrEmpty(e))return null;let t,i=Gt.tryParse(e);return null!=(t=i.successfully?z.parse(R.e.StiMeterIdent,i.result):z.parse(R.e.StiMeterIdent,e))?this.neww2(t):null}static neww2(e){switch(e){case R.e.StiMeterIdent.ArgumentChartMeter:return new Hs;case R.e.StiMeterIdent.SeriesChartMeter:return new zs;case R.e.StiMeterIdent.SortByChartMeter:return new Hr;case R.e.StiMeterIdent.IndicatorValueChartMeter:return new Pr;case R.e.StiMeterIdent.ValueChartMeter:return new js;case R.e.StiMeterIdent.StartValueChartMeter:return new Ba;case R.e.StiMeterIdent.EndValueChartMeter:return new Xs;case R.e.StiMeterIdent.OpenValueChartMeter:return new Ns;case R.e.StiMeterIdent.CloseValueChartMeter:return new Ls;case R.e.StiMeterIdent.LowValueChartMeter:return new Bs;case R.e.StiMeterIdent.HighValueChartMeter:return new Ps;case R.e.StiMeterIdent.WeightChartMeter:return new Vs;case R.e.StiMeterIdent.XChartMeter:return new Lr;case R.e.StiMeterIdent.YChartMeter:return new Nr;case R.e.StiMeterIdent.KeyComboBoxMeter:return new As;case R.e.StiMeterIdent.NameComboBoxMeter:return new Ms;case R.e.StiMeterIdent.MaxGaugeMeter:return new ma;case R.e.StiMeterIdent.MinGaugeMeter:return new ha;case R.e.StiMeterIdent.SeriesGaugeMeter:return new Ds;case R.e.StiMeterIdent.ValueGaugeMeter:return new Is;case R.e.StiMeterIdent.TargetGaugeMeter:return new Rs;case R.e.StiMeterIdent.SeriesIndicatorMeter:return new Es;case R.e.StiMeterIdent.TargetIndicatorMeter:return new Os;case R.e.StiMeterIdent.ValueIndicatorMeter:return new ks;case R.e.StiMeterIdent.KeyListBoxMeter:return new Cs;case R.e.StiMeterIdent.NameListBoxMeter:return new xs;case R.e.StiMeterIdent.LatitudeMapMeter:return new bs;case R.e.StiMeterIdent.LongitudeMapMeter:return new ys;case R.e.StiMeterIdent.LocationMapMeter:return new Kr;case R.e.StiMeterIdent.LocationValueMapMeter:return new qr;case R.e.StiMeterIdent.LocationArgumentMapMeter:return new Yr;case R.e.StiMeterIdent.LocationColorMapMeter:return new Qr;case R.e.StiMeterIdent.KeyMapMeter:return new cs;case R.e.StiMeterIdent.NameMapMeter:return new ms;case R.e.StiMeterIdent.GroupMapMeter:return new hs;case R.e.StiMeterIdent.ColorMapMeter:return new os;case R.e.StiMeterIdent.ValueMapMeter:return new us;case R.e.StiMeterIdent.PivotColumn:return new Ss;case R.e.StiMeterIdent.PivotRow:return new ws;case R.e.StiMeterIdent.PivotSummary:return new fs;case R.e.StiMeterIdent.SeriesProgressMeter:return new ps;case R.e.StiMeterIdent.TargetProgressMeter:return new gs;case R.e.StiMeterIdent.ValueProgressMeter:return new ds;case R.e.StiMeterIdent.ColorScaleColumn:return new ts;case R.e.StiMeterIdent.DataBarsColumn:return new is;case R.e.StiMeterIdent.DimensionColumn:return new ns;case R.e.StiMeterIdent.IndicatorColumn:return new es;case R.e.StiMeterIdent.MeasureColumn:return new as;case R.e.StiMeterIdent.SparklinesColumn:return new rs;case R.e.StiMeterIdent.BubbleColumn:return new Zr;case R.e.StiMeterIdent.ColorScaleCardsColumn:return new Xr;case R.e.StiMeterIdent.DataBarsCardsColumn:return new Gr;case R.e.StiMeterIdent.DimensionCardsColumn:return new Wr;case R.e.StiMeterIdent.IndicatorCardsColumn:return new jr;case R.e.StiMeterIdent.MeasureCardsColumn:return new Ni;case R.e.StiMeterIdent.SparklinesCardsColumn:return new Jr;case R.e.StiMeterIdent.BubbleCardsColumn:return new zr;case R.e.StiMeterIdent.KeyTreeViewMeter:return new $r;case R.e.StiMeterIdent.KeyTreeViewBoxMeter:return new _r;case R.e.StiMeterIdent.ValueDatePickerMeter:return new vs;case R.e.StiMeterIdent.ValueNumberBoxMeter:return new Br;case R.e.StiMeterIdent.TextMeasureMeter:return new Vr;case R.e.StiMeterIdent.TextMeter:return new La;case R.e.StiMeterIdent.ImageMeter:return new Va;case R.e.StiMeterIdent.WebContentMeter:return new Na;default:throw new pa(e)}}},R.G.StiMeterJsonConverter=class{},R.g.StiImageDashboardInteraction=class extends R.g.StiDashboardInteraction{isDefault(){return this.onHover==ci.ShowToolTip&&this.onClick==di.OpenHyperlink&&this.hyperlinkDestination==gi.NewTab&&H.isNullOrEmpty(this.hyperlink)&&H.isNullOrEmpty(this.drillDownPageKey)&&null!=this.drillDownParameters&&0==this.drillDownParameters.length&&H.isNullOrEmpty(this.toolTip)}constructor(e,t,i,r,s,l,n){super(e,t,i,r,s,l,n),this.ident=pi.Image,this.availableOnClick=Si.OpenHyperlink|Si.ShowDashboard,this.onClick=di.OpenHyperlink}},P.Report.Helpers.StiHyperlinkProcessor),Ha=R.g.StiImageDashboardInteraction,ja=P.System.Drawing.Image,za=P.Report.Dashboard.ImplementsIStiImageElement,Xa=P.Base.Drawing.StiImageConverter,Ga=P.Report.Dashboard.Helpers.StiDashboardImageHyperlinkCache,Ja=P.Report.Dashboard.IStiImageElement,Wa=P.Report.StiFontIconsHelper,Ua=(ht.add("StiImageElement","Stimulsoft.Dashboard.Export.Tools.StiImageElementExportTool"),R.X.StiImageElement=class extends R.e.StiElement{implements(){let e=super.implements().concat([Ii,si,Ja,Je,Ue,Ie,ke,...Ti,...$t,...za,...Ge,...Ze,...il,n,Ci]);return(this.implements=()=>e)()}clone(e){let t,i,r=super.clone(e);return r.title=null!=this.title?this.title.clone():null,r.shadow=null==(t=this.shadow)?void 0:t.clone(),r.cornerRadius=null==(i=this.cornerRadius)?void 0:i.clone(),r}meta(){return[...super.meta(),new s("DashboardInteraction").check(()=>null!=this.dashboardInteraction.as(Ha)).set(e=>{let t,i=null==(t=bi.loadInteractionFromJsonObject(e.value))?void 0:t.as(Ha);null!=i&&(this.dashboardInteraction=i)}).setXml(e=>{let t,i=null==(t=bi.loadInteractionFromXml(e))?void 0:t.as(Ha);null!=i&&(this.dashboardInteraction=i)}),new h("AspectRatio","",!0),new l("ImageHyperlink"),new r("HorAlignment","",X,X.Center),new r("VertAlignment","",Ht,Ht.Center),new l("Group"),new l("Style"),new h("CrossFiltering","",!0),new l("CornerRadius").get(()=>this.cornerRadius.toString()).set(e=>this.cornerRadius=v.tryParse(e.value.toString())).setXml(e=>this.cornerRadius=v.tryParse(e.textContent)),new s("Padding").get(e=>this.padding.saveToJsonObject(0,0,0,0)),new l("Shadow").get(()=>a.Serialize.jShadow(this.shadow)).set(e=>this.shadow=a.Deserialize.simpleSahdow(e.value)).setXml(e=>this.shadow=We.loadFromXml(e.textContent)),new s("Title").check(()=>null!=this.title).set(e=>this.title=R.e.StiTitle.createFromJsonObject(e.value)).setXml(e=>this.title=R.e.StiTitle.createFromXml(e)),new re("Image").check(()=>null!=this.image).get(()=>Xa.imageToString(this.image)).set(e=>this.image=Xa.stringToImage(e.value.toString())).setXml(e=>this.image=Xa.stringToImage(e.textContent)),new r("Icon","",Et).check(()=>null!=this.icon),new i("IconColor","",N.fromArgb2(68,114,196))]}get isDefined(){return this.isImageDefined||this.isImageHyperlinkDefined||this.isImageIconDefined}get isQuerable(){return this.isImageHyperlinkDataColumnDefined}fetchAllMeters(){return this.getMeters()}getMeters(){if(!this.isHyperlinkExpressionOrHyperlinkDataColumnDefined)return new j;if(this.isImageHyperlinkExpressionDefined)return Or.fetchBlocksFromExpression(this.imageHyperlink).select(e=>new Va(e,e,e)).cast().toList();{let e=Pa.getRealDataColumnFromHyperlink(this.report,this.imageHyperlink),t=new j;return t.add(new Va(e,e,e)),t}}retrieveUsedDataNames(){return rl.getMany2(this.getMeters()).distinct().toList()}get imageToDraw(){if(this.isImageDefined)return new Promise(e=>{e(this.image)});if(this.isImageIconDefined){let e=this.getPaintRectangle(!0,!1);return Wa.convertFontIconToImageAsync(this.icon,this.iconColor,e.width,e.height,null,this.horAlignment)}if(this.isImageHyperlinkDefined)return new Promise(r=>{setTimeout(async()=>{if(this.isImageHyperlinkDataColumnDefined){let i=await yn.getOrCreate(this);if(null!=i){let e=i.rows.find(e=>!0),t=null!=e?e.find(e=>!0):null;if(Pl.isArray(t)){let e=new P.System.Drawing.Image;e.bytes=t,r(e)}else if("string"==typeof t&&!H.isNullOrEmpty(t)){if(t[P.System.StiObject.stimulsoft]().isBase64String()){let e=new P.System.Drawing.Image;e.base64=t,r(e)}r(Ga.get(t,this.report))}}r(null)}else if(this.isImageHyperlinkExpressionDefined){let e=await yn.getOrCreate(this);if(null!=e){let i=e.rows.firstOrDefault();if(null!=i)if(Pl.isArray(i[P.System.StiObject.stimulsoft]().toList().firstOrDefault())){let e=new P.System.Drawing.Image;e.bytes=i,r(e)}else{let e=i[P.System.StiObject.stimulsoft]().toList().select(e=>null!=(null==e?void 0:e.toString())?e.toString():"").toList(),t=P.Data.Helpers.StiExpressionHelper.replaceExpressionBlocksByValues(this.imageHyperlink,e);r(Pa.getImage(this.report,t))}}}r(Ga.get(this.imageHyperlink,this.report))})});return new Promise(e=>{e(null)})}copyAllImageProperties(e){if(null==e)return;this.image=e.image,this.imageHyperlink=e.imageHyperlink,this.icon=e.icon,this.iconColor=e.iconColor}get style(){return this.componentStyle}set style(e){this.componentStyle=e}setString(e,t){switch(e){case"Title.Text":this.title.text=t;break}}getString(e){switch(e){case"Title.Text":return this.title.text}throw new Error(`Property with name `+e)}getAllStrings(){return["Title.Text"]}get toolboxPosition(){return _e.ImageElement}get localizedName(){return T.get("Components","StiImage")}getNestedPages(){if(null==this.dashboardInteraction||this.dashboardInteraction.onClick!=di.ShowDashboard)return null;let t=this.dashboardInteraction.drillDownPageKey;if(de.isEmptyKey(t))return null;let e=this.report.pages.toList().firstOrDefault(e=>e.guid==t);if(null==e)return null;return new j([e])}resetAllImageProperties(){this.image=new ja,this.imageHyperlink=null,this.icon=null}get isHyperlinkExpressionOrHyperlinkDataColumnDefined(){return this.isImageHyperlinkExpressionDefined||this.isImageHyperlinkDataColumnDefined}get isImageDefined(){return null!=this.image&&(null!=this.image.bytes||!H.isNullOrEmpty(this.image.url))}get isImageIconDefined(){return null!=this.icon}get isImageHyperlinkDefined(){return!H.isNullOrWhiteSpace(this.imageHyperlink)}get isImageHyperlinkExpressionDefined(){var e,t;return(null==(e=this.imageHyperlink)?void 0:e[P.System.StiObject.stimulsoft]().contains("{"))&&(null==(t=this.imageHyperlink)?void 0:t[P.System.StiObject.stimulsoft]().contains("}"))}get isImageHyperlinkDataColumnDefined(){return!this.isImageDefined&&!this.isImageIconDefined&&this.isImageHyperlinkDefined&&!H.isNullOrWhiteSpace(Pa.getRealDataColumnFromHyperlink(this.report,this.imageHyperlink))}constructor(e=L.empty){super(e),this.group="",this.title=new R.e.StiTitle,this.image=null,this.aspectRatio=!0,this.icon=null,this.iconColor=N.fromArgb2(68,114,196),this.crossFiltering=!0,this.horAlignment=X.Center,this.vertAlignment=Ht.Center,this.shadow=new We,this.cornerRadius=new v(0),this.defaultClientRectangle=new L(0,0,120,120),this.helpUrl="user-manual/dashboards_image.htm",this.title.text=this.localizedName,this.title.visible=!1,this.padding=it.create(0),this.dashboardInteraction=new Ha}},R._.StiImageBytesConverter=class{},R.g.StiIndicatorDashboardInteraction=class extends R.g.StiDashboardInteraction{implements(){let e=super.implements().concat([Il,n,Ws]);return(this.implements=()=>e)()}meta(){return[...super.meta(),new h("AllowUserDrillDown"),new h("AllowUserSorting","",!0),new h("ShowFullScreenButton","",!0),new h("ShowSaveButton","",!0),new h("ShowViewDataButton","",!0),new l("FileName"),new l("HeaderText"),new l("FooterText")]}get isDefaultLayout(){return this.showFullScreenButton&&this.showSaveButton&&this.showViewDataButton&&null==this.fileName&&null==this.headerText&&!this.allowUserDrillDown&&null==this.footerText}isDefault(){return this.isDefaultLayout&&this.onHover==ci.ShowToolTip&&this.onClick==di.None&&this.hyperlinkDestination==gi.NewTab&&H.isNullOrEmpty(this.hyperlink)&&H.isNullOrEmpty(this.drillDownPageKey)&&null!=this.drillDownParameters&&0==this.drillDownParameters.length&&H.isNullOrEmpty(this.toolTip)&&!this.allowUserDrillDown&&this.allowUserSorting}constructor(e,t,i,r,s,l,n,a,o,u,h,m,c,d,g){super(),this.ident=pi.Indicator,this.availableOnClick=Si.OpenHyperlink|Si.ShowDashboard,this.availableOnDataManipulation=fi.AllowDrillDown|fi.AllowSorting,this.allowUserDrillDown=!1,this.allowUserSorting=!0,this.onClick=di.None,this.showFullScreenButton=!0,this.showSaveButton=!0,this.showViewDataButton=!0,this.fileName=null,this.headerText=null,this.footerText=null,null!=e&&(this.onHover=e),null!=t&&(this.onClick=t),null!=i&&(this.hyperlinkDestination=i),null!=r&&(this.toolTip=r),null!=s&&(this.hyperlink=s),null!=l&&(this.drillDownPageKey=l),null!=n&&(this.drillDownParameters=n),null!=a&&(this.allowUserDrillDown=a),null!=u&&(this.fileName=u),null!=h&&(this.headerText=h),null!=m&&(this.footerText=m),null!=c&&(this.showFullScreenButton=c),null!=d&&(this.showSaveButton=d),null!=o&&(this.allowUserSorting=o),null!=g&&(this.showViewDataButton=g)}},P.Report.Dashboard.StiIndicatorIconRangeMode),Za=P.Report.Dashboard.StiIndicatorIconMode,Ya=P.Data.Engine.IStiAllowSortByVariation,Ka=P.Report.Dashboard.StiTargetMode,Qa=R.g.StiIndicatorDashboardInteraction,qa=P.Report.Dashboard.ImplementsIStiIndicatorElement,_a=P.Data.Engine.ImplementsIStiAllowSortByVariation,$a=P.Report.Helpers.StiFontIconSet,eo=P.Report.Dashboard.IStiIndicatorElement,to=P.System.Convert,io=P.Report.Dashboard.StiFontSizeMode,ro=P.Report.Dashboard.StiIndicatorValueType,so=(R.U.StiIndicatorElement=class extends R.e.StiElement{implements(){let e=super.implements().concat([Di,eo,Ue,Je,Ie,ri,Ai,el,Ci,ke,Ya,Us,..._i,...qa,...Ze,...Ge,...il,..._t,...Fi,...$s,..._a,n]);return(this.implements=()=>e)()}clone(e){let t,i,r=super.clone(e);return r.value=null!=this.value?this.value.clone():null,r.target=null!=this.target?this.target.clone():null,r.series=null!=this.series?this.series.clone():null,r.userSorts=this.userSorts.select(e=>e.clone()).toList(),r.transformActions=this.transformActions.select(e=>e.clone()).toList(),r.transformFilters=this.transformFilters.select(e=>e.clone()).toList(),r.transformSorts=this.transformSorts.select(e=>e.clone()).toList(),r.dataFilters=this.dataFilters.select(e=>e.clone()).toList(),r.topN=this.topN.clone(),r.textFormat=this.textFormat.clone(),r.targetFormat=this.targetFormat.clone(),r.title=null!=this.title?this.title.clone():null,r.layout=null!=this.layout?this.layout.clone():null,r.indicatorConditions=this.indicatorConditions.select(e=>e.clone()).toList(),r.dashboardInteraction=this.dashboardInteraction.clone(),r.shadow=null==(t=this.shadow)?void 0:t.clone(),r.cornerRadius=null==(i=this.cornerRadius)?void 0:i.clone(),r}meta(){return[...super.meta(),new s("UserSorts").get(e=>a.Serialize.objectArray(this.userSorts,e)).set(e=>this.userSorts.addRange(e.value.properties().select(e=>ll.loadFromJson(e.value)))).setXml(e=>this.userSorts.addRange(e.childNodes.map(e=>ll.loadFromXml(e)))),new s("TransformActions").get(e=>a.Serialize.objectArray(this.transformActions,e)).set(e=>this.transformActions.addRange(e.value.properties().select(e=>nl.loadFromJson(e.value)))).setXml(e=>this.transformActions.addRange(e.childNodes.map(e=>nl.loadFromXml(e)))),new s("TransformFilters").get(e=>a.Serialize.objectArray(this.transformFilters,e)).set(e=>this.transformFilters.addRange(e.value.properties().select(e=>y.loadFromJson(e.value)))).setXml(e=>this.transformFilters.addRange(e.childNodes.map(e=>y.loadFromXml(e)))),new s("TransformSorts").get(e=>a.Serialize.objectArray(this.transformSorts,e)).set(e=>this.transformSorts.addRange(e.value.properties().select(e=>ll.loadFromJson(e.value)))).setXml(e=>this.transformSorts.addRange(e.childNodes.map(e=>ll.loadFromXml(e)))),new s("DataFilters").get(e=>a.Serialize.objectArray(this.dataFilters,e)).set(e=>this.dataFilters.addRange(e.value.properties().select(e=>y.loadFromJson(e.value)))).setXml(e=>this.dataFilters.addRange(e.childNodes.map(e=>y.loadFromXml(e)))),new s("IconRanges").get(e=>a.Serialize.objectArray(this.iconRanges,e)).set(e=>this.iconRanges.addRange(e.value.properties().select(e=>R.U.StiIndicatorIconRange.loadFromJson(e.value)))).setXml(e=>this.iconRanges.addRange(e.childNodes.map(e=>R.U.StiIndicatorIconRange.loadFromXml(e)))),new h("CrossFiltering","",!0),new s("TopN").check(()=>null!=this.topN).set(e=>this.topN=Ei.createFromJsonObject(e.value)).setXml(e=>this.topN=Ei.createFromXml(e)),new s("TextFormat").check(()=>null!=this.textFormat).set(e=>this.textFormat=Mi.createFromJsonObject(e.value)).setXml(e=>this.textFormat=Mi.loadFormatFromXml(e,this.report)),new s("TargetFormat").check(()=>null!=this.targetFormat).set(e=>this.targetFormat=Mi.createFromJsonObject(e.value)).setXml(e=>this.targetFormat=Mi.loadFormatFromXml(e,this.report)),new s("Value").check(()=>null!=this.value).set(e=>{let t=d.loadFromJson(e.value).as(ks);null!=t&&(this.value=t)}).setXml(e=>{let t=d.loadFromXml(e).as(ks);null!=t&&(this.value=t)}),new s("Target").check(()=>null!=this.target).set(e=>{let t=d.loadFromJson(e.value).as(R.U.StiTargetIndicatorMeter);null!=t&&(this.target=t)}).setXml(e=>{let t=d.loadFromXml(e).as(R.U.StiTargetIndicatorMeter);null!=t&&(this.target=t)}),new s("Series").check(()=>null!=this.series).set(e=>{let t=d.loadFromJson(e.value).as(R.U.StiSeriesIndicatorMeter);null!=t&&(this.series=t)}).setXml(e=>{let t=d.loadFromXml(e).as(R.U.StiSeriesIndicatorMeter);null!=t&&(this.series=t)}),new s("Title").check(()=>null!=this.title).set(e=>this.title=R.e.StiTitle.createFromJsonObject(e.value)).setXml(e=>this.title=R.e.StiTitle.createFromXml(e)),new s("Layout").check(()=>null!=this.layout).set(e=>this.layout=tl.createFromJsonObject(e.value)).setXml(e=>this.layout=tl.createFromXml(e)),new i("ForeColor","",N.transparent),new i("GlyphColor","",N.transparent),new l("Font").get(()=>a.Serialize.fontArial13(this.font)).set(e=>this.font=a.Deserialize.font(e.value,this.font)).setXml(e=>this.font=P.System.Convert.toFont(e.textContent)),new r("DataMode","",Nl,Nl.UsingDataFields),new l("ManuallyEnteredData"),new r("Style","",o,o.Auto),new l("Group"),new l("CustomStyleName"),new r("Icon","",Et,Et.Rating4),new r("IconSet","",$a,$a.Rating),new r("IconMode","",Za,Za.Auto),new r("IconRangeMode","",Ua,Ua.Percentage),new re("CustomIcon").check(()=>null!=this.customIcon).get(()=>to.toBase64String(this.customIcon)).set(e=>this.customIcon=to.fromBase64String(e.value.toString())).setXml(e=>this.customIcon=to.fromBase64String(e.textContent)),new r("IconAlignment","",G,G.Right),new r("TargetMode","",Ka,Ka.Variation),new r("ValueType","",ro,ro.Value),new r("FontSizeMode","",io,io.Auto),new s("IndicatorConditions").get(e=>a.Serialize.objectArray(this.indicatorConditions,e)).set(e=>this.indicatorConditions.addRange(e.value.properties().select(e=>R.U.StiIndicatorElementCondition.createFromJson(e.value)))).setXml(e=>this.indicatorConditions.addRange(e.childNodes.map(e=>R.U.StiIndicatorElementCondition.createFromXml(e)))),new l("CornerRadius").get(()=>this.cornerRadius.toString()).set(e=>this.cornerRadius=v.tryParse(e.value.toString())).setXml(e=>this.cornerRadius=v.tryParse(e.textContent)),new l("Shadow").get(()=>a.Serialize.jShadow(this.shadow)).set(e=>this.shadow=a.Deserialize.simpleSahdow(e.value)).setXml(e=>this.shadow=We.loadFromXml(e.textContent)),new s("DashboardInteraction").check(()=>null!=this.dashboardInteraction.as(Qa)).set(e=>{let t,i=null==(t=bi.loadInteractionFromJsonObject(e.value))?void 0:t.as(Qa);null!=i&&(this.dashboardInteraction=i)}).setXml(e=>{let t,i=null==(t=bi.loadInteractionFromXml(e))?void 0:t.as(Qa);null!=i&&(this.dashboardInteraction=i)}),new h("ShowBlanks")]}addValue2(e){this.value=null!=e?c.Indicator.getValue2(e):null}addValue(e){this.value=c.Indicator.getValue(e.as(R.e.StiMeter))}removeValue(){this.value=null}getValue(){return this.value}getValue2(e){return null!=e?c.Indicator.getValue(e.as(R.e.StiMeter)):null}createNewValue(){this.value=new ks,this.value.expression="Sum()"}addTarget2(e){this.target=null!=e?c.Indicator.getTarget2(e):null}addTarget(e){this.target=c.Indicator.getTarget(e.as(R.e.StiMeter))}removeTarget(){this.target=null}getTarget(){return this.target}getTarget2(e){return null!=e?c.Indicator.getTarget(e.as(R.e.StiMeter)):null}createNewTarget(){this.target=new R.U.StiTargetIndicatorMeter,this.target.expression="Sum()"}addSeries2(e){this.series=null!=e?c.Indicator.getSeries2(e):null}addSeries(e){this.series=c.Indicator.getSeries(e.as(R.e.StiMeter))}removeSeries(){this.series=null}getSeries(){return this.series}getSeries2(e){return null!=e?c.Indicator.getSeries(e.as(R.e.StiMeter)):null}createNewSeries(){this.series=new R.U.StiSeriesIndicatorMeter}getIconRanges(){let e=new j;return e.addRange(this.iconRanges),e}addRange(){let e=new R.U.StiIndicatorIconRange;return this.iconRanges.add(e),e}removeRange(e){e<this.iconRanges.length&&this.iconRanges.removeAt(e)}createdDefaultRanges(){this.iconRanges.clear(),this.iconRanges.add(new R.U.StiIndicatorIconRange(Et.Rating1,"0","25")),this.iconRanges.add(new R.U.StiIndicatorIconRange(Et.Rating2,"25","50")),this.iconRanges.add(new R.U.StiIndicatorIconRange(Et.Rating3,"50","75")),this.iconRanges.add(new R.U.StiIndicatorIconRange(Et.Rating4,"75","100"))}getManuallyEnteredDataTable(){if(this.dataMode!=Nl.ManuallyEnteringData)return null;return R.e.StiManuallyEnteredDataParser.getIndicatorDataTable(this.manuallyEnteredData,this)}addIndicatorCondition(e,t,i,r,s,l,n,a,o,u,h,m,c,d){this.indicatorConditions.add(new R.U.StiIndicatorElementCondition(e,t,i,r,s,l,n,a,o,u,h,m,c,d))}fetchIndicatorConditions(){let e=new j;return null!=this.indicatorConditions&&e.addRange(this.indicatorConditions),e}clearIndicatorConditions(){this.indicatorConditions.clear()}convertFrom(e){let t=e.fetchAllMeters();if(null==t)return;let i=t.firstOrDefault(e=>e.is(ji)),r=(null!=(i=null==i?t.firstOrDefault(e=>e.is(vt)):i)&&(this.value=null==this.value?new ks:this.value,this.value.loadFromJsonObject(i.saveToJsonObject(Le.Report))),t.firstOrDefault(e=>e.is(Ir))),s=(null!=r&&(this.target=null==this.target?new R.U.StiTargetIndicatorMeter:this.target,this.target.loadFromJsonObject(r.saveToJsonObject(Le.Report))),t.firstOrDefault(e=>e.is(Dr)));null!=(s=null==s?t.firstOrDefault(e=>e.is(Pe)):s)&&(this.series=null==this.series?new R.U.StiSeriesIndicatorMeter:this.series,this.series.loadFromJsonObject(s.saveToJsonObject(Le.Report))),null==this.dashboardInteraction&&(this.dashboardInteraction=new Qa)}fetchAllMeters(){let e=new j;return this.dataMode==Nl.UsingDataFields&&(null!=this.value&&e.add(this.value),null!=this.target&&e.add(this.target),null!=this.series)&&e.add(this.series),e}getMeters(){let e=new j;return this.dataMode==Nl.UsingDataFields&&(null!=this.value&&e.add(this.value),null!=this.target&&e.add(this.target),null!=this.series)&&e.add(this.series),e}retrieveUsedDataNames(){return this.dataMode==Nl.UsingDataFields?rl.getMany(this.value,this.target,this.series):null}get isDefined(){return null!=this.value||null!=this.target||null!=this.series||this.dataMode==Nl.ManuallyEnteringData}get style(){return this._style}set style(e){(this._style=e)!=o.Custom&&(this.customStyleName="")}setString(e,t){switch(e){case"Title.Text":this.title.text=t;break}}getString(e){switch(e){case"Title.Text":return this.title.text}throw new Error(`Property with name `+e)}getAllStrings(){return["Title.Text"]}get toolboxPosition(){return _e.IndicatorElement}get localizedName(){return b.get("Components","StiIndicator")}getNestedPages(){if(null==this.dashboardInteraction||this.dashboardInteraction.onClick!=di.ShowDashboard)return null;let t=this.dashboardInteraction.drillDownPageKey;if(de.isEmptyKey(t))return null;let e=this.report.pages.toList().firstOrDefault(e=>e.guid==t);if(null==e)return null;return new j([e])}constructor(e=L.empty){super(e),this.group="",this.shadow=new We,this.cornerRadius=new v(0),this.dataMode=Nl.UsingDataFields,this.textFormat=new zt,this.font=new B("Arial",13),this.foreColor=N.transparent,this.showBlanks=!1,this.title=new R.e.StiTitle,this.layout=new tl,this.transformActions=new j,this.transformFilters=new j,this.transformSorts=new j,this.topN=new Ei,this.dataTransformation={},this.dataFilters=new j,this.userSorts=new j,this._style=o.Auto,this.customStyleName="",this.defaultClientRectangle=new L(0,0,160,160),this.helpUrl="user-manual/dashboards_indicator.htm",this.glyphColor=N.transparent,this.targetFormat=new Zi,this.icon=Et.Rating4,this.iconSet=$a.Rating,this.iconAlignment=G.Right,this.targetMode=Ka.Variation,this.fontSizeMode=io.Auto,this.iconMode=Za.Auto,this.iconRangeMode=Ua.Percentage,this.iconRanges=new j,this.indicatorConditions=new j,this.crossFiltering=!0,this.valueType=ro.Value,this.isSampleForStyles=!1,this.title.text=this.localizedName,this.dashboardInteraction=new Qa}},P.Report.Dashboard.IStiIndicatorElementCondition),lo=P.Report.Dashboard.StiIndicatorFieldCondition,no=P.Report.Dashboard.StiIndicatorConditionPermissions;{class hp{implements(){let e=[Rt,so,n];return(this.implements=()=>e)()}meta(){return[new re("Ident").get(()=>this[P.System.StiObject.stimulsoft]().getType()[P.System.StiObject.stimulsoft]().getTypeName()),new r("Condition","",nn,nn.EqualTo),new r("Field","",lo,lo.Value),new l("Value"),new i("IconColor","",N.fromArgb2(68,114,196)),new r("Icon","",Et,Et.Rating4),new i("TargetIconColor","",N.fromArgb2(68,114,196)),new r("TargetIcon","",Et,Et.Rating4),new re("CustomIcon").check(()=>null!=this.customIcon).get(()=>to.toBase64String(this.customIcon)).set(e=>this.customIcon=to.fromBase64String(e.value.toString())).setXml(e=>this.customIcon=to.fromBase64String(e.textContent)),new r("Permissions","",no,no.All),new l("Font").get(()=>a.Serialize.fontArial8(this.font)).set(e=>this.font=a.Deserialize.font(e.value,this.font)).setXml(e=>this.font=P.System.Convert.toFont(e.textContent)),new i("TextColor","",N.black),new i("BackColor","",N.transparent),new r("IconAlignment","",G,G.Right),new r("TargetIconAlignment","",G,G.Right)]}saveToJsonObject(e){return u.saveToJsonObject(e,this)}loadFromJsonObject(e){u.loadFromJsonObject(e,this)}loadFromXml(e){u.loadFromXml(e,this)}clone(){return this[P.System.StiObject.stimulsoft]().memberwiseClone()}static createFromJson(e){let t=new hp;return t.loadFromJsonObject(e),t}static createFromXml(e){let t=new hp;return t.loadFromXml(e),t}constructor(e,t,i,r,s,l,n,a,o,u,h,m,c,d){this.iconColor=N.fromArgb2(68,114,196),this.icon=Et.Rating4,this.targetIconColor=N.fromArgb2(68,114,196),this.targetIcon=Et.Rating4,this.condition=nn.EqualTo,this.field=lo.Value,this.permissions=no.All,this.textColor=N.black,this.backColor=N.transparent,this.font=new B("Arial",8),this.iconAlignment=G.Right,this.targetIconAlignment=G.Right,null!=e&&(this.field=e),null!=t&&(this.condition=t),null!=i&&(this.value=i),null!=l&&(this.targetIcon=l),null!=n&&(this.targetIconColor=n),null!=r&&(this.icon=r),null!=s&&(this.iconColor=s),null!=a&&(this.customIcon=a),null!=o&&(this.iconAlignment=o),null!=u&&(this.targetIconAlignment=u),null!=h&&(this.permissions=h),null!=m&&(this.font=m),null!=c&&(this.textColor=c),null!=d&&(this.backColor=d)}}R.U.StiIndicatorElementCondition=hp}let ao=P.Report.Dashboard.ImplementsStiIndicatorIconRange,oo=P.Report.Dashboard.IStiIndicatorIconRange;{class mp{implements(){let e=[n,oo,...ao,Rt];return(this.implements=()=>e)()}clone(){return this[P.System.StiObject.stimulsoft]().memberwiseClone()}meta(){return[new l("StartExpression"),new l("EndExpression"),new r("Icon","",Et)]}saveToJsonObject(e){return u.saveToJsonObject(e,this)}loadFromJsonObject(e){u.loadFromJsonObject(e,this)}loadFromXml(e){u.loadFromXml(e,this)}static loadFromJson(e){let t=new mp;return t.loadFromJsonObject(e),t}static loadFromXml(e){let t=new mp;return t.loadFromXml(e),t}saveToString(){return this.saveToJsonObject(Le.Report).serialize()}getStringRepresentation(){return this.startExpression+` - `+this.endExpression}constructor(e,t,i){this.icon=Et.Rating4,this.startExpression="0",this.endExpression="100",null!=e&&(this.icon=e),null!=t&&(this.startExpression=t),null!=i&&(this.endExpression=i)}}R.U.StiIndicatorIconRange=mp}let uo=P.Report.Dashboard.StiListBoxSelectionType,ho=P.Report.Dashboard.ImplementsIStiListBoxElement,mo=P.Report.Dashboard.IStiListBoxElement,co=(ht.add("StiListBoxElement","Stimulsoft.Dashboard.Export.Tools.StiListBoxElementExportTool"),R.P.StiListBoxElement=class extends R.e.StiElement{implements(){let e=super.implements().concat([mo,Ue,Je,Ie,ke,...ho,...Ze,...Ge,...il,n,Ci]);return(this.implements=()=>e)()}clone(e){let t,i,r,s=super.clone(e);return s.keyMeter=null!=this.keyMeter?this.keyMeter.clone():null,s.nameMeter=null!=this.nameMeter?this.nameMeter.clone():null,s.userFilters=this.userFilters.select(e=>e.clone()).toList(),s.transformActions=this.transformActions.select(e=>e.clone()).toList(),s.transformFilters=this.transformFilters.select(e=>e.clone()).toList(),s.transformSorts=this.transformSorts.select(e=>e.clone()).toList(),s.dataFilters=this.dataFilters.select(e=>e.clone()).toList(),s.textFormat=this.textFormat.clone(),s.title=null!=this.title?this.title.clone():null,s.shadow=null==(t=this.shadow)?void 0:t.clone(),s.cornerRadius=null==(i=this.cornerRadius)?void 0:i.clone(),s.dashboardInteraction=null==(r=this.dashboardInteraction)?void 0:r.clone(),s}meta(){return[...super.meta(),new l("ParentKey"),new l("InitialValue"),new s("UserFilters").get(e=>a.Serialize.objectArray(this.userFilters,e)).set(e=>this.userFilters.addRange(e.value.properties().select(e=>y.loadFromJson(e.value)))).setXml(e=>this.userFilters.addRange(e.childNodes.map(e=>y.loadFromXml(e)))),new s("TransformActions").get(e=>a.Serialize.objectArray(this.transformActions,e)).set(e=>this.transformActions.addRange(e.value.properties().select(e=>nl.loadFromJson(e.value)))).setXml(e=>this.transformActions.addRange(e.childNodes.map(e=>nl.loadFromXml(e)))),new s("TransformFilters").get(e=>a.Serialize.objectArray(this.transformFilters,e)).set(e=>this.transformFilters.addRange(e.value.properties().select(e=>y.loadFromJson(e.value)))).setXml(e=>this.transformFilters.addRange(e.childNodes.map(e=>y.loadFromXml(e)))),new s("TransformSorts").get(e=>a.Serialize.objectArray(this.transformSorts,e)).set(e=>this.transformSorts.addRange(e.value.properties().select(e=>ll.loadFromJson(e.value)))).setXml(e=>this.transformSorts.addRange(e.childNodes.map(e=>ll.loadFromXml(e)))),new s("DataFilters").get(e=>a.Serialize.objectArray(this.dataFilters,e)).set(e=>this.dataFilters.addRange(e.value.properties().select(e=>y.loadFromJson(e.value)))).setXml(e=>this.dataFilters.addRange(e.childNodes.map(e=>y.loadFromXml(e)))),new i("ForeColor","",N.transparent),new l("Font").get(()=>a.Serialize.fontArial8(this.font)).set(e=>this.font=a.Deserialize.font(e.value,this.font)).setXml(e=>this.font=P.System.Convert.toFont(e.textContent)),new h("ShowAllValue"),new h("ShowBlanks"),new r("SelectionMode","",pn,pn.One).set(e=>{let t=z.parse(pn,e.value);null!=t&&(this.selectionMode=t)}).setXml(e=>{let t=z.parse(pn,e.textContent);null!=t&&(this.selectionMode=t)}),new r("Orientation","",qs,qs.Vertical),new r("SelectionType","",uo,uo.ListBox),new r("InclusionMode","",q,q.SelectionOnly),new s("NameMeter").check(()=>null!=this.nameMeter).set(e=>{let t=d.loadFromJson(e.value).as(xs);null!=t&&(this.nameMeter=t)}).setXml(e=>{let t=d.loadFromXml(e).as(xs);null!=t&&(this.nameMeter=t)}),new s("KeyMeter").check(()=>null!=this.keyMeter).set(e=>{let t=d.loadFromJson(e.value).as(R.P.StiKeyListBoxMeter);null!=t&&(this.keyMeter=t)}).setXml(e=>{let t=d.loadFromXml(e).as(R.P.StiKeyListBoxMeter);null!=t&&(this.keyMeter=t)}),new s("Title").check(()=>null!=this.title).set(e=>this.title=R.e.StiTitle.createFromJsonObject(e.value)).setXml(e=>this.title=R.e.StiTitle.createFromXml(e)),new s("TextFormat").check(()=>!(this.textFormat.is(zt)||null==this.textFormat)).set(e=>this.textFormat=Mi.createFromJsonObject(e.value)).setXml(e=>this.textFormat=Mi.loadFormatFromXml(e,this.report)),new r("Style","",o,o.Auto),new l("Group"),new l("CustomStyleName"),new l("CornerRadius").get(()=>this.cornerRadius.toString()).set(e=>this.cornerRadius=v.tryParse(e.value.toString())).setXml(e=>this.cornerRadius=v.tryParse(e.textContent)),new l("Shadow").get(()=>a.Serialize.jShadow(this.shadow)).set(e=>this.shadow=a.Deserialize.simpleSahdow(e.value)).setXml(e=>this.shadow=We.loadFromXml(e.textContent)),new s("DashboardInteraction").check(()=>null!=this.dashboardInteraction).set(e=>{let t,i=null==(t=bi.loadInteractionFromJsonObject(e.value))?void 0:t.as(dn);null!=i&&(this.dashboardInteraction=i)}).setXml(e=>{let t,i=null==(t=bi.loadInteractionFromXml(e))?void 0:t.as(dn);null!=i&&(this.dashboardInteraction=i)})]}get style(){return this._style}set style(e){(this._style=e)!=o.Custom&&(this.customStyleName="")}fetchAllMeters(){let e=new j;return null!=this.nameMeter&&e.add(this.nameMeter),null!=this.keyMeter&&e.add(this.keyMeter),e}getMeters(){let e=new j;return null!=this.nameMeter&&e.add(this.nameMeter),null!=this.keyMeter&&e.add(this.keyMeter),e}retrieveUsedDataNames(){return rl.getMany(this.nameMeter,this.keyMeter)}get isDefined(){return null!=this.nameMeter||null!=this.keyMeter}getParentKey(){return this.parentKey}setParentKey(e){this.parentKey=e}async applyDefaultFilters(){let e=await R.P.StiListBoxHelper.fetchDefaultUserFilters(this);null!=e&&(this.userFilters=e)}getIdentityFilters(){let e=new y;return e.condition=Ot.Any,e.elementKey=this.key,e.path=R.P.StiListBoxHelper.getKeyMeterExpression(this),e.toList()}addKeyMeter2(e){this.keyMeter=null!=e?c.ListBox.getKey2(e):null}addKeyMeter(e){this.keyMeter=null!=e?c.ListBox.getKey(e.as(R.e.StiMeter)):null}getKeyMeter(){return this.keyMeter}removeKeyMeter(){this.keyMeter=null}createNewKeyMeter(){this.keyMeter=new R.P.StiKeyListBoxMeter}addNameMeter2(e){this.nameMeter=null!=e?c.ListBox.getName2(e):null}addNameMeter(e){this.nameMeter=null!=e?c.ListBox.getName(e.as(R.e.StiMeter)):null}getNameMeter(){return this.nameMeter}removeNameMeter(){this.nameMeter=null}createNewNameMeter(){this.nameMeter=new xs}createNextMeter(e){null!=this.keyMeter&&null==this.nameMeter?this.nameMeter=c.ListBox.getName2(e):this.keyMeter=c.ListBox.getKey2(e)}convertFrom(e){let t=e.fetchAllMeters();if(null==t)return;let i=t.firstOrDefault(e=>e.is(ji)),r=(null!=(i=null==i?t.firstOrDefault(e=>e.is(vt)):i)&&(this.keyMeter=null==this.keyMeter?new R.P.StiKeyListBoxMeter:this.keyMeter,this.keyMeter.loadFromJsonObject(i.saveToJsonObject(Le.Report))),t.firstOrDefault(e=>e.is(ji)));null!=(r=null==r?t.firstOrDefault(e=>e.is(Pe)):r)&&(this.nameMeter=null==this.nameMeter?new xs:this.nameMeter,this.nameMeter.loadFromJsonObject(r.saveToJsonObject(Le.Report)))}setString(e,t){switch(e){case"Title.Text":this.title.text=t;break}}getString(e){switch(e){case"Title.Text":return this.title.text}throw new Error(`Property with name `+e)}getAllStrings(){return["Title.Text"]}get toolboxPosition(){return _e.ListBoxElement}get localizedName(){return T.get("Components","StiListBox")}constructor(e=L.empty){super(e),this.group="",this._style=o.Auto,this.customStyleName="",this.showAllValue=!1,this.showBlanks=!1,this.selectionMode=pn.One,this.orientation=qs.Vertical,this.selectionType=uo.ListBox,this.title=new R.e.StiTitle,this.inclusionMode=q.SelectionOnly,this.shadow=new We,this.cornerRadius=new v(0),this.userFilters=new j,this.transformActions=new j,this.transformFilters=new j,this.transformSorts=new j,this.dataTransformation={},this.dataFilters=new j,this.font=new B("Arial",8),this.foreColor=N.transparent,this.textFormat=new zt,this.defaultClientRectangle=new L(0,0,200,300),this.helpUrl="user-manual/dashboards_data_filtering_list_box.htm",this.title.text=this.localizedName,this.title.visible=!1,this.dashboardInteraction=new dn}},R.P.StiListBoxHelper=class{static fetchItems(r,e,s){if(null==e||e==Ct.nullTable||0==e.rows.length)return null;let l=this.getNameMeterIndex(e),n=this.getKeyMeterIndex(e);if(-1==l&&1==n)return null;-1==n&&(n=l),-1==l&&(l=n);let a=new j;for(let i of e.rows){let e=i[n];if(null==e)continue;let t=i[l];!s&&this.isBlank(t)||a.add(new R.P.StiListBoxItem(this.format(r,i[l]),i[n]))}return a}static isBlank(e){return null==e||e==bn.value||"string"==typeof e&&H.isNullOrEmpty(e)}static async fetchDefaultUserFilters(t){let e=!H.isNullOrEmpty(t.initialValue);if(t.showAllValue&&!e)return null;if(t.selectionMode==pn.Multi&&!e)return null;let i=this.getKeyMeterExpression(t);if(null==i)return null;let r=await yn.getOrCreate(t),s=this.fetchItems(t,r,t.showBlanks);if(null==s)return null;return this.fetchInitialValues(t,s).select(e=>fn.createEqualBasedOnValue(e.value,i,t)).toList()}static fetchInitialValues(e,r){if(!H.isNullOrEmpty(e.initialValue)){let i=this.getInitialValues(e),t=r[P.System.StiObject.stimulsoft]().toList().where(e=>{var t;return i.contains(null==(t=e.value)?void 0:t.toString())});if(e.selectionMode==pn.One&&t.any()){let e=new j;return e.add(t.firstOrDefault()),e}return t.toList()}let t=new j;return t.add(r[P.System.StiObject.stimulsoft]().toList().firstOrDefault()),t}static getInitialValues(e){if(H.isNullOrEmpty(e.initialValue))return new j;let t=k.parse2(e.initialValue,e.report);return t.split(";")[P.System.StiObject.stimulsoft]().toList().select(e=>e.trim()).toList()}static getNameMeterIndex(e){if(null==e)return-1;let t=e.meters.firstOrDefault(e=>e.is(R.P.StiNameListBoxMeter));return null!=t?e.meters.indexOf(t):-1}static getKeyMeterIndex(e){if(null==e)return-1;let t=e.meters.firstOrDefault(e=>e.is(R.P.StiKeyListBoxMeter));return null!=t?e.meters.indexOf(t):-1}static getKeyMeterExpression(e){if(null!=e.keyMeter)return e.keyMeter.expression;if(null!=e.nameMeter)return e.nameMeter.expression;return null}static format(e,t){var i;if(t instanceof F&&!(e.textFormat.is2(Ji)||e.textFormat.is2(Gi)||e.textFormat.is2(wn)))return t.toShortDateString();let r=null==(i=null==e?void 0:e.report)?void 0:i.culture;if(nr.isEligable(t,r))return nr.convert(t,r);return e.textFormat.format(t)}},R.P.StiListBoxItem=class{toString(){return null!=this.label?this.label:this.value.toString()}constructor(e,t=e){this.label=e,this.value=t}},P.Report.DecimalRange),go=P.Report.Dashboard.StiNumberSelectionMode,po=P.Report.Dashboard.StiNumberCondition,So=P.Report.Dashboard.StiNumberMinMaxMode,wo=(R.R.StiNumberBoxHelper=class{static getInitialValue(e){return this.isRange(e)?this.getRangeInitialValue(e):this.getSingleInitialValue(e)}static async getRangeInitialValue(e){let t=O.tryToNumber(k.parse2(e.initialValue,e.report)),i=O.tryToNumber(k.parse2(e.initialToValue,e.report)),r=await this.getMinMaxRange(e);return t=Math.max(t,r.from),t=Math.min(t,r.to),i=Math.max(i,r.from),i=Math.min(i,r.to),new co(t,i)}static async getSingleInitialValue(t){let e,i=null,r=null==(e=this.getVariableSpecifiedAsValue(t))?void 0:e.as(Js);if(null!=r){let e=t.report.dictionary.getVariableValueByName(r.name);r.initBy!=kn.Expression||H.isNullOrEmpty(e)||(e=En.parseTextValue(`{${e}}`,t)),P.System.Type.isNumericType(r.type)&&(i=O.tryToNullableNumber(e))}else H.isNullOrEmpty(t.initialValue)||(i=O.tryToNullableNumber(k.parse2(t.initialValue,t.report,!0)));let s=await this.getMinMaxRange(t);return i=null!=i?(i=Math.max(Gt.getValueOrDefault(i),s.from),Math.min(Gt.getValueOrDefault(i),s.to)):s.from,Gt.getValueOrDefault(i)}static async fetchDefaultUserFilters(e){let t=this.getValueMeterExpression(e);return e.selectionMode==go.Single?this.getSingleDefaultUserFilters(e,t):this.getRangeDefaultUserFilters(e,t)}static async getSingleDefaultUserFilters(e,t){let i=await this.getSingleInitialValue(e);return new y("",t,this.getCondition(e),e.textFormat.format(i)).toList()}static async getRangeDefaultUserFilters(e,t){let i=await this.getRangeInitialValue(e);return new y("",t,Ot.Between,e.textFormat.format(i.from),e.textFormat.format(i.to),!0,!1).toList()}static async getAutoRange(e){let t=this.getValueMeterExpression(e);if(!H.isNullOrEmpty(t)){let t=await yn.getOrCreate(e);if(null!=t){let e=t.rows.select(e=>e[0]).where(e=>null!=e&&P.System.Type.isNumericType(P.System.Type.getType(e))).select(e=>O.tryToNumber(e));if(null!=e&&e.any())return new co(e.min(),e.max())}}return new co(0,65535)}static getValueMeterExpression(e){var t;return null==(t=e.valueMeter)?void 0:t.expression}static getCondition(e){switch(e.condition){case po.EqualTo:return Ot.EqualTo;case po.NotEqualTo:return Ot.NotEqualTo;case po.GreaterThan:return Ot.GreaterThan;case po.GreaterThanOrEqualTo:return Ot.GreaterThanOrEqualTo;case po.LessThan:return Ot.LessThan;case po.LessThanOrEqualTo:return Ot.LessThanOrEqualTo;default:return Ot.EqualTo}}static getVariableSpecifiedAsValue(e){var t;return On.getVariableSpecifiedAsExpression(e,null==(t=e.getValueMeter())?void 0:t.expression)}static isRange(t){if(this.isVariableSpecifiedAsValue(t)){let e=this.getVariableSpecifiedAsValue(t).as(Js);return null!=e&&In.isNumericRangeType(e.type)}return t.selectionMode==go.Range}static isVariableSpecifiedAsValue(e){var t;return On.isVariableSpecifiedAsExpression(e,null==(t=e.getValueMeter())?void 0:t.expression)}static async getMinMaxRange(i){if(i.minMaxMode==So.Auto)return this.getAutoRange(i);{let e=0,t=(H.isNullOrWhiteSpace(i.min)||(e=O.tryToNumber(k.parse2(i.min,i.report,!0))),65535);return H.isNullOrWhiteSpace(i.max)||(t=O.tryToNumber(k.parse2(i.max,i.report,!0))),new co(e,t)}}},R.R.StiNumberBoxHelper),fo=P.Report.Dashboard.IStiNumberBoxElement,bo=P.Report.Dashboard.ImplementsIStiNumberBoxElement,yo=(ht.add("StiNumberBoxElement","Stimulsoft.Dashboard.Export.Tools.StiNumberBoxElementExportTool"),R.R.StiNumberBoxElement=class extends R.e.StiElement{implements(){let e=super.implements().concat([fo,Ue,Je,ii,st,Ii,...bo,...Ze,...Ge,...qt,...Cn,...Ti,n]);return(this.implements=()=>e)()}meta(){return[...super.meta(),new s("DataFilters").get(e=>a.Serialize.objectArray(this.dataFilters,e)).set(e=>this.dataFilters.addRange(e.value.properties().select(e=>y.loadFromJson(e.value)))).setXml(e=>this.dataFilters.addRange(e.childNodes.map(e=>y.loadFromXml(e)))),new i("ForeColor","",N.transparent),new l("Font").get(()=>a.Serialize.fontArial8(this.font)).set(e=>this.font=a.Deserialize.font(e.value,this.font)).setXml(e=>this.font=P.System.Convert.toFont(e.textContent)),new r("Condition","",po,po.GreaterThanOrEqualTo),new r("MinMaxMode","",So,So.Auto),new r("SelectionMode","",go,go.Single).set(e=>{let t=z.parse(go,e.value);null!=t&&(this.selectionMode=t)}).setXml(e=>{let t=z.parse(go,e.textContent);null!=t&&(this.selectionMode=t)}),new l("InitialValue"),new l("InitialToValue"),new l("Min"),new l("Max"),new ie("DecimalDigits","",0),new r("HorAlignment","",X,X.Center),new s("ValueMeter").check(()=>null!=this.valueMeter).set(e=>{let t=d.loadFromJson(e.value).as(Br);null!=t&&(this.valueMeter=t)}).setXml(e=>{let t=d.loadFromXml(e).as(Br);null!=t&&(this.valueMeter=t)}),new r("Style","",o,o.Auto),new l("Group"),new l("CustomStyleName"),new l("CornerRadius").get(()=>this.cornerRadius.toString()).set(e=>this.cornerRadius=v.tryParse(e.value.toString())).setXml(e=>this.cornerRadius=v.tryParse(e.textContent)),new l("Shadow").get(()=>a.Serialize.jShadow(this.shadow)).set(e=>this.shadow=a.Deserialize.simpleSahdow(e.value)).setXml(e=>this.shadow=We.loadFromXml(e.textContent)),new se("MinSize"),new se("MaxSize"),new r("InclusionMode","",q,q.SelectionOnly)]}clone(e){let t,i,r=super.clone(e);return r.valueMeter=null!=this.valueMeter?this.valueMeter.clone():null,r.userFilters=this.userFilters.select(e=>e.clone()).toList(),r.dataFilters=this.dataFilters.select(e=>e.clone()).toList(),r.shadow=null==(t=this.shadow)?void 0:t.clone(),r.cornerRadius=null==(i=this.cornerRadius)?void 0:i.clone(),r}getParentKey(){return null}setParentKey(e){}async applyDefaultFilters(){let e,r=null==(e=wo.getVariableSpecifiedAsValue(this))?void 0:e.as(Js);if(null==r){let e=await wo.fetchDefaultUserFilters(this);null!=e&&(this.userFilters=e)}else if(In.isRangeType(r.type)){let e=0,t=0,i=new P.Report.DecimalRange(e,t);Rn.setVariableValue(this.report,r,i),r.initBy==kn.Value&&(r.valueObject=i)}}getIdentityFilters(){let e=new y;return e.condition=Ot.Any,e.elementKey=this.key,e.path=wo.getValueMeterExpression(this),e.toList()}get style(){return this._style}set style(e){(this._style=e)!=o.Custom&&(this.customStyleName="")}fetchAllMeters(){let e=new j;return null!=this.valueMeter&&e.add(this.valueMeter),e}getMeters(){let e=new j;return e.add(this.valueMeter),e}retrieveUsedDataNames(){return rl.getMany(this.valueMeter)}get isDefined(){return null!=this.valueMeter}addValueMeter2(e){this.valueMeter=null!=e?c.NumberBox.getValue2(e):null}addValueMeter(e){this.valueMeter=null!=e?c.NumberBox.getValue(e.as(R.e.StiMeter)):null}getValueMeter(){return this.valueMeter}removeValueMeter(){this.valueMeter=null}createNewValueMeter(){this.valueMeter=new Br}convertFrom(e){let t=e.fetchAllMeters();if(null==t)return;let i=t.firstOrDefault(e=>e.is(ji));null!=(i=null==i?t.firstOrDefault(e=>e.is(vt)):i)&&(this.valueMeter=null==this.valueMeter?new Br:this.valueMeter,this.valueMeter.loadFromJsonObject(i.saveToJsonObject(Le.Report)))}get textFormat(){let e=new Wi;return e.decimalDigits=this.decimalDigits,e.state=P.Report.Components.StiTextFormatState.DecimalDigits,e}getFonts(){let e=super.getFonts();return e.push(this.font),e}get toolboxPosition(){return _e.NumberBoxElement}get localizedName(
){return T.get("Components","StiNumberBox")}getMinSize(){let e=null!=this.report?this.report.getCurrentPage():null;if(null==e)return W.empty;let t=Lt.alignToMaxGrid(this.defaultClientRectangle.height,e.gridSize,!0);return new W(0,t)}setMinSize(e){}getMaxSize(){let e=null!=this.report?this.report.getCurrentPage():null;if(null==e)return W.empty;let t=Lt.alignToMaxGrid(this.defaultClientRectangle.height,e.gridSize,!0);return new W(0,t)}setMaxSize(e){}constructor(e=L.empty){super(e),this.group="",this.isFixedHeight=!0,this.inclusionMode=q.SelectionOnly,this.userFilters=new j,this.dataFilters=new j,this._style=o.Auto,this.customStyleName="",this.font=new B("Arial",8),this.foreColor=N.transparent,this.shadow=new We,this.cornerRadius=new v(0),this.horAlignment=X.Center,this.defaultClientRectangle=new L(0,0,200,40),this.helpUrl="user-manual/dashboards_data_filtering_number_box.htm",this.decimalDigits=0,this.condition=po.GreaterThanOrEqualTo,this.selectionMode=go.Single,this.minMaxMode=So.Auto,this.initialValue="",this.initialToValue="",this.min="",this.max=""}},R.g.StiOnlineMapDashboardInteraction=class extends R.g.StiDashboardInteraction{implements(){let e=super.implements().concat([n,Ws]);return(this.implements=()=>e)()}meta(){return[...super.meta(),new h("ShowFullScreenButton","",!0),new h("ShowSaveButton","",!0),new h("ShowViewDataButton","",!0),new l("FileName"),new l("HeaderText"),new l("FooterText")]}get isDefaultLayout(){return this.showFullScreenButton&&this.showSaveButton&&this.showViewDataButton&&null==this.fileName&&null==this.headerText&&null==this.footerText}isDefault(){return this.isDefaultLayout}constructor(e,t,i,r,s,l){super(),this.ident=pi.OnlineMap,this.availableOnClick=Si.None,this.availableOnHover=wi.None,this.availableOnDataManipulation=fi.None,this.showFullScreenButton=!0,this.showSaveButton=!0,this.showViewDataButton=!0,this.fileName=null,this.headerText=null,this.footerText=null,null!=e&&(this.fileName=e),null!=t&&(this.headerText=t),null!=i&&(this.footerText=i),null!=r&&(this.showFullScreenButton=r),null!=s&&(this.showSaveButton=s),null!=l&&(this.showViewDataButton=l)}},P.Report.Dashboard.StiGeoMapProviderType),Co=R.g.StiOnlineMapDashboardInteraction,xo=P.Report.Dashboard.ImplementsIStiOnlineMapElement,vo=P.Report.Dashboard.IStiOnlineMapElement,Fo=P.Report.Dashboard.StiOnlineMapLocationType,To=P.Report.Dashboard.StiOnlineMapCulture,Mo=P.Report.Dashboard.StiOnlineMapLocationColorType,Ao=P.Report.Dashboard.StiOnlineMapValueViewMode,Do=(ht.add("StiOnlineMapElement","Stimulsoft.Dashboard.Export.Tools.StiOnlineMapElementExportTool"),R.O.StiOnlineMapElement=class extends R.e.StiElement{implements(){let e=super.implements().concat([vo,Ue,Je,Ie,el,Ci,ke,...xo,...Ze,...Ge,...il,...$s,n]);return(this.implements=()=>e)()}clone(e){let t,i,r=super.clone(e);return r.latitude=null!=this.latitude?this.latitude.clone():null,r.longitude=null!=this.longitude?this.longitude.clone():null,r.location=null!=this.location?this.location.clone():null,r.locationColorMeter=null!=this.locationColorMeter?this.locationColorMeter.clone():null,r.locationValue=null!=this.locationValue?this.locationValue.clone():null,r.locationArgument=null!=this.locationArgument?this.locationArgument.clone():null,r.transformActions=this.transformActions.select(e=>e.clone()).toList(),r.transformFilters=this.transformFilters.select(e=>e.clone()).toList(),r.transformSorts=this.transformSorts.select(e=>e.clone()).toList(),r.dataFilters=this.dataFilters.select(e=>e.clone()).toList(),r.title=null!=this.title?this.title.clone():null,r.layout=null!=this.layout?this.layout.clone():null,r.locationType=this.locationType,r.culture=this.culture,r.locationColorType=this.locationColorType,r.locationColor=this.locationColor,r.iconColor=this.iconColor,r.icon=this.icon,r.customIcon=null!=this.customIcon?to.fromBase64String(to.toBase64String(this.customIcon)):null,r.dashboardInteraction=this.dashboardInteraction.clone(),r.shadow=null==(t=this.shadow)?void 0:t.clone(),r.cornerRadius=null==(i=this.cornerRadius)?void 0:i.clone(),r.onePointZoom=this.onePointZoom,r.userBingKey=this.userBingKey,r.provider=this.provider,r}meta(){return[...super.meta(),new s("TransformActions").get(e=>a.Serialize.objectArray(this.transformActions,e)).set(e=>this.transformActions.addRange(e.value.properties().select(e=>nl.loadFromJson(e.value)))).setXml(e=>this.transformActions.addRange(e.childNodes.map(e=>nl.loadFromXml(e)))),new s("TransformFilters").get(e=>a.Serialize.objectArray(this.transformFilters,e)).set(e=>this.transformFilters.addRange(e.value.properties().select(e=>y.loadFromJson(e.value)))).setXml(e=>this.transformFilters.addRange(e.childNodes.map(e=>y.loadFromXml(e)))),new s("TransformSorts").get(e=>a.Serialize.objectArray(this.transformSorts,e)).set(e=>this.transformSorts.addRange(e.value.properties().select(e=>ll.loadFromJson(e.value)))).setXml(e=>this.transformSorts.addRange(e.childNodes.map(e=>ll.loadFromXml(e)))),new s("DataFilters").get(e=>a.Serialize.objectArray(this.dataFilters,e)).set(e=>this.dataFilters.addRange(e.value.properties().select(e=>y.loadFromJson(e.value)))).setXml(e=>this.dataFilters.addRange(e.childNodes.map(e=>y.loadFromXml(e)))),new s("Title").check(()=>null!=this.title).set(e=>this.title=R.e.StiTitle.createFromJsonObject(e.value)).setXml(e=>this.title=R.e.StiTitle.createFromXml(e)),new s("Layout").check(()=>null!=this.layout).set(e=>this.layout=tl.createFromJsonObject(e.value)).setXml(e=>this.layout=tl.createFromXml(e)),new s("Latitude").check(()=>null!=this.latitude).set(e=>this.latitude=d.loadFromJson(e.value).as(R.O.StiLatitudeMapMeter)).setXml(e=>this.latitude=d.loadFromXml(e).as(R.O.StiLatitudeMapMeter)),new s("Longitude").check(()=>null!=this.longitude).set(e=>this.longitude=d.loadFromJson(e.value).as(R.O.StiLongitudeMapMeter)).setXml(e=>this.longitude=d.loadFromXml(e).as(R.O.StiLongitudeMapMeter)),new s("Location").check(()=>null!=this.location).set(e=>this.location=d.loadFromJson(e.value).as(R.O.StiLocationMapMeter)).setXml(e=>this.location=d.loadFromXml(e).as(R.O.StiLocationMapMeter)),new s("LocationColorMeter").check(()=>null!=this.locationColorMeter).set(e=>this.locationColorMeter=d.loadFromJson(e.value).as(R.O.StiLocationColorMapMeter)).setXml(e=>this.locationColorMeter=d.loadFromXml(e).as(R.O.StiLocationColorMapMeter)),new s("LocationArgument").check(()=>null!=this.locationArgument).set(e=>this.locationArgument=d.loadFromJson(e.value).as(R.O.StiLocationArgumentMapMeter)).setXml(e=>this.locationArgument=d.loadFromXml(e).as(R.O.StiLocationArgumentMapMeter)),new s("LocationValue").check(()=>null!=this.locationValue).set(e=>this.locationValue=d.loadFromJson(e.value).as(R.O.StiLocationValueMapMeter)).setXml(e=>this.locationValue=d.loadFromXml(e).as(R.O.StiLocationValueMapMeter)),new l("Group"),new r("Culture","",To).set(e=>this.culture=z.parse(To,e.value,!1)).setXml(e=>this.culture=z.parse(To,e.textContent,!1)),new r("LocationType","",Fo),new i("LocationColor","",N.limeGreen),new r("LocationColorType","",Mo),new r("ValueViewMode","",Ao),new r("Provider","",yo),new r("Icon","",Et),new i("IconColor","",N.limeGreen),new h("CrossFiltering","",!0),new l("CornerRadius").get(()=>this.cornerRadius.toString()).set(e=>this.cornerRadius=v.tryParse(e.value.toString())).setXml(e=>this.cornerRadius=v.tryParse(e.textContent)),new l("Shadow").get(()=>a.Serialize.jShadow(this.shadow)).set(e=>this.shadow=a.Deserialize.simpleSahdow(e.value)).setXml(e=>this.shadow=We.loadFromXml(e.textContent)),new re("CustomIcon").check(()=>null!=this.customIcon).get(()=>to.toBase64String(this.customIcon)).set(e=>this.customIcon=to.fromBase64String(e.value.toString())).setXml(e=>this.customIcon=to.fromBase64String(e.textContent)),new s("DashboardInteraction").check(()=>null!=this.dashboardInteraction.as(Co)).set(e=>{let t,i=null==(t=bi.loadInteractionFromJsonObject(e.value))?void 0:t.as(Co);null!=i&&(this.dashboardInteraction=i)}).setXml(e=>{let t,i=null==(t=bi.loadInteractionFromXml(e))?void 0:t.as(Co);null!=i&&(this.dashboardInteraction=i)}),new ie("OnePointZoom","",1),new re("UserBingKey","")]}fetchAllMeters(){let e=new j;return null!=this.latitude&&e.add(this.latitude),null!=this.longitude&&e.add(this.longitude),null!=this.location&&e.add(this.location),null!=this.locationColorMeter&&e.add(this.locationColorMeter),null!=this.locationValue&&e.add(this.locationValue),null!=this.locationArgument&&e.add(this.locationArgument),e}getMeters(){let e=new j;return this.isDefined&&(null!=this.latitude&&e.add(this.latitude),null!=this.longitude&&e.add(this.longitude),null!=this.location&&e.add(this.location),null!=this.locationColorMeter&&e.add(this.locationColorMeter),null!=this.locationValue&&e.add(this.locationValue),null!=this.locationArgument)&&e.add(this.locationArgument),e}retrieveUsedDataNames(){let e=new j;return e.addRange(rl.getMany(this.latitude)),e.addRange(rl.getMany(this.longitude)),e.addRange(rl.getMany(this.location)),e.addRange(rl.getMany(this.locationColorMeter)),e.addRange(rl.getMany(this.locationValue)),e.addRange(rl.getMany(this.locationArgument)),e.distinct().toList()}get isDefined(){return null!=this.latitude||null!=this.longitude||null!=Location||null!=this.locationValue||null!=this.locationColorMeter||null!=this.locationArgument}createNextMeter(e){this.location=c.OnlineMap.getLocation2(e)}addLatitudeMeter2(e){this.latitude=null!=e?c.OnlineMap.getLatitude2(e):null}addLatitudeMeter(e){this.latitude=null!=e?c.OnlineMap.getLatitude(e.as(R.e.StiMeter)):null}getLatitudeMeter(){return this.latitude}removeLatitudeMeter(){this.latitude=null}createNewLatitudeMeter(){this.latitude=new R.O.StiLatitudeMapMeter}addLongitudeMeter2(e){this.longitude=null!=e?c.OnlineMap.getLongitude2(e):null}addLongitudeMeter(e){this.longitude=null!=e?c.OnlineMap.getLongitude(e.as(R.e.StiMeter)):null}getLongitudeMeter(){return this.longitude}removeLongitudeMeter(){this.longitude=null}createNewLongitudeMeter(){this.longitude=new R.O.StiLongitudeMapMeter}addLocationMeter2(e){this.location=null!=e?c.OnlineMap.getLocation2(e):null}addLocationMeter(e){this.location=null!=e?c.OnlineMap.getLocation(e):null}getLocationMeter(){return this.location}removeLocationMeter(){this.location=null}createNewLocationMeter(){this.location=new R.O.StiLocationMapMeter}addLocationColorMeter2(e){this.locationColorMeter=null!=e?c.OnlineMap.getLocationColor2(e):null}addLocationColorMeter(e){this.locationColorMeter=null!=e?c.OnlineMap.getLocationColor(e.as(R.e.StiMeter)):null}getLocationColorMeter(){return this.locationColorMeter}removeLocationColorMeter(){this.locationColor=null}createNewLocationColorMeter(){this.locationColorMeter=new R.O.StiLocationColorMapMeter}addLocationValueMeter2(e){this.locationValue=null!=e?c.OnlineMap.getLocationValue2(e):null}addLocationValueMeter(e){this.locationValue=null!=e?c.OnlineMap.getLocationValue(e.as(R.e.StiMeter)):null}getLocationValueMeter(){return this.locationValue}removeLocationValueMeter(){this.locationValue=null}createNewLocationValueMeter(){this.locationValue=new R.O.StiLocationValueMapMeter}addLocationArgumentMeter(e){this.locationArgument=null!=e?c.OnlineMap.getLocationArgument2(e):null}addLocationArgumentMeter2(e){this.locationArgument=null!=e?c.OnlineMap.getLocationArgument(e):null}getLocationArgumentMeter(){return this.locationArgument}removeLocationArgumentMeter(){this.locationArgument=null}createNewLocationArgumentMeter(){this.locationArgument=new R.O.StiLocationArgumentMapMeter}convertFrom(e){let t=e.as(R.L.StiRegionMapElement);null==t||null==t.keyMeter||t.keyMeter.isDefault()||(this.location=new R.O.StiLocationMapMeter,this.location.label=t.keyMeter.label,this.location.expression=t.keyMeter.expression),null==this.dashboardInteraction&&(this.dashboardInteraction=new Co)}setString(e,t){switch(e){case"Title.Text":this.title.text=t;break}}getString(e){switch(e){case"Title.Text":return this.title.text}throw new Error(`Property with name `+e)}getAllStrings(){return["Title.Text"]}get toolboxPosition(){return _e.OnlineMapElement}get localizedName(){return T.get("Components","StiOnlineMap")}get onePointZoom(){return this._onePointZoom}set onePointZoom(e){this._onePointZoom=Math.max(Math.min(e,20),1)}constructor(e=L.empty){super(e),this.group="",this.title=new R.e.StiTitle,this.layout=new tl,this.transformActions=new j,this.transformFilters=new j,this.transformSorts=new j,this.dataTransformation={},this.dataFilters=new j,this.shadow=new We,this.cornerRadius=new v(0),this.helpUrl="user-manual/dashboards_maps_online_map.htm",this._onePointZoom=1,this.userBingKey="",this.locationType=Fo.Auto,this.culture=To.en_US,this.locationColorType=Mo.Single,this.valueViewMode=Ao.Bubble,this.locationColor=N.limeGreen,this.icon=Et.MapMarker,this.iconColor=N.maroon,this.crossFiltering=!0,this.provider=yo.OpenStreetMap,this.title.text=this.localizedName,this.dashboardInteraction=new Co}},P.Report.Dashboard.IStiTableCells);{class fu{implements(){let e=[Do,Rt,n,oi];return(this.implements=()=>e)()}meta(){return[new s("Columns").check(()=>null!=this.columns&&!this.columns.isDefault()).get(()=>this.columns.saveToJsonObject(Le.Report)).set(e=>this.columns=R.K.StiTableSection.createFromJsonObject(e.value)).setXml(e=>this.columns=R.K.StiTableSection.createFromXml(e)),new s("Data").check(()=>null!=this.data&&!this.data.isDefault()).get(()=>this.data.saveToJsonObject(Le.Report)).set(e=>this.data=R.K.StiTableSection.createFromJsonObject(e.value)).setXml(e=>this.data=R.K.StiTableSection.createFromXml(e)),new s("Totals").check(()=>null!=this.totals&&!this.totals.isDefault()).get(()=>this.totals.saveToJsonObject(Le.Report)).set(e=>this.totals=R.K.StiTableSection.createFromJsonObject(e.value)).setXml(e=>this.totals=R.K.StiTableSection.createFromXml(e))]}saveToJsonObject(e){return u.saveToJsonObject(e,this)}loadFromJsonObject(e){u.loadFromJsonObject(e,this)}loadFromXml(e){u.loadFromXml(e,this)}static createFromJsonObject(e){let t=new fu;return t.loadFromJsonObject(e),t}static createFromXml(e){let t=new fu;return t.loadFromXml(e),t}clone(){let e,t,i,r=this[P.System.StiObject.stimulsoft]().memberwiseClone();return r.columns=null==(e=this.columns)?void 0:e.clone(),r.data=null==(t=this.data)?void 0:t.clone(),r.totals=null==(i=this.totals)?void 0:i.clone(),r}isDefault(){return!this.shouldSerializeColumns()&&!this.shouldSerializeData()&&!this.shouldSerializeTotals()}getFonts(){let e=[];return e.push(this.columns.font),e.push(this.data.font),e.push(this.totals.font),e}getColumns(){return this.columns}getData(){return this.data}getTotals(){return this.totals}get columns(){return this._columns}set columns(e){this._columns!=e&&null!=(this._columns=e)&&(e.element=this.element)}shouldSerializeColumns(){return null==this.columns||!this.columns.isDefault()}get data(){return this._data}set data(e){this._data!=e&&null!=(this._data=e)&&(e.element=this.element)}shouldSerializeData(){return null==this.data||!this.data.isDefault()}get totals(){return this._totals}set totals(e){this._totals!=e&&null!=(this._totals=e)&&(e.element=this.element)}shouldSerializeTotals(){return null==this.totals||!this.totals.isDefault()}get element(){return this.getElement()}set element(e){this.setElement(e)}getElement(){return this._element}setElement(e){this._element!=e&&(this._element=e,this.columns.element=e,this.totals.element=e,this.data.element=e)}constructor(){this.columns=new R.K.StiTableSection,this.data=new R.K.StiTableSection,this.totals=new R.K.StiTableSection}}R.K.StiTableCells=fu}let Io=P.Report.Dashboard.IStiPivotTableCells;{class ko extends R.K.StiTableCells{implements(){let e=[Io,Rt,n,oi];return(this.implements=()=>e)()}meta(){return[...super.meta(),new s("Rows").check(()=>null!=this.rows&&!this.rows.isDefault()).get(()=>this.rows.saveToJsonObject(Le.Report)).set(e=>this.rows=R.K.StiTableSection.createFromJsonObject(e.value)).setXml(e=>this.rows=R.K.StiTableSection.createFromXml(e))]}saveToJsonObject(e){let t=super.saveToJsonObject(e);return u.saveToJsonObject(e,this,t)}loadFromJsonObject(e){super.loadFromJsonObject(e),u.loadFromJsonObject(e,this)}loadFromXml(e){super.loadFromXml(e),u.loadFromXml(e,this)}static createFromJsonObject(e){let t=new ko;return t.loadFromJsonObject(e),t}static createFromXml(e){let t=new ko;return t.loadFromXml(e),t}clone(){let e,t=super.clone();return t.rows=null==(e=this.rows)?void 0:e.clone(),t}isDefault(){return super.isDefault()&&!this.shouldSerializeRows()}getFonts(){let e=super.getFonts();return e.push(this.rows.font),e}getRows(){return this.rows}get rows(){return this._rows}set rows(e){this._rows!=e&&null!=(this._rows=e)&&(e.element=this.element)}shouldSerializeRows(){return null==this.rows||!this.rows.isDefault()}setElement(e){super.getElement()!=e&&(super.setElement(e),this.rows.element=e)}constructor(){super(),this.rows=new R.K.StiTableSection}}R.K.StiPivotTableCells=ko}R.N.StiPivotTableColumnVisibilityHelper=class{static getVisible(e,t){if(e.visibility==zi.True)return!0;if(e.visibility==zi.False)return!1;if(H.isNullOrWhiteSpace(e.visibilityExpression))return!1;let i=k.parse2(e.visibilityExpression,t);return O.tryToBool(i)}};let Ro=P.System.Collections.Hashtable;{class Lo{static getSelected(e){let t=this.hash.get(e.key);if(null==t)return null;return t.keys.toList()}static getSelectedObjects(e){let t=this.getSelected(e);return null!=t?t.toList():null}static isSelected(e,t){let i=this.hash.get(e.key);return null==i&&(i=new Ro,this.hash.set(e.key,i)),null!=i.get(t)}static select(e,t){let i=this.hash.get(e.key);null==i&&(i=new Ro,this.hash.set(e.key,i)),i.set(t,t)}static resetSelection(e){this.hash.containsKey(e.key)&&this.hash.remove(e.key)}}Lo.hash=new Ro,R.h.StiPivotTableElementSelection=Lo}let Eo=P.Report.Dashboard.IStiInteractionPivotLayout,ko=(R.g.StiPivotTableDashboardInteraction=class extends R.g.StiDashboardInteraction{implements(){let e=super.implements().concat([n,Ws,Eo]);return(this.implements=()=>e)()}meta(){return[...super.meta(),new h("ShowFullScreenButton","",!0),new h("ShowSaveButton","",!0),new h("ShowViewDataButton","",!0),new h("ShowExpandAllButton","",!0),new h("ShowCollapseAllButton","",!0),new l("FileName"),new l("HeaderText"),new l("FooterText")]}get isDefaultLayout(){return this.showFullScreenButton&&this.showSaveButton&&this.showViewDataButton&&this.showExpandAllButton&&this.showCollapseAllButton&&null==this.fileName&&null==this.headerText&&null==this.footerText}isDefault(){return this.isDefaultLayout}constructor(e,t,i,r,s,l,n,a){super(),this.ident=pi.PivotTable,this.availableOnClick=Si.None,this.availableOnHover=wi.None,this.availableOnDataManipulation=fi.None,this.showFullScreenButton=!0,this.showSaveButton=!0,this.showViewDataButton=!0,this.showExpandAllButton=!0,this.showCollapseAllButton=!0,this.fileName=null,this.headerText=null,this.footerText=null,null!=e&&(this.fileName=e),null!=t&&(this.headerText=t),null!=i&&(this.footerText=i),null!=r&&(this.showFullScreenButton=r),null!=s&&(this.showSaveButton=s),null!=l&&(this.showViewDataButton=l),null!=n&&(this.showExpandAllButton=n),null!=a&&(this.showCollapseAllButton=a)}},R.K.StiPivotTableCells),Oo=P.Report.CrossTab.Core.StiSummaryDirection,Vo=R.g.StiPivotTableDashboardInteraction,No=P.Report.Dashboard.ImplementsIStiPivotTableElement,Lo=R.h.StiPivotTableElementSelection,Bo=P.Report.Dashboard.IStiPivotTableElement,Po=P.Report.Engine.StiParserParameters,Ho=P.Report.Components.StiText,jo=P.Report.Engine.StiAsmCommandType,zo=(ht.add("StiPivotTableElement","Stimulsoft.Dashboard.Export.Tools.StiPivotTableElementExportTool"),R.N.StiPivotTableElement=class extends R.e.StiElement{implements(){let e=super.implements().concat([Bo,Ue,Je,Ie,el,Ci,ke,...No,...Ze,...Ge,...il,...$s,n]);return(this.implements=()=>e)()}clone(e){let t,i,r=super.clone(e),s={};return r.columns=this.columns.select(e=>this.cloneMeter(e,s)).toList(),r.rows=this.rows.select(e=>this.cloneMeter(e,s)).toList(),r.summaries=this.summaries.select(e=>this.cloneMeter(e,s)).toList(),r.transformActions=this.transformActions.select(e=>e.clone()).toList(),r.transformFilters=this.transformFilters.select(e=>e.clone()).toList(),r.transformSorts=this.transformSorts.select(e=>e.clone()).toList(),r.dataFilters=this.dataFilters.select(e=>e.clone()).toList(),r.cells=this.cells.clone(),r.title=null!=this.title?this.title.clone():null,r.layout=null!=this.layout?this.layout.clone():null,r.dashboardInteraction=this.dashboardInteraction.clone(),r.pivotTableConditions=this.pivotTableConditions.select(e=>e.clone()).toList(),r.totalLabel=this.totalLabel,r.shadow=null==(t=this.shadow)?void 0:t.clone(),r.cornerRadius=null==(i=this.cornerRadius)?void 0:i.clone(),r.pivotTableConditions.forEach(e=>{e.destinationValueMeter=this.findKey(e.destinationValueMeter,s),e.keyValueMeter=this.findKey(e.keyValueMeter,s),e.measureField=this.findKey(e.measureField,s)}),r}meta(){return[...super.meta(),new s("TransformActions").get(e=>a.Serialize.objectArray(this.transformActions,e)).set(e=>this.transformActions.addRange(e.value.properties().select(e=>nl.loadFromJson(e.value)))).setXml(e=>this.transformActions.addRange(e.childNodes.map(e=>nl.loadFromXml(e)))),new s("TransformFilters").get(e=>a.Serialize.objectArray(this.transformFilters,e)).set(e=>this.transformFilters.addRange(e.value.properties().select(e=>y.loadFromJson(e.value)))).setXml(e=>this.transformFilters.addRange(e.childNodes.map(e=>y.loadFromXml(e)))),new s("TransformSorts").get(e=>a.Serialize.objectArray(this.transformSorts,e)).set(e=>this.transformSorts.addRange(e.value.properties().select(e=>ll.loadFromJson(e.value)))).setXml(e=>this.transformSorts.addRange(e.childNodes.map(e=>ll.loadFromXml(e)))),new s("DataFilters").get(e=>a.Serialize.objectArray(this.dataFilters,e)).set(e=>this.dataFilters.addRange(e.value.properties().select(e=>y.loadFromJson(e.value)))).setXml(e=>this.dataFilters.addRange(e.childNodes.map(e=>y.loadFromXml(e)))),new s("Cells").check(()=>null!=this.cells&&!this.cells.isDefault()).get(()=>this.cells.saveToJsonObject(Le.Report)).set(e=>this.cells=ko.createFromJsonObject(e.value)).setXml(e=>this.cells=ko.createFromXml(e)),new s("Columns").get(e=>a.Serialize.objectArray(this.columns,e)).set(e=>this.columns.addRange(e.value.properties().select(e=>d.loadFromJson(e.value).as(Ss)).where(e=>null!=e))).setXml(e=>this.columns.addRange(e.childNodes.map(e=>d.loadFromXml(e)))),new s("Rows").get(e=>a.Serialize.objectArray(this.rows,e)).set(e=>this.rows.addRange(e.value.properties().select(e=>d.loadFromJson(e.value).as(R.N.StiPivotRow)).where(e=>null!=e))).setXml(e=>this.rows.addRange(e.childNodes.map(e=>d.loadFromXml(e)))),new s("Summaries").get(e=>a.Serialize.objectArray(this.summaries,e)).set(e=>this.summaries.addRange(e.value.properties().select(e=>d.loadFromJson(e.value).as(fs)).where(e=>null!=e))).setXml(e=>this.summaries.addRange(e.childNodes.map(e=>d.loadFromXml(e)))),new h("CrossFiltering","",!0),new i("ForeColor","",N.transparent),new s("Title").check(()=>null!=this.title).set(e=>this.title=R.e.StiTitle.createFromJsonObject(e.value)).setXml(e=>this.title=R.e.StiTitle.createFromXml(e)),new s("Layout").check(()=>null!=this.layout).set(e=>this.layout=tl.createFromJsonObject(e.value)).setXml(e=>this.layout=tl.createFromXml(e)),new r("Style","",o,o.Auto),new l("Group"),new l("CustomStyleName"),new l("TotalLabel"),new s("PivotTableConditions").get(e=>a.Serialize.objectArray(this.pivotTableConditions,e)).set(e=>this.pivotTableConditions.addRange(e.value.properties().select(e=>R.N.StiPivotTableElementCondition.loadFromJson(e.value).as(R.N.StiPivotTableElementCondition)).where(e=>null!=e))).setXml(e=>this.pivotTableConditions.addRange(e.childNodes.map(e=>R.N.StiPivotTableElementCondition.loadFromXml(e)))),new r("SummaryDirection","",Oo,Oo.UpToDown),new l("CornerRadius").get(()=>this.cornerRadius.toString()).set(e=>this.cornerRadius=v.tryParse(e.value.toString())).setXml(e=>this.cornerRadius=v.tryParse(e.textContent)),new l("Shadow").get(()=>a.Serialize.jShadow(this.shadow)).set(e=>this.shadow=a.Deserialize.simpleSahdow(e.value)).setXml(e=>this.shadow=We.loadFromXml(e.textContent)),new s("DashboardInteraction").check(()=>null!=this.dashboardInteraction.as(Vo)).set(e=>{let t,i=null==(t=bi.loadInteractionFromJsonObject(e.value))?void 0:t.as(Vo);null!=i&&(this.dashboardInteraction=i)}).setXml(e=>{let t,i=null==(t=bi.loadInteractionFromXml(e))?void 0:t.as(Vo);null!=i&&(this.dashboardInteraction=i)})]}retrieveUsedDataNames(){let e=rl.getMany2(this.columns);return e.addRange(rl.getMany2(this.rows)),e.addRange(rl.getMany2(this.summaries)),e}fetchAllMeters(){let e=this.columns.cast();return e.addRange(this.rows.cast()),e.addRange(this.summaries.cast()),e}getMeters(){let e=this.columns.cast();return e.addRange(this.rows.cast()),e.addRange(this.summaries.cast()),e}getUsedMeters(){let i=this.getMeters();try{this.summaries.forEach(e=>{let t=this.getPushCommands(e.expression);1<t.length&&t.forEach(e=>{let t=new fs(de.generateKey(),e,"label");i.add(t)})})}catch(e){}return i}get isDefined(){return null!=this.columns&&0<this.columns.length||null!=this.rows&&0<this.rows.length||null!=this.summaries&&0<this.summaries.length}get style(){return this._style}set style(e){(this._style=e)!=o.Custom&&(this.customStyleName="")}createNextMeter(e){0==this.columns.length?this.columns.add(c.Pivot.getColumn2(e)):0==this.rows.length?this.rows.add(c.Pivot.getRow2(e)):0==this.summaries.length?this.summaries.add(c.Pivot.getSummary2(e)):this.columns.add(c.Pivot.getColumn2(e))}createNewColumn(){this.columns.add(new Ss)}getColumn2(e){return null!=e?c.Pivot.getColumn2(e):null}getColumn(e){return null!=e?c.Pivot.getColumn(e.as(R.e.StiMeter)):null}getColumnByIndex(e){return e<this.columns.length?this.columns[e]:null}insertColumn(e,t){let i=t.as(Ss);null!=i&&(0<=e&&e<this.columns.length?this.columns.insert(e,i):this.columns.add(i))}removeColumn(e){e<this.columns.length&&this.columns.removeAt(e)}removeAllColumns(){this.columns.clear()}createNewRow(){this.rows.add(new R.N.StiPivotRow)}getRow2(e){return null!=e?c.Pivot.getRow2(e):null}getRow(e){return null!=e?c.Pivot.getRow(e.as(R.e.StiMeter)):null}getRowByIndex(e){return e<this.rows.length?this.rows[e]:null}insertRow(e,t){let i=t.as(R.N.StiPivotRow);null!=i&&(0<=e&&e<this.rows.length?this.rows.insert(e,i):this.rows.add(i))}removeRow(e){e<this.rows.length&&this.rows.removeAt(e)}removeAllRows(){this.rows.clear()}createNewSummary(){let e=new fs;e.expression="Sum()",this.summaries.add(e)}getSummary2(e){return null!=e?c.Pivot.getSummary2(e):null}getSummary(e){return null!=e?c.Pivot.getSummary(e.as(R.e.StiMeter)):null}getSummaryByIndex(e){return e<this.summaries.length?this.summaries[e]:null}insertSummary(e,t){let i=t.as(fs);null!=i&&(0<=e&&e<this.summaries.length?this.summaries.insert(e,i):this.summaries.add(i))}removeSummary(e){e<this.summaries.length&&this.summaries.removeAt(e)}removeAllSummaries(){this.summaries.clear()}addPivotTableCondition(e,t,i,r,s,l,n,a,o,u,h,m,c,d,g,p,S,w,f,b){this.pivotTableConditions.add(new R.N.StiPivotTableElementCondition(e,t,i,r,s,l,n,a,o,u,h,m,c,d,g,p,S,w,f,b))}getAllMeters(){let e=new j;return e.addRange(this.columns),e.addRange(this.rows),e.addRange(this.summaries),e}fetchPivotTableConditions(){let e=new j;return null!=this.pivotTableConditions&&e.addRange(this.pivotTableConditions),e}clearPivotTableConditions(){this.pivotTableConditions.clear()}getFonts(){let e=super.getFonts();return e.push(this.title.font),e=e.concat(this.cells.getFonts())}convertFrom(e){let t=e.fetchAllMeters();if(this.columns.clear(),this.rows.clear(),this.summaries.clear(),null==t)return;let i=0;t.cast().forEach(t=>{if(t.is2(Pe))if(0==(1&i)){let e=new Ss;e.loadFromJsonObject(t.saveToJsonObject(Le.Report)),this.columns.add(e)}else{let e=new R.N.StiPivotRow;e.loadFromJsonObject(t.saveToJsonObject(Le.Report)),this.rows.add(e)}else if(t.is2(vt)){let e=new fs;e.loadFromJsonObject(t.saveToJsonObject(Le.Report)),this.summaries.add(e)}},this),null==this.dashboardInteraction&&(this.dashboardInteraction=new Vo)}setString(i,r){switch(i){case"Title.Text":this.title.text=r;break;case"TotalLabel":this.totalLabel=r;break}let s=0;for(let t of this.columns){let e=`Column${s++}.Label`;i==e&&(t.label=r)}s=0;for(let t of this.rows){let e=`Row${s++}.Label`;i==e&&(t.label=r)}}cloneMeter(e,t){let i=e.clone();return t[e.key]=i.key,i}findKey(e,t){return!H.isNullOrEmpty(e)&&e in t?t[e]:e}getString(i){switch(i){case"Title.Text":return this.title.text;case"TotalLabel":return this.totalLabel}let r=0;for(let t of this.columns){let e=`Column${r++}.Label`;if(i==e)return t.label}r=0;for(let t of this.rows){let e=`Row${r++}.Label`;if(i==e)return t.label}throw new Error(`Property with name `+i)}getAllStrings(){let t=["Title.Text","TotalLabel"],i=0;return this.columns.forEach(e=>t.push(`Column${i++}.Label`)),i=0,this.rows.forEach(e=>t.push(`Row${i++}.Label`)),t}getCells(){return this.cells}get toolboxPosition(){return _e.PivotTableElement}get localizedName(){return b.get("Components","StiPivotTable")}get foreColor(){return this.cells.data.foreColor}set foreColor(e){this.cells.data.foreColor=e}get cells(){return this._cells}set cells(e){null!=e&&(e.element=this),this._cells=e}shouldSerializeCells(){return null==this.cells||!this.cells.isDefault()}getColumnFont(){return U.getElementFontFromStyle(this,this.cells.columns.font)}getRowFont(){return U.getElementFontFromStyle(this,this.cells.rows.font)}getDataFont(){return U.getElementFontFromStyle(this,this.cells.data.font)}getTotalFont(){return U.getElementFontFromStyle(this,this.cells.totals.font)}getFormatObjects(){return Lo.getSelectedObjects(this)}getNestedPages(){let e,r,s=new j,t=new j;t.add(this),t.addRange(this.columns),t.addRange(this.rows),t.addRange(this.summaries);for(let i of t)if(null!=(null==i?void 0:i.dashboardInteraction)&&i.dashboardInteraction.onClick==di.ShowDashboard&&de.isKey(null==(e=i.dashboardInteraction)?void 0:e.drillDownPageKey)){let t=null==(r=i.dashboardInteraction)?void 0:r.drillDownPageKey,e=this.report.pages.toList().firstOrDefault(e=>e.guid==t);null!=e&&s.add(e)}return 0==s.length?null:s.distinct()}getPushCommands(e){let t=new Te,i=(t.report=this.report,new Po),r=(i.returnAsmList=!0,new Ho),s=(r.report=this.report,r.page=t,new j),l=[];try{l=En.parseTextValue2(`{${e}}`,r,null,i)}catch(e){}let n=0;while(n<l.length){try{l[n].type==jo.PushValue&&n+1<l.length&&l[n+1].type==jo.PushFunction&&s.add(`${z.getName(P.Report.Engine.StiFunctionType,l[n+1].parameter1)}(${l[n].parameter1[0].parameter1})`)}catch(e){}n++}return s}constructor(e=L.empty){super(e),this.maxIconSize=50,this.shadow=new We,this.cornerRadius=new v(0),this.group="",this.title=new R.e.StiTitle,this.layout=new tl,this.transformActions=new j,this.transformFilters=new j,this.transformSorts=new j,this.dataTransformation={},this.dataFilters=new j,this.crossFiltering=!0,this._style=o.Auto,this.customStyleName="",this.summaryDirection=Oo.UpToDown,this.helpUrl="user-manual/dashboards_pivot_table.htm",this.columns=new j,this.rows=new j,this.summaries=new j,this.totalLabel="",this.pivotTableConditions=new j,this.cells=new ko,this.title.text=this.localizedName,this.dashboardInteraction=new Vo}},P.Report.Dashboard.StiPivotTableConditionType),Xo=P.Data.Engine.StiDataTopNMode,Go=P.Report.Components.StiConditionPermissions,Jo=P.Base.StiScale,Wo=P.Report.Dashboard.IStiPivotTableElementCondition;{let y=R.a.StiFilterDataType,C=R.a.StiFilterCondition;class cp{implements(){let e=[Wo,n];return(this.implements=()=>e)()}is(e){if(e instanceof P.System.Interface)return-1!=this.implements().indexOf(e);if("function"==typeof e)return this instanceof e;if(null==e)throw new Error("Type for comparison is 'undefined'");return!1}is2(e){return this.is(e)}as(e){if(this.is(e))return this;return null}clone(){let e=this.saveToJsonObject(null),t=new cp;return t.loadFromJsonObject(e),t}meta(){return[new re("Ident").get(()=>"StiPivotTableElementCondition"),new l("KeyValueMeter"),new l("DestinationValueMeter"),new r("Condition","",C),new r("DataType","",y),new l("Value"),new i("TextColor","",N.black),new i("BackColor","",N.transparent),new At("Font"),new r("Permissions","",Go),new r("IconAlignment","",G),new i("IconColor","",N.maroon),new r("Icon","",Et),new re("CustomIcon").check(()=>null!=this.customIcon).get(()=>to.toBase64String(this.customIcon)).set(e=>this.customIcon=to.fromBase64String(e.value.toString())).setXml(e=>this.customIcon=to.fromBase64String(e.textContent)),new r("ConditionType","",zo),new r("TopNMode","",Xo),new ie("TopNCount"),new l("MeasureField"),new h("TopNConditionCell"),new h("TopNConditionHeader"),new h("TopNConditionTotal","",!0)]}saveToJsonObject(e){return u.saveToJsonObject(e,this)}loadFromJsonObject(e){u.loadFromJsonObject(e,this)}loadFromXml(e){u.loadFromXml(e,this)}static loadFromJson(e){let t=new cp;return t.loadFromJsonObject(e),t}static loadFromXml(e){let t=new cp;return t.loadFromXml(e),t}get iconFontSize(){return 18*Jo.factor}get customIcon(){return this._customIcon}set customIcon(e){this._customIcon=e,this._iconSize=null}get destinationValueMeter(){return H.isNullOrEmpty(this._destinationValueMeter)?this.keyValueMeter:this._destinationValueMeter}set destinationValueMeter(e){this._destinationValueMeter=e}get iconSize(){try{if(null==this._iconSize&&null!=this.customIcon){let e=new ja;e.bytes=this.customIcon,this._iconSize=new W(e.width,e.height)}else null==this._iconSize&&(this._iconSize=new W(this.iconFontSize,this.iconFontSize))}catch(e){}return this._iconSize}async getIcon(){if(null!=this.customIcon)return this.customIcon;{let e=await Wa.convertFontIconToImageAsync(this.icon,this.iconColor,this.iconFontSize,this.iconFontSize,"0.9em");return e.bytes}}getUniqueCode(){return 0}constructor(e,t,i,r,s,l,n,a,o,u,h,m,c,d,g,p,S,w,f,b){this.textColor=N.black,this.backColor=N.transparent,this.font=new B("Arial",8),this.permissions=Go.All,this.icon=Et.Adjust,this.iconAlignment=G.None,this.condition=C.EqualTo,this.dataType=y.Numeric,this._destinationValueMeter="",this.iconColor=N.maroon,this.conditionType=zo.Condition,this.topNMode=Xo.Top,this.topNCount=5,this.topNConditionCell=!1,this.topNConditionHeader=!1,this.topNConditionTotal=!0,null!=e&&(this.keyValueMeter=e),null!=t&&(this.destinationValueMeter=t),null!=i&&(this.dataType=i),null!=r&&(this.condition=r),null!=s&&(this.value=s),null!=l&&(this.font=l),null!=n&&(this.textColor=n),null!=a&&(this.backColor=a),null!=o&&(this.permissions=o),null!=u&&(this.icon=u),null!=h&&(this.iconAlignment=h),null!=m&&(this.customIcon=m),null!=c&&(this.iconColor=c),null!=d&&(this.conditionType=d),null!=g&&(this.topNMode=g),null!=p&&(this.topNCount=p),null!=S&&(this.measureField=S),null!=w&&(this.topNConditionCell=w),null!=f&&(this.topNConditionHeader=f),null!=b&&(this.topNConditionTotal=b)}}R.N.StiPivotTableElementCondition=cp}R.ac.StiPivotColumnConverter=class extends cn{},R.ac.StiPivotRowConverter=class extends cn{},R.ac.StiPivotSummaryConverter=class extends cn{},R.g.StiProgressDashboardInteraction=class extends R.g.StiDashboardInteraction{implements(){let e=super.implements().concat([Rl,Il,n,Ws]);return(this.implements=()=>e)()}meta(){return[...super.meta(),new h("AllowUserDrillDown"),new h("AllowUserSorting","",!0),new h("ShowFullScreenButton","",!0),new h("ShowSaveButton","",!0),new h("ShowViewDataButton","",!0),new l("FileName"),new l("HeaderText"),new l("FooterText")]}get isDefaultLayout(){return this.showFullScreenButton&&this.showSaveButton&&this.showViewDataButton&&null==this.fileName&&null==this.headerText&&!this.allowUserDrillDown&&null==this.footerText}isDefault(){return this.isDefaultLayout&&this.onHover==ci.ShowToolTip&&this.onClick==di.None&&this.hyperlinkDestination==gi.NewTab&&H.isNullOrEmpty(this.hyperlink)&&H.isNullOrEmpty(this.drillDownPageKey)&&null!=this.drillDownParameters&&0==this.drillDownParameters.length&&H.isNullOrEmpty(this.toolTip)&&!this.allowUserDrillDown&&this.allowUserSorting}constructor(e,t,i,r,s,l,n,a,o,u,h,m,c,d,g){super(),this.ident=pi.Progress,this.availableOnClick=Si.OpenHyperlink|Si.ShowDashboard,this.availableOnDataManipulation=fi.AllowDrillDown|fi.AllowSorting,this.allowUserDrillDown=!1,this.allowUserSorting=!0,this.onClick=di.None,this.showFullScreenButton=!0,this.showSaveButton=!0,this.showViewDataButton=!0,this.fileName=null,this.headerText=null,this.footerText=null,null!=e&&(this.onHover=e),null!=t&&(this.onClick=t),null!=i&&(this.hyperlinkDestination=i),null!=r&&(this.toolTip=r),null!=s&&(this.hyperlink=s),null!=l&&(this.drillDownPageKey=l),null!=n&&(this.drillDownParameters=n),null!=a&&(this.allowUserDrillDown=a),null!=u&&(this.fileName=u),null!=h&&(this.headerText=h),null!=m&&(this.footerText=m),null!=c&&(this.showFullScreenButton=c),null!=d&&(this.showSaveButton=d),null!=o&&(this.allowUserSorting=o),null!=g&&(this.showViewDataButton=g)}};let Uo=R.g.StiProgressDashboardInteraction,Zo=P.Report.Dashboard.ImplementsIStiProgressElement,Yo=P.Report.Dashboard.StiProgressElementMode,Ko=P.Report.Dashboard.IStiProgressElement,Qo=P.Report.Dashboard.StiProgressValueType,qo=(R.M.StiProgressElement=class extends R.e.StiElement{implements(){let e=super.implements().concat([Di,Ue,Je,Ko,Ie,ri,Ai,el,Ci,ke,Ks,Ya,Us,..._i,...Ze,...Ge,...Zo,...il,..._t,...Fi,...$s,...Wl,..._a,n]);return(this.implements=()=>e)()}clone(e){let t,i,r=super.clone(e);return r.value=null!=this.value?this.value.clone():null,r.target=null!=this.target?this.target.clone():null,r.series=null!=this.series?this.series.clone():null,r.userSorts=this.userSorts.select(e=>e.clone()).toList(),r.transformActions=this.transformActions.select(e=>e.clone()),r.transformFilters=this.transformFilters.select(e=>e.clone()),r.transformSorts=this.transformSorts.select(e=>e.clone()),r.dataFilters=this.dataFilters.select(e=>e.clone()),r.topN=this.topN.clone(),r.textFormat=this.textFormat.clone(),r.title=null!=this.title?this.title.clone():null,r.layout=null!=this.layout?this.layout.clone():null,r.seriesColors=null!=this.seriesColors?this.seriesColors.slice():null,r.progressConditions=this.progressConditions.select(e=>e.clone()).toList(),r.dashboardInteraction=this.dashboardInteraction.clone(),r.shadow=null==(t=this.shadow)?void 0:t.clone(),r.cornerRadius=null==(i=this.cornerRadius)?void 0:i.clone(),r}meta(){return[...super.meta(),new s("UserSorts").get(e=>a.Serialize.objectArray(this.userSorts,e)).set(e=>this.userSorts.addRange(e.value.properties().select(e=>ll.loadFromJson(e.value)))).setXml(e=>this.userSorts.addRange(e.childNodes.map(e=>ll.loadFromXml(e)))),new s("TransformActions").get(e=>a.Serialize.objectArray(this.transformActions,e)).set(e=>this.transformActions.addRange(e.value.properties().select(e=>nl.loadFromJson(e.value)))).setXml(e=>this.transformActions.addRange(e.childNodes.map(e=>nl.loadFromXml(e)))),new s("TransformFilters").get(e=>a.Serialize.objectArray(this.transformFilters,e)).set(e=>this.transformFilters.addRange(e.value.properties().select(e=>y.loadFromJson(e.value)))).setXml(e=>this.transformFilters.addRange(e.childNodes.map(e=>y.loadFromXml(e)))),new s("TransformSorts").get(e=>a.Serialize.objectArray(this.transformSorts,e)).set(e=>this.transformSorts.addRange(e.value.properties().select(e=>ll.loadFromJson(e.value)))).setXml(e=>this.transformSorts.addRange(e.childNodes.map(e=>ll.loadFromXml(e)))),new s("DataFilters").get(e=>a.Serialize.objectArray(this.dataFilters,e)).set(e=>this.dataFilters.addRange(e.value.properties().select(e=>y.loadFromJson(e.value)))).setXml(e=>this.dataFilters.addRange(e.childNodes.map(e=>y.loadFromXml(e)))),new s("TopN").check(()=>null!=this.topN).set(e=>this.topN=Ei.createFromJsonObject(e.value)).setXml(e=>this.topN=Ei.createFromXml(e)),new s("TextFormat").check(()=>null!=this.textFormat).set(e=>this.textFormat=Mi.createFromJsonObject(e.value)).setXml(e=>this.textFormat=Mi.loadFormatFromXml(e,this.report)),new s("Value").check(()=>null!=this.value).set(e=>{let t=d.loadFromJson(e.value).as(R.M.StiValueProgressMeter);null!=t&&(this.value=t)}).setXml(e=>{let t=d.loadFromXml(e).as(R.M.StiValueProgressMeter);null!=t&&(this.value=t)}),new s("Target").check(()=>null!=this.target).set(e=>{let t=d.loadFromJson(e.value).as(gs);null!=t&&(this.target=t)}).setXml(e=>{let t=d.loadFromXml(e).as(gs);null!=t&&(this.target=t)}),new s("Series").check(()=>null!=this.series).set(e=>{let t=d.loadFromJson(e.value).as(R.M.StiSeriesProgressMeter);null!=t&&(this.series=t)}).setXml(e=>{let t=d.loadFromXml(e).as(R.M.StiSeriesProgressMeter);null!=t&&(this.series=t)}),new s("Title").check(()=>null!=this.title).set(e=>this.title=R.e.StiTitle.createFromJsonObject(e.value)).setXml(e=>this.title=R.e.StiTitle.createFromXml(e)),new s("Layout").check(()=>null!=this.layout).set(e=>this.layout=tl.createFromJsonObject(e.value)).setXml(e=>this.layout=tl.createFromXml(e)),new i("ForeColor","",N.transparent),new l("Font").get(()=>a.Serialize.fontArial8(this.font)).set(e=>this.font=a.Deserialize.font(e.value,this.font)).setXml(e=>this.font=P.System.Convert.toFont(e.textContent)),new r("DataMode","",Nl,Nl.UsingDataFields),new l("ManuallyEnteredData"),new s("SeriesColors").get(e=>a.Serialize.colorArray(this.seriesColors)).set(e=>this.seriesColors=a.Deserialize.colorArray(e)).setXml(e=>this.seriesColors=Ys.convertStringToColorArray(e.textContent)),new r("Mode","",Yo,Yo.Circle),new r("ValueType","",Qo,Qo.Percentage),new r("Style","",o,o.Auto),new l("CustomStyleName"),new l("Group"),new h("ColorEach","",!0),new s("ProgressConditions").get(e=>a.Serialize.objectArray(this.progressConditions,e)).set(e=>this.progressConditions.addRange(e.value.properties().select(e=>R.M.StiProgressElementCondition.createFromJson(e.value)))).setXml(e=>this.progressConditions.addRange(e.childNodes.map(e=>R.M.StiProgressElementCondition.createFromXml(e)))),new h("CrossFiltering","",!0),new l("CornerRadius").get(()=>this.cornerRadius.toString()).set(e=>this.cornerRadius=v.tryParse(e.value.toString())).setXml(e=>this.cornerRadius=v.tryParse(e.textContent)),new l("Shadow").get(()=>a.Serialize.jShadow(this.shadow)).set(e=>this.shadow=a.Deserialize.simpleSahdow(e.value)).setXml(e=>this.shadow=We.loadFromXml(e.textContent)),new s("DashboardInteraction").check(()=>null!=this.dashboardInteraction.as(Uo)).set(e=>{let t,i=null==(t=bi.loadInteractionFromJsonObject(e.value))?void 0:t.as(Uo);null!=i&&(this.dashboardInteraction=i)}).setXml(e=>{let t,i=null==(t=bi.loadInteractionFromXml(e))?void 0:t.as(Uo);null!=i&&(this.dashboardInteraction=i)}),new h("ShowBlanks")]}addValue2(e){this.value=null!=e?c.Progress.getValue2(e):null}addValue(e){this.value=c.Progress.getValue(e.as(R.e.StiMeter))}removeValue(){this.value=null}getValue(){return this.value}getValue2(e){return null!=e?c.Progress.getValue(e.as(R.e.StiMeter)):null}createNewValue(){this.value=new R.M.StiValueProgressMeter,this.value.expression="Sum()"}addTarget2(e){this.target=null!=e?c.Progress.getTarget2(e):null}addTarget(e){this.target=c.Progress.getTarget(e.as(R.e.StiMeter))}removeTarget(){this.target=null}getTarget(){return this.target}getTarget2(e){return null!=e?c.Progress.getTarget(e.as(R.e.StiMeter)):null}createNewTarget(){this.target=new gs,this.target.expression="Sum()"}addSeries2(e){this.series=null!=e?c.Progress.getSeries2(e):null}addSeries(e){this.series=c.Progress.getSeries(e.as(R.e.StiMeter))}removeSeries(){this.series=null}getSeries(){return this.series}getSeries2(e){return null!=e?c.Progress.getSeries(e.as(R.e.StiMeter)):null}createNewSeries(){this.series=new R.M.StiSeriesProgressMeter}getManuallyEnteredDataTable(){if(this.dataMode!=Nl.ManuallyEnteringData)return null;return R.e.StiManuallyEnteredDataParser.getProgressDataTable(this.manuallyEnteredData,this)}convertFrom(e){let t=e.fetchAllMeters();if(null==t)return;let i=t.firstOrDefault(e=>e.is(ji)),r=(null!=(i=null==i?t.firstOrDefault(e=>e.is(vt)):i)&&(this.value=null==this.value?new R.M.StiValueProgressMeter:this.value,this.value.loadFromJsonObject(i.saveToJsonObject(Le.Report))),t.firstOrDefault(e=>e.is(Ir))),s=(null!=r&&(this.target=null==this.target?new gs:this.target,this.target.loadFromJsonObject(r.saveToJsonObject(Le.Report))),t.firstOrDefault(e=>e.is(Dr)));null!=(s=null==s?t.firstOrDefault(e=>e.is(Pe)):s)&&(this.series=null==this.series?new R.M.StiSeriesProgressMeter:this.series,this.series.loadFromJsonObject(s.saveToJsonObject(Le.Report))),null==this.dashboardInteraction&&(this.dashboardInteraction=new Uo)}fetchAllMeters(){let e=new j;return this.dataMode==Nl.UsingDataFields&&(null!=this.value&&e.add(this.value),null!=this.target&&e.add(this.target),null!=this.series)&&e.add(this.series),e}getMeters(){let e=new j;return this.dataMode==Nl.UsingDataFields&&(null!=this.value&&e.add(this.value),null!=this.target&&e.add(this.target),null!=this.series)&&e.add(this.series),e}retrieveUsedDataNames(){return this.dataMode==Nl.UsingDataFields?rl.getMany(this.value,this.target,this.series):null}get isDefined(){return null!=this.value||null!=this.target||null!=this.series||this.dataMode==Nl.ManuallyEnteringData}get style(){return this._style}set style(e){(this._style=e)!=o.Custom&&(this.customStyleName="")}setString(e,t){switch(e){case"Title.Text":this.title.text=t;break}}getString(e){switch(e){case"Title.Text":return this.title.text}throw new Error(`Property with name `+e)}getAllStrings(){return["Title.Text"]}get toolboxPosition(){return _e.ProgressElement}get localizedName(){return T.get("Components","StiProgress")}addProgressCondition(e,t,i,r,s,l,n,a){this.progressConditions.add(new R.M.StiProgressElementCondition(e,t,i,r,s,l,n,a))}fetchProgressConditions(){let e=new j;return null!=this.progressConditions&&e.addRange(this.progressConditions),e}clearProgressConditions(){this.progressConditions.clear()}getNestedPages(){if(null==this.dashboardInteraction||this.dashboardInteraction.onClick!=di.ShowDashboard)return null;let t=this.dashboardInteraction.drillDownPageKey;if(de.isEmptyKey(t))return null;let e=this.report.pages.toList().firstOrDefault(e=>e.guid==t);if(null==e)return null;return new j([e])}constructor(e=L.empty){super(e),this.group="",this.dataMode=Nl.UsingDataFields,this.textFormat=new zt,this.font=new B("Arial",13),this.foreColor=N.transparent,this.title=new R.e.StiTitle,this.layout=new tl,this.shadow=new We,this.cornerRadius=new v(0),this.showBlanks=!1,this.transformActions=new j,this.transformFilters=new j,this.transformSorts=new j,this.topN=new Ei,this.dataTransformation={},this.crossFiltering=!0,this.dataFilters=new j,this.userSorts=new j,this._style=o.Auto,this.customStyleName="",this.seriesColors=[],this.defaultClientRectangle=new L(0,0,160,160),this.helpUrl="user-manual/dashboards_progress.htm",this.colorEach=!0,this.mode=Yo.Circle,this.progressConditions=new j,this.valueType=Qo.Percentage,this.isSampleForStyles=!1,this.title.text=this.localizedName,this.dashboardInteraction=new Uo}},P.Report.Dashboard.IStiProgressElementCondition),_o=P.Report.Dashboard.StiProgressFieldCondition,$o=P.Report.Dashboard.StiProgressConditionPermissions;{class dp{implements(){let e=[Rt,n,qo];return(this.implements=()=>e)()}meta(){return[new re("Ident").get(()=>this[P.System.StiObject.stimulsoft]().getType()[P.System.StiObject.stimulsoft]().getTypeName()),new r("Condition","",nn,nn.EqualTo),new r("Field","",_o,_o.Value),new l("Value"),new i("Color","",N.transparent),new r("Permissions","",$o,$o.All),new l("Font").get(()=>a.Serialize.fontArial8(this.font)).set(e=>this.font=a.Deserialize.font(e.value,this.font)).setXml(e=>this.font=P.System.Convert.toFont(e.textContent)),new i("TextColor","",N.black),new i("TrackColor","",N.transparent)]}saveToJsonObject(e){return u.saveToJsonObject(e,this)}loadFromJsonObject(e){u.loadFromJsonObject(e,this)}loadFromXml(e){u.loadFromXml(e,this)}clone(){return this[P.System.StiObject.stimulsoft]().memberwiseClone()}static createFromJson(e){let t=new dp;return t.loadFromJsonObject(e),t}static createFromXml(e){let t=new dp;return t.loadFromXml(e),t}constructor(e,t,i,r,s,l,n,a){this.condition=nn.EqualTo,this.field=_o.Value,this.permissions=$o.All,this.textColor=N.black,this.color=N.transparent,this.trackColor=N.transparent,this.font=new B("Arial",8),null!=e&&(this.field=e),null!=t&&(this.condition=t),null!=i&&(this.value=i),null!=r&&(this.permissions=r),null!=s&&(this.font=s),null!=l&&(this.textColor=l),null!=n&&(this.color=n),null!=a&&(this.trackColor=a)}}R.M.StiProgressElementCondition=dp}R.g.StiRegionMapDashboardInteraction=class extends R.g.StiDashboardInteraction{implements(){let e=super.implements().concat([n,Ws]);return(this.implements=()=>e)()}meta(){return[...super.meta(),new h("ShowFullScreenButton","",!0),new h("ShowSaveButton","",!0),new h("ShowViewDataButton","",!0),new l("FileName"),new l("HeaderText"),new l("FooterText")]}get isDefaultLayout(){return this.showFullScreenButton&&this.showSaveButton&&this.showViewDataButton&&null==this.fileName&&null==this.headerText&&null==this.footerText}isDefault(){return this.onHover==ci.ShowToolTip&&this.onClick==di.ApplyFilter&&this.hyperlinkDestination==gi.NewTab&&H.isNullOrEmpty(this.hyperlink)&&H.isNullOrEmpty(this.drillDownPageKey)&&null!=this.drillDownParameters&&0==this.drillDownParameters.length&&H.isNullOrEmpty(this.toolTip)&&this.isDefaultLayout}constructor(e,t,i,r,s,l,n,a,o,u,h,m,c){super(e,t,i,r,s,l,n),this.ident=pi.RegionMap,this.availableOnClick=Si.ApplyFilter|Si.OpenHyperlink|Si.ShowDashboard,this.showFullScreenButton=!0,this.showSaveButton=!0,this.showViewDataButton=!0,this.fileName=null,this.headerText=null,this.footerText=null,null!=a&&(this.fileName=a),null!=o&&(this.headerText=o),null!=u&&(this.footerText=u),null!=h&&(this.showFullScreenButton=h),null!=m&&(this.showSaveButton=m),null!=c&&(this.showViewDataButton=c)}};let eu=P.Report.Maps.StiMapLabels,tu=R.g.StiRegionMapDashboardInteraction,iu=P.Report.Dashboard.ImplementsIStiRegionMapElement,ru=P.Report.Maps.StiMap,su=P.Report.Maps.StiDisplayNameType,lu=P.Report.Maps.StiMapType,nu=P.Report.Maps.StiMapSource,au=P.Report.Dashboard.IStiRegionMapElement;{ht.add("StiRegionMapElement","Stimulsoft.Dashboard.Export.Tools.StiRegionMapElementExportTool");class Zm extends R.e.StiElement{implements(){let e=super.implements().concat([au,Ue,Je,fe,Ie,el,ri,ke,...iu,...Ze,...Ge,...Kl,...il,...$s,..._t,n,Ci,Oa]);return(this.implements=()=>e)()}clone(e){let t,i,r,s,l=super.clone(e);return l.keyMeter=null!=this.keyMeter?this.keyMeter.clone():null,l.nameMeter=null!=this.nameMeter?this.nameMeter.clone():null,l.valueMeter=null!=this.valueMeter?this.valueMeter.clone():null,l.groupMeter=null!=this.groupMeter?this.groupMeter.clone():null,l.colorMeter=null!=this.colorMeter?this.colorMeter.clone():null,l.userFilters=this.userFilters.select(e=>e.clone()).toList(),l.transformActions=this.transformActions.select(e=>e.clone()).toList(),l.transformFilters=this.transformFilters.select(e=>e.clone()).toList(),l.transformSorts=this.transformSorts.select(e=>e.clone()).toList(),l.dataFilters=this.dataFilters.select(e=>e.clone()).toList(),l.valueFormat=null==(t=this.valueFormat)?void 0:t.clone(),l.labels=null==(i=this.labels)?void 0:i.clone(),l.title=null!=this.title?this.title.clone():null,l.layout=null!=this.layout?this.layout.clone():null,l.dashboardInteraction=this.dashboardInteraction.clone(),l.shadow=null==(r=this.shadow)?void 0:r.clone(),l.cornerRadius=null==(s=this.cornerRadius)?void 0:s.clone(),l}meta(){return[...super.meta(),new s("UserFilters").get(e=>a.Serialize.objectArray(this.userFilters,e)).set(e=>this.userFilters.addRange(e.value.properties().select(e=>y.loadFromJson(e.value)))).setXml(e=>this.userFilters.addRange(e.childNodes.map(e=>y.loadFromXml(e)))),new s("TransformActions").get(e=>a.Serialize.objectArray(this.transformActions,e)).set(e=>this.transformActions.addRange(e.value.properties().select(e=>nl.loadFromJson(e.value)))).setXml(e=>this.transformActions.addRange(e.childNodes.map(e=>nl.loadFromXml(e)))),new s("TransformFilters").get(e=>a.Serialize.objectArray(this.transformFilters,e)).set(e=>this.transformFilters.addRange(e.value.properties().select(e=>y.loadFromJson(e.value)))).setXml(e=>this.transformFilters.addRange(e.childNodes.map(e=>y.loadFromXml(e)))),new s("TransformSorts").get(e=>a.Serialize.objectArray(this.transformSorts,e)).set(e=>this.transformSorts.addRange(e.value.properties().select(e=>ll.loadFromJson(e.value)))).setXml(e=>this.transformSorts.addRange(e.childNodes.map(e=>ll.loadFromXml(e)))),new s("DataFilters").get(e=>a.Serialize.objectArray(this.dataFilters,e)).set(e=>this.dataFilters.addRange(e.value.properties().select(e=>y.loadFromJson(e.value)))).setXml(e=>this.dataFilters.addRange(e.childNodes.map(e=>y.loadFromXml(e)))),new s("DashboardInteraction").check(()=>null!=this.dashboardInteraction.as(tu)).set(e=>{let t,i=null==(t=bi.loadInteractionFromJsonObject(e.value))?void 0:t.as(tu);null!=i&&(this.dashboardInteraction=i)}).setXml(e=>{let t,i=null==(t=bi.loadInteractionFromXml(e))?void 0:t.as(tu);null!=i&&(this.dashboardInteraction=i)}),new s("Labels").check(()=>null!=this.labels).set(e=>this.labels=eu.createFromJsonObject(e.value)).setXml(e=>this.labels=eu.createFromXml(e)),new s("Title").check(()=>null!=this.title).set(e=>this.title=R.e.StiTitle.createFromJsonObject(e.value)).setXml(e=>this.title=R.e.StiTitle.createFromXml(e)),new s("Layout").check(()=>null!=this.layout).set(e=>this.layout=tl.createFromJsonObject(e.value)).setXml(e=>this.layout=tl.createFromXml(e)),new s("KeyMeter").check(()=>null!=this.keyMeter).set(e=>{let t=d.loadFromJson(e.value).as(cs);null!=t&&(this.keyMeter=t)}).setXml(e=>{let t=d.loadFromXml(e).as(cs);null!=t&&(this.keyMeter=t)}),new s("NameMeter").check(()=>null!=this.nameMeter).set(e=>{let t=d.loadFromJson(e.value).as(R.L.StiNameMapMeter);null!=t&&(this.nameMeter=t)}).setXml(e=>{let t=d.loadFromXml(e).as(R.L.StiNameMapMeter);null!=t&&(this.nameMeter=t)}),new s("ValueMeter").check(()=>null!=this.valueMeter).set(e=>{let t=d.loadFromJson(e.value).as(R.L.StiValueMapMeter);null!=t&&(this.valueMeter=t)}).setXml(e=>{let t=d.loadFromXml(e).as(R.L.StiValueMapMeter);null!=t&&(this.valueMeter=t)}),new s("GroupMeter").check(()=>null!=this.groupMeter).set(e=>{let t=d.loadFromJson(e.value).as(R.L.StiGroupMapMeter);null!=t&&(this.groupMeter=t)}).setXml(e=>{let t=d.loadFromXml(e).as(R.L.StiGroupMapMeter);null!=t&&(this.groupMeter=t)}),new s("ColorMeter").check(()=>null!=this.colorMeter).set(e=>{let t=d.loadFromJson(e.value).as(R.L.StiColorMapMeter);null!=t&&(this.colorMeter=t)}).setXml(e=>{let t=d.loadFromXml(e).as(R.L.StiColorMapMeter);null!=t&&(this.colorMeter=t)}),new r("DataFrom","",nu,nu.Manual),new r("MapType","",lu,lu.Individual),new l("MapData"),new h("ShowValue","",!0),new h("ShortValue","",!0),new h("ShowZeros","",!0),new h("ColorEach"),new h("ShowBubble"),new h("Show3D"),new r("ShowName","",su,su.Full),new r("Style","",o,o.Auto),new l("Group"),new l("Language"),new l("CustomStyleName"),new l(["MapIdent","MapID"]),new h("CrossFiltering","",!0),new l("CornerRadius").get(()=>this.cornerRadius.toString()).set(e=>this.cornerRadius=v.tryParse(e.value.toString())).setXml(e=>this.cornerRadius=v.tryParse(e.textContent)),new l("Shadow").get(()=>a.Serialize.jShadow(this.shadow)).set(e=>this.shadow=a.Deserialize.simpleSahdow(e.value)).setXml(e=>this.shadow=We.loadFromXml(e.textContent)),new l("ManuallyEnteredData"),new s("ValueFormat").check(()=>null!=this.valueFormat).set(e=>this.valueFormat=Mi.createFromJsonObject(e.value)).setXml(e=>this.valueFormat=Mi.loadFormatFromXml(e))]}get allowSkipOwnFilter(){return!0}fetchAllMeters(){let e=new j;return null!=this.keyMeter&&e.add(this.keyMeter),null!=this.nameMeter&&e.add(this.nameMeter),null!=this.valueMeter&&e.add(this.valueMeter),null!=this.groupMeter&&e.add(this.groupMeter),null!=this.colorMeter&&e.add(this.colorMeter),e}getMeters(){let e=new j;return this.isDefined&&this.dataFrom==nu.DataColumns&&(null!=this.keyMeter&&e.add(this.keyMeter),null!=this.nameMeter&&e.add(this.nameMeter),null!=this.valueMeter&&(Or.isAggregationFunctionPresent(this.valueMeter.expression)?e.add(this.valueMeter):e.add(new R.L.StiValueMapMeter(this.valueMeter.key,`First(${this.valueMeter.expression})`))),null!=this.groupMeter&&e.add(this.groupMeter),null!=this.colorMeter)&&e.add(this.colorMeter),e}retrieveUsedDataNames(){let e=new j;return this.dataFrom==nu.DataColumns&&(e.addRange(rl.getMany(this.keyMeter)),e.addRange(rl.getMany(this.nameMeter)),e.addRange(rl.getMany(this.valueMeter)),e.addRange(rl.getMany(this.groupMeter)),e.addRange(rl.getMany(this.colorMeter))),e.distinct()}get isDefined(){return this.dataFrom!=nu.DataColumns||null!=this.keyMeter||null!=this.nameMeter||null!=this.valueMeter||null!=this.groupMeter||null!=this.colorMeter}get isQuerable(){return this.dataFrom==nu.DataColumns}get font(){return this.labels.font}set font(e){this.labels.font=e}static getValueFormatDefault(){let e=new Wi;return e.decimalDigits=1,e.state=R.a.StiTextFormatState.DecimalDigits|R.a.StiTextFormatState.Abbreviation,e}get style(){return this._style}set style(e){(this._style=e)!=o.Custom&&(this.customStyleName="")}createNextMeter(e){null==this.keyMeter?this.keyMeter=c.RegionMap.getKey2(e):null==this.nameMeter?this.nameMeter=c.RegionMap.getName2(e):null==this.valueMeter?this.valueMeter=c.RegionMap.getValue2(e):null==this.groupMeter?this.groupMeter=c.RegionMap.getGroup2(e):null==this.colorMeter?this.colorMeter=c.RegionMap.getColor2(e):this.keyMeter=c.RegionMap.getKey2(e)}addKeyMeter2(e){this.keyMeter=null!=e?c.RegionMap.getKey2(e):null}addKeyMeter(e){this.keyMeter=null!=e?c.RegionMap.getKey(e.as(R.e.StiMeter)):null}getKeyMeter(){return this.keyMeter}removeKeyMeter(){this.keyMeter=null}createNewKeyMeter(){this.keyMeter=new cs}addNameMeter2(e){this.nameMeter=null!=e?c.RegionMap.getName2(e):null}addNameMeter(e){this.nameMeter=null!=e?c.RegionMap.getName(e.as(R.e.StiMeter)):null}getNameMeter(){return this.nameMeter}removeNameMeter(){this.nameMeter=null}createNewNameMeter(){this.nameMeter=new R.L.StiNameMapMeter}addValueMeter2(e){this.valueMeter=null!=e?c.RegionMap.getValue2(e):null}addValueMeter(e){this.valueMeter=null!=e?c.RegionMap.getValue(e.as(R.e.StiMeter),this.dashboard):null}getValueMeter(){return this.valueMeter}removeValueMeter(){this.valueMeter=null}createNewValueMeter(){this.valueMeter=new R.L.StiValueMapMeter}addGroupMeter2(e){this.groupMeter=null!=e?c.RegionMap.getGroup2(e):null}addGroupMeter(e){this.groupMeter=null!=e?c.RegionMap.getGroup(e.as(R.e.StiMeter)):null}getGroupMeter(){return this.groupMeter}removeGroupMeter(){this.groupMeter=null}createNewGroupMeter(){this.groupMeter=new R.L.StiGroupMapMeter}addColorMeter2(e){this.colorMeter=null!=e?c.RegionMap.getColor2(e):null}addColorMeter(e){this.colorMeter=null!=e?c.RegionMap.getColor(e.as(R.e.StiMeter)):null}getColorMeter(){return this.colorMeter}removeColorMeter(){this.colorMeter=null}createNewColorMeter(){this.colorMeter=new R.L.StiColorMapMeter}convertFrom(e){let t=e.as(R.O.StiOnlineMapElement);null==t||null==t.location||t.location.isDefault()||(this.keyMeter=new cs,this.keyMeter.label=t.location.label,this.keyMeter.expression=t.location.expression),null==this.dashboardInteraction&&(this.dashboardInteraction=new tu)}setString(e,t){switch(e){case"Title.Text":this.title.text=t;break}}getString(e){switch(e){case"Title.Text":return this.title.text}throw new Error(`Property with name `+e)}getAllStrings(){return["Title.Text"]}get toolboxPosition(){return _e.RegionMapElement}get localizedName(){return T.get("Components","StiRegionMap")}get dashboardInteraction(){return this._dashboardInteraction}set dashboardInteraction(e){this._dashboardInteraction=e}getManuallyEnteredDataTable(){if(this.dataFrom==nu.Manual){let e=this.getMapData().orderBy(e=>e.key).toList(),i=new Ct;i.meters.add(new cs("Key","Key")),i.meters.add(new R.L.StiNameMapMeter("Name","Name")),i.meters.add(new R.L.StiValueMapMeter("Value","Value"));for(let t of e){let e=[];e[0]=t.key,e[1]=t.name,e[2]=t.value,i.rows.add(e)}return i}return null}get language(){return this._language}set language(e){this._language!=e&&(this._language="EN"!=e?e:null)}getNestedPages(){if(null==this.dashboardInteraction||this.dashboardInteraction.onClick!=di.ShowDashboard)return null;let t=this.dashboardInteraction.drillDownPageKey;if(de.isEmptyKey(t))return null;let e=this.report.pages.toList().firstOrDefault(e=>e.guid==t);if(null==e)return null;return new j([e])}getMapData(){let e=new ru;return e.mapData=this.mapData,e.mapIdent=this.mapIdent,e.language=this.language,e.page=this.page,e.getMapData()}constructor(e=L.empty){super(e),this.group="",this.shadow=new We,this.cornerRadius=new v(0),this.title=new R.e.StiTitle,this.valueFormat=Zm.getValueFormatDefault(),this.layout=new tl,this._style=o.Auto,this.customStyleName="",this.userFilters=new j,this.transformActions=new j,this.transformFilters=new j,this.transformSorts=new j,this.dataTransformation={},this.dataFilters=new j,this.helpUrl="user-manual/dashboards_maps_region_map.htm",this.dataMode=Nl.UsingDataFields,this.labels=new eu,this.mapIdent="USA",this.dataFrom=nu.Manual,this.mapType=lu.Individual,this.showValue=!0,this.showZeros=!0,this.shortValue=!0,this.colorEach=!1,this.showBubble=!1,this.show3D=!1,this.showName=su.Full,this.crossFiltering=!0,this.title.text=this.localizedName,this.dashboardInteraction=new tu}}R.L.StiRegionMapElement=Zm}R.g.StiShapeDashboardInteraction=class extends R.g.StiDashboardInteraction{constructor(e,t,i,r,s,l,n){super(e,t,i,r,s,l,n),this.ident=pi.Shape,this.availableOnClick=Si.OpenHyperlink|Si.ShowDashboard,this.onClick=di.OpenHyperlink}};let ou=P.Report.Components.StiShapeTypeService,uu=P.Report.Dashboard.ImplementsIStiShapeElement,hu=P.Report.Components.StiRectangleShapeType,mu=P.Report.Dashboard.IStiShapeElement,cu=R.g.StiShapeDashboardInteraction;ht.add("StiShapeElement","Stimulsoft.Dashboard.Export.Tools.StiShapeElementExportTool"),R.Z.StiShapeElement=class extends R.e.StiElement{implements(){let e=super.implements().concat([mu,Ie,Ci,ke,...uu,...il,n]);return(this.implements=()=>e)()}clone(e){let t,i,r=super.clone(e);return r.title=null!=this.title?this.title.clone():null,r.shapeType=null==(t=this.shapeType)?void 0:t.clone(),r.dashboardInteraction=null==(i=this.dashboardInteraction)?void 0:i.clone(),r}meta(){return[...super.meta(),new s("Title").check(()=>null!=this.title).set(e=>{this.title=new _l,this.title.loadFromJsonObject(e)}).setXml(e=>{this.title=new _l,this.title.loadFromXml(e)}),new Vt("Fill"),new i("Stroke","",N.black),new ie("Size","",1),new s("ShapeType").set(e=>this.shapeType=ou.createFromJsonObject(e.value)).setXml(e=>{this.shapeType=ou.convertFromXml(e),this.shapeType.loadFromXml(e)}),new s("Padding").get(e=>this.padding.saveToJsonObject(0,0,0,0)),new s("DashboardInteraction").check(()=>null!=this.dashboardInteraction.as(cu)).set(e=>{let t,i=null==(t=bi.loadInteractionFromJsonObject(e.value))?void 0:t.as(cu);null!=i&&(this.dashboardInteraction=i)}).setXml(e=>{let t,i=null==(t=bi.loadInteractionFromXml(e))?void 0:t.as(cu);null!=i&&(this.dashboardInteraction=i)})]}get toolboxPosition(){return _e.ShapeElement}get localizedName(){return T.get("Components","StiShape")}get isDefined(){return!0}get isQuerable(){return!1}setString(e,t){switch(e){case"Title.Text":this.title.text=t;break}}getString(e){switch(e){case"Title.Text":return this.title.text}throw new Error(`Property with name `+e)}getAllStrings(){return["Title.Text"]}get size(){return this._size}set size(e){e!=this._size&&(this._size=e<1?1:e)}getNestedPages(){var e;if(null==this.dashboardInteraction||this.dashboardInteraction.onClick!=di.ShowDashboard)return null;let t=null==(e=this.dashboardInteraction)?void 0:e.drillDownPageKey;if(de.isEmptyKey(t))return null;super.getNestedPages;let i=this.report.pages.toList().firstOrDefault(e=>e.guid==t);if(null==i)return null;return new j([i])}constructor(e=L.empty){super(e),this.helpUrl="user-manual/dashboards_shape.htm",this.title=new _l,this.shapeType=new hu,this._size=1,this.fill=new E,this.stroke=N.black,this.title.text=this.localizedName,this.title.visible=!1,this.padding=it.create(0),this.dashboardInteraction=new cu}};{let e;(Y=e=R.K.StiDataBarsDirection||(R.K.StiDataBarsDirection={}))[Y["LeftToRight"]=0]="LeftToRight",Y[Y["RighToLeft"]=1]="RighToLeft";let t;(Z=t=R.K.StiDataBarsBrushType||(R.K.StiDataBarsBrushType={}))[Z["Solid"]=0]="Solid",Z[Z["Gradient"]=1]="Gradient";let i;(V=i=R.K.StiSparklinesType||(R.K.StiSparklinesType={}))[V["Line"]=0]="Line",V[V["Area"]=1]="Area",V[V["Column"]=2]="Column",V[V["WinLoss"]=3]="WinLoss"}{class xu{static getSelected(e){let t=this.hash.get(e.key);if(null==t)return null;return t.keys.cast().toList()}static getSelectedObjects(e){let t=this.getSelected(e);return null!=t?t.cast():null}static isSelected(e,t){let i=this.hash.get(e.key);return null==i&&(i=new Ro,this.hash.set(e.key,i)),null!=i.get(t)}static select(e,t){let i=this.hash.get(e.key);null==i&&(i=new Ro,this.hash.set(e.key,i)),i.set(t,t)}static resetSelection(e){this.hash.containsKey(e.key)&&this.hash.remove(e.key)}}xu.hash=new Ro,R.h.StiTableElementSelection=xu}let du=P.Report.Dashboard.IStiAllowUserColumnSelectionDashboardInteraction,gu=P.Report.Dashboard.IStiTableDashboardInteraction,pu=P.Report.Dashboard.IStiAllowUserFilteringDashboardInteraction,Su=(R.g.StiTableDashboardInteraction=class extends R.g.StiDashboardInteraction{implements(){let e=super.implements().concat([gu,Il,du,pu,n,Ws]);return(this.implements=()=>e)()}meta(){return[...super.meta(),new h("AllowUserColumnSelection","",!0),new h("AllowUserSorting","",!0),new h("AllowUserFiltering","",!0),new h("DrillDownFiltered","",!0),new h("FullRowSelect"),new h("ShowFullScreenButton","",!0),new h("ShowSaveButton","",!0),new h("ShowViewDataButton","",!0),new l("FileName"),new l("HeaderText"),new l("FooterText")]}get isDefaultLayout(){return this.showFullScreenButton&&this.showSaveButton&&this.showViewDataButton&&null==this.fileName&&null==this.headerText&&null==this.footerText}isDefault(){return this.isDefaultLayout&&this.allowUserColumnSelection&&this.allowUserFiltering&&this.allowUserSorting&&this.drillDownFiltered&&!this.fullRowSelect&&super.isDefault()}constructor(e,t,i,r,s,l,n,a,o,u,h,m,c,d,g,p,S,w){super(e,t,i,r,s,l,n),this.allowUserColumnSelection=!0,this.allowUserSorting=!0,this.allowUserFiltering=!0,this.drillDownFiltered=!0,this.fullRowSelect=!1,this.ident=pi.Table,this.availableOnClick=Si.None,this.availableOnHover=wi.None,this.availableOnDataManipulation=fi.AllowFiltering|fi.AllowSorting,this.showFullScreenButton=!0,this.showSaveButton=!0,this.showViewDataButton=!0,this.fileName=null,this.headerText=null,this.footerText=null,null!=u&&(this.allowUserColumnSelection=u),null!=a&&(this.allowUserFiltering=a),null!=o&&(this.allowUserSorting=o),null!=h&&(this.drillDownFiltered=h),null!=m&&(this.fullRowSelect=m),null!=c&&(this.fileName=c),null!=d&&(this.headerText=d),null!=g&&(this.footerText=g),null!=p&&(this.showFullScreenButton=p),null!=S&&(this.showSaveButton=S),null!=w&&(this.showViewDataButton=w)}},P.Report.Dashboard.IStiTableElementCondition),wu=P.Report.Dashboard.StiTableConditionPermissions;{class Fu{implements(){let e=[Rt,Su,n];return(this.implements=()=>e)()}meta(){return[new re("Ident").get(()=>this[P.System.StiObject.stimulsoft]().getType()[P.System.StiObject.stimulsoft]().getTypeName()),new s("KeyValueMeters").get(()=>a.Serialize.stringArray(this.keyValueMeters)).set(e=>this.keyValueMeters=a.Deserialize.stringArray(e.value)).setXml(e=>this.keyValueMeters=this.parseStringArray(e)),new s("KeyDataFieldMeters").get(()=>a.Serialize.stringArray(this.keyDataFieldMeters)).set(e=>this.keyValueMeters=a.Deserialize.stringArray(e.value)).setXml(e=>this.keyValueMeters=this.parseStringArray(e)),new s("KeyDestinationMeters").get(()=>a.Serialize.stringArray(this.keyDestinationMeters)).set(e=>this.keyDestinationMeters=a.Deserialize.stringArray(e.value)).setXml(e=>this.keyDestinationMeters=this.parseStringArray(e)),new r("DataType","",R.a.StiFilterDataType,R.a.StiFilterDataType.Numeric),new r("Condition","",nn,nn.EqualTo),new l("Value"),new h("IsExpression"),new r("Permissions","",wu,wu.All),new l("Font").get(()=>a.Serialize.fontArial8(this.font)).set(e=>this.font=a.Deserialize.font(e.value,this.font)).setXml(e=>this.font=P.System.Convert.toFont(e.textContent)),new i("ForeColor","",N.black),new i("BackColor","",N.transparent),new r("IconAlignment","",G),new i("IconColor","",N.maroon),new r("Icon","",Et),new re("CustomIcon").check(()=>null!=this.customIcon).get(()=>to.toBase64String(this.customIcon)).set(e=>this.customIcon=to.fromBase64String(e.value.toString())).setXml(e=>this.customIcon=to.fromBase64String(e.textContent))]}saveToJsonObject(e){return u.saveToJsonObject(e,this)}loadFromJsonObject(e){u.loadFromJsonObject(e,this)}loadFromXml(e){u.loadFromXml(e,this)}parseStringArray(i){let r=[];for(let t=0;t<i.childNodes.length;t++){let e=i.childNodes[t];"value"==e.nodeName&&(r[t]=e.textContent)}return r}clone(){let e=this.saveToJsonObject(null),t=new Fu;return t.loadFromJsonObject(e),t}get keyValueMeters(){return this.keyDataFieldMeters}set keyValueMeters(e){this.keyDataFieldMeters=e,this.keyDestinationMeters=e}static createFromJson(e){let t=new Fu;return t.loadFromJsonObject(e),t}static createFromXml(e){let t=new Fu;return t.loadFromXml(e),t}constructor(e,t,i,r,s,l,n,a,o,u,h,m,c,d){this.keyDataFieldMeters=[],this.keyDestinationMeters=[],this.dataType=P.Report.Components.StiFilterDataType.Numeric,this.condition=P.Report.Components.StiFilterCondition.EqualTo,this.permissions=wu.All,this.font=new B("Arial",8),this.foreColor=N.black,this.backColor=N.transparent,this.isExpression=!1,this.icon=Et.Adjust,this.iconAlignment=G.None,this.iconColor=N.maroon,null!=e&&(this.keyDataFieldMeters=e),null!=t&&(this.keyDestinationMeters=t),null!=i&&(this.dataType=i),null!=r&&(this.condition=r),null!=s&&(this.value=s),null!=l&&(this.permissions=l),null!=n&&(this.font=n),null!=a&&(this.foreColor=a),null!=o&&(this.backColor=o),null!=u&&(this.isExpression=u),null!=h&&(this.icon=h),null!=m&&(this.iconAlignment=m),null!=c&&(this.customIcon=c),null!=d&&(this.iconColor=d)}}R.K.StiTableElementCondition=Fu}let fu=R.K.StiTableCells,bu=R.g.StiTableDashboardInteraction,yu=P.Report.Dashboard.StiTableSizeMode,Cu=P.Report.Dashboard.ImplementsIStiTableElement,xu=R.h.StiTableElementSelection,vu=P.Report.Dashboard.IStiTableElement,Fu=R.K.StiTableElementCondition;{ht.add("StiTableElement","Stimulsoft.Dashboard.Export.Tools.StiTableElementExportTool");class Gm extends R.e.StiElement{implements(){let e=super.implements().concat([vu,Ue,Je,Ie,el,ke,...Cu,...Ze,...Ge,...il,...$s,n,Ci,fe]);return(this.implements=()=>e)()}clone(e){let t,i,r=super.clone(e),s=(r.columns=this.columns.select(e=>e.clone()).toList(),r.userFilters=this.userFilters.select(e=>e.clone()).toList(),r.userSorts=this.userSorts.select(e=>e.clone()).toList(),r.transformActions=this.transformActions.select(e=>e.clone()).toList(),r.transformFilters=this.transformFilters.select(e=>e.clone()).toList(),r.transformSorts=this.transformSorts.select(e=>e.clone()).toList(),r.dataFilters=this.dataFilters.select(e=>e.clone()).toList(),r.cells=this.cells.clone(),r.title=null!=this.title?this.title.clone():null,r.layout=null!=this.layout?this.layout.clone():null,r.tableConditions=this.tableConditions.select(e=>e.clone()).toList(),new He);for(let i=0;i<this.columns.length;i++){let e=this.columns[i].key,t=r.columns[i].key;s.set(e,t)}for(let i of r.tableConditions){for(let t=0;t<i.keyDataFieldMeters.length;t++){let e={ref:""};s.tryGetValue(i.keyDataFieldMeters[t],e)&&(i.keyDataFieldMeters[t]=e.ref)}for(let t=0;t<i.keyDestinationMeters.length;t++){let e={ref:""};s.tryGetValue(i.keyDestinationMeters[t],e)&&(i.keyDestinationMeters[t]=e.ref)}}return r.dashboardInteraction=this.dashboardInteraction.clone(),r.shadow=null==(t=this.shadow)?void 0:t.clone(),r.cornerRadius=null==(i=this.cornerRadius)?void 0:i.clone(),r}meta(){return[...super.meta(),new s("Columns").get(e=>a.Serialize.objectArray(this.columns,e)).set(e=>this.columns.addRange(e.value.properties().select(e=>d.loadFromJson(e.value).as(Ts)).where(e=>null!=e))).setXml(e=>this.columns.addRange(e.childNodes.map(e=>d.loadFromXml(e)).filter(e=>null!=e))),new s("UserFilters").get(e=>a.Serialize.objectArray(this.userFilters,e)).set(e=>this.userFilters.addRange(e.value.properties().select(e=>y.loadFromJson(e.value)))).setXml(e=>this.userFilters.addRange(e.childNodes.map(e=>y.loadFromXml(e)))),new s("UserSorts").get(e=>a.Serialize.objectArray(this.userSorts,e)).set(e=>this.userSorts.addRange(e.value.properties().select(e=>ll.loadFromJson(e.value)))).setXml(e=>this.userSorts.addRange(e.childNodes.map(e=>ll.loadFromXml(e)))),new s("TransformActions").get(e=>a.Serialize.objectArray(this.transformActions,e)).set(e=>this.transformActions.addRange(e.value.properties().select(e=>nl.loadFromJson(e.value)))).setXml(e=>this.transformActions.addRange(e.childNodes.map(e=>nl.loadFromXml(e)))),new s("TransformFilters").get(e=>a.Serialize.objectArray(this.transformFilters,e)).set(e=>this.transformFilters.addRange(e.value.properties().select(e=>y.loadFromJson(e.value)))).setXml(e=>this.transformFilters.addRange(e.childNodes.map(e=>y.loadFromXml(e)))),new s("TransformSorts").get(e=>a.Serialize.objectArray(this.transformSorts,e)).set(e=>this.transformSorts.addRange(e.value.properties().select(e=>ll.loadFromJson(e.value)))).setXml(e=>this.transformSorts.addRange(e.childNodes.map(e=>ll.loadFromXml(e)))),new s("DataFilters").get(e=>a.Serialize.objectArray(this.dataFilters,e)).set(e=>this.dataFilters.addRange(e.value.properties().select(e=>y.loadFromJson(e.value)))).setXml(e=>this.dataFilters.addRange(e.childNodes.map(e=>y.loadFromXml(e)))),new s("Cells").check(()=>null!=this.cells&&!this.cells.isDefault()).get(()=>this.cells.saveToJsonObject(Le.Report)).set(e=>this.cells=fu.createFromJsonObject(e.value)).setXml(e=>this.cells=fu.createFromXml(e)),new i("HeaderForeColor","",N.transparent),new i("FooterForeColor","",N.transparent),new i("ForeColor","",N.transparent),new l("HeaderFont").get(()=>a.Serialize.fontArial8(this.headerFont)).set(e=>this.headerFont=a.Deserialize.font(e.value,this.headerFont)).setXml(e=>this.headerFont=P.System.Convert.toFont(e.textContent)),new l("FooterFont").get(()=>a.Serialize.fontArial8(this.footerFont)).set(e=>this.footerFont=a.Deserialize.font(e.value,this.footerFont)).setXml(e=>this.footerFont=P.System.Convert.toFont(e.textContent)),new At("Font","","Arial",10),new h("CrossFiltering","",!0),new s("TableConditions").get(e=>a.Serialize.objectArray(this.tableConditions.select(e=>e[P.System.StiObject.stimulsoft]().as(Fu)),e)).set(e=>this.tableConditions.addRange(e.value.properties().select(e=>Fu.createFromJson(e.value)))).setXml(e=>this.tableConditions.addRange(e.childNodes.map(e=>Fu.createFromXml(e)))),new s("Title").check(()=>null!=this.title),new s("Layout").check(()=>null!=this.layout),new s("DashboardInteraction").check(()=>null!=this.dashboardInteraction.as(bu)).set(e=>{let t,i=null==(t=bi.loadInteractionFromJsonObject(e.value))?void 0:t.as(bu);null!=i&&(this.dashboardInteraction=i)}).setXml(e=>{let t,i=null==(t=bi.loadInteractionFromXml(e))?void 0:t.as(bu);null!=i&&(this.dashboardInteraction=i)}),new r("Style","",o,o.Auto),new r("SizeMode","",yu,yu.AutoSize),new l("Group"),new l("CustomStyleName"),new l("CornerRadius").get(()=>this.cornerRadius.toString()).set(e=>this.cornerRadius=v.tryParse(e.value.toString())).setXml(e=>this.cornerRadius=v.tryParse(e.textContent)),new l("Shadow").get(()=>a.Serialize.jShadow(this.shadow)).set(e=>this.shadow=a.Deserialize.simpleSahdow(e.value)).setXml(e=>this.shadow=We.loadFromXml(e.textContent)),new ie("RowsPerPage","",0),new ie("PageTurnTime","",0)]}createMeters(e){let t=e.as(Gm);this.columns.clear();for(let e of t.columns)this.columns.add(e)}createMeters2(t){this.columns.clear();for(let e of t.columns.list)null!=e&&null!=e.type&&Oe.isNumericType(e.type)?this.columns.add(c.Table.getMeasure2(e)):this.columns.add(c.Table.getDimension2(e))}createMeter3(e){let t=e.as(or),i=e.as(Js),r=null!=t?t.type:null==i?void 0:i.type;if(null!=r&&Oe.isNumericType(r)){let e=c.Table.getMeasure2(t);e.showTotalSummary=!0,e.summaryType=Qi.Sum,this.columns.add(e)}else this.columns.add(c.Table.getDimension2(e))}removeMeter(e){e<this.columns.length&&this.columns.removeAt(e)}removeAllMeters(){this.columns.clear()}insertMeter(e,t){let i=t.as(Ts);if(null==i)return;0<=e&&e<this.columns.length?this.columns.insert(e,i):this.columns.add(i)}insertNewDimension(e){let t=new R.K.StiDimensionColumn;t.horAlignment=X.Left,this.insertMeter(e,t)}insertNewMeasure(e){let t=new R.K.StiMeasureColumn;t.expression="Sum()",t.horAlignment=X.Right,this.insertMeter(e,t)}getMeasure(e){return c.Table.getMeasure2(e)}getDimension(e){return c.Table.getDimension2(e)}getFonts(){let e=super.getFonts();return e.push(this.font),e=e.concat(this.cells.getFonts())}getCells(){return this.cells}convertFrom(e){let t=e.fetchAllMeters();if(this.columns.clear(),null==t)return;t.cast().forEach(e=>{let t=null;e.is2(Pe)?t=new R.K.StiDimensionColumn:e.is2(rr)?t=new R.K.StiSparklinesColumn:e.is2(ir)?t=new R.K.StiDataBarsColumn:e.is2(er)?t=new R.K.StiIndicatorColumn:e.is2(tr)?t=new R.K.StiColorScaleColumn:e.is2(Bi)?t=new R.K.StiBubbleColumn:e.is2(vt)&&((t=new R.K.StiMeasureColumn).horAlignment=X.Right),null!=t&&(t.loadFromJsonObject(e.saveToJsonObject(Le.Report)),this.columns.add(t))},this),null==this.dashboardInteraction&&(this.dashboardInteraction=new bu)}fetchAllMeters(){return this.columns.cast()}getMeters(){return this.columns.cast()}retrieveUsedDataNames(){return rl.getMany2(this.columns)}get isDefined(){return null!=this.columns&&0<this.columns.length}get allowSkipOwnFilter(){return!this.dashboardInteraction.drillDownFiltered}get foreColor(){return this.cells.data.foreColor}set foreColor(e){this.cells.data.foreColor=e}get font(){return this.cells.data.font}set font(e){this.cells.data.font=e}get style(){return this._style}set style(e){(this._style=e)!=o.Custom&&(this.customStyleName="")}get cells(){return this._cells}set cells(e){null!=e&&(e.element=this),this._cells=e}shouldSerializeCells(){return null==this.cells||!this.cells.isDefault()}setString(i,r){switch(i){case"Title.Text":this.title.text=r;break}let s=0;for(let t of this.columns){let e=`Column${s++}.Label`;i==e&&(t.label=r)}}getString(i){switch(i){case"Title.Text":return this.title.text}let r=0;for(let t of this.columns){let e=`Column${r++}.Label`;if(i==e)return t.label}throw new Error(`Property with name `+i)}getAllStrings(){let t=["Title.Text"],i=0;return this.columns.forEach(e=>t.push(`Column${i++}.Label`)),t}addTableCondition(e,t,i,r,s,l,n,a,o,u,h,m,c,d){null==this.tableConditions&&(this.tableConditions=new j),this.tableConditions.add(new Fu(e,t,i,r,s,l,n,a,o,u,h,m,c,d))}get toolboxPosition(){return _e.TableElement}get localizedName(){return T.get("Components","StiTable")}get headerForeColor(){return this.cells.columns.foreColor}set headerForeColor(e){this.cells.columns.foreColor=e}get headerFont(){return this.cells.columns.font}set headerFont(e){this.cells.columns.font=e}get footerForeColor(){return this.cells.totals.foreColor}set footerForeColor(e){this.cells.totals.foreColor=e}get footerFont(){return this.cells.totals.font}set footerFont(e){this.cells.totals.font=e}getColumnFont(){return U.getElementFontFromStyle(this,this.cells.columns.font)}getDataFont(){return U.getElementFontFromStyle(this,this.cells.data.font)}getTotalFont(){return U.getElementFontFromStyle(this,this.cells.totals.font)}getNestedPages(){let e,t,i=new j,r="";if(null!=this.dashboardInteraction&&this.dashboardInteraction.onClick==di.ShowDashboard&&(r=null==(e=this.dashboardInteraction)?void 0:e.drillDownPageKey,de.isKey(r))){let e=this.report.pages.toList().firstOrDefault(e=>e.guid==r);null!=e&&i.add(e)}for(let e of this.columns)if(null!=(null==e?void 0:e.dashboardInteraction)&&e.dashboardInteraction.onClick==di.ShowDashboard&&(r=null==(t=null==e?void 0:e.dashboardInteraction)?void 0:t.drillDownPageKey,de.isKey(r))){let e=this.report.pages.toList().firstOrDefault(e=>e.guid==r);null!=e&&i.add(e)}return 0==i.length?null:i.distinct()}getFormatObjects(){return xu.getSelectedObjects(this)}constructor(e=L.empty){super(e),this.shadow=new We,this.cornerRadius=new v(0),this.title=new R.e.StiTitle,this.layout=new tl,this.group="",this._style=o.Auto,this.customStyleName="",this.userFilters=new j,this.userSorts=new j,this.transformActions=new j,this.transformFilters=new j,this.transformSorts=new j,this.dataTransformation={},this.dataFilters=new j,this.tableConditions=new j,this.crossFiltering=!0,this.helpUrl="user-manual/dashboards_table.htm",this.columns=new j,this.sizeMode=yu.AutoSize,this.rowsPerPage=0,this.pageTurnTime=0,this.currentPageIndex=-1,this.cells=new fu,this.title.text=this.localizedName,this.dashboardInteraction=new bu}}R.K.StiTableElement=Gm}let Tu=P.System.Exception,Mu=(R.K.StiTableElementConditionHelper=class{static async getConditionResult(r,t,s){let e=!1;if(null!=r){try{if(t.dataType==R.a.StiFilterDataType.Numeric){let e=Gt.tryParse(r);e.successfully&&(r=e.result)}else if(t.dataType==R.a.StiFilterDataType.DateTime){let e=F.fromString(r.toString(),!1);r=null!=e?e:F.fromOADate(r[P.System.StiObject.stimulsoft]().toNumber())}}catch(e){}let i=await this.getConditionValue(t,s),e=r;if(null!=e&&null!=i){r[P.System.StiObject.stimulsoft]().getType()!=i[P.System.StiObject.stimulsoft]().getType()&&(r=r.toString(),i=i[P.System.StiObject.stimulsoft]().toString(),e=r);try{switch(t.condition){case R.a.StiFilterCondition.EqualTo:return 0==e[P.System.StiObject.stimulsoft]().compareTo(i);case R.a.StiFilterCondition.NotEqualTo:return 0!=e[P.System.StiObject.stimulsoft]().compareTo(i);case R.a.StiFilterCondition.GreaterThan:return 1==e[P.System.StiObject.stimulsoft]().compareTo(i);case R.a.StiFilterCondition.GreaterThanOrEqualTo:return 0<=e[P.System.StiObject.stimulsoft]().compareTo(i);case R.a.StiFilterCondition.LessThan:return-1==e[P.System.StiObject.stimulsoft]().compareTo(i);case R.a.StiFilterCondition.LessThanOrEqualTo:return e[P.System.StiObject.stimulsoft]().compareTo(i)<=0;case R.a.StiFilterCondition.Containing:{let e=r.toString(),t=i.toString();return-1!=e.indexOf(t)}case R.a.StiFilterCondition.NotContaining:{let e=r.toString(),t=i.toString();return-1==e.indexOf(t)}case R.a.StiFilterCondition.BeginningWith:{let e=r.toString(),t=i.toString();return e.startsWith(t)}case R.a.StiFilterCondition.EndingWith:{let e=r.toString(),t=i.toString();return e.endsWith(t)}}}catch(e){}}}return e}static async getConditionValue(i,r){try{let t=i.isExpression?await k.parseAsync(`{${i.value}}`,r):i.value;switch(i.dataType){case R.a.StiFilterDataType.String:return t;case R.a.StiFilterDataType.Numeric:return null!=t?t[P.System.StiObject.stimulsoft]().toNumber():0;case R.a.StiFilterDataType.DateTime:{let e=F.fromString(t,!1);if(null!=e)return e;break}case R.a.StiFilterDataType.Boolean:return"true"==t.toLowerCase()}}catch(e){let t=`Problem when parsing Table Element ${i} value
`;throw Tu.log(e,r,t),e}return null}static async processBackColor(e,t,r,s,l){for(let i of r.tableConditions.where(e=>e.keyDestinationMeters.includes(t)))for(let t=0;t<l.length;t++){let e=l[t];if(0<=i.keyDataFieldMeters.indexOf(e)&&0<(i.permissions&wu.BackColor)){let e=s[t];if(await this.getConditionResult(e,i,r))return i.backColor}}return e}static async processForeColor(e,t,r,s,l){for(let i of r.tableConditions.where(e=>e.keyDestinationMeters.includes(t)))for(let t=0;t<l.length;t++){let e=l[t];if(i.keyDataFieldMeters.includes(e)&&0<(i.permissions&wu.ForeColor)){let e=s[t];if(await this.getConditionResult(e,i,r))return i.foreColor}}return e}static async processForeAndBackColor(e,t,i,s,l,n){let a={foreColor:null,backColor:null};for(let r of s.tableConditions.where(e=>0<=e.keyDestinationMeters.indexOf(i)))for(let i=0;i<n.length;i++){let e=n[i],t=l[i];if((null==a.foreColor||null==a.backColor)&&0<=r.keyDataFieldMeters.indexOf(e)&&await this.getConditionResult(t,r,s)&&(0<(r.permissions&wu.ForeColor)&&(a.foreColor=r.foreColor),0<(r.permissions&wu.BackColor))&&(a.backColor=r.backColor),null!=a.backColor&&null!=a.foreColor)return a}return null==a.foreColor&&(a.foreColor=e),null==a.backColor&&(a.backColor=t),a}static async processFontStyle(e,t,i,r,s){let l=0<i.tableConditions.length?await this.processFontBold(e.bold,t,i,r,s):e.bold,n=0<i.tableConditions.length?await this.processFontItalic(e.italic,t,i,r,s):e.italic,a=0<i.tableConditions.length?await this.processFontUnderline(e.underline,t,i,r,s):e.underline,o=0<i.tableConditions.length?await this.processFontStrikeout(e.strikeout,t,i,r,s):e.strikeout,u=cl.Regular;return l&&(u^=cl.Bold),n&&(u^=cl.Italic),a&&(u^=cl.Underline),o&&(u^=cl.Strikeout),u}static async processFontStrikeout(e,t,s,l,n){for(let r of s.tableConditions.where(e=>e.keyDestinationMeters.includes(t)))for(let i=0;i<n.length;i++){let e=n[i],t=l[i];if(r.keyDataFieldMeters.includes(e)&&0<(r.permissions&wu.FontStyleStrikeout)&&await this.getConditionResult(t,r,s))return r.font.strikeout}return e}static async processFontUnderline(e,t,s,l,n){for(let r of s.tableConditions.where(e=>e.keyDestinationMeters.includes(t)))for(let i=0;i<n.length;i++){let e=n[i],t=l[i];if(r.keyDataFieldMeters.includes(e)&&0<(r.permissions&wu.FontStyleUnderline)&&await this.getConditionResult(t,r,s))return r.font.underline}return e}static async processFontItalic(e,t,s,l,n){for(let r of s.tableConditions.where(e=>e.keyDestinationMeters.includes(t)))for(let i=0;i<n.length;i++){let e=n[i],t=l[i];if(r.keyDataFieldMeters.includes(e)&&0<(r.permissions&wu.FontStyleItalic)&&await this.getConditionResult(t,r,s))return r.font.italic}return e}static async processFontBold(e,t,s,l,n){for(let r of s.tableConditions.where(e=>e.keyDestinationMeters.includes(t)))for(let i=0;i<n.length;i++){let e=n[i],t=l[i];if(r.keyDataFieldMeters.includes(e)&&0<(r.permissions&wu.FontStyleBold)&&await this.getConditionResult(t,r,s))return r.font.bold}return e}static async getIconCondition(t,s,l,n){for(let r of s.tableConditions.filter(e=>e.keyDestinationMeters&&0<=e.keyDestinationMeters.indexOf(t)))for(let i=0;i<n.length;i++){let e=n[i],t=l[i];if(0<=r.keyDataFieldMeters.indexOf(e)&&await this.getConditionResult(t,r,s))return r}return null}},P.Report.Dashboard.IStiTableSection),Au=R.N.StiPivotTableElement,Du=P.Report.Dashboard.StiPivotToContainerCache;{class gp{implements(){let e=[Mu,n];return(this.implements=()=>e)()}meta(){return[new i("BackColor","",N.transparent),new i("ForeColor","",N.transparent),new At("Font","","Arial",10)]}saveToJsonObject(e){return u.saveToJsonObject(e,this)}loadFromJsonObject(e){u.loadFromJsonObject(e,this)}loadFromXml(e){u.loadFromXml(e,this)}static createFromJsonObject(e){let t=new gp;return t.loadFromJsonObject(e),t}static createFromXml(e){let t=new gp;return t.loadFromXml(e),t}clone(){let e=this[P.System.StiObject.stimulsoft]().memberwiseClone();return e.font=this.font.clone(),e}isDefault(){return!this.shouldSerializeBackColor()&&!this.shouldSerializeForeColor()&&!this.shouldSerializeFont()}get backColor(){return this._backColor}set backColor(e){e.equals(this._backColor)||(this._backColor=e,this.clearElementCache())}shouldSerializeBackColor(){return!this.backColor.equals(N.transparent)}get foreColor(){return this._foreColor}set foreColor(e){e.equals(this._foreColor)||(this._foreColor=e,this.clearElementCache())}shouldSerializeForeColor(){return!this.foreColor.equals(N.transparent)}get font(){return this._font}set font(e){this._font!=e&&(this._font=e,this.clearElementCache())}shouldSerializeFont(){return!(null!=this.font&&"Arial"==this.font.name&&10==this.font.sizeInPoints&&this.font.style==cl.Regular)}clearElementCache(){var e;null!=(e=this.element)&&e.is(Au)&&this.element.isDesigning&&Du.remove(this.element.as(Au))}constructor(e,t,i){this._backColor=N.transparent,this._foreColor=N.transparent,this._font=new B("Arial",10),null!=e&&(this.font=e),null!=t&&(this.foreColor=t),null!=i&&(this.backColor=i)}}R.K.StiTableSection=gp}R.ad.StiDataBarsColumnConverter=class extends cn{},R.ad.StiDimensionColumnConverter=class extends cn{},R.ad.StiSparklinesColumnConverter=class extends cn{},R.ad.StiTableColumnConverter=class extends cn{},R.g.StiTextDashboardInteraction=class extends R.g.StiDashboardInteraction{isDefault(){return this.onHover==ci.ShowToolTip&&this.onClick==di.OpenHyperlink&&this.hyperlinkDestination==gi.NewTab&&H.isNullOrEmpty(this.hyperlink)&&H.isNullOrEmpty(this.drillDownPageKey)&&null!=this.drillDownParameters&&0==this.drillDownParameters.length&&H.isNullOrEmpty(this.toolTip)}constructor(e,t,i,r,s,l,n){super(e,t,i,r,s,l,n),this.ident=pi.Text,this.availableOnClick=Si.OpenHyperlink|Si.ShowDashboard,this.onClick=di.OpenHyperlink}};let Iu=P.Report.StiParserType,Ru=R.g.StiTextDashboardInteraction,Eu=P.Report.Dashboard.StiDashboardDesignAssembly,ku=P.Report.Dashboard.ImplementsIStiTextElement,Ou=P.Report.Dashboard.IStiTextElement,Vu=P.Report.Components.IStiTextFont,Nu=(ht.add("StiTextElement","Stimulsoft.Dashboard.Export.Tools.StiTextElementExportTool"),R.V.StiTextElement=class extends R.e.StiElement{implements(){let e=super.implements().concat([Vu,Ue,Je,Ai,li,si,Ou,Ie,ke,..._i,...Ze,...Ge,...Fi,...ei,...$t,...ku,...il,n,Ci]);return(this.implements=()=>e)()}clone(e){let t,i,r,s=super.clone(e);return s.title=null!=this.title?this.title.clone():null,s.shadow=null==(t=this.shadow)?void 0:t.clone(),s.cornerRadius=null==(i=this.cornerRadius)?void 0:i.clone(),s.dashboardInteraction=null==(r=this.dashboardInteraction)?void 0:r.clone(),s.measures=this.measures.select(e=>e.clone()).toList(),s}meta(){return[...super.meta(),new se("HorAlignment"),new se("Padding"),new l("Group"),new l("Style"),new s("DashboardInteraction").check(()=>null!=this.dashboardInteraction).set(e=>{let t,i=null==(t=bi.loadInteractionFromJsonObject(e.value))?void 0:t.as(Ru);null!=i&&(this.dashboardInteraction=i)}).setXml(e=>{let t,i=null==(t=bi.loadInteractionFromXml(e))?void 0:t.as(Ru);null!=i&&(this.dashboardInteraction=i)}),new s("Padding").get(()=>this.padding.saveToJsonObject(0,0,0,0)),new i("ForeColor","",N.transparent),new l("Text"),new r("VertAlignment","",Ht,Ht.Center),new r("SizeMode","",Mt,Mt.Fit),new h("CrossFiltering","",!0),new l("CornerRadius").get(()=>this.cornerRadius.toString()).set(e=>this.cornerRadius=v.tryParse(e.value.toString())).setXml(e=>this.cornerRadius=v.tryParse(e.textContent)),new l("Shadow").get(()=>a.Serialize.jShadow(this.shadow)).set(e=>this.shadow=a.Deserialize.simpleSahdow(e.value)).setXml(e=>this.shadow=We.loadFromXml(e.textContent)),new s("Title").check(()=>null!=this.title).set(e=>this.title=R.e.StiTitle.createFromJsonObject(e.value)).setXml(e=>this.title=R.e.StiTitle.createFromXml(e)),new h("RightToLeft","",!1),new s("Measures").get(e=>a.Serialize.objectArray(this.measures,e)).set(e=>this.measures.addRange(e.value.properties().select(e=>d.loadFromJson(e.value).as(Vr)).where(e=>null!=e))).setXml(e=>this.measures.addRange(e.childNodes.map(e=>d.loadFromXml(e)).filter(e=>null!=e)))]}get isDefined(){return!H.isNullOrWhiteSpace(this.text)}get isQuerable(){return!this.isReportParserExpression&&!H.isNullOrEmpty(this.text)&&this.text.includes("{")}fetchAllMeters(){return this.getMeters()}getMeters(){if(this.isReportParserExpression)return new j;{if(H.isNullOrEmpty(this.text))return null;let t=new j,i=Or.fetchBlocksFromExpression(this.text),r=Vr.getUniqueNames(this.measures);for(let e of i)r.containsKey(e)?t.add(r.get(e)):t.add(new R.V.StiTextMeter(e,e,e));return t.cast().toList()}}retrieveUsedDataNames(){return this.isReportParserExpression?super.retrieveUsedDataNames():rl.getMany2(this.getMeters()).distinct().toList()}getSimpleText(){return this.getHtmlTextHelper().getSimpleText(this.text,U.getForeColor(this))}getMeasures(){return this.measures.cast().toList()}addMeasure(){let e=new Vr;e.expression="Sum(DataSource.Field)",this.measures.add(e)}getMeasure(e){return c.Text.getMeter2(e)}removeMeasure(e){e<this.measures.length&&this.measures.removeAt(e)}removeAllMeasures(){this.measures.clear()}insertMeasure(e,t){let i=t.as(Vr);0<=e&&e<this.measures.length?this.measures.insert(e,i):this.measures.add(i)}getFont(){let e=this.getHtmlTextHelper();if(null==e)return null;return e.getFont(this,this.text,U.getForeColor(this))}setFontName(e){let t=this.getHtmlTextHelper();null!=t&&(this.text=t.setFontName(this,this.text,e,U.getForeColor(this)))}setFontSize(e){let t=this.getHtmlTextHelper();null!=t&&(this.text=t.setFontSize(this,this.text,e,U.getForeColor(this)))}growFontSize(){let e=this.getHtmlTextHelper();null!=e&&(this.text=e.growFontSize(this,this.text,U.getForeColor(this)))}shrinkFontSize(){let e=this.getHtmlTextHelper();null!=e&&(this.text=e.shrinkFontSize(this,this.text,U.getForeColor(this)))}setFontBoldStyle(e){let t=this.getHtmlTextHelper();null!=t&&(this.text=t.setFontBoldStyle(this,this.text,e,U.getForeColor(this)))}setFontItalicStyle(e){let t=this.getHtmlTextHelper();null!=t&&(this.text=t.setFontItalicStyle(this,this.text,e,U.getForeColor(this)))}setFontUnderlineStyle(e){let t=this.getHtmlTextHelper();null!=t&&(this.text=t.setFontUnderlineStyle(this,this.text,e,U.getForeColor(this)))}get horAlignment(){let e=this.getHtmlTextHelper();return e.getHorAlign(this,this.text,U.getForeColor(this))}set horAlignment(e){this.text=this.getHtmlTextHelper().setHorAlignment(this,this.text,e,U.getForeColor(this))}get style(){return this.componentStyle}set style(e){this.componentStyle=e}setString(e,t){switch(e){case"Title.Text":this.title.text=t;break;case"Text":this.text=t;break}}getString(e){switch(e){case"Title.Text":return this.title.text;case"Text":return this.text}throw new Error(`Property with name `+e)}getAllStrings(){return["Title.Text","Text"]}get toolboxPosition(){return _e.TextElement}get localizedName(){return T.get("Components","StiText")}get isReportParserExpression(){return P.StiOptions.Engine.dashboardTextElementExpressionParser==Iu.ReportParser||Or.isThisExpression(this.text)}getNestedPages(){if(null==this.dashboardInteraction||this.dashboardInteraction.onClick!=di.ShowDashboard)return null;let t=this.dashboardInteraction.drillDownPageKey;if(de.isEmptyKey(t))return null;let e=this.report.pages.toList().firstOrDefault(e=>e.guid==t);if(null==e)return null;return new j([e])}getHtmlTextHelper(){return Eu.getHtmlTextHelper()}constructor(e=L.empty){super(e),this.title=new R.e.StiTitle,this.shadow=new We,this.cornerRadius=new v(0),this.text="",this.rightToLeft=!1,this.group="",this.foreColor=N.transparent,this.crossFiltering=!0,this.vertAlignment=Ht.Center,this.defaultClientRectangle=new L(0,0,100,40),this.helpUrl="user-manual/dashboards_text.htm",this.sizeMode=Mt.Fit,this.measures=new j,this.title.text=this.localizedName,this.title.visible=!1,this.padding=it.create(0),this.dashboardInteraction=new Ru}},R.aa.StiTextConverter=class{},R.J.StiTreeItem=class{toString(){return null==this.key?"":this.key.toString()}constructor(e,t){this.key=e,this.meter=t}},P.Report.Dashboard.ImplementsIStiTreeViewElement),Lu=P.Report.Dashboard.IStiTreeViewElement,Bu=P.Report.Dashboard.StiItemFilterMode,Pu=(ht.add("StiTreeViewElement","Stimulsoft.Dashboard.Export.Tools.StiTreeViewElementExportTool"),R.J.StiTreeViewElement=class extends R.e.StiElement{implements(){let e=super.implements().concat([Lu,Ue,Je,Ie,ke,...Nu,...Ze,...Ge,...il,n]);return(this.implements=()=>e)()}clone(e){let t,i,r=super.clone(e);return r.keyMeters=this.keyMeters.select(e=>e.clone()).toList(),r.userFilters=this.userFilters.select(e=>e.clone()).toList(),r.transformActions=this.transformActions.select(e=>e.clone()).toList(),r.transformFilters=this.transformFilters.select(e=>e.clone()).toList(),r.transformSorts=this.transformSorts.select(e=>e.clone()).toList(),r.dataFilters=this.dataFilters.select(e=>e.clone()).toList(),r.textFormat=this.textFormat.clone(),r.title=null!=this.title?this.title.clone():null,r.shadow=null==(t=this.shadow)?void 0:t.clone(),r.cornerRadius=null==(i=this.cornerRadius)?void 0:i.clone(),r}meta(){return[...super.meta(),new l("ParentKey"),new s("UserFilters").get(e=>a.Serialize.objectArray(this.userFilters,e)).set(e=>this.userFilters.addRange(e.value.properties().select(e=>y.loadFromJson(e.value)))).setXml(e=>this.userFilters.addRange(e.childNodes.map(e=>y.loadFromXml(e)))),new s("TransformActions").get(e=>a.Serialize.objectArray(this.transformActions,e)).set(e=>this.transformActions.addRange(e.value.properties().select(e=>nl.loadFromJson(e.value)))).setXml(e=>this.transformActions.addRange(e.childNodes.map(e=>nl.loadFromXml(e)))),new s("TransformFilters").get(e=>a.Serialize.objectArray(this.transformFilters,e)).set(e=>this.transformFilters.addRange(e.value.properties().select(e=>y.loadFromJson(e.value)))).setXml(e=>this.transformFilters.addRange(e.childNodes.map(e=>y.loadFromXml(e)))),new s("TransformSorts").get(e=>a.Serialize.objectArray(this.transformSorts,e)).set(e=>this.transformSorts.addRange(e.value.properties().select(e=>ll.loadFromJson(e.value)))).setXml(e=>this.transformSorts.addRange(e.childNodes.map(e=>ll.loadFromXml(e)))),new s("DataFilters").get(e=>a.Serialize.objectArray(this.dataFilters,e)).set(e=>this.dataFilters.addRange(e.value.properties().select(e=>y.loadFromJson(e.value)))).setXml(e=>this.dataFilters.addRange(e.childNodes.map(e=>y.loadFromXml(e)))),new i("ForeColor","",N.transparent),new l("Font").get(()=>a.Serialize.fontArial8(this.font)).set(e=>this.font=a.Deserialize.font(e.value,this.font)).setXml(e=>this.font=P.System.Convert.toFont(e.textContent)),new h("ShowAllValue"),new h("ShowBlanks"),new s("KeyMeters").get(e=>a.Serialize.objectArray(this.keyMeters,e)).set(e=>this.keyMeters.addRange(e.value.properties().select(e=>d.loadFromJson(e.value)))).setXml(e=>this.keyMeters.addRange(e.childNodes.map(e=>d.loadFromXml(e)))),new s("Title").check(()=>null!=this.title).set(e=>this.title=R.e.StiTitle.createFromJsonObject(e.value)).setXml(e=>this.title=R.e.StiTitle.createFromXml(e)),new r("SelectionMode","",pn,pn.Multi),new r("FilterMode","",Bu,Bu.SelectedOnly),new r("Style","",o,o.Auto),new r("InclusionMode","",q,q.SelectionOnly),new l("Group"),new l("CustomStyleName"),new l("CornerRadius").get(()=>this.cornerRadius.toString()).set(e=>this.cornerRadius=v.tryParse(e.value.toString())).setXml(e=>this.cornerRadius=v.tryParse(e.textContent)),new l("Shadow").get(()=>a.Serialize.jShadow(this.shadow)).set(e=>this.shadow=a.Deserialize.simpleSahdow(e.value)).setXml(e=>this.shadow=We.loadFromXml(e.textContent)),new s("TextFormat").check(()=>null!=this.textFormat).set(e=>this.textFormat=Mi.createFromJsonObject(e.value)).setXml(e=>this.textFormat=Mi.loadFormatFromXml(e,this.report))]}getParentKey(){return this.parentKey}setParentKey(e){this.parentKey=e}async applyDefaultFilters(){let e=await R.J.StiTreeViewHelper.fetchDefaultUserFilters(this);null!=e&&(this.userFilters=e)}getIdentityFilters(){return R.J.StiTreeViewHelper.getValueMeterExpressions(this).select(e=>{let t=new y;t.condition=Ot.Any,t.elementKey=this.key,t.path=e}).toList().cast()}get style(){return this._style}set style(e){(this._style=e)!=o.Custom&&(this.customStyleName="")}fetchAllMeters(){let e=new j;return e.addRange(this.keyMeters),e}getMeters(){let e=new j;return e.addRange(this.keyMeters),e}retrieveUsedDataNames(){return rl.getMany2(this.keyMeters)}get isDefined(){return null!=this.keyMeters&&0<this.keyMeters.length}getKeyMeter(e){return null!=e?c.TreeView.getKey2(e):null}getKeyMeterByIndex(e){return e<this.keyMeters.length?this.keyMeters[e]:null}insertKeyMeter(e,t){let i=t.as(R.J.StiKeyTreeViewMeter);null!=i&&(0<=e&&e<this.keyMeters.length?this.keyMeters.insert(e,i):this.keyMeters.add(i))}removeKeyMeter(e){e<this.keyMeters.length&&this.keyMeters.removeAt(e)}removeAllKeyMeters(){this.keyMeters.clear()}addNewKeyMeter(){let e=new R.J.StiKeyTreeViewMeter;return this.keyMeters.add(e),e}addKey(e){null==this.keyMeters&&(this.keyMeters=new j),this.keyMeters.add(c.TreeView.getKey2(e))}convertFrom(e){let t=e.fetchAllMeters();if(null==t)return;let i=t.firstOrDefault(e=>e.is(ji));if(null!=(i=null==i?t.firstOrDefault(e=>e.is(vt)):i)){let e=new R.J.StiKeyTreeViewMeter;e.loadFromJsonObject(i.saveToJsonObject(Le.Report)),this.keyMeters.clear(),this.keyMeters.add(e)}}setString(e,t){switch(e){case"Title.Text":this.title.text=t;break}}getString(e){switch(e){case"Title.Text":return this.title.text}throw new Error(`Property with name `+e)}getAllStrings(){return["Title.Text"]}get toolboxPosition(){return _e.TreeViewElement}get localizedName(){return T.get("Components","StiTreeView")}constructor(e=L.empty){super(e),this.group="",this.shadow=new We,this.cornerRadius=new v(0),this.inclusionMode=q.SelectionOnly,this.title=new R.e.StiTitle,this._style=o.Auto,this.customStyleName="",this.userFilters=new j,this.transformActions=new j,this.transformFilters=new j,this.transformSorts=new j,this.dataTransformation={},this.dataFilters=new j,this.font=new B("Arial",8),this.foreColor=N.transparent,this.showAllValue=!1,this.showBlanks=!1,this.selectionMode=pn.Multi,this.filterMode=Bu.SelectedOnly,this.textFormat=new zt,this.defaultClientRectangle=new L(0,0,200,300),this.helpUrl="user-manual/dashboards_data_filtering_tree_view.htm",this.keyMeters=new j,this.title.text=this.localizedName,this.title.visible=!1}},R.J.StiTreeItem),Hu=(R.J.StiTreeViewHelper=class{static fetchItems(n,a){let t=new Pu;for(let e of n.rows){let s=0,l=t;for(let r of e){let e=null==r,t="string"==typeof r?H.isNullOrEmpty(r):null==r,i=e||t;if(a||!i){let e=null!=l.items?l.items.firstOrDefault(e=>e.key==r):null;null==e&&(e=new Pu(r,n.meters[s]),null==l.items&&(l.items=new j),l.items.add(e)),l=e}s++}}return t.items}static async fetchDefaultUserFilters(e){if(e.showAllValue)return null;if(e.selectionMode==pn.Multi)return null;let t=await yn.getOrCreate(e),i=this.fetchItems(t,e.showBlanks);if(null==i)return null;let r=i.firstOrDefault();if(null==r)return null;let s=r.meter,l=s.expression;return fn.createEqualBasedOnValue(r.key,l,e).toList()}static format(e,t){var i;if(t instanceof F&&!(e.textFormat.is2(Ji)||e.textFormat.is2(Gi)||e.textFormat.is2(wn)))return t.toShortDateString();let r=null==(i=null==e?void 0:e.report)?void 0:i.getParsedCulture();if(nr.isEligable(t,r))return nr.convert(t,r);return e.textFormat.format(t)}static getValueMeterExpressions(e){var t,i;return null==(i=null==(t=e.keyMeters)?void 0:t.select(e=>e.expression))?void 0:i.toList()}},P.Report.Dashboard.ImplementsIStiTreeViewBoxElement),ju=P.Report.Dashboard.IStiTreeViewBoxElement,zu=(ht.add("StiTreeViewBoxElement","Stimulsoft.Dashboard.Export.Tools.StiTreeViewBoxElementExportTool"),R.I.StiTreeViewBoxElement=class extends R.e.StiElement{implements(){let e=super.implements().concat([ju,Ue,Je,ii,...Hu,...Ze,...Ge,...qt,n]);return(this.implements=()=>e)()}meta(){return[new h("FixedHeight","",!0),...super.meta(),new l("ParentKey"),new s("UserFilters").get(e=>a.Serialize.objectArray(this.userFilters,e)).set(e=>this.userFilters.addRange(e.value.properties().select(e=>y.loadFromJson(e.value)))).setXml(e=>this.userFilters.addRange(e.childNodes.map(e=>y.loadFromXml(e)))),new s("TransformActions").get(e=>a.Serialize.objectArray(this.transformActions,e)).set(e=>this.transformActions.addRange(e.value.properties().select(e=>nl.loadFromJson(e.value)))).setXml(e=>this.transformActions.addRange(e.childNodes.map(e=>nl.loadFromXml(e)))),new s("TransformFilters").get(e=>a.Serialize.objectArray(this.transformFilters,e)).set(e=>this.transformFilters.addRange(e.value.properties().select(e=>y.loadFromJson(e.value)))).setXml(e=>this.transformFilters.addRange(e.childNodes.map(e=>y.loadFromXml(e)))),new s("TransformSorts").get(e=>a.Serialize.objectArray(this.transformSorts,e)).set(e=>this.transformSorts.addRange(e.value.properties().select(e=>ll.loadFromJson(e.value)))).setXml(e=>this.transformSorts.addRange(e.childNodes.map(e=>ll.loadFromXml(e)))),new s("DataFilters").get(e=>a.Serialize.objectArray(this.dataFilters,e)).set(e=>this.dataFilters.addRange(e.value.properties().select(e=>y.loadFromJson(e.value)))).setXml(e=>this.dataFilters.addRange(e.childNodes.map(e=>y.loadFromXml(e)))),new i("ForeColor","",N.transparent),new l("Font").get(()=>a.Serialize.fontArial8(this.font)).set(e=>this.font=a.Deserialize.font(e.value,this.font)).setXml(e=>this.font=P.System.Convert.toFont(e.textContent)),new h("ShowAllValue"),new h("ShowBlanks"),new r("SelectionMode","",pn,pn.Multi),new r("FilterMode","",Bu,Bu.SelectedOnly),new s("KeyMeters").get(e=>a.Serialize.objectArray(this.keyMeters,e)).set(e=>this.keyMeters.addRange(e.value.properties().select(e=>d.loadFromJson(e.value)))).setXml(e=>this.keyMeters.addRange(e.childNodes.map(e=>d.loadFromXml(e)))),new r("Style","",o,o.Auto),new l("Group"),new l("CustomStyleName"),new l("CornerRadius").get(()=>this.cornerRadius.toString()).set(e=>this.cornerRadius=v.tryParse(e.value.toString())).setXml(e=>this.cornerRadius=v.tryParse(e.textContent)),new l("Shadow").get(()=>a.Serialize.jShadow(this.shadow)).set(e=>this.shadow=a.Deserialize.simpleSahdow(e.value)).setXml(e=>this.shadow=We.loadFromXml(e.textContent)),new s("TextFormat").check(()=>null!=this.textFormat).set(e=>this.textFormat=Mi.createFromJsonObject(e.value)).setXml(e=>this.textFormat=Mi.loadFormatFromXml(e,this.report)),new se("MinSize"),new se("MaxSize"),new r("InclusionMode","",q,q.SelectionOnly)]}clone(e){let t,i,r=super.clone(e);return r.keyMeters=this.keyMeters.select(e=>e.clone()).toList(),r.userFilters=this.userFilters.select(e=>e.clone()).toList(),r.transformActions=this.transformActions.select(e=>e.clone()).toList(),r.transformFilters=this.transformFilters.select(e=>e.clone()).toList(),r.transformSorts=this.transformSorts.select(e=>e.clone()).toList(),r.dataFilters=this.dataFilters.select(e=>e.clone()).toList(),r.textFormat=this.textFormat.clone(),r.shadow=null==(t=this.shadow)?void 0:t.clone(),r.cornerRadius=null==(i=this.cornerRadius)?void 0:i.clone(),r}get isFixedHeight(){return this.fixedHeight}getParentKey(){return this.parentKey}setParentKey(e){this.parentKey=e}async applyDefaultFilters(){let e=await R.I.StiTreeViewBoxHelper.fetchDefaultUserFilters(this);null!=e&&(this.userFilters=e)}getIdentityFilters(){return R.I.StiTreeViewBoxHelper.getValueMeterExpressions(this).select(e=>{let t=new y;t.condition=Ot.Any,t.elementKey=this.key,t.path=e}).toList().cast()}get style(){return this._style}set style(e){(this._style=e)!=o.Custom&&(this.customStyleName="")}fetchAllMeters(){let e=new j;return e.addRange(this.keyMeters),e}getMeters(){let e=new j;return e.addRange(this.keyMeters),e}retrieveUsedDataNames(){return rl.getMany2(this.keyMeters)}get isDefined(){return null!=this.keyMeters&&0<this.keyMeters.length}getKeyMeter(e){return null!=e?c.TreeViewBox.getKey2(e):null}getKeyMeterByIndex(e){return e<this.keyMeters.length?this.keyMeters[e]:null}insertKeyMeter(e,t){let i=t.as(R.I.StiKeyTreeViewBoxMeter);null!=i&&(0<=e&&e<this.keyMeters.length?this.keyMeters.insert(e,i):this.keyMeters.add(i))}removeKeyMeter(e){e<this.keyMeters.length&&this.keyMeters.removeAt(e)}removeAllKeyMeters(){this.keyMeters.clear()}addNewKeyMeter(){let e=new R.I.StiKeyTreeViewBoxMeter;return this.keyMeters.add(e),e}addKey(e){null==this.keyMeters&&(this.keyMeters=new j),this.keyMeters.add(c.TreeViewBox.getKey2(e))}convertFrom(e){let t=e.fetchAllMeters();if(null==t)return;let i=t.firstOrDefault(e=>e.is(ji));if(null!=(i=null==i?t.firstOrDefault(e=>e.is(vt)):i)){let e=new R.I.StiKeyTreeViewBoxMeter;e.loadFromJsonObject(i.saveToJsonObject(Le.Report)),this.keyMeters.clear(),this.keyMeters.add(e)}}get toolboxPosition(){return _e.TreeViewBoxElement}get localizedName(){return T.get("Components","StiTreeViewBox")}getMinSize(){let e=null!=this.report?this.report.getCurrentPage():null;if(null==e)return W.empty;let t=Lt.alignToMaxGrid(this.defaultClientRectangle.height,e.gridSize,!0);return new W(0,t)}setMinSize(e){}getMaxSize(){if(!this.fixedHeight)return super.getMaxSize();let e=null!=this.report?this.report.getCurrentPage():null;if(null==e)return W.empty;let t=Lt.alignToMaxGrid(this.defaultClientRectangle.height,e.gridSize,!0);return new W(0,t)}setMaxSize(e){this.fixedHeight||super.setMaxSize(e)}get fixedHeight(){return this._fixedHeight}set fixedHeight(e){var t;this._fixedHeight!=e&&(this._fixedHeight=e)&&(this.height=Lt.alignToMaxGrid(this.defaultClientRectangle.height,null==(t=this.page)?void 0:t.gridSize,!0))}constructor(e=L.empty){super(e),this.group="",this.inclusionMode=q.SelectionOnly,this.shadow=new We,this.cornerRadius=new v(0),this._style=o.Auto,this.customStyleName="",this.userFilters=new j,this.transformActions=new j,this.transformFilters=new j,this.transformSorts=new j,this.dataTransformation={},this.dataFilters=new j,this.font=new B("Arial",8),this.foreColor=N.transparent,this.showAllValue=!1,this.showBlanks=!1,this.selectionMode=pn.Multi,this.filterMode=Bu.SelectedOnly,this.textFormat=new zt,this.defaultClientRectangle=new L(0,0,200,40),this.helpUrl="user-manual/dashboards_data_filtering_tree_view_box.htm",this._fixedHeight=!0,this.keyMeters=new j}},R.J.StiTreeViewHelper),Xu=(R.I.StiTreeViewBoxHelper=class{static async fetchDefaultUserFilters(e){if(e.showAllValue)return null;if(e.selectionMode==pn.Multi)return null;let t=await yn.getOrCreate(e),i=zu.fetchItems(t,e.showBlanks);if(null==i)return null;let r=i.firstOrDefault();if(null==r)return null;let s=r.meter,l=s.expression;return fn.createEqualBasedOnValue(r.key,l,e).toList()}static format(e,t){var i,r;return t instanceof F&&!(e.textFormat.is2(Ji)||e.textFormat.is2(Gi)||e.textFormat.is2(wn))?t.toShortDateString():nr.isEligable(t,null==(i=null==e?void 0:e.report)?void 0:i.culture)?nr.convert(t,null==(r=null==e?void 0:e.report)?void 0:r.culture):e.textFormat.format(t)}static getValueMeterExpressions(e){var t,i;return null==(i=null==(t=e.keyMeters)?void 0:t.select(e=>e.expression))?void 0:i.toList()}},P.Report.Dashboard.ImplementsIStiWebContentElement),Gu=P.Report.Dashboard.IStiWebContentElement;ht.add("StiWebContentElement","Stimulsoft.Dashboard.Export.Tools.StiWebContentElementExportTool"),R.Y.StiWebContentElement=class extends R.e.StiElement{implements(){let e=super.implements().concat([Gu,Je,Ue,Ie,...Xu,...Ge,...Ze,...il,n]);return(this.implements=()=>e)()}clone(e){let t,i,r=super.clone(e);return r.title=null!=this.title?this.title.clone():null,r.shadow=null==(t=this.shadow)?void 0:t.clone(),r.cornerRadius=null==(i=this.cornerRadius)?void 0:i.clone(),r}meta(){return[...super.meta(),new l("URL","url"),new l("EmbedCode"),new l("CornerRadius").get(()=>this.cornerRadius.toString()).set(e=>this.cornerRadius=v.tryParse(e.value.toString())).setXml(e=>this.cornerRadius=v.tryParse(e.textContent)),new l("Shadow").get(()=>a.Serialize.jShadow(this.shadow)).set(e=>this.shadow=a.Deserialize.simpleSahdow(e.value)).setXml(e=>this.shadow=We.loadFromXml(e.textContent)),new s("Title").check(()=>null!=this.title).set(e=>this.title=R.e.StiTitle.createFromJsonObject(e.value)).setXml(e=>this.title=R.e.StiTitle.createFromXml(e))]}get isDefined(){return!H.isNullOrWhiteSpace(this.url)||!H.isNullOrWhiteSpace(this.embedCode)}get isQuerable(){return this.isDefined}fetchAllMeters(){return null}getMeters(){if(!this.isURLExpressionOrHyperlinkDataColumnDefined)return new j;if(this.isURLExpressionDefined)return Or.fetchBlocksFromExpression(this.url).select(e=>new Na(e,e,e)).cast().toList();{let e=Pa.getRealDataColumnFromHyperlink(this.report,this.url),t=new j;return t.add(new Na(e,e,e)),t}}retrieveUsedDataNames(){return rl.getMany2(this.getMeters()).distinct().toList()}get toolboxPosition(){return _e.WebContentElement}get localizedName(){return T.get("Components","StiWebContent")}get isURLExpressionOrHyperlinkDataColumnDefined(){return this.isURLExpressionDefined||this.isHyperlinkDataColumnDefined}get isURLExpressionDefined(){var e,t;return(null==(e=this.url)?void 0:e[P.System.StiObject.stimulsoft]().contains("{"))&&(null==(t=this.url)?void 0:t[P.System.StiObject.stimulsoft]().contains("}"))}get isHyperlinkDataColumnDefined(){return!H.isNullOrWhiteSpace(Pa.getRealDataColumnFromHyperlink(this.report,this.url))}constructor(e=L.empty){super(e),this.title=new R.e.StiTitle,this.shadow=new We,this.cornerRadius=new v(0),this.defaultClientRectangle=new L(0,0,120,120),this.helpUrl="user-manual/dashboards_image.htm",this.title.text=this.localizedName,this.title.visible=!1,this.padding=it.create(0)}},R.k.StiInplaceDesigner=class{};{let e;(K=e=R.r.StiRichTextAlignment||(R.r.StiRichTextAlignment={}))[K["Left"]=1]="Left",K[K["Right"]=2]="Right",K[K["Center"]=3]="Center",K[K["Justify"]=4]="Justify"}R.r.StiRichBoxControl=class{selectAll(){this.selectedText=this.text}select(e,t){!H.isNullOrEmpty(this.text)&&e<this.text.length&&(this.selectedText=this.text.substr(e,t))}beginUpdate(){}endUpdate(){}setSelectionFont(e){return this.selectionFont=Hn.changeFontName(this.selectionFont,e),!0}setSelectionSize(e){return this.selectionFont=Hn.changeFontSize(this.selectionFont,e),!0}setSelectionBold(e){return this.selectionFont=Hn.changeFontStyleBold(this.selectionFont,e),!0}setSelectionItalic(e){return this.selectionFont=Hn.changeFontStyleItalic(this.selectionFont,e),!0}setSelectionUnderlined(e){return this.selectionFont=Hn.changeFontStyleUnderline(this.selectionFont,e),!0}constructor(){this.selectionFont=new B("Arial",12),this.selectionColor=N.black,this.font=new B("Arial",12),this.text="",this.selectedText=""}};let Ju=P.Base.Drawing.StiTextRenderer,Wu=R.r.StiRichTextAlignment,Uu=P.System.Drawing.ColorTranslator,Zu=P.Base.Drawing.StiHtmlState,Yu=P.Base.Drawing.StiHtmlTagsState,Ku=R.r.StiRichBoxControl,Qu=(R.r.StiHtmlTextHelper=class{setFontName(e,t,i,r){let s=new Ku;return this.setHtmlText(t,e,s,r),s.selectAll(),s.setSelectionFont(i),this.getHtmlText(s,r)}setFontSize(e,t,i,r){let s=new Ku;return this.setHtmlText(t,e,s,r),s.selectAll(),s.setSelectionSize(Math.round(i)),this.getHtmlText(s,r)}growFontSize(e,t,i){let r=new Ku;return this.setHtmlText(t,e,r,i),r.selectAll(),r.setSelectionSize(Math.round(r.selectionFont.size+1)),this.getHtmlText(r,i)}shrinkFontSize(e,t,i){let r=new Ku;return this.setHtmlText(t,e,r,i),r.selectAll(),0<r.selectionFont.size-1&&r.setSelectionSize(Math.round(r.selectionFont.size-1)),this.getHtmlText(r,i)}setFontBoldStyle(e,t,i,r){let s=new Ku;return this.setHtmlText(t,e,s,r),s.selectAll(),s.setSelectionBold(i),this.getHtmlText(s,r)}setFontItalicStyle(e,t,i,r){let s=new Ku;return this.setHtmlText(t,e,s,r),s.selectAll(),s.setSelectionItalic(i),this.getHtmlText(s,r)}setFontUnderlineStyle(e,t,i,r){let s=new Ku;return this.setHtmlText(t,e,s,r),s.selectAll(),s.setSelectionUnderlined(i),this.getHtmlText(s,r)}setColor(e,t,i,r){let s=new Ku;return this.setHtmlText(t,e,s,r),s.selectAll(),s.selectionColor=i,this.getHtmlText(s,r)}setHorAlignment(e,t,i,r){let s=new Ku;return this.setHtmlText(t,e,s,r),s.selectAll(),s.selectionAlignment=this.getAlignment(i),this.getHtmlText(s,r)}getFont(e,t,i){let r=new Ku;return this.setHtmlText(t,e,r,i),r.selectAll(),r.selectionFont}getColor(e,t,i){let r=new Ku;return this.setHtmlText(t,e,r,i),r.selectAll(),r.selectionColor}getHorAlign(e,t,i){let r=new Ku;return this.setHtmlText(t,e,r,i),r.selectAll(),this.getAlignment2(r.selectionAlignment)}setHtmlText(e,t,n,i){let r="Arial",s=12,l=(n.selectAll(),n.setSelectionFont(r),n.setSelectionSize(s),new Yu(!1,!1,!1,!1,s,r,i,N.white,!1,!1,0,0,0,jt.Center)),a=null,o=new Zu(l,0),u=Ju.parseHtmlToStates(e,o,!1);for(let l of u){let e=n.text.length,t=(n.select(e,0),null),i=(t=H.isNullOrEmpty(l.ts.href)?l.text.toString():`<a href="${l.ts.href}">${l.text.toString()}</a>`,n.text+=t,n.select(e,l.text.length),cl.Regular),r=(l.ts.bold&&(i|=cl.Bold),l.ts.italic&&(i|=cl.Italic),l.ts.underline&&(i|=cl.Underline),l.ts.fontName),s=l.ts.fontSize;null==a&&(a=n.font=new B(r,s)),n.selectionFont=Hn.changeFontStyle2(r,s,i),n.selectionColor=l.ts.fontColor,n.selectionAlignment=this.getAlignment(l.ts.textAlign)}n.select(0,0)}getHtmlText(a,o){let u=!1,h=!1,m=!1,c=o,d="",e=(a.selectAll(),null!=a.selectionFont?a.selectionFont.name:"Arial"),t=null!=a.selectionFont?a.selectionFont.sizeInPoints:12,i=z.getName(Wu,a.selectionAlignment);d=d+`<font face="${e}" size="${t}">`+`<text-align="${i}">`;for(let n=0;n<a.text.length;n++){a.select(n,1);let e=a.selectionFont,t=null!=e&&e.style&cl.Bold,i=null!=e&&e.style&cl.Italic,r=null!=e&&e.style&cl.Underline,s=a.selectionColor,l="\n"==a.text[n];l&&(d+="<br />"),t&&!u&&(u=!0,d+="<b>"),!t&&u&&(u=!1,d+="</b>"),i&&!h&&(h=!0,d+="<i>"),!i&&h&&(h=!1,d+="</i>"),r&&!m&&(m=!0,d+="<u>"),!r&&m&&(m=!1,d+="</u>"),c.equals(s)||(c=(c.equals(o)?d+=`<font-color="${Uu.toHtml(s)}">`:s.equals(o)?d+="</font-color>":d=(d+="</font-color>")+`<font-color="${Uu.toHtml(s)}">`,s)),d+=a.text[n]}return c.equals(o)||(d+="</font-color>"),m&&(d+="</u>"),h&&(d+="</i>"),u&&(d+="</b>"),(d=d+"</text-align>"+"</font>").toString()}getAlignment(e){switch(e){case jt.Left:return Wu.Left;case jt.Center:return Wu.Center;case jt.Right:return Wu.Right;case jt.Width:return Wu.Justify;default:throw new Error("NotSupportedException")}}getAlignment2(e){switch(e){case Wu.Left:return jt.Left;case Wu.Center:return jt.Center;case Wu.Right:return jt.Right;case Wu.Justify:return jt.Width;default:throw new Error("NotSupportedException")}}getSimpleText(e,t){let i=new Ku;return this.setHtmlText(e,null,i,t),i.text}},P.Report.Components.StiHtmlTextRender),qu=P.System.Drawing.StringTrimming,_u=P.System.Drawing.Text.HotkeyPrefix,$u=R.V.StiTextElement,eh=P.Base.Drawing.StiTextOptions,th=(R.h.StiAutoSizeHtmlTextHelper=class{static measure(e,t,i,r,s=null){let l=this.getTextScale(s,r),n=(t.height=1e3,new B("Arial",12)),a=new Ho,o=(a.font=n,a.clientRectangle=t.clone(),a.text=i,r.as($u)),u=(null==o||o.sizeMode!=Mt.WordWrap&&o.sizeMode!=Mt.FitAndWordWrap||(a.wordWrap=!0),Qu.measureString(a));return new W(u.width*l,u.height*l)}static getDefaultTextOptions(){return new eh(!1,!1,!1,0,_u.None,qu.None)}static getTextScale(e,t){if(null!=e)return e;let i=t[P.System.StiObject.stimulsoft]().as(ve);return null!=i&&i.isDesigning?t.zoom:1}},P.Base.Drawing.StiTextDrawing);R.h.StiAutoSizeTextHelper=class{static toAlignment(e){switch(e){case X.Left:return jt.Left;case X.Center:return jt.Center;case X.Right:return jt.Right;default:throw new pa(e)}}static measure(e,t,i){let r=th.measureString(e,t,i);return new W(r.width,r.height)}static measure2(e,t,i,r){let s=new eh,l=(s.angle=0,s.wordWrap=!0,th.measureString(e,t,i,r,s));return new W(l.width,l.height)}static measureFontSize(e,t,i,r){let s=this.measure(e,t,r),l=s.width>i.width?i.width/s.width:1,n=i.height<s.height?i.height/s.height:1,a=Math.min(Math.abs(l),Math.abs(n));return r.size*a}};{class Zh{static getContent(){let e=P.System.compactBase64("ba\frT4>*qvsmN/~Un=O%Y=6%8;)m%:bc+{DvZ+R)O:I,UMN5o?/@d,@lr;E16N>@5i#]|'gkUt{4~YMOg0Jy_y\vVx?vLBjX)dVKQcWERQ}cun~;'3o/,hM\vG>k~/A~d?5_FpsphCsOc2JsyxvaQI\vt^Xvr)=R?:{Q5Y`~r].-.ZVU{F\tB>t~:o]s\v?T#F(~1>|CQy/c[kS$[~=Zl<O#/`/^><FCAc|;8~]Nk|2/.qnF63\f+ lb%5DzX,$j+|wpi\bs#Qm_>\vJVg<>F$kUQK>l9qaw%HODBI\v}\b<D#|joz]S7{jf\v~`6:?d74;/F|4S]azw;S4=*~y3M\tptrb3\vO.Ljo4KS0y\b^--m\v16>%TJ2o[`h/A|<.#5S/i.,OnXU$`#rAP)q8OGS/7kGks|z8^nWQA!_-RV(y%f7#}oBi,r>'u|jG%n:'u\vqfCB=T|r\va~|<?F,I9Z]JkgIwo9?T}UjaYTQEc7E\vjgZT/\tE^~oU>/;bFFWiY+e< e%#.!-(Y-!,[qN]d3R'TLDcVkiJ?f[%#+<X^j\fVN4 ,[h53\bW@2yr+\f_\b\bc'Vgt.-Fg[/K6X@Xm!<{p\f!g*+z7.< G'RpuF.TZ[W\b@OitM>u@>3|7=^,\tuDC?-2:`JuN\vlq_:h2CLb9bgU@p]_)GGsNG19M!x`E\f{!/T>ufV#eQy-\v5$SPBW|dgJo!nsceUi~Fjw_7kz~j]Rf5Vf{w-s#iNMch!5^A]cO1}@*3Dv+i|P/{_|uBW#Pr_U81(\ba=Y =X6EP]*/#<0*'L\v\vklC=i%Q0FHa:zt~}\tD]<E{F;N'}k xF)Yq{Da|LYO`^.U@Ew%NGWr;G8uoElD$D|E|\t)QNNARMxqBz071ezC#?YxtWtLHav@`ch_UP*`OIPn(\tM5\fb=,$#>x(i7k75W\vWWFDz<lU2lHpUSj\t{{DS}$\vKT<+*xdDu#!V#EtET81E~YhdDeYV/;8+b RS=\t3.LBM(6>0)8u]|EiO,}z\bp'H00 X7MV3$t{K3}.f_)Wa\tER/5Ri4CHd.\fR* 7.6~td.%:y'k]mn{N/G/S{)iXFOK%8=!/;rQA-83<UY#-V\v[V*Ik,bk:>z|>!?gt_.7PWk?oQm\b;ln\fs>dyLE%'gsmgu=%)524'l\bYkcC'!0PUB6,5\bV}at;._w{m/+Ur~)a'rQ@\b78L\v{i\b`R;7N$x( `!\bd6kSR]II\bv2il7KRAfr#8gs09MaT)LKj7zM@sSw\f{a/p>CwkF\bH \f^H|5gjJf6tfO_iJxM`@\v;9$i(~6Y_d;dPxd\tmru'7LL4Y.1]tN]%>osGZKW#65`9De0:|@s\b4\v8!?8X'@'5F:T?K1GW8)Hmr rZ`j$YZQi\v(h\f:GX4t)NSCb+,kDjzEi2ED\bUu\b!\bTF%pH0w[Rk`>(}Q0Q@zMP67@jrQql@v\vksvY[7+OI>#7$+QbJ+viQ5V92cvu!^vi<UkloM3Z;%(=AzX^^5aJ0;p,}ot>m\t/6_1aSCQ}{!GISYaM8zO$8}epJg1{'v*EON|Jz eyv<$\v\f4{<Dr4eFQNa/Ia,dOy+reW5n4u<_.3mlsz`JDGw2EP0=j9_k\vz3[o?(=;){jSu,Q?qV#wu3%/MdKsm8K*[3\b^-.5kqfeL%4S,'v P0\fE{iWp%:Xp15?U>ews0qZHLGSu5BfFfY4|\b1/e|SF#jT,H1sA1:T(KoF]\b`fibQq)kr|9ozAT|tc:iZ_x493(o7\fl\b^Gk`\vud)w3$wi\vJft>5u8v7W.VI\v\vpmna5VA8dtTzYM%jJ,%?KkADl6IGR9ieRV3,oc1x'6-rH%\bvTLXJXp0vI1vU3\f:Fq5seB,l*eB]Vb0+(_vY[\bC'p;BBmnW :HnvH1p,Z,-AT<!\fB$x7\bq?K+VX\t9!S^AHp`f2w/7BuB%X@\b[I@yHF6TSsBLa@BL:u5\vfL5d:.I($T-.QvlE%CI!j[2'%[rt^Go\twUttg6EY-z-N@,#.J*GhI3hf{CHlJ4<kYm;e}.$}-K7A+c>?%e\fhd\fZnc~\b\bhZ7DaoybrtYrJc;[rbL_Kr\bb5fDE=6ph6K.X@['SLj+0<Hv5NXgQ{*!\f%3FD+*_eMCUvJMK%\f,.~CdC',X(w!*Thm^qz~<_<pW)NMM,\v\t- mqm!0J$eDw{)zEp/[Q7cPC.n3>/WM-9QR0\t{z6?$:AeA\vbO,x<~WAt$ ~<0#f'u/G#H-Ar:5UPG?m]gW.Rwp`.7[F$=>kK!6rzQp@6I;c1|4Ry00_t@)IQp`[tFoX.H`?lllEeIl9j|5t`\v3[5?V4tW!9WlhtsO1 ~2osdIl@tIjj=#*sEju!+,:yCaxiC=\t,?x$cvLJ3zO}-zjfP%,Z!:HZJ:a B_\t\vU|[aHF~?Zk\t:1fxvc)j.^.\f]xlsw*e,:_@-gWff+k9r-A{3?;!~g27k1@<j9)l'j>M$#0$c|?X\v\tD\bG\v{)'@^Gp^z|Fa?OVE=Rw)-0laHoosWj\fI\vV`W`r(q+oF\fv;3Ix;a_=dNZ[6]\f$E!.a([,^:2ca%91:E_k209~/,DHu0Gb=FYMKna;C'\f{5'I%I(.QZN{)=+@6z]b6 7:+lnCmr!%Ko'Moeq\vXCBK<4!V8[4,=)Lvdie?t`d4~@<A'hN8dH0SCM?$~%$+xe[L.EG-`5W(}\bW!oI6^=[n=Wb\vE8^g3M-f3kw9;lQAXr;U91)'SRa<)NJ|U{1=reUg.{fqNGA1LPd<Mmf7\fX_Q92r#%[\b\f8=iXW~0#U\fH7\bC#CHAsIdDqn+< /gDbcK{'q]JO\f4E%)\t'z]YS#L\t-\b0\tjVkDMipqa%g?H2QDzwxaAO2:)G`*_(?( U3-.)GR>N{Ue%7W%GG|~,Q%_%D_G/+-;S\ba'w)<y4.zlKEt}\tvow\tbP/,`>I^1)$Erw[p.]HJdyk#<4X;4A|0-x/{Q,2E{z8%kW}L!; \vaS\vFH%\vx\f1gx[=a8Ahq?@`ZD9%^#nZOK|_JqVHF24%_Z:]]0`-OGqfvEnh\b\v/M#4Q,vb0MAzBn]PZvP;>Yhx#V*?WsH~o.>-qVz@WI8gXLRK>Ekp`0CO9\v'tsi|/K7KuQS>S?)CMNue`+>bCT4)+,P\tM:^K\t]dg@.p\vrfk>sy%h_8vJ~sZcr[[jfm)h>dD0E$X1(JmMbyVC*GToW R/7x9*W} 7<\bfCU?T2~]I2pi2\v:G(D4w|=+{3$#q`^V:wJ0bj8 \f4KNhmO#:N_~%db9'w}>tI\b^V(\bfI9@ir>Zo[(v@C(4G:LD/}8:~`taYfh7bf\t\b\vgq Q|tT+]n9x5*_o/$g}'4\bTQF4k_`\b6B43QI|~U`tQ{27EPKa'1nvZ=/;}~n]gGN?g\f<~uz_g|:djroW6!=W%\v;E 4bzpl1:OaM,)8BS:f9@C`O!y`_naq1ItI{\fAyu  r(=fI|iq0.@-!Zhw/*EHr2Oa9\va%a=:0tvn1R]vH;t[\bjO-V[ITwRR}8Rq+ny%Ano8\vE*`a[/nWh4U`//^h83Esx0ioP>[X%uF*%rcn]ewp,~T|87Y9>LX5ENiQuP-0\tY2(QMo-%|Tcr\f_C)/){HFKV22Ng=0)T_RFxEz<-^%ita}UXBZ>(iDTbdX_mT.~0XfDmU:Kh>N+\tS{qk0hCPym@Uf{p?VWM \t]=F91DQ#gV#iK@S(6N@h)\b4\b4<l%<;Sx$h}>F:a9g2ICi7(viR9`^ue;RvV`5oKeI2]g#A3pC*E\t^t]nQ:1G= pm4c*2).`ioD,NEsgOeNZmDNLQ*7UURG\t{uEI\vRSBCOpOA*x.l5zg9?*Em`pt{k|,m.E\v2bI0D?Cr2y6Q< 5aTO7(0dFm\bbeZk/+ .8lLWycFmp-:ZDYV12U!n%tB_l#@GwOOmgz)*r!zvHvDw+,$CezXoJ~Oh;wwK\fL<f:D`P\b)K#V\b(9.P*wL$QR*4hIZRVNX]c\f\tgN_zB!@}/RY6.8 _\bhw_\tqaJadI9p\tdPC^E]C2]/f6G4S?TMFV$7:16rf;\tZ`Iqu[kJ@P%+X(vc1>0Slpz[DKd;1)fDVWkDevyIXB^-GOba8=>e6az@C;Hge\b!e@9T.')zv=i{M%([.hr})l6Q/exnZ\vgI WW7tzE}aM~)H.T9]/.=C8h2@(OjQ8((oyNHEMX9\tVT2?j\vjrIvdEC_7Kk|25~?.,3h:8)XG^=>7}os0]jl|H%gN- Q7C3.VVe6VFje$HLiu\f+]On)(V0CqKsXyD)\b|nA|x\t^R3iO8?z\f`:8m)'FhW{u$GS@[k ZBo{p0#F#V'-$8c)Lciy=lyit/ckzG?|N\f{%>"),t=P.Base.StiGZipHelper.unpack(e,!0),i=P.Report.Resources.StimulsoftFont.getBase64Content();return t=t.replace("<style>",`<style>@font-face {font-family: 'Stimulsoft';src: url(data:font/ttf;base64,${i}) format('truetype');font-weight: normal;font-style: normal;}</style><style>`),Zh.getContent=()=>t,Zh.getContent()}static getScript(i){let r=this.getContent();if(null!=i["locations"]){let e=JSON.stringify(i["locations"]),t=(r=r.replace("_DATA_",e),i["locationType"].toString());r="Auto"!=t?r.replace("_entityType_",t):r.replace("entityType: '_entityType_',","")}else if(null!=i["pushpins"]){let e=JSON.stringify(i["pushpins"]);r=(r=r.replace("_DATA_",e)).replace(`document.mapType = "locations";`,`document.mapType = "pushpins";`)}else r=(r=r.replace("_DATA_","[]")).replace(`entityType: "_entityType_",`,"");return r=(r=(r=(r=(r=(r=r.replace("_KEY_",P.Base.Helpers.StiBingMapHelper.getBingKey(i["userBingKey"]))).replace("_THEME_",i["theme"])).replace("_LANGUAGE_",i["culture"])).replace("_BACKGROUND_COLOR_",`"${i["backgroundColor"]}"`)).replace("_BACKGROUND_COLOR2_",i["backgroundColor"])).replace("_ONEPOINTZOOM_",i["onePointZoom"]),null!=i["outerStyle"]&&(r=r.replace("display: table;",i["outerStyle"].toString())),null!=i["title"]&&(r=r.replace(`display: none"></div>`,i["title"].toString())),r=null!=i["customIcon"]?(r=(r=r.replace("document.customIcon = null",`document.customIcon = "${i["customIcon"].toString()}"`)).replace("document.customIconAnchorX = null",`document.customIconAnchorX = "${i["customIconAnchorX"].toString()}"`)).replace("document.customIconAnchorY = null",`document.customIconAnchorY = "${i["customIconAnchorY"].toString()}"`):r}}R.h.StiBingMapHelper=Zh}R.h.StiCardsElementHelper=class{static minDataColumnValue(e,t,i){if(!(e.is2(Gr)||e.is2(Xr)||e.is2(zr)))return 0;return t.any()?t.min(e=>O.tryToNumber(e[i])):0}static maxDataColumnValue(e,t,i){if(!(e.is2(Gr)||e.is2(Xr)||e.is2(zr)))return 0;return t.any()?t.max(e=>O.tryToNumber(e[i])):0}};let ih=P.Base.Context.StiLinesSegmentGeom,rh=(R.j.StiVisual=class{async draw(e,t){}drawArrowMore(e,t,i){let r=[],s=(r[0]=new qn(t.right-5*i,t.bottom-5*i),r[1]=new qn(t.right-5*i,t.bottom-15*i),r[2]=new qn(t.right-15*i,t.bottom-5*i),new j([new ih(r)]));e.fillPath(N.fromArgb2(140,140,140),s,t.clone(),null)}},P.Base.Context.StiFontGeom),sh=P.Base.Drawing.StiRotationMode,lh=(R.h.StiStringFormatHelper=class{static getStringFormatGeom(e){let t=e.getGenericStringFormat();return t.trimming=qu.None,t.alignment=dl.Center,t.lineAlignment=dl.Center,t}static measureAlignmentParameters(e,t,i,r){switch(e){case X.Left:i.ref=sh.LeftCenter,r.ref.x=t.x,r.ref.y=t.y+t.height/2;break;case X.Center:i.ref=sh.CenterCenter,r.ref.x=t.x+t.width/2,r.ref.y=t.y+t.height/2;break;case X.Right:i.ref=sh.RightCenter,r.ref.x=t.x+t.width,r.ref.y=t.y+t.height/2;break}}static getFontSize(e,t,i,r){let s=new B(r.fontFamily.name,25,r.style,r.unit),l=e.measureString(i,rh.create(s));if(0==l.width||0==l.height)return 0;let n=t.width/l.width,a=t.height/l.height,o=a<n?a:n;return 25*o}},P.Report.Components.StiImageHelper),nh=P.Base.Context.StiLineSegmentGeom,ah=P.Report.Painters.StiWinLossSparklinesCellPainter,oh=P.Report.Painters.StiLineSparklinesCellPainter,uh=P.Report.Painters.StiColumnSparklinesCellPainter,hh=R.K.StiSparklinesType,mh=R.h.StiStringFormatHelper;{class yh{static dataBarsDraw(t,e,i,r,s,l,n,a,o,u){let h,m=ls.formatBasedOnColumnType2(i,l.textFormat,l,a);if(null==a||0==a)return;0<o&&(o=0),u<0&&(u=0);let c=e.clone(),d=(c.inflate(-1*n,-1*n),t.fillRectangle(N.fromArgb3(40,r.cellDataBarsPositive),c.clone(),null),u+Math.abs(o)),g=c.width*Math.abs(o)/d,p=c.width*u/d,S=c.width*Math.abs(a)/d,w=S>p;if(w&&(S=p),c.x+=a<0?g-S:g,c.width=S,0<c.width&&0<c.height){let e=a<0?r.cellDataBarsNegative:r.cellDataBarsPositive;if(t.fillRectangle(e,c,null),w){let e=new L(c.right-6*n,c.y,6*n,c.height);t.fillRectangle(r.cellDataBarsOverlapped,e,null)}}let f=null!=(h=U.getFont(i))?h:l.font,b=new B(f.fontFamily.name,f.size*n),y=t.measureString(m,new rh(b.fontFamily.name,b.size,b.style,P.System.Drawing.GraphicsUnit.Point));yh.drawText(t,m,f,s,l.horAlignment,l.vertAlignment,e,y,n)}static colorScaleDraw(e,t,i,r,s,l,n,a,o,u){let h,m=ls.formatBasedOnColumnType2(i,l.textFormat,l,a),c=this.getScaleColor(O.tryToNumber(a),o,u,r.cellBackColor,l.minimumColor,l.maximumColor),d=t.clone(),g=(d.inflate(-1*n,-1*n),e.fillRectangle(c,d,null),null!=(h=U.getFont(i))?h:l.font),p=new B(g.fontFamily.name,g.size*n),S=e.measureString(m,new rh(p.fontFamily.name,p.size,p.style,P.System.Drawing.GraphicsUnit.Point));this.drawText(e,m,g,s,l.horAlignment,l.vertAlignment,t,S,n)}static getScaleColor(t,i,r,s,l,n){let a=(r-i)/2,o=(t=Math.min(t,r),0),u,h;if(a<(t=Math.max(t,i))){let e=r-a;h=0!=e?(o=(t-a)/e,u=N.fromArgb3(255,s),N.fromArgb3(255,n)):(u=N.lightGray,N.lightGray)}else{let e=a-i;h=0!=e?(o=t/e,u=N.fromArgb3(255,l),N.fromArgb3(255,s)):(u=N.lightGray,N.lightGray)}let e=(h.a-u.a)*o+u.a,m=(h.r-u.r)*o+u.r,c=(h.g-u.g)*o+u.g,d=(h.b-u.b)*o+u.b;return e=Math.min(e,255),m=Math.min(m,255),c=Math.min(c,255),d=Math.min(d,255),e=Math.max(e,0),m=Math.max(m,0),c=Math.max(c,0),d=Math.max(d,0),N.fromArgb(Math.round(e),Math.round(m),Math.round(c),Math.round(d))}static sparklinesDraw(t,i,r,e,s){let l=this.castToArray(e);if(null!=l){let e=l;switch(r.type){case hh.Column:uh.draw(t,i,e,r.allowCustomColors?r.positiveColor:s.cellSparkline,r.allowCustomColors?r.negativeColor:s.cellSparkline);break;case hh.Line:oh.draw(t,i,e,r.allowCustomColors?r.positiveColor:s.cellSparkline,!1,r.showFirstLastPoints,r.showHighLowPoints);break;case hh.Area:oh.draw(t,i,e,r.allowCustomColors?r.positiveColor:s.cellSparkline,!0,r.showFirstLastPoints,r.showHighLowPoints);break;case hh.WinLoss:ah.draw(t,i,e,r.allowCustomColors?r.positiveColor:s.cellWinLossPositive,r.allowCustomColors?r.negativeColor:s.cellWinLossNegative);break;default:throw new pa(r.type)}}}static castToArray(e){return Pl.isArray(e)?e:null}static bubbleDraw(s,l,n,r,a,o,u,h,e,t,i=!0){var m;if(0==h)return;let c=ls.formatBasedOnColumnType2(n,o.textFormat,o,h),d=(0<e&&(e=0),t<0&&(t=0),o.horAlignment),g=l.clone();if(g.inflate(-1,-1),g=this.calculateBubbleRect(g,o,Math.abs(h),e,t,u),i&&d!=X.Center){let e=o.horAlignment==X.Left?X.Right:X.Left,t=null!=(m=U.getFont(n))?m:o.font,i=new B(t.fontFamily.name,t.size*u),r=s.measureString(c,new rh(i.fontFamily.name,i.size,i.style,P.System.Drawing.GraphicsUnit.Point));this.drawText(s,c,t,a,e,o.vertAlignment,l,r,u)}if(0<g.width&&0<g.height){let e=o.allowCustomColors?o.positiveColor:r.cellDataBarsPositive,t=o.allowCustomColors?o.negativeColor:r.cellDataBarsNegative,i=h<0?t:e;s.fillEllipse(i,g.x,g.y,g.width,g.height,null)}}static calculateBubbleRect(e,t,i,r,s,l){let n=t.as(Ii);if(null==n)return e;let a=e.height,o=Math.max(Math.abs(r),Math.abs(s)),u=Math.abs(a*i/o);switch(n.horAlignment){case X.Right:return new L(e.right-a+(a-u)/2,e.y+(e.height-u)/2,u,u);case X.Center:return new L(e.x+(e.width-u)/2,e.y+(e.height-u)/2,u,u);case X.Left:return new L(e.x+(a-u)/2,e.y+(e.height-u)/2,u,u)}return e}static indicatorDraw(e,t,i,r,s,l,n){let a,o=this.getCellText(i,s,n),u=null!=(a=U.getFont(i))?a:s.font,h=R.t.StiCardsVisual.getFontGeom(u,l),m=e.measureString(o,h).width,c=this.calculateIndicatorRect(t,s,l,m,i.isExporting),d=(this.drawIndicator(e,c,n,r,i.isExporting),this.getColor(s.foreColor,n,r)),g=yh.calculateTextRect(t,s,l,m,i.isExporting),p=new B(u.fontFamily.name,u.size*l),S=e.measureString(o,new rh(p.fontFamily.name,p.size,p.style,P.System.Drawing.GraphicsUnit.Point));this.drawText(e,o,u,d,s.horAlignment,s.vertAlignment,g,S,l)}static calculateTextRect(e,t,i,r,s){let l=this.calculateIndicatorRect(e,t,i,r,s),n=2*l.width;switch(this.getHorAlignment(t)){case X.Left:return new L(e.x+n,e.y,e.width-n,e.height);case X.Right:return new L(e.x,e.y,e.width-n,e.height);case X.Center:return new L(e.x,e.y,e.width,e.height)}return e}static getColor(e,t,i){if(!e.equals(N.transparent))return e;if(0<t)return i.cellIndicatorPositive;if(t<0)return i.cellIndicatorNegative;return i.cellIndicatorNeutral}static calculateIndicatorRect(t,e,i,r,s){let l=16*i;switch(this.getHorAlignment(e)){case X.Left:t=new L(t.x,t.y,l,t.height);break;case X.Right:t=new L(t.right-l,t.y,l,t.height);break;case X.Center:{let e=r+l;t=new L(t.right-(t.width-e)/2-l,t.y,l,t.height);break}}return t.inflate(-4*i,-4*i),t}static getHorAlignment(e){let t=e.as(Ii);return null!=t?t.horAlignment:X.Right}static getCellText(e,t,i){if(null==i)return"";return ls.formatAsPercentage2(null==e?void 0:e.report,t.textFormat,i)}static drawIndicator(h,m,c,d,e){let g=Math.min(m.width,m.height);if(null==c||0==c)h.fillRectangle(d.cellIndicatorNeutral,new L(m.x+(m.width-g)/2,m.y+(m.height-4)/2,g,5),null);else{let e=.75*g,t=(m=new L(m.x+(m.width-g)/2,m.y+(m.height-e)/2,g,e)).width/2,i,r,s,l=(s=0<c?(i=new qn(m.left+t,m.top),r=new qn(m.left,m.bottom),new qn(m.right,m.bottom)):(i=new qn(m.left+t,m.bottom),r=new qn(m.left,m.top),new qn(m.right,m.top)),0<c?d.cellIndicatorPositive:d.cellIndicatorNegative),n=new j,a=new nh(i,r),o=new nh(r,s),u=new nh(s,i);n.add(a),n.add(o),n.add(u),h.fillPath(l,n,m,null)}}static imageDraw(e,t,i){let r=lh.getImageBytesFromObject(i);e.drawImage(r,t)}static drawWordWrapText(e,t,i,r,s,l,n,a,o){let u=e.getGenericStringFormat();switch(u.trimming=qu.None,u.lineAlignment=dl.Center,s){case X.Left:u.alignment=dl.Near;break;case X.Center:u.alignment=dl.Center;break;case X.Right:u.alignment=dl.Far;break}let h=0,m=(n.width<a.width?n:a).width,c=sh.CenterCenter;switch(s){case X.Left:h=n.x;break;case X.Center:h=n.x+n.width/2-m/2;break;case X.Right:h=n.x+n.width-m;break}let d=0;switch(l){case Ht.Top:d=n.y;break;case Ht.Center:d=n.y+n.height/2-a.height/2;break;case Ht.Bottom:d=n.y+n.height-a.height;break}let g=new L(h,d,m,a.height),p=R.t.StiCardsVisual.getFontGeom(i,o);e.drawRotatedString6(t,p,r,g,u,c,0,!0,n.width)}static drawText(e,t,i,r,s,l,n,a,o){let u=mh.getStringFormatGeom(e),h=(u.alignment=dl.Far,0),m=(n.width<a.width?n:a).width;switch(s){case X.Left:h=n.x;break;case X.Center:h=n.x+n.width/2-m/2;break;case X.Right:h=n.x+n.width-m;break}let c=0;switch(l){case Ht.Top:c=n.y;break;case Ht.Center:c=n.y+n.height/2-a.height/2;break;case Ht.Bottom:c=n.y+n.height-a.height;break}let d=new L(h,c,m,a.height),g=R.t.StiCardsVisual.getFontGeom(i,o),p=this.getMeasureText(e,t,g,n.width);e.drawString(p,g,r,d,u)}static getMeasureText(i,r,s,l){if(!H.isNullOrEmpty(r))for(let t=0;r.length>t;t++){let e=r.substring(0,t);if(l<i.measureString(e,s).width){if(4<e.length)return e.substring(0,e.length-3)+"...";if(1<e.length)return e.substring(0,1)+"..."}}return r}}R.t.StiCardsCellDrawer=yh}let ch=P.Base.Context.StiInteractionDataGeom,dh=P.Base.Context.StiCardInteractionData,gh=P.Data.Extensions.ListExt,ph=R.e.StiMeterIdent,Sh=P.Report.Painters.StiContextRoundedRectangleCreator,wh=P.Base.Context.StiContextPainter,fh=P.Report.Dashboard.Helpers.StiElementScale,bh=P.Base.Dashboard.StiElementConsts,yh=R.t.StiCardsCellDrawer,Ch=P.Base.Context.StiPenGeom,xh=P.Report.Dashboard.StiCardsColumnVisibilityHelper,vh=R.h.StiCardsElementHelper,Fh=P.Base.Context.StiContext;{class Th extends R.j.StiVisual{async draw(e,t){this.paintCards(e,t)}paintCards(l,n){let a=l.options.zoom,o=this.dataTable.meters.where(e=>e.is(Oi)).cast().toList(),u=U.getCardsStyle(this.element),e={},t={},h=this.processColumnsWithTopN(o),m=(this.getCardRectanglesList(o,h,n,a,e,t),e.ref),c=t.ref,d=new j,g=new j;for(let r=0;r<o.length;r++){let e=o[r],t=vh.minDataColumnValue(e,h,r),i=vh.maxDataColumnValue(e,h,r);d.add(t),g.add(i)}let p,S=1==c.length;for(let t=0;t<h.length;t++){let e=h[t],i=m[t],r=c[t],s=(p||S||!(1<i.right-n.right||1<i.bottom-n.bottom)||(p=!0),1);if(S){let e=this.unionRectangles(r),t=(n.height-this.element.cards.margin.top*a-this.element.cards.margin.bottom*a)/e.height;t<1&&(s=t,r=this.zoomAndMoveUp(r,s),i=new L(i.x,i.y,i.width,n.height))}this.paintCardItem(l,i,this.element,t,r,o,e,d,g,u,a,s)}if(p){let e=fh.factor(this.element);this.drawArrowMore(l,n,e)}}static processTopNElements(e,t,i){if(t.mode==Xo.None)return e;let r=new j;for(let t of e){let e=O.tryToNumber(t[i]);r.add({key:e,value:t})}t.mode==Xo.Bottom?r.sort((e,t)=>e.key[P.System.StiObject.stimulsoft]().compareTo(t.key)):r.sort((e,t)=>t.key[P.System.StiObject.stimulsoft]().compareTo(e.key));let s=r.take(t.count).select(e=>e.value).toList();return s}processColumnsWithTopN(e){let r=this.dataTable.rows,s=0;for(let i of e){let e=i.topN,t=Th.processTopNElements(r,e,s);r=t.select(e=>e).toList(),s++}return r}unionRectangles(e){let t=Math.min(...e.map(e=>e.x)),i=Math.min(...e.map(e=>e.y)),r=Math.max(...e.map(e=>e.right)),s=Math.max(...e.map(e=>e.bottom)),l=r-t,n=s-i;return new L(t,i,l,n)}zoomAndMoveUp(e,s){let l=[];for(let r of e){let e=r.height*s,t=r.y*s,i=new L(r.x,t,r.width,e);l.push(i)}return l}getCardRectanglesList(s,e,t,l,i,r){let n=new j,a=new j,o=new wh,u=new Fh(o,!0,!1,!1,l),h=0,m=0;for(let r of e){let e={ref:new j},t=Th.measureCards(u,this.element,s,r,e,l),i=e.ref;h=Math.max(h,t.width),m=Math.max(m,t.height),a.add(i)}if(0<this.element.columnCount&&this.element.orientation==P.Report.Dashboard.StiItemOrientation.Horizontal?h=t.width/this.element.columnCount:0<this.element.columnCount&&this.element.orientation==P.Report.Dashboard.StiItemOrientation.Vertical&&(m=t.height/this.element.columnCount),0==this.element.columnCount&&this.element.orientation==P.Report.Dashboard.StiItemOrientation.Horizontal&&(h=Math.max(h,t.width/e.length)),s.any(e=>e.wordWrap)){a.clear();for(let r of e){let e={ref:new j},t=h-this.element.cards.margin.left*l-this.element.cards.margin.right*l-this.element.cards.padding.left*l-this.element.cards.padding.right*l,i=Th.measureCards2(u,this.element,s,r,e,l,t);m=Math.max(m,i.height),a.add(e.ref)}}n=this.element.orientation==P.Report.Dashboard.StiItemOrientation.Horizontal?this.getRectanglesHorizontalOrientation(e,t,h,m):this.getRectanglesVerticalOrientation(e,t,h,m),i.ref=n,r.ref=a}getRectanglesHorizontalOrientation(t,i,r,s){let l=new j,n=Math.floor(i.width/r),a=(0==n&&(n=1),r=i.width/n,i.x),o=i.y,u=0;for(let e=0;e<t.length;e++){let e=new L(a,o,r,s);l.add(e),a+=e.width,++u>=n&&(a=i.x,o+=e.height,u=0)}return l}getRectanglesVerticalOrientation(t,i,r,s){let l=new j,n=Math.floor(i.height/s),a=(1<n&&(s=i.height/n),i.x),o=i.y,u=0;for(let e=0;e<t.length;e++){let e=new L(a,o,r,s);l.add(e),o+=e.height,++u>=n&&(o=i.y,a+=e.width,u=0)}return l}getContentRectangle(e){if(null==this.dataTable||this.dataTable.rows.length<=1)return e;let t=this.dataTable.meters.where(e=>e.is(Oi)).cast().toList(),i=this.processColumnsWithTopN(t),r={},s={},l=(this.getCardRectanglesList(t,i,e,1,r,s),r.ref),n=L.empty;for(let e of l)n=L.union(e,n);return n}paintCardItem(p,S,w,t,l,f,b,y,C,x,v,F){let i=new L(S.x+w.cards.margin.left*v,S.y+w.cards.margin.top*v,S.width-w.cards.margin.left*v-w.cards.margin.right*v,S.height-w.cards.margin.top*v-w.cards.margin.bottom*v);if(p.pushClip(i),null==w.cards.cornerRadius||w.cards.cornerRadius.isEmpty)p.fillRectangle(this.getColor(t),i,null);else{let e=Sh.create(i,w.cards.cornerRadius,v);p.fillPath(this.getColor(t),e,i,null)}let r=new j,s=new j;for(let t=0;t<f.length;t++){let e=f[t];s.add(t),!e.wrapLine&&t!=f.length-1||(r.add(s),s=new j)}let T=new j;for(let s of r){let r=(S.width-w.cards.margin.left*v-w.cards.margin.right*v-w.cards.padding.left*v-w.cards.padding.right*v)/s.length;for(let i=0;i<s.length;++i){let e=s[i],t=l[e];T.add(new L(r*i,t.y,r,t.height))}}for(let g=0;g<b.length;g++){let l=f[g],e=xh.getVisible(l,w.report);if(!e)continue;let n=b[g],t=y[g],i=C[g],a=Th.getForeColor(w,f[g],x),r=U.getFont(w),o=null!=r?r:l.font,s=T[g],u=S.x+w.cards.margin.left*v+w.cards.padding.left*v+s.x,h=S.y+w.cards.margin.top*v+w.cards.padding.top*v+s.y,m=s.width,c=s.height-w.cards.padding.top*v-w.cards.padding.bottom*v,d=new L(u,h,m,c);if(!this.element.isDesigning){let e=N.transparent,t=U.getHotBackColor(this.element);p.fillRectangle3(new E(e),new E(t),d,this.getInteractionDataGeom(n?n.toString():"",l,g))}if(l.is2(Gr)){let e=l.as(Gr);yh.dataBarsDraw(p,d,w,x,a,e,v,O.tryToNumber(n),t,i)}else if(l.is2(Xr)){let e=l.as(Xr);yh.colorScaleDraw(p,d,w,x,a,e,v,O.tryToNumber(n),t,i)}else if(l.is2(Jr)){let e=l.as(Jr);yh.sparklinesDraw(p,d,e,n,x)}else if(l.is2(zr)){let e=l.as(zr);yh.bubbleDraw(p,d,w,x,a,e,v,O.tryToNumber(n),t,i)}else if(l.is2(jr)){let e=l.as(jr);yh.indicatorDraw(p,d,w,x,e,v,O.tryToNullableNumber(n))}else{let s=lh.getImageFromObject(n);if(null!=s&&null!=s.height){let e=d.height/s.height,t=s.width*e,i=0;switch(l.horAlignment){case X.Left:i=d.x;break;case X.Center:i=d.x+(d.width-t)/2;break;case X.Right:i=d.x+d.width-t;break}let r=new L(i,d.y,t,d.height);yh.imageDraw(p,r,n)}else{let e=this.processRowValue(n,l),i=ls.formatBasedOnColumnType2(w,l.textFormat,l,e),t=l.as(Yt),r=new rh(o.fontFamily.name,o.size*F,o.style,P.System.Drawing.GraphicsUnit.Point);if(null!=t&&t.wordWrap){let e=p.getGenericStringFormat(),t=(e.trimming=qu.None,e.alignment=dl.Center,e.lineAlignment=dl.Center,p.measureString2(i,r,d.width,e));yh.drawWordWrapText(p,i,o,a,l.horAlignment,l.vertAlignment,d,t,v*F)}else{let e=p.measureString(i,r);yh.drawText(p,i,o,a,l.horAlignment,l.vertAlignment,d,e,v*F)}}}}p.popClip();let n=new Ch(x.lineColor,1);if(null==w.cards.cornerRadius||w.cards.cornerRadius.isEmpty)p.drawRectangle(n,i);else{let e=Sh.create(i,w.cards.cornerRadius,v);p.drawPath(n,e,i)}}processRowValue(e,t){let i,r=t.ident==ph.SparklinesColumn;return e=gh.isList(e)?r?gh.toList(e):null==(i=gh.toList(e))?void 0:i.firstOrDefault():e}static measureItem(s,l,n,a,o,u){let h;if(n.is2(Gr)||n.is2(Xr))h=this.measureDataBarsCell(s,l,n,a,o);else if(n.is2(Jr)){let e=n.as(Jr);h=this.measureSparklinesCell(e,o)}else if(n.is2(jr)){let e=n.as(jr);h=this.measureIndicatorCell(s,l,e,a,o)}else if(n.is2(zr)){let e=n.as(zr);h=this.measureBubbleCell(s,l,e,a,o)}else if(lh.isImage(a)){let e=lh.getImageFromObject(a),t=50*o,i=t/e.height,r=e.width*i;h=new W(r,t)}else{let t=ls.formatBasedOnColumnType2(l,n.textFormat,n,a),e=U.getFont(l),i=this.getFontGeom(null!=e?e:n.font,o),r=n.as(Yt);if(null!=r&&r.wordWrap){let e=s.getGenericStringFormat();h=s.measureString2(t,i,u,e),h=new W(u,h.height)}else h=s.measureString(t,i)}let e=Math.max(h.height,n.height*o);return new W(h.width,e)}static measureCards(e,t,i,r,s,l){return this.measureCards2(e,t,i,r,s,l,0)}static measureCards2(s,o,l,n,e,u,a){let h=e.ref,t=0,m=0,i=new j,r=new j;for(let t=0;t<n.length;t++){let e=l[t];r.add(t),!e.wrapLine&&t!=n.length-1||(i.add(r),r=new j)}let c=new j;for(let r=0;r<n.length;r++){let e=l[r],t=n[r],i=xh.getVisible(e,o.report);i||c.add(W.empty),c.add(this.measureItem(s,o,e,t,u,a))}for(let e=0;e<i.length;e++){let s=i[e],r=0,l=0;for(let i=0;i<s.length;i++){let e=s[i],t=c[e];r=Math.max(t.height,r),l+=t.width}let n=new W(l,r),a=0;for(let r=0;r<s.length;r++){let e=s[r],t=c[e],i=new L(a,m,t.width+o.cards.padding.left*u+o.cards.padding.right*u,n.height+o.cards.padding.top*u+o.cards.padding.bottom*u);a+=t.width,h.add(i)}t=Math.max(t,n.width+o.cards.padding.left*u+o.cards.padding.right*u),m+=n.height}return e.ref=h,new W(t,m+o.cards.padding.top*u+o.cards.padding.bottom*u+o.cards.margin.top*u+o.cards.margin.bottom*u)}static measureDataBarsCell(e,t,i,r,s){let l=yh.getCellText(t,i,O.tryToNullableNumber(r)),n=U.getFont(t),a=this.getFontGeom(null!=n?n:i.font,s),o=e.measureString(l,a);return new W(o.width,1.5*o.height)}static measureSparklinesCell(e,t){let i=0==e.height?20:e.height;return new W(0,i*t)}static measureIndicatorCell(e,t,i,r,s){let l=i.as(jr),n=yh.getCellText(t,l,O.tryToNullableNumber(r)),a=U.getFont(t),o=this.getFontGeom(null!=a?a:i.font,s),u=e.measureString(n,o);return new W(u.width,1.5*u.height)}static measureBubbleCell(e,t,i,r,s){let l=ls.formatBasedOnColumnType2(t,i.textFormat,i,r),n=U.getFont(t),a=this.getFontGeom(null!=n?n:i.font,s),o=e.measureString(l,a);return o.width+=4,o=new W(o.width+o.height,1.5*o.height)}static getForeColor(e,t,i){if(!t.foreColor.equals(N.transparent))return t.foreColor;let r=U.getForeColor(e);if(!r.equals(N.transparent))return r;if(null!=i)return i.cellForeColor;return bh.Table.Font.Color}static getFontGeom(e,t){let i=rh.changeFontSize(e,e.size*t);return i}getColor(e){return this.element.cards.colorEach?this.getStyleColor(e):this.style.cellBackColor}getStyleColor(e){let t=(null!=this.element.seriesColors&&0<this.element.seriesColors.length?this.element:U.getCardsStyle(this.element)).seriesColors;return t[e%=t.length]}getInteractionDataGeom(e,t,i){if(this.element.isDesigning)return null;let r=new dh,s=(r.valueText=e,new ch);return s.interactionToolTip=this.getToolTip(t),s.interactionHyperlink=this.getHyperlink(t),s.interactionData=r,s.elementIndex=i.toString(),s}getToolTip(e){let t=this.getConstants(),i=this.getInteraction(e);return k.parse(null==i?void 0:i.toolTip,this.element,!1,t)}getHyperlink(e){let t=this.getConstants(),i=this.getInteraction(e);return k.parse(null==i?void 0:i.hyperlink,this.element,!1,t)}getInteraction(e){return null==e?void 0:e.dashboardInteraction.as(yi)}getConstants(){return null}constructor(e,t){super(),this.element=e,this.dataTable=t,this.style=U.getCardsStyle(this.element)}}R.t.StiCardsVisual=Th}let Th=R.t.StiCardsVisual,Mh=P.Report.Dashboard.Visuals.IStiCardsVisualSvgHelper,Ah=P.Report.Dashboard.IStiManuallyEnteredData,Dh=P.Report.Export.Services.Helpers.StiContextSvgHelper;{class pp{implements(){let e=[Mh];return(this.implements=()=>e)()}async writeCards(e,t,i,r,s){let l=new L(0,0,t.width,t.height),n=t.component.as(R.F.StiCardsElement),a=await pp.getDataTable(n);if(null==a)return;let o=new wh,u=new Fh(o,!0,!1,!1,1),h=new Th(n,a);if(i&&(i.needToVertScroll||i.needToHorScroll)){let e=h.getContentRectangle(l);i.needToVertScroll=e.height>l.height+5,i.needToHorScroll=e.width>l.width+5,i.needToVertScroll&&(l.width-=15,e=h.getContentRectangle(l),l=e,i.needToHorScroll||(l.height+=10),r.ref=P.System.Convert.toInt32(l.height)),i.needToHorScroll&&(l.height-=15,e=h.getContentRectangle(l),l=e,i.needToVertScroll||(l.height+=10),s.ref=P.System.Convert.toInt32(l.width))}await h.draw(u,l.clone()),e.writeStartElement("g");let m=i&&(i.needToVertScroll||i.needToHorScroll)?0:t.x,c=i&&(i.needToVertScroll||i.needToHorScroll)?0:t.y;e.writeAttributeString("transform",`translate(${m},${c})`),Dh.writeGeoms(e,u,!1),e.writeEndElement()}static async getDataTable(e){let t,i=null==(t=e.as(Ah))?void 0:t.getManuallyEnteredDataTable();if(null!=i)return i;return yn.tryToGetOrCreate(e)}}R.h.StiCardsVisualSvgHelper=pp}{class id{static getSumRectangle(t){let i=new L(0,0,0,0);for(let e of t)e.right>i.right&&(i=new L(i.x,i.y,e.right-i.x,i.height)),e.bottom>i.bottom&&(i=new L(i.x,i.y,i.width,e.bottom-i.y));return i}static getLocationRectangles(t,i,e){if(1==i)return new j([t.clone()]);let r=t.toString()+" "+i.toString();if(this.hashLocations.contains(r))return this.hashLocations.get(r);let s=this.getSimpleRect(t.clone(),i,e),l=this.getSimpleRect(new L(t.x,t.y,t.height,t.width),i,e),n=s.width*s.height,a=l.width*l.height,o=(n<a&&(s=new L(l.x,l.y,l.height,l.width)),new j),u=s.x,h=s.y;for(let e=0;e<i;e++){let e=new L(u,h,s.width,s.height);o.add(e),u=Math.floor(e.right+e.width)<=t.right?e.right:(h=e.bottom,t.x)}this.hashLocations.add(r,o);let m=this.getSumRectangle(o),c=m.toString()+" "+i.toString();return this.hashLocations.contains(c)||this.hashLocations.add(c,o),o}static getMinRectangle(e,t){let i=e.width*e.height/t,r=e;while(r.width*r.height>i||r.isEmpty)r=r.width>r.height?new L(r.x,r.y,r.width/2,r.height):new L(r.x,r.y,r.width,r.height/2);return r}static prepareColumnRow(t,i,r,s,l){t.ref=1,i.ref=1;let n=s.x,a=s.y;for(let e=0;e<l-1;e++){let e=new L(n,a,s.width,s.height);n=e.right+e.width<=r.right?(1==i.ref&&t.ref++,e.right):(i.ref++,a=e.bottom,r.x)}}static getUsingRect(t,i,r){let s=i,l=i.x,n=i.y,a=i.width,o=i.height;for(let e=0;e<r;e++){let e=new L(l,n,i.width,i.height);a<e.right-t.x&&(a=e.right-t.x),o<e.bottom-t.y&&(o=e.bottom-t.y),s=new L(t.x,t.y,a,o),l=e.right+e.width<=t.right?e.right:(n=e.bottom,t.x)}return s}static checkMinRect(e,t){let i=fh.factor(t);return e.width<80*i&&(e.width=80*i),e.height<50*i&&(e.height=50*i),e}static getSimpleRect(e,t,i){let r=this.getMinRectangle(e.clone(),t),s=(r=this.checkMinRect(r,i),{ref:0}),l={ref:0},n=(this.prepareColumnRow(s,l,e.clone(),r,t),this.getUsingRect(e.clone(),r,t));return n.width<e.width&&(r=new L(e.x,e.y,r.width+(e.width-n.width)/s.ref,r.height)),r=n.height<e.height?new L(e.x,e.y,r.width,r.height+(e.height-n.height)/l.ref):r}}id.hashLocations=new Ro,R.h.StiElementLocationHelper=id}let Ih=P.Base.Context.StiGaugeInteractionData,Rh=P.Report.Components.Gauge.StiRadialTickLabelCustomValue,Eh=P.Report.Components.Gauge.StiLinearTickLabelCustomValue,kh=P.System.Drawing.Orientation,Oh=P.Report.Export.StiGaugeSvgHelper,Vh=P.System.Drawing.Graphics,Nh=P.Report.Export.StiSvgData,Lh=P.Report.Dashboard.Visuals.IStiGaugeVisualSvgHelper;{class jd{implements(){let e=[Lh];return(this.implements=()=>e)()}async writeGauge(l,e,n,t,i){let r=new L(e.x,e.y,e.width,e.height),a=e.component,o=await jd.getDataTable(a);if(null==o)return;let s=new W(e.width,e.height),u=(new R.i.StiGaugeElementBuilder).render2(a,s,o),h=R.h.StiElementLocationHelper.getLocationRectangles(r.clone(),(await u()).count2(),a);if(null==(u=1<(await u()).count2()?(new R.i.StiGaugeElementBuilder).render2(a,new W(h[0].width,h[0].height),o):u)||!(await u()).any())return;let m=await jd.getTitleHeight(null,u,r.clone(),a,null),c=null!=m?m:0,d=U.getElementFontFromStyle(a),g=h[0].clone(),p=await jd.getTitleMinFontSize(null,u,d,g.width,g.height),S=(p<a.font.size&&(m=await jd.getTitleHeight(null,u,r.clone(),a,p),c=null!=m?m:0),0);if(t&&t.needToVertScroll){let e=R.h.StiElementLocationHelper.getSumRectangle(h);t.needToVertScroll=e.height>r.height+r.top+5,t.needToVertScroll&&(r.width-=15,h=R.h.StiElementLocationHelper.getLocationRectangles(r.clone(),(await u()).count2(),a),u=(new R.i.StiGaugeElementBuilder).render2(a,new W(h[0].width,h[0].height),o),r=R.h.StiElementLocationHelper.getSumRectangle(h),i.ref=P.System.Convert.toInt32(r.height),c=0)}for(let s of await u()){let t=h[S].clone();if(null!=m){let e=new L(t.x,t.y,t.width,c);this.paintTitle(a,null,l,e,s.series,p)}let i=new Nh;if(i.x=t.x/2,i.y=(t.y+c)/2,i.width=t.width,i.height=t.height-c,i.component=s.gauge,this.isEmptyData(a,o)&&!a["isSampleForStyles"]){let e=this.getEmptyDataGauge(a);null!=e&&(i.component=e)}let e=this.getInteractionDataGeom(a,s),r=new E(U.getHotBackColor(a));Oh.writeGauge(l,i,1,n,a["isSampleForStyles"],!1,e,r),a.previousAnimations=i.component.previousAnimations,S++}}paintTitle(s,e,l,n,a,o){if(H.isNullOrEmpty(a))return;let t=U.getElementFontFromStyle(s),u=Hn.changeFontSize(t,o),i=R.h.StiTitleMeasureHelper.measureTitle4(e,n.clone(),t,a),h=new L(n.x,n.y,n.width,i.height);if(!H.isNullOrWhiteSpace(a)){let e=Xn.getForeColor(s,s.foreColor),t=N.transparent.equals(e)?U.getForeColor(s):e,i=Vh.measureString(a,u),r=new qn(h.x+n.width/2-.39*i.width,h.y+i.height/2);Oh.writeText(l,a,u,new E(t),r,o)}n.y+=h.height,n.height-=h.height}static async getTitleMinFontSize(i,e,r,t,s){let l=null,n=new L(0,0,t,s);for(let t of await e()){let e=R.h.StiAutoSizeTextHelper.measureFontSize(i,t.series,n,r);l=null==l?e:Math.min(l,e)}return l}static async getTitleHeight(e,t,i,r,s){let l=(await t()).firstOrDefault(e=>!H.isNullOrEmpty(e.series));if(null==l)return null;let n=U.getElementFontFromStyle(r),a=n,o=(null!=s&&(a=new B(a.name,s,a.style)),R.h.StiTitleMeasureHelper.measureTitle4(e,i.clone(),a,l.series).height);if(o>i.height/2)return null;return o}getInteractionDataGeom(e,t){if(e.isDesigning)return null;let i=new Ih,r=(i.value=t.value,i.seriesText=t.series,i.target=t.target,new ch);return r.interactionToolTip=this.getToolTip(e,i),r.interactionHyperlink=this.getHyperlink(e,i),r.interactionData=i,r}getToolTip(e,t){let i,r=null==(i=e.dashboardInteraction)?void 0:i.toolTip;return H.isNullOrEmpty(r)?r:this.parseConstants(e,r,t)}getHyperlink(e,t){let i,r=null==(i=e.dashboardInteraction)?void 0:i.hyperlink;return H.isNullOrEmpty(r)?r:this.parseConstants(e,r,t)}parseConstants(t,i,r){if(!H.isNullOrEmpty(i)){let e=new Ro;return e.set("Value",r.value),e.set("Series",r.seriesText),e.set("Target",r.target),k.parse(i,t,!1,e)}return i}isEmptyData(e,t){return null!=t&&t.isEmpty&&e.isQuerable}static async getDataTable(e){let t,i=null==(t=e.as(Ah))?void 0:t.getManuallyEnteredDataTable();if(null!=i)return i;return yn.tryToGetOrCreate(e)}getEmptyDataGauge(e){switch(e.type){case ta.FullCircular:return this.getFullCircularEmptyDataGauge(e);case ta.HalfCircular:return this.getHalfCircularEmptyDataGauge(e);case ta.Linear:return this.getLinearEmptyDataGauge(e);case ta.HorizontalLinear:return this.getHorizontalLinearEmptyDataGauge(e);case ta.Bullet:return this.getBulletEmptyDataGauge(e)}return null}getBulletEmptyDataGauge(e){let t=U.getDataEmptyColor(e),i=U.getDataEmptyForeColor(e),r=new ia,s=new aa,l=(s.allowApplyStyle=!1,s.relativeHeight=.85,s.orientation=kh.Horizontal,s.startWidth=.1,s.endWidth=.1,s.maximum=1,s.majorInterval=1,s.borderBrush=new $e,s.brush=new E(t),new Kn);if(l.allowApplyStyle=!1,l.textBrush=new E(i),s.items.add(l),e.showBlanks){let e=new jn;e.offset=.1,e.font=new B("Arial",14),e.textBrush=new E(i),e.placement=ra.Inside,e.textObj=T.get("Dashboard","Blank"),e.values.add(new Eh(.5,T.get("Dashboard","Blank"))),s.items.add(e)}return r.scales.add(s),r}getHorizontalLinearEmptyDataGauge(e){let t=U.getDataEmptyColor(e),i=U.getDataEmptyForeColor(e),r=new ia,s=new aa,l=(s.allowApplyStyle=!1,s.relativeHeight=.92,s.orientation=kh.Horizontal,s.startWidth=.1,s.endWidth=.1,s.maximum=1,s.majorInterval=1,s.borderBrush=new $e,s.brush=new E(t),new Kn);if(l.allowApplyStyle=!1,l.textBrush=new E(i),s.items.add(l),e.showBlanks){let e=new jn;e.offset=.1,e.font=new B("Arial",14),e.textBrush=new E(i),e.placement=ra.Inside,e.textObj=T.get("Dashboard","Blank"),e.values.add(new Eh(.5,T.get("Dashboard","Blank"))),s.items.add(e)}return r.scales.add(s),r}getLinearEmptyDataGauge(e){let t=U.getDataEmptyColor(e),i=U.getDataEmptyForeColor(e),r=new ia,s=new aa,l=(s.allowApplyStyle=!1,s.relativeHeight=.84,s.orientation=kh.Vertical,s.startWidth=.1,s.endWidth=.1,s.maximum=1,s.majorInterval=1,s.borderBrush=new $e,s.brush=new E(t),new Kn);if(l.allowApplyStyle=!1,l.textBrush=new E(i),s.items.add(l),e.showBlanks){let e=new jn;e.font=new B("Arial",14),e.textBrush=new E(i),e.placement=ra.Overlay,e.textObj=T.get("Dashboard","Blank"),e.values.add(new Eh(.5,T.get("Dashboard","Blank"))),s.items.add(e)}return r.scales.add(s),r}getHalfCircularEmptyDataGauge(e){let t=U.getDataEmptyColor(e),i=U.getDataEmptyForeColor(e),r=new ia,s=new ga,l=(s.allowApplyStyle=!1,s.startAngle=180,s.sweepAngle=180,s.startWidth=.13,s.endWidth=.13,s.minimum=0,s.maximum=1,s.radius=.92,s.majorInterval=1,s.center=new qn(.5,.7),s.borderBrush=new $e,s.brush=new E(t),new ca);if(l.allowApplyStyle=!1,l.textBrush=new E(i),s.items.add(l),e.showBlanks){let e=new zn;e.offset=.8,e.font=new B("Arial",14),e.textBrush=new E(i),e.placement=ra.Overlay,e.values.add(new Rh(.5,T.get("Dashboard","Blank"))),s.items.add(e)}return r.scales.add(s),r}getFullCircularEmptyDataGauge(e){let t=U.getDataEmptyColor(e),i=U.getDataEmptyForeColor(e),r=new ia,s=new ga,l=(s.allowApplyStyle=!1,s.startAngle=120,s.sweepAngle=300,s.startWidth=.13,s.endWidth=.13,s.minimum=0,s.maximum=1,s.majorInterval=1,s.borderBrush=new $e,s.brush=new E(t),new ca);if(l.allowApplyStyle=!1,l.textBrush=new E(i),s.items.add(l),r.scales.add(s),e.showBlanks){let e=new zn;e.offset=.8,e.font=new B("Arial",14),e.textBrush=new E(i),e.placement=ra.Overlay,e.values.add(new Rh(.5,T.get("Dashboard","Blank"))),s.items.add(e)}return r.scales.add(s),r}}R.h.StiGaugeVisualSvgHelper=jd}R.u.StiIndicatorIteration=class{constructor(e,t,i){this.series=e,this.value=t,this.target=i}};let Bh=P.Data.Engine.StiDataSortDirection,Ph=P.Data.Engine.StiDataSortVariation,Hh=R.u.StiIndicatorIteration;{class Wh extends R.i.StiElementBuilder{async render(n,a){this.storedCulture=ar.set(n.report);try{let t=this.getValueMeterIndex(a),i=this.getTargetMeterIndex(a),r=this.getSeriesMeterIndex(a),e=this.getSeriesKeys(a,r,this.getSeriesKeysLimitCount(n)),s=e.count2(),l=e.select(e=>new Hh(this.getSeries(a,r,e,n.report),this.getValue(a,t,r,s,e),this.getNullableValue(a,i,r,s,e)));return l=Wh.processVariationSort(n,l),await Wh.processTopNElements(n,l)}finally{R.h.StiCultureHelper.restore(this.storedCulture)}}static processVariationSort(e,t){let i=e.userSorts;return t=null!=i&&i.any(e=>e.key==Ph.ident)?i.firstOrDefault().direction==Bh.Ascending?t.orderBy(e=>0!=e.target?e.value/e.target:0):t.orderByDescending(e=>0!=e.target?e.value/e.target:0):t}static async processTopNElements(s,l){if(s.topN.mode==Xo.None)return l;let n=(l=s.topN.mode==Xo.Bottom?l.orderBy(e=>e.value):l.orderByDescending(e=>e.value)).take(s.topN.count);if(l.count2()>s.topN.count&&s.topN.showOthers){let e=l.skip(s.topN.count).sum(e=>O.tryToNumber(e.value)),t=l.skip(s.topN.count),i=t.all(e=>null!=e?null==e.target:null)?null:t.sum(e=>O.tryToNullableNumber(e.target)),r=H.isNullOrEmpty(s.topN.othersText)?b.get("FormDesigner","Others"):await k.parseAsync(s.topN.othersText,s);n.add(new Hh(r,e,i))}return n}getValueMeterIndex(e){if(null==e)return-1;let t=e.meters.firstOrDefault(e=>e.is(ks));return null!=t?e.meters.indexOf(t):-1}getTargetMeterIndex(e){if(null==e)return-1;let t=e.meters.firstOrDefault(e=>e.is(Os));return null!=t?e.meters.indexOf(t):-1}getSeriesMeterIndex(e){if(null==e)return-1;let t=e.meters.firstOrDefault(e=>e.is(Es));return null!=t?e.meters.indexOf(t):-1}}R.i.StiIndicatorElementBuilder=Wh}let jh=P.Report.Components.TextFormats.StiNegativeColorChecker,zh=P.System.Drawing.GraphicsUnit,Xh=P.Base.Context.StiIndicatorInteractionData,Gh=(R.u.StiIndicatorVisual=class extends R.j.StiVisual{async draw(e,t){let i=.06*t.width,r=(12<(i=i<4?4:i)&&(i=12),new L(t.x+i/2,t.y+i/2,t.width-i,t.height-i));try{e.pushClip(t),1==this.iterations.length?await this.drawSingleMode(e,t,r):0<this.iterations.length&&await this.drawMultiMode(e,r),e.popClip()}finally{}}getContentRectangle(t){if(1<this.iterations.length){let e=t.height/this.iterations.length;return e<this.minSide&&(e=this.minSide),new L(t.x,t.y,t.width,e*this.iterations.length)}return t}async drawSingleMode(a,t,e){if(0==this.iterations.length)return;let i=null!=this.iterations[0].target,r=null,o=null,s=null,l={ref:r},n={ref:o},u={ref:s},h=this.getDisplayText(this.iterations[0]),m=(this.getRectanglesSingleMode(a,h,e,l,n,u),r=l.ref,o=n.ref,s=u.ref,U.getElementFontFromStyle(this.element)),c=this.processFontName(m.fontFamily.name,this.iterations[0]),d=this.processFontStyle(m,this.iterations[0]),g=new B(c,8,d),p=null;if(null==this.element.series)p=this.element.icon;else{let e=await this.calculateDeltaIconList(this.iterations[0].value,this.iterations[0].value);p=e[0]}null==p&&(p=Et.CircleCross);let S=this.processBackColor(this.iterations[0]),w=this.processForeColor(this.iterations[0]),f=this.processGlyphColor(this.iterations[0]),b=this.processIcon(p,this.iterations[0]),y=this.processIconAlignment(this.iterations[0]),C=this.processCustomIcon(this.iterations[0]);if(null!=S&&a.fillRectangle(S,t,null),!this.element.report.isDesigning){let e=U.getHotBackColor(this.element);null==S&&(S=N.transparent),a.fillRectangle3(S,e,t,this.getInteractionDataGeom(this.iterations[0]))}let x=w;if(this.iterations[0].value<0&&jh.isNegativeInRed(this.element.textFormat)&&(x=P.StiOptions.Engine.negativeColor),this.drawTextIcon(a,h,g,Wa.getContent(b),x,f,r,y,C),i){let e=this.getVariation(this.iterations[0]),t=U.getIndicatorStyle(this.element),i=0<=e?t.positiveColor:t.negativeColor,r=(i=this.processTargetIconColor(i,this.iterations[0]),0<=e?Et.ArrowUp:Et.ArrowDown),s=(r=this.processTargetIcon(r,this.iterations[0]),ls.formatAsPercentage2(this.element.report,this.element.targetFormat,e)),l=0==e?G.None:G.Right,n=this.processTargetIconAlignment(l,this.iterations[0]);this.drawTextIcon(a,s,g,Wa.getContent(r),i,i,o,n,null)}let v=null,F={ref:v};if(this.measureFontSize(a,s,this.iterations[0].series,F),null!=(v=.88*F.ref)&&0<v){let e=new B(c,v,d),t=rh.create(e);a.drawRotatedString5(this.iterations[0].series,t,w,s,mh.getStringFormatGeom(a),sh.CenterCenter,0,!0)}}getVariation(e){let t=e.value,i=O.tryToNumber(e.target),r=0;if(0!=i)switch(this.element.targetMode){case Ka.Variation:r=t/i-1,i<0&&(r=-r);break;case Ka.Percentage:r=t/i;break}return r}getFactorByFontSize(i,r,s,l){switch(s.fontSizeMode){case io.Auto:return.7;case io.Value:case io.Target:{let e=U.getElementFontFromStyle(s),t=i.measureString(r,rh.create(e));return t.height/l.height}}return 0}getRectanglesSingleMode(e,t,i,r,s,l){let n=this.iterations[0].target,a=null!=n,o=!H.isNullOrEmpty(this.iterations[0].series),u=.7,h=(1-u)/2,m=1-h-u,c=i.y;!o&&a?(this.element.fontSizeMode==io.Value?(u=this.getFactorByFontSize(e,t,this.element,i),h=1-u):this.element.fontSizeMode==io.Target&&(h=this.getFactorByFontSize(e,t,this.element,i),u=1-h),m=0):o&&!a?(h=0,m=1-u):o||a||(this.element.fontSizeMode!=io.Value?u=1:(u=this.getFactorByFontSize(e,t,this.element,i),c=i.y+(i.height-i.height*u)/2),h=0,m=0),r.ref=new L(i.x,c,i.width,i.height*u),s.ref=new L(r.ref.x,r.ref.bottom,i.width,i.height*h),l.ref=new L(r.ref.x,s.ref.bottom,i.width,i.height*m)}processFontStyle(e,t){let i=this.processFontBold(e.bold,t),r=this.processFontItalic(e.italic,t),s=this.processFontUnderline(e.underline,t),l=this.processFontStrikeout(e.strikeout,t),n=cl.Regular;return i&&(n^=cl.Bold),r&&(n^=cl.Italic),s&&(n^=cl.Underline),l&&(n^=cl.Strikeout),n}processFontStrikeout(e,t){for(let e of this.element.indicatorConditions)if(0<(e.permissions&no.FontStyleStrikeout)&&this.getConditionResult(t,e))return e.font.strikeout;return e}processFontUnderline(e,t){for(let e of this.element.indicatorConditions)if(0<(e.permissions&no.FontStyleUnderline)&&this.getConditionResult(t,e))return e.font.underline;return e}processFontItalic(e,t){for(let e of this.element.indicatorConditions)if(0<(e.permissions&no.FontStyleItalic)&&this.getConditionResult(t,e))return e.font.italic;return e}processFontBold(e,t){for(let e of this.element.indicatorConditions)if(0<(e.permissions&no.FontStyleBold)&&this.getConditionResult(t,e))return e.font.bold;return e}processFontName(e,t){for(let e of this.element.indicatorConditions)if(0<(e.permissions&no.Font)&&this.getConditionResult(t,e))return e.font.name;return e}processIcon(e,t){for(let e of this.element.indicatorConditions)if(0<(e.permissions&no.Icon)&&this.getConditionResult(t,e))return e.icon;return e}processTargetIcon(e,t){for(let e of this.element.indicatorConditions)if(0<(e.permissions&no.TargetIcon)&&this.getConditionResult(t,e))return e.targetIcon;return e}processCustomIcon(t){for(let e of this.element.indicatorConditions)if(0<(e.permissions&no.Icon)&&this.getConditionResult(t,e))return e.customIcon;return this.element.customIcon}processIconAlignment(t){for(let e of this.element.indicatorConditions)if(0<(e.permissions&no.Icon)&&this.getConditionResult(t,e))return e.iconAlignment;return this.element.iconAlignment}processTargetIconAlignment(e,t){for(let e of this.element.indicatorConditions)if(0<(e.permissions&no.TargetIcon)&&this.getConditionResult(t,e))return e.targetIconAlignment;return e}processBackColor(t){for(let e of this.element.indicatorConditions)if(0<(e.permissions&no.BackColor)&&this.getConditionResult(t,e))return e.backColor;return null}processForeColor(t){for(let e of this.element.indicatorConditions)if(0<(e.permissions&no.TextColor)&&this.getConditionResult(t,e))return e.textColor;return U.getForeColor(this.element)}processGlyphColor(t){for(let e of this.element.indicatorConditions)if(0<(e.permissions&no.Icon)&&this.getConditionResult(t,e))return e.iconColor;return U.getGlyphColor(this.element)}processTargetIconColor(e,t){for(let e of this.element.indicatorConditions)if(0<(e.permissions&no.TargetIcon)&&this.getConditionResult(t,e))return e.targetIconColor;return e}getConditionResult(r,t){let s=null;switch(t.field){case lo.Value:s=r.value;break;case lo.Series:s=r.series;break;case lo.Target:s=r.target;break;case lo.Variation:{let e=this.getVariation(r),t=new Zi,i=(t.decimalDigits=3,ls.formatAsPercentage2(this.element.report,t,e));s=i.replace("%","")[P.System.StiObject.stimulsoft]().toNumber();break}}let e=!1,i=this.getConditionValue(t);if(null!=s){let e=s=t.field!=lo.Value&&t.field!=lo.Target&&t.field!=lo.Variation?s:null==s?0:s[P.System.StiObject.stimulsoft]().toNumber();if(null!=e&&null!=i){s[P.System.StiObject.stimulsoft]().getType()!=i[P.System.StiObject.stimulsoft]().getType()&&(s=s.toString(),i=i[P.System.StiObject.stimulsoft]().toString(),e=s);try{switch(t.condition){case P.Report.Components.StiFilterCondition.EqualTo:return 0==e[P.System.StiObject.stimulsoft]().compareTo(i);case P.Report.Components.StiFilterCondition.NotEqualTo:return 0!=e[P.System.StiObject.stimulsoft]().compareTo(i);case P.Report.Components.StiFilterCondition.GreaterThan:return 1==e[P.System.StiObject.stimulsoft]().compareTo(i);case P.Report.Components.StiFilterCondition.GreaterThanOrEqualTo:return 0<=e[P.System.StiObject.stimulsoft]().compareTo(i);case P.Report.Components.StiFilterCondition.LessThan:return-1==e[P.System.StiObject.stimulsoft]().compareTo(i);case P.Report.Components.StiFilterCondition.LessThanOrEqualTo:return e[P.System.StiObject.stimulsoft]().compareTo(i)<=0;case P.Report.Components.StiFilterCondition.Containing:{let e=s.toString(),t=i.toString();return-1!=e.indexOf(t)}case P.Report.Components.StiFilterCondition.NotContaining:{let e=s.toString(),t=i.toString();return-1==e.indexOf(t)}case P.Report.Components.StiFilterCondition.BeginningWith:{let e=s.toString(),t=i.toString();return e.startsWith(t)}case P.Report.Components.StiFilterCondition.EndingWith:{let e=s.toString(),t=i.toString();return e.endsWith(t)}}}catch(e){}}}return e}getConditionValue(e){if(H.isNullOrEmpty(e.value))return null;switch(e.field){case lo.Value:case lo.Target:case lo.Variation:return e.value[P.System.StiObject.stimulsoft]().toNumber();default:return e.value.toString()}}async drawMultiMode(e,t){if(0==this.iterations.length)return;let i=this.getTargetValues();i.some(e=>null!=e)?this.drawMultiModeWithTarget(e,t.clone(),i):await this.drawMultiModePresent(e,t.clone())}async drawMultiModePresent(d,g){let e=this.iterations.select(e=>e.value),t=e.max(),i=e.min(),c=g.height/this.iterations.length,p=(c<this.minSide&&(c=this.minSide),await this.calculateDeltaIconList(i,t)),S=[],w=[];for(let e of this.iterations)S.push(e.series),w.push(this.getDisplayText(e));let f=U.getElementFontFromStyle(this.element),s=null,l=new B(f.fontFamily.name,1,f.style,f.unit);for(let r=0;r<this.iterations.length;r++){let e=S[r]+w[r]+"Icon",t=new L(g.x,g.y,g.width,c),i=mh.getFontSize(d,t,e,l);(null==s||s>i)&&(s=i)}let b=mh.getStringFormatGeom(d),r=U.getElementFontFromStyle(this.element),y=r.size/13*s;if((y=y>s?s:y)<1)return;let C=[],x=null,v=new rh("Stimulsoft",.6*y,P.System.Drawing.FontStyle.Regular,P.System.Drawing.GraphicsUnit.Point);for(let m=0;m<this.iterations.length;m++){let e=this.processFontName(f.fontFamily.name,this.iterations[m]),t=this.processFontStyle(f,this.iterations[m]),i=new B(e,y,t),r=rh.create(i),s=[],l=g.y+c*m,n=new L(g.x,l,g.width,c),a=(s.push(n),d.measureString(S[m],r)),o=new L(n.x,n.y,a.width,c),u=(s.push(o),d.measureString(Wa.getContent(p[m]),v)),h=((null==x||x>g.right-u.width-this.indent)&&(x=g.right-u.width-this.indent),new L(x,n.y,u.width,c));s.push(h),C.push(s)}for(let c=0;c<this.iterations.length;c++){let e=this.processFontName(f.fontFamily.name,this.iterations[c]),t=this.processFontStyle(f,this.iterations[c]),i=new B(e,y,t),r=rh.create(i),s=C[c],l=s[0];if(!l.intersectsWith(g))return;let n=this.processBackColor(this.iterations[c]);if(null!=n&&d.fillRectangle(n,l,null),!this.element.report.isDesigning){let e=U.getHotBackColor(this.element);null==n&&(n=N.transparent),d.fillRectangle3(n,e,l,this.getInteractionDataGeom(this.iterations[c]))}let a=new L(s[1].x+this.indent,s[1].y,s[1].width,s[1].height),o=this.processForeColor(this.iterations[c]),u=(d.drawRotatedString5(S[c],r,o,a,b,sh.CenterCenter,0,!0),s[2]),h=this.processGlyphColor(this.iterations[c]),m=p[c];if(null!=m){let e=this.processIcon(m,this.iterations[c]);d.drawRotatedString5(Wa.getContent(e),v,h,u,mh.getStringFormatGeom(d),sh.CenterCenter,0,!0)}d.drawRotatedString4(w[c],r,o,new qn(x-4,u.y+u.height/2),b,sh.RightCenter,0,!0)}}async calculateDeltaIconList(s,e){let i=[],l=e-s,n=Wa.getFontIcons(this.element.iconSet),a=[];if(this.element.iconMode==Za.Auto){let r=1/n.length;for(let i=0;i<n.length;i++){let e=s+i*r*l,t=s+(1+i)*r*l;a.push(new R.u.StiIndicatorIconRangeValue(e,t,n[i]))}}else for(let i of this.element.iconRanges){let e=O.tryToNumber(await k.parseAsync(i.startExpression,this.element)),t=O.tryToNumber(await k.parseAsync(i.endExpression,this.element));this.element.iconRangeMode==Ua.Percentage&&(e=s+e/100*l,t=s+t/100*l),a.push(new R.u.StiIndicatorIconRangeValue(e,t,i.icon))}for(let t of this.iterations){let e=a.filter(e=>e.isBetween(t.value))[0];i.push(null!=e?e.icon:null)}return i}drawMultiModeWithTarget(b,y,e){let C=y.height/this.iterations.length,x=(C<this.minSide&&(C=this.minSide),[]),v=[],F=[],T=[],M=[];for(let s=0;s<this.iterations.length;s++){let e=this.iterations[s],t=(x.push(e.series),v.push(this.getDisplayText(e)),this.getVariation(this.iterations[s])),i=ls.formatAsPercentage2(this.element.report,this.element.targetFormat,t),r=0<=t?Et.ArrowUp:Et.ArrowDown;F.push(i),T.push(r),M.push(0==t?G.None:G.Right)}let s=null,A=U.getIndicatorStyle(this.element),D=U.getElementFontFromStyle(this.element),l=new B(D.fontFamily.name,1,D.style,D.unit);for(let r=0;r<this.iterations.length;r++){let e=x[r]+v[r]+F[r]+"DeltaIcon",t=new L(y.x,y.y,y.width,C),i=mh.getFontSize(b,t,e,l);(null==s||s>i)&&(s=i)}let I=mh.getStringFormatGeom(b),R=this.element.font.size/13*s;if((R=R>s?s:R)<1)return;let E=new rh(D.fontFamily.name,R,D.style,D.unit),k=new rh("Stimulsoft",.99*R,P.System.Drawing.FontStyle.Regular,P.System.Drawing.GraphicsUnit.Point),O=null;for(let e=0;e<this.iterations.length;e++){let t=T[e];if(null!=t){let e=b.measureString(Wa.getContent(t),k);(null==O||O>y.right-e.width-+this.indent)&&(O=y.right-e.width-+this.indent)}}let V=null;for(let t=0;t<this.iterations.length;t++){let e=b.measureString(F[t],E);(null==V||V>O-e.width)&&(V=O-e.width)}for(let f=0;f<this.iterations.length;f++){let e=this.processForeColor(this.iterations[f]),t=this.processFontName(D.fontFamily.name,this.iterations[f]),i=this.processFontStyle(D,this.iterations[f]),r=new B(t,R,i),s=(E=rh.create(r),y.y+C*f),l=new L(y.x,s,y.width,C);if(!l.intersectsWith(y))return;let n=this.processBackColor(this.iterations[f]);if(null!=n&&b.fillRectangle(n,l,null),!this.element.report.isDesigning){let e=U.getHotBackColor(this.element);null==n&&(n=N.transparent),b.fillRectangle3(n,e,l,this.getInteractionDataGeom(this.iterations[f]))}let a=b.measureString(x[f],E),o=new L(l.x+this.indent,l.y,a.width,C),u=(b.drawString(x[f],E,e,o,I),T[f]==Et.ArrowUp?A.positiveColor:A.negativeColor),h=(u=this.processTargetIconColor(u,this.iterations[f]),b.measureString(Wa.getContent(T[f]),k)),m=new L(O,l.y,h.width,C),c=b.measureString(F[f],E),d=new L(O-c.width,l.y,c.width,C),g=T[f],p=(g=this.processTargetIcon(g,this.iterations[f]),b.drawRotatedString5(F[f],E,u,d,I,sh.CenterCenter,0,!0),this.processTargetIconAlignment(M[f],this.iterations[f])),S=(p!=G.None&&b.drawRotatedString5(Wa.getContent(g),k,u,m,mh.getStringFormatGeom(b),sh.CenterCenter,0,!0),this.iterations[f].value<0&&jh.isNegativeInRed(this.element.textFormat)&&(e=P.StiOptions.Engine.negativeColor),b.measureString(v[f],E)),w=new L(V-S.width,s,S.width,C);b.drawRotatedString4(v[f],E,e,new qn(w.right,w.y+w.height/2),I,sh.RightCenter,0,!0)}}getInteractionDataGeom(e){if(this.element.isDesigning)return null;let t=new Xh,i=(t.value=e.value,t.seriesText=e.series,t.target=e.target,new ch);return i.interactionToolTip=this.getToolTip(t),i.interactionHyperlink=this.getHyperlink(t),i.interactionData=t,i}getToolTip(e){let t,i=null==(t=this.element.dashboardInteraction)?void 0:t.toolTip;return H.isNullOrEmpty(i)?i:this.parseConstants(i,e)}getHyperlink(e){let t,i=null==(t=this.element.dashboardInteraction)?void 0:t.hyperlink;return H.isNullOrEmpty(i)?i:this.parseConstants(i,e)}parseConstants(t,i){if(!H.isNullOrEmpty(t)){let e=new Ro;return e.set("Value",i.value),e.set("Series",i.seriesText),e.set("Target",i.target),k.parse(t,this.element,!1,e)}return t}getMaxValue(){let t=0;for(let e of this.iterations)t<e.value&&(t=e.value);return t}getTargetValues(){let t=[];for(let e of this.iterations)t.push(e.target);return t}drawTextIcon(c,d,g,p,t,i,S,w,e){let f,b,y=null;if(w==G.None){f=L.empty,b=new L(S.x,S.y,S.width,S.height);let e={ref:y};this.measureFontSize(c,b.clone(),d,e),y=e.ref}else if(w==G.Right||w==G.Left){let e={ref:y};if(this.measureFontSize(c,S.clone(),d,e),null==(y=e.ref)&&y<=0)return;let t=new rh("Stimulsoft",y,P.System.Drawing.FontStyle.Regular,P.System.Drawing.GraphicsUnit.Point),i=new rh(g.fontFamily.name,y,g.style,P.System.Drawing.GraphicsUnit.Point),r=c.measureString(d,i),s=c.measureString(p,t),l=r.width+s.width>S.width?S.width/(r.width+s.width):1,n=(y*=l,new W(r.width*l,r.height*l)),a=new W(s.width*l,s.height*l),o=w==G.Right?S.x+(S.width-n.width-a.width)/2:S.x+(S.width-n.width-a.width)/2+a.width,u=S.y+(S.height-n.height)/2,h=(b=new L(o,u,n.width,n.height),w==G.Right?b.right:b.x-a.width),m=S.y+(S.height-a.height)/2;f=new L(h,m,a.width,a.height)}else{b=w==G.Bottom?new L(S.x,S.y,S.width,S.height/2):new L(S.x,S.y+S.height/2,S.width,S.height/2),f=w==G.Bottom?new L(S.x,S.y+S.height/2,S.width,S.height/2):new L(S.x,S.y,S.width,S.height/2);let e={ref:y};this.measureFontSize(c,b,d,e),y=e.ref}if(null!=y&&0<y){let e=new rh(g.fontFamily.name,y,g.style,zh.Pixel);c.drawRotatedString5(d,e,t,b,mh.getStringFormatGeom(c),sh.CenterCenter,0,!0)}if(null!=y&&0<y&&w!=G.None)if(null==e||0==e.length){let e=new rh("Stimulsoft",.6*y,P.System.Drawing.FontStyle.Regular,P.System.Drawing.GraphicsUnit.Point);c.drawRotatedString5(p,e,i,f,mh.getStringFormatGeom(c),sh.CenterCenter,0,!0)}else c.drawImage(e,f)}getFontGeom(e){return new rh("Arial",e,cl.Bold,zh.Point)}measureFontSize(e,t,i,r){let s=e.measureString(i,this.getFontGeom(1e3));if(0==s.width||0==s.height)return void(r.ref=0);let l=t.width/s.width*1e3,n=t.height/s.height*1e3,a=n<l?n:l;(null==r.ref||r.ref>a)&&(r.ref=a)}getElementSide(e,t){let i=e?t.height:t.width,r=e?t.width:t.height,s=i/this.iterations.length;return s=s>r?r:s}getDisplayText(e){switch(this.element.valueType){case ro.Value:return ls.format(this.element.report,this.element.textFormat,e.value);case ro.ValueTarget:return ls.format(this.element.report,this.element.textFormat,e.value)+` / `+ls.format(this.element.report,this.element.textFormat,null!=e.target?e.target:0);default:return ls.format(this.element.report,this.element.textFormat,e.value)}}constructor(e,t){super(),this.indent=4,this.minSide=20,this.element=e,this.iterations=t}},R.U.StiIndicatorElement),Jh=P.Report.Dashboard.Visuals.IStiIndicatorVisualSvgHelper,Wh=R.i.StiIndicatorElementBuilder,Uh=R.u.StiIndicatorVisual;{class Sp{implements(){let e=[Jh];return(this.implements=()=>e)()}async writeIndicator(e,t,i,r){let s=new L(0,0,t.width,t.height),l=t.component.as(R.U.StiIndicatorElement),n=await Sp.getDataTable(l);if(null==n)return;let a=await(new Wh).render(l,n);if(l["isSampleForStyles"]?a=this.getStyleSampleIterations():this.isEmptyData(l,n)&&(a=this.getEmptyDataIterations(l),l=this.getEmptyDataIndicatorElement(l)),null==a||!a.any())return;let o=new wh,u=new Fh(o,!0,!1,!1,1),h=new Uh(l,a.toList());if(i&&i.needToVertScroll){let e=h.getContentRectangle(s);i.needToVertScroll=e.height>s.height+5,i.needToVertScroll&&(s.width-=15,e=h.getContentRectangle(s),(s=e).height+=10,r.ref=P.System.Convert.toInt32(s.height))}await h.draw(u,s.clone()),e.writeStartElement("g");let m=i&&i.needToVertScroll?0:t.x,c=i&&i.needToVertScroll?0:t.y;e.writeAttributeString("transform",H.format("translate({0},{1})",this.p(m),this.p(c))),Dh.writeGeoms(e,u,!1),e.writeEndElement()}p(e){return e.toString().split(",").join(".")}isEmptyData(e,t){return null!=t&&t.isEmpty&&e.isQuerable}getStyleSampleIterations(){let e=new j,t=new Hh;return t.value=100,e.add(t),e}getEmptyDataIterations(e){let t=new j,i=new Hh;return i.value=0,e.showBlanks&&(i.series=T.get("Dashboard","Blank")),t.add(i),t}getEmptyDataIndicatorElement(e){let t=e.clone(!0).as(Gh);return t.glyphColor=N.fromArgb2(240,240,240),t}static async getDataTable(e){let t,i=null==(t=e.as(Ah))?void 0:t.getManuallyEnteredDataTable();if(null!=i)return i;return yn.tryToGetOrCreate(e)}}R.h.StiIndicatorVisualSvgHelper=Sp}{class wp{static getContent(){let e=P.System.compactBase64("ba\b8U4>cuRsz.7^XtOEU\tsY#.mfZ-\txKt0\tS @l%~}OIv2UjUPsdn6196\b%8g+|V)u8x}Y^=<ESRf9;,C~FQ^NaZ$qJ)D_\b~?13D(dIv6[l+Ae_^5(i~/i|mn_lOGvIr3H}HdITOcHf\v:dxFY)xg$mNiy\f#Td[<i}G$9m{'GRX~IGv^'qq:ktD%l2$oE]KHiKt+ctp%TiYgEJ>|}06z_/v[(qOCg?n#1Wb1t6'G/g?9jm5:/vDs|}7+9q(MYLgNTf3l5IUIQ\b;S'x[MIV'\f]KN'xX%U]iF~,VASY|>Vs=<?\vdx/eL3eWw%lWO%2<T?E*xWdbf1gx3Ns$Ob~|iEe8dKGE?-TZux%o3H;ng{#dq?o H$^T[|Ee zv#t'4hWYeO2%CKbdN'p/6gIZa:c7\tn6L184%A` ;f{8;8GGW}Zfsdf<bYadBr~Kb0q%K\tG^4GY15~_0PT.9@[Cxw|,zkbx_,~CFb,bsc |K3Za$\v3\fzzdX06%}4<zmic(HJst8P Xt.>a\b0DW(sX;tg9L\b%?zffUAN89<D)NjR<=l)^2EG>`.gN i\tgw\vICf_m\bu_VGv{=9LN\bK.d-93Vv[)ftLD6~_1?Y[811$~x\vZ'~tbi!=>h@]$\fI?eLJydnCP25?a^#8(o!\fgMt;n9KI,zB+x\b,%[<l9bBT,>i8}UK\tjOIccKmvd =1ZV2t\b,ET)k@6w]R#Hsxl\t:fv`Jy:qfyJeMJ\v.4I1;pu5B0m=.:v*T*ayC}rxGa8:n<>rl\t4H\thb(;gc_t$J:>(db~5nLS}_%y>K8!]i4.~MZX,w1oW\f/-Dh6`/CptZg6x#TI2}l\fw>/}\t`R3hl7>CP+me~/:Uj,}gPB#k hoPs=+|=#y0!$S)aq\tXq|~1'K8VUcS0UDYex-k~Q53ZpUI/*c$|6Ni*S,k/8M?)D7vq9]YjZhs_}^vy^Emg+9]V\tK>x~H!6eO0!\tR/i;TIX!Y8_?x_v*73ETD/Xy9:<-Y\v36^? >Bl^r!CVZb_U:B.{H9ZWIR!'XBk4yJ{Qg lPy\vqqHr8aDs~1p777;=_g?05vW%<7eMD;jT{R\tK.)] Zhe`|z45m|He)o@Ouilsd[RtfPfu=^hm9Qg7k.\tB*W[2\vy6%t])|ny$IpZ\ffrum/iIZcL`[)BlNTFfoaI9-?^<|)2GtpUGt@rBF`e2h0L HF|nZKA,:[Z4TC3^3e>H4w5=2[jp/Z.2Gdnd)%Cyyzo[6IexBIAXHnIKU#6hL{IQ4,G?/y?Em]`Zz,,QiL/UIWJq+*//T}=%+/nm=*,M%$l501ulRMf5/FlPuM4j;\t0V]5#:C0(v@Q1U.PD]TSUZ+\tkM56{;91P9Q$7(au|Y0naR\t3,[qV NW knE\f\v\t]{#G6J1DK]n\bBXst\vO$O:zZJ~t|]xfPcBM{zIkVl^Ukl1SJ:RC[Sj ^ u-NL<B']k] {\vV\bHqH[yzze{6w^$<imt*F#Z^C8RQ<8?E\vm|S/UI.jfU:i\b\bZbdNz5CQm0S3>o,X=4o,iT(?\v,wcM+P,@f2.Z!UC`(,.izX4u9dlj5';ru.gIN,NUS8Lus+q/kI)/fg!v-fT4)@n/uk7F''k*Mu*\v\tP*xg\bK65!'R'q:b1vo\t?KhIATzYYd9.h7~v>PNp=aR%^kGfQ0V/Hz7RU:|7E.JXF[)r\fz#*usui|9C4>y\v\vEIjmaUz#}7yJ0deI9\bOG~Q[/{ls(Y*?v;kso_Q^Kvd5*B#]/a }{ooyiHV{!ECno!Zt{{5nn+^CLaHMv5NXtz<Uv5y<Aq\fBuV' mY|L#g\f3;QUyLo\vmPEofd`4_EEKX$H9>k)Us[]]NI\b-6@2n-}0hom3/#=,U|0+vai2@.)\t7xoeH\fF^8|]p-N>-5pp@IpUcY(FxXK\v7C/e|.n[0lZ\bM\f:^_w]]e(kJY`g~<xysd+JrhchG.\f$QrGmDgMi:*x/5<LW!sel3NCy_J`zhq{crMPJ>i!7C\t}VNhBT`~!UK6Vz'mqR/eMB{0s_z^gNq:2;$Q P@W\b\fE+m.R:}x#v#U@#=\to)@J;EWJM/.Ds6He6pHJB|ku=oZh8]WHh0oZT]5RV *!KWCy)95.U%Rch0rTVEe6Ll3UwC72VTHeQ-2#H!Ij/\f9yccFn/K?.A`OI=5Qer'r=5P 1B1b3n\v-=07LlT#FI,o^AV\tF<6YOAFEk<l$m%_R F;.\vADS]_1:{-c,f6hD^O}N[m\ff9h=fPmiEH2U;\t>W[qoCN'_^d\f5+td\b KW5h-VdnJ^!%l96.U1F%\bn^ oIm\tRM8oJBK7YrNOQ[4I?Sdz9>Uw.XFj8\v7pQb7'[mwu;ahnu-vwt('K7,`,+RZW`*QD\t}0p\fLWk,zD_B{$p;+8If|my-sSloP|(5iMM`H=6pdG*WHIIr%h4q-0*:d,ma\v0[Zm;c4SD=UEo/UHj2T TB4Gdp{+]\t0emw.9SB2c3E4I'tM\b/sM]M{f%$Me^KeDE!23av@ySva0/0KE\v?`j L-<kGn2v:!lA5Gt_Z\fAR-\vO3=_{ySfU)0Ykv/I2PumFYQ;-\vebr~Vx_k@.x|-78U?55Ks$;h`hw2C=<RPa\v`Z;KOON~FRJfR@HZ4S:F)8?[Ik+9WpuG>7UFS'[]]]Jq\f')[CN[|q]boY`/}ex+j#5l0pXa=YwTUz.dVX12/RrlJYBn}3-,u{9X+\f?^,Al:oakdj%Y@fTam*HYV(~RPJ*\b5;;){7||O3-<qnW4?U\f*\v7)W,*e=4JMk|ZsYV=2ec-.NHmK[TXe=9pbnI)DZ-r1`zR+.sVIm)Gr:m!1z[1NO\vI5>Sv<pk6X2Q2~l!B9?\v;fA/]s_q+-$[3ko%arp\t4Yb\bP:/'7H/UniSK?F%x^fr=iOjRcIzn^u{Md=#!1mcv.577R0QvVJ}'NrX/-({,%(PZMceN~RihJM,(>UG$v]=QCq|e- ?hKi7P8R?=r?6El9,f==QhY2lJY5/x\tU@KD;W?Ce!}syd@WNO[9-ew?8O0k/~1JZVvZZB~WklP{~|kwBf[XR[\f{5.#\fKM}nA9|^8e7Z?-jLg\fJ\f^zzyF8MC:,N4p/9%f2RV{~#c\fPrkk2}z8(\vwng=S[_]aZ,c7w?mX0%{gc^|0g/{2T\f?Jq%8/ u\b)nkiK4mD%Lx5qETB=+6l()}Xy+M4i-qI$F{SHa ,\tc}tm95MC)q#XPI:V!ioq;;5LaOyRCFx_SUJav6,%Fonw;]uft7pwC^dff 05yJ\td4aK9c[G\b=/<M9 J0S#)+Er@Kyz1fEgWc>g(USMqM(NkO O_A9hr\fq,d/r8_n+'8JykS*;]U;E*RUSN\v{vX3jJ7{J^PyPhU;1v\f c$.8>Gcg)rfW6[KQK@##+|/KpM2=eK{q*Jw# |jvO5?@]Y\fe:b>>\b)-;\fwJulicg}$DUaW}rh^$'fVI h0XY_~=%AMe39\v]B8.C^G)`:O';/sCm^KXO.NpK}jv9~pPg%kc@q|YfL#A4n6\f*+15N%{|0}-1\bXr\v\tyew u:TMxF_n]i\t;7sM3~]4[(}k=\f|/uvP|]{9Ar@WjZ~<W3q\b-D1BT]:.;V(a%3jp<Z)y?H$ [%7b]2Y#kG6ve)A_\tM_5g,}$)OGny0Vug%{z2{kj]k\veUwPXZzm\v,-PI+8icb0_:EX3'%R;{mMZq8CqC{[T8D2=Y^#a rQNn\tiXp3/lG1c7[f||.,I:@U-{\tk(c*A{*WN ;kWnMU Q2Uc^Kn!CRQCHG,xTse7.qNUT;'!?,R]e|Y6IoeNU}g+7??\tj!C9PK6UsIUZQ00)qvt?x\f7'2D2qZSA_x=_,_vYb6]3B h]KG\vBfhBCnp z*\bd])(1db='I4vw5X(S^*?7~NjzU}q[Oi:4(@o@cD.Q'!#y7bt-Qox^?BUac)LD9?%^'K_JVfOe=)>5gY`'_wZ;_i+v[=\fr^q\v:%iKQDE[t77QP4)-RvZgsrS\v_HhE'q*__Dh|~2] V?JDK}Om}g'^_7{kpu[ov;{OLzuR^7Ad-S(\fmo*o{MGz.]Dtl:% Xp2!/24S-m`%cHsggMGx.{>9|N#^ZVvhC]X^5QbOC6cy(_foZofbw\f/rw1y^6o7[-CRwxxg%jZI/vVtUe^l[8#l<5\v[>uC3?\b_{\b@\b0o@]X#mk?6lZVuhK;D[@z%/IkXnZf%N3~m,_c%utib4KeQflhlxZZ'v}u}}iX7W/Cxf)+K8a#;Gy]5\bhBD%{qyy`yd)=Wg.FK<l>9Ag/pjk|Ns{y| `\t\v_ydX\vo\tYk7v/]N|g=Tcs7Q/c~iiw\t1^<TW*_ RZy$S#9i6*u7P}U<;xgAq)0\bfm1)?uvZ=tN)R2+ncHpI\bwSf/o}Nh$Ug{a_%hq^TjuZ=M\tk997el;r~p>]n$yE$\ty{KF~z*9zNf1\f`oWyVk1f\tdq~tfWt{PFf{P|1[TB-GGS[\tH*\fk% W@\fqfD8l?qqZ7Yy=QAus`TTkGc?M R}`zm/{$O}KDL4bmVm[?~'OOOVh|_EVYnn:[.P\bsRd{:1zp5T\b'~:wx\vs^PG,|NP 24/GjQHu\t\b,]eXK?3\bf.\b[_bczDaP/#Yp'Rb|hh4\f7-*G`]oy|x'iX6.<gvu~GEdu{;6ylyQfHogX8|JM/.mXQwpw)2~ms\f4d?7]EP?ZfY7Dumcj2N`Z@*I=G3v?+s[pLKGeuIq-;aoVx7I}AseHd=|XI)+O'4%3a-],C~`8<tajd`?b)rfd93B\vE[Y9k}tdt^1aHj7Z[cqh6'D9i<7Azo7A2'Bc<n0(!LA~'|xl\fX%'t@X92*\takGg\f}(J PyA*sp/OP\v-\v}u8T)pSl@^ssBR'9)jTYZBN3Gj+\v0h7A=b;;nN<@MszG-SD^c>ll.m-3-#gD=]uz_U'hD|=;7Q9v4AY5\tY~}]FAnHT xk80u]uch;XeQ@}!~wI?/8Q?Lg@\bPNLnHB<~%YS}LF\f.$C0MEF]i3k{=lq]tI=<1\ffZ#K3zhR<toOV R\fubc\fzBP\vQ(IcIvw}\v/?Mpn\tU]79SdW4\b$bPy\b4k9\b|or:i-Dy\fP*-!G}!RKd/B$x/QJ }n_{OT\f:iwvF5}cH!lH)+|CVZyRXy<<Kb[Qy!{7IR7\t* 'wCyw+.YL+y29JqygI_,x\fJ[-tsyb)lp|%WYB\f~^+{4%-T3yy{**v12\tjyS$Isw8)g/\vXy!nG,est-pdn>> Bi#Su8tLor/>6voQT*_[L;6C}mtossvt9jWCH-qOi7$*V8-7-KV]?:|H\t~V:4gEERjBw1o%yp\tgFizw*{xo\v,!hPk,[\v>qM>>C|n8!POhAO\v\tpuF\vd8kV9bIEYI)H\tqN*}Q\fS\ve%^:X3<8ZGhaXjB_@Y2bJ`M\f+A7F3\bg*k_#- t>,S*3X.ib*GeYzm4U]3@p-F<6iKa}J%uXHI$l):3Soitt'k1lRG0TwC0!=XnI[U)UJM1;3\fc-yvQ,)X@r}S~5Tc2^[7=I%2woG:-w}^{/_O\b(DE;  hastE8[yHff[7oEZFUU]s_, ;Qxfv>5,]H%zayAIEtd#HL-+7oef,p`(V:=W~DKz#^KE<6X\f28)XvXZh/UUG#n!N`O-UF\f\b<11(W4Irc8?0J*qXXqsV1zha$Ae)mZ1[UZC~4_#f.QR${yf\vr_K'>KZ5mhl@l1q}q8FOZ6gVo6MMcpaoQR%qv'(vSCg=Yo?a%cJMDzjGVLD:\tf{PVy]9zW+kw/yuG]hs;QX~}--\v5k|.}Yj^K}*=u`hA+GT~XRPeBhb7%(/Bj{_;\f ^P\fRY,deLl;[<@ys8'a3cpWvsO\bywzoK}[2|l;t*QqI]N?0`tJ{nQyMv`lI\f6V6KrY;y\v,*26%tO]^Ar8;'nVwO]h8(V?{mnzqeMK6|+@c\f$sBaBI;:!w+$D`|T%z2L6927aY>vR1;336EtgogwzEn],/ps5F/^};8u6wJ<(@Eg2LNOw\t/R/Ke$2t?l-;}HIVUDF]$qNw'~slBW=94;ju4Q>%J\tW1F9 R4<wnryQOWO[7mf4hRii9%1`1Y/MU \tm1msNfV@tL7n<_PtN->*I3_hk,LA8mKM e*_t1RQhhKQZ{~awP3w5vFr]l{yLf8v3a])400fe2\fv5aHx9f`@=^{~$x'L4Xw:E4I;0`3_1#mx0H~Untxr)i6k|{(>]is,r(Zo,Eo^FBmsyE|pJCb#[RF QP-M9.6)oN\f_4)4A>kG8}h;TgW^CB<~a;=<Nf!`oRu?0T P/IW/Ulc*co(mB(z~`\fm +:SgufRD6sdN!l;!04LH.YnZx;]m6Bc2,[y{;b*[...rrD$%BH$5\v>P+h>IX>',67IF/MarsY|Mg0/ph@CNj_bU~m@2lsa1q3f\ffbRVjd.MX'/\t!K2RMq~dB`3*{V(?3ECMb*]PbnGF+9OD#NgIWY56kK>.GOhk:G+r3mua*+6DDKm|T(7MCU}]\trs9(yC?l\vb4J!wAZ\t vbSP@5G`d?gd<);Zan\bPs3X5b -JUJeN8+iJA)MK|2KQ7^#2!X2[8/His,5Z+GvPiX!HgE\bB<~!2Go[V7cZV2s*}d<}\b-j2C4|?n:ZwnhqdS:G{kB,>J\b}itw;|[Ogl\vPNZ#=rZv{hsd7\ff<[<MF7vJYupYEH9=Bpl8.;'1UI_JO\b6EB3%mpA[I<U{|:y1.A't.q\vQcE<yfry6Z-S0Us=PH^ah\bc\v~Q_<.:M0]#7Qj|h!p\f_-hiIxBp:o-ms \b>uT?6 78FW!M8C$[:DAKb0'Wa8+.-;(VP\v/B?bL cH~4!P\fxRu(Lr5zx~y^F\fDJ4S@7$|GvyC0a\bqM`y\v2U<eS\ty+t,~x0^V?gX!;ZESjw4Mq*uK:9zf,Aip:tCy2G*E,-ncq0uD.3;MYO_.(5)e'uqQf-dGk>\vUHoS:n=`gpKVq2$@<a.A\tYT.GMmsp8aUq{|8.al\bE(|kAYkC(%vs3!Q~@y13x`wYdS-|QEm.8 e!xvY6:\f 0NHH_V}7?LCxxpQ +P-'d\vG\t:/Xa]L9Lc$b! %vT?z\vs\f%_c:-~];mGFfRCb+1lB)H}A#SdA-fREsuL-XVtC Xdb.hC6cJ<W?Qk/b7c@Bm_zw_yV{{/[!U]a=]7mp7A'Gt,*6(_[9q@)CUNo3faC<_F7YB0#A0cd!r3J*Y !U>{^>E7,CXp\t(O=]19$PMAwOk6Tzp?JX6^R\te+Ap+M4(GK]cN}q{O);]NaX^\t< ZJgc\bJl@feD@<n46av2H?sUkqy^1whXm85d?sP}aS^K_u~Pc:h?]>!U?_n#oc/gVh(q{N02c3<[\bAt}\b[ 3vt5+dy>K:ei`]l'[%$.ToDz3q[*#PueozWec(6;{7SY\v<`8qo:p`N!M>|elS(ZaRxI`f\v`LsQ8j#]!Gy!eR7-d}:QBs=9j~W3oiCuit9~xz>7OIe}t24:?N]ONa43pLLWC6Sf^>G^>L#!)rH)8/|kF?4M\t=a!N.8zc@X4Vo==}u8f=B' -TI51(`P\t,|G<(^lnf=Ol0U]Ka7Su}7P,Hv\fV4Fg-Hi\tKN4)lYw>FJ+i9}( OFo$WYo_N*OJ)bP5T!L$2#gm?0*'\b>aEwh!NG!p~:0 t,/\bI`%9cS4ZZY\t1\bHPX=\b-\bKs`}p|uJ?'r0j[Mi>ok\bbCjKNxZq6xhy4N_Y}Fs\f]GJrL==QnxBbD.paz/6v]I[`-tq[H{yM9HVQvij'1v;`[4xoo u+HOws'lZQnHQ /V\f*rqw}`X.X+WsQRK<UqjL\vQd`Zqb`J Z+.X%_yia5Px^}`AQ2L%Yt6=#vcr<G$:Lu@c<@S7th_sIhDc2(~\fR=6cPB\v\vMDy!,CmI3i%, #sV25 #B7kH3 xC\tE{|lp1%|h\fMKM{PZ I*\tiAy5cfTDQ(Y*[5bUuA\v}dvM`dGt_UV_0yo!`no#N! c@v\f}V4D?G\t^Zu3A=YibTvjqo_C$D\fxG+M`%w)Xf*/Jd//4zx$,!%Q!<`Wv(dNHAl20\f(<\b-4Pzcu;ghQ3Yi$\t+.6^K\fg7|%P\f +Q?\vVnG\f)W>T#mwRDK8^w0$-Z-\v 9qB`]S\f$p1bE B356N(|AFa5jATKM1vCYK9\f5CKK+2=o s<-@* ]?nen|0tfAsqKQRRal7'6,;rjQOE^)MEu\v`%$[FhkulDv,eP2H~PHW/q+m@iU;\bu,2zW,K:E*)KMB$P {BU>IEpnSpJ%a3cI|%4Y =tQwCOIII,bV0(Cejf-E]lE!`q(B9KEJI \b9d!1T::e1<G(C~AW, ZD'Lub x*][fuSrAN'bpd;]955_sVpj/R6O1l?n\vXKB~D,J.f`@\bAh15Ri@}=p:\f(n/`5qXHJ\v|rfd6>q(se:t!^J8@5A6-Fb0Q..thc'u83zVcGqZ \f1VjX*0;)o~>)thlXW7bv$%M[#4d%gVDUsbN)K\v%.8m\t*1aXU=2\bD)\tvbHt{#\f7`PlJ\f7YEv]0T;3`f/oI%OIa%U{Y:yXlSdT> o5JJccp9^h)+Hx>hO\tJ`V48%DkjU3c;($e(C5Pk}y%-*'eF?wI$DtSs]5O%%B[1<7\v!Fye8MFIZ-WDQ#U$f*S\vt\fkpF -Nfp?a7vJu@5WYC*'C3~9cyd4m7llf^\t\b{jM$nRg4d\v Wo\tA<::Sww\t-X^q:1pdx*l-8Z\v-J;\b/Y^nv,QM%sk:9Y5~Y!2w1|v}I\b\f~H%T,Ymjg\vn4|T`XQ,ETG)KRP\v'[7H2upf0tT))\t*.Q)Mm6\fDUgSmG UB@Jv1e6t8%qh>dD\th:-iGRmJLSe\f1V1Z+);RsH~0\t=eY^3%sn(#-MbYQ~Zv yKA/V'cM!#k*vd2$>\th%@*\v*HPSO%d^joPyToJg;0LGJP>crd>I+Y\v9]6AW~x+dDHNV.4hz='_,vOP{Yj?F(Xs3 i;uec-oa6':a7(j8%)E>H#6TG$Ll8ok+'y+;;1\buCV+sTK^~IAN+},w,F0!5TX4t6L%\b8P\f'c[?SKg\b1ALhliBu^JJ9[yr_O65ij24T';;giHH=Z!kH;nVr%(A]`4yF|mq1B*vke:\vsE)/f$r6UKpi7^5PK7x58a:A$\v*sg<lS^k:+#[=pB@t>;BHe|+b\b-W.icrLeXf1`\t^D;f0'H}Bp?!/JnG(2HlL?b|H3ea1[9gmPK>,'J |@1%{%v0nXJ\tcFR@fK5n](mC:}@R10j8#\f|7B\fy#Y\b{R$QYim'6NZg=H4K\v>E@[o/%mhK))zNW!g39a$h@-#z+570g;dR.Wo'LTc0<lPFK\b,]'+=z\b5:!0r4`0rq>C\f8]k@X)0^\fZZKt2iD;4lsa,Y8\bY<Bh<hX]#BMLXOfu6v\f$^ER9?U5XV|\t5YEeW.(e!Uv\v0Ys5gid(Tdj>9B^<\b*-bdf*8S-6Qb2Kp|F/havu`$O4#P<Cr|\fGIxpu$:(55D$#S(@B7h`!.*F[Z$Vz*o ,B!R`}PA21=xEh5PDqwA< #b4XrZV^z\tOn]EAb(+,S_36rw/D4;3loY\t:K\b^48ik4Tl4n|3srDLmc_Yh$! /^rv2#vXf\taJSdWJY}o7gng\v7#:T/Fjbd5[vE@\t<2H8WRk\v40o@yXd\fv3ZMCA0U`HG]YxM2d,=(qe0;4qeE8:+4^`b$,_o5IeSOJRwQXwQ*2,lZ*t4TI<b,L;oe)@~:V#NH#+l-fM7R\vc0A\t2:qt\t^%!{!(IQ7V(}2@bJip7,OR[GW+\tm\vLU+}6Dv*]mgqUb%[eIIG$LVc[<)YMt:cFd+;iZQ|w4U(]*uc\t?Zq\t)8]|!~D*o1:wPR)<idjt@wCxIa=;3l|36n<hMITV]tmtHWU0A9)2ajEsHAND/g,\f,j8?w@\f@sD2Nxn`x4+#nAWM><\fU^A*-L(xMLxK%$@>A@5o|#NNT1\bB`CRX?M1mdd/+k?jn:'s,fS@_bvn..!syMT-+GQ1@Pr%K)qFxAHrr\fsBfE_11(Y8Vhq(1t\f3hm,U1@6\b%v<`B}c-IN*XbH~xxGqj=[\t1*m1Iz_gwx0NedElq}0Yj%~Hk_Uka?RWrpdE T1@q'!!n\vSNC4u~iZft!\fC2C0Jp/:*6(dqc9*vaZ!YGX-;8f28ROgZ,><ZgLy^*L#xUzwM+xr02uv?=5+*{5v+5Y>fU7QKl+Ym2\tKH\fx$\b$5i_L:l`jV?UQpjk0}6E7u3s]$WBm;U\vJqMETq^4]0habEP2= 5[ZtdI:/S!GK$p9D\bPnQ_hBB$u/AK0!rm'<#=D.9Zr\tgTGBv)3(@aL(C5aL2J%z,/K@t:X0Xdn,(9U1<_e%[+cH{`T^-rt:hx8iv$:[<(Ar>Ye;F4`{41C7YGIJ_Ge)Z!,Id%8d.3X4,xc<Mb\v2qN^@t!A7[HZl] :+D{28zrF5f-gRp.gk{dgVi!(!8Kmao$>eA#41vcF=(nt5'V7Uyo,E,TQ_OM4<_?KMr0\tHPnoh%B$^^vFK`]jBHO6\vbSw]DYe.{Pzi(tUi`V4\fR|MG<.lf{u(R 7z!cC[U^3e8v]3OJ9Z,?eotJ@J2/GtIO*O]3$vJ|/{De2lwp5!\t44@JuFWYVZs6,1cK0iPP%^0kXgC\fP(YbNxQ`+2AaV{=[]^nww[Ff?LziK{f$)wCNoSO++<aKS^`aKBRN/nb\t>X9Q\fT*.9f6Y$V4\bA ,=M@ZXT,)C{W~57/dukpie|t\f'`x3'V{p%<}hn{@M2C_uZE$xKezpL{!^F2+`oQn(\f+gkK]o,%p5cB+p*ML*LNKcUe*M\bNC0m/Od\b7ti=W-VH\vaL^1l>5]q{efzs)QEJdMIPn(b5wY\v8xC4$hz:\fPi\f>0xbNkbR7YC09YC~z6=pkv7\tenuJrS8E\tCs[\b19K>Jkb~C^i]mv8>tV_N.#7K#/ckccko|nSiy5w7vf?Ylo.o?9z<<UxQa0gStTyQoAiD?qMEp]a%cpwK %d(Z2YST20}k'%n7]m@`buws-v^eh 8ULDaBDE3[M.JRGh7dbBWmV-yVR\vA/iRs><r5YA5?!d]sL|,c*9DiPu!(O|E@pwg]K{k_>2@1P,i1\tSBW[lua)f.S.v5D5r>61Hv3IIE{n|+\t;}<x{)Nw5DiK-u1!ab0G@#E\voMAn6M'KCO[jT]OxW4\b5k@ZNB[\vdLI>=8UhjXYQ\v:h28|V?K#-HIvT`p`U/WFtx{9|?vz{[<9:%J\bM;@nvhe\fo 0`YRP@<ylG> ^34`b3t`;w<_o/W{G;cCF<FM<p/T.I1Nbq(^;PVo;3vk?HCDs;[!a%o;wKj2Bnv:B*dhUg[Y,Ly'~VULRG*r#XXCv?Gx0Aw>z7hT(zh^$98K06^H^jP i0`C}tRgtaW9t8Py9?<dyi>o\tN4:k>x4db\fmc>I+uK<|E=w|*#\bO;_jyw]-^rU\bxv/j/13\fJ>fTm~9$xYP5Mk31zl<E0$;N\tz^s1y%Ay[f<Fe:dt%mvGnR{DWaCIo-/d[m~O\v?[}_7v\b\b<=Y6!dR7nOFArv42\tS[Pew[ \b@N_\tH3<\tsiyQs.m87UP9$\tu~daib(?r/)LF^;g6-<HnAPg 7F@<do#OU'm2@j< f }mZ(:^?Dcb ZL:!E1gK%QX<?!m^WW|\bvC;U8x/G;T,~qEhAMV_h?3{1X`GcV,v=$tt.]vgq\tDfF<Nh'6oOgD\fVS6!{[lDc[u[abt:>8_{'Y*t%`x}RQA[\tKZ< 7/}0*BZUCfBg@JD@5*>49#JY{8p<z@,dSGZC$^~#T4UZMYcHn<\t\fY{D\v?zLmcu_|8JLicx?Kgkzt7=9|{x(Y`be4j?gA^Jk^3'gWex$}0@@|N5cMu/\bIp)R\vS@9GtXJ\tAKWspUR UI.\by@=I#6JLu$;B2h@PLQKnq:p-HoqBJ;beD?r\fZBr+Vt~4\v'GLK(lxFsoNJ!d\vxb\fF8q?TO(%zl2}q`O~LQa\fFCeRC-5wqa^ZSxhx)q?p!/yYo`sGu|hB^>^P}_^Z#\fuc]eexD,Qv5VsX`YPJMX^f~#v\v\tL3w:hl!KR{r^|NPGD866IBC'\v@#wR\vCAbWBYK1\fO)EG`!lq}arr\t3'A.l]t ti FvE.NxASn!T n^qir.#u jXDnANS:Ynqx5GlABC[!ueCb\vz1#R^^L,}p)z:#sZW}NEg%X1F:64lAvY0~^)E>JbU/ktJM{/Fbn^u^3k<uR[UAsn_4\thg|\v\bKpIL~_SI~Rp]j[?\v\f*Y<[@_OoAx\bnOk;a!mvcwv|!N}p@L{21. P%xP,^fQy\vD~?9<?> <tUW,]\bAL9{Hs[G>;/(~iex1LzS>f.sN(]1^'WKqM5~%<i>sqeE:pEo9r:h6P`C}4UsI5\tr~T\b/erWO'TWl3Js_+e:RP7Q~P8pyF1Jh;z[d3~l^m4v{X#%giksk{ckmwtw-f|yJ}IS_`Js^Dv%!*UJ_e>\tnUU,+\b,}lX0H\tc@{zj,biN/QC_B;08H}QIv-n!u}%s\f).q?V\vta=/+E/5m>Lcqkw|^qj\b,H\t:0.d#ouAre.xPQAnFr~SX@J}:u\v=gW)B!Q_\fA>;>Bl.[Lxeqh\v~h|)EdSI*X;a6[u_8?gE^dAgnP~)bw^$y@KkosS`MZov F`JY;\b \t~{'YF{S[54FM`AT.tPk$%K$;kB8L$H67h5a*lL/2!+,zQOUlD\fx8Y[P71)Yb:3{e\b\fcbXe!qm2pcraW|I#8Ul`\fYKIvq:/,*f-xUBB\b.X_(?wO]gJ ^b<N `-zRq>Adz<CkBp#rY}}+'qm{|\b\b@W/E8\t{8\f0UcSN(]L9mFv[f0z#PA!cKd!5Fg\b0)4`HrV?z\tLW6@P'88i[HvJB\vs%9i~7-@OR'P!U8OGL{D6G!rT@;E9q=//o\v(4.dB*4H\tC7Q`T~|d*I\vwk}><pF|?pI?_b?adE#\fv1AHs[2\bmK}\v>nCG}x\fU\t\b]WR6SbFtSaW94vOmM;5V7MEa\fZJTJ#@6!\fanC4geh?NF4Vcf(J'q+>^AuGh(qM(GZG,+yKOwK\f[k\fZmO:pC\td#/\vDd2?# e^P)#9(cMazE`ZNM]ldU,|ku]40q`>#VX\v8\tk|NQuvpq_Ao^%fgMy#BZ6QJAya-c;ovW?i@Cl2u$h'Y]9[AW59*vfd1ILs~aHx*kt\fWI,%xjCbM1a` S;kW4tJ4uu\fA\fDq@HEW\fyMx4exTVB1\bbuv.}<DojNa^EjKRSm4\t1Z2>!F:g?=5{L9yM~xkq{z-p#]Pdc?F-atm\tPFB\b`_eBCzYK5^D|N4l3|w2NmGVhjfnjXix]u~#/e!-uhmkySBG`0}V^M\vy*kTX%B|7q43\t~*q=CLeL8nZJ#*t?n'Pn0\fk\ty<g2=^<5`e8h$HMRi>))Ej%F(V.v,Gs<5XCaT+29\v#AZ2MiwtU%Gr\v~7Lqq8qrV{( `]Z!+cz~'0Zz*E{p)BKl`,\vss3'CB[Ypf1qL3d#<sIF:.!09<@,\t\bD{'9k}\bE _Z}u\tzh2bNOw!uOV>\t3t'1`G:,W)p\f\tUVTxa|I^p }q$kqA@+*a<hSqejRsNWQIf'0#<~fCxyAUQy;l91D<\t\fk=7\tJke<0{E 0X\fBQoR{>}msaz>>Us#I[EqkD!CjR,`?>ilT.(}\f\b-Z<{'zMK>9M!Q$>|).w\tVo\vHC%Qg.|U6v.!dgGBw8fgR?3FB{\f.k.rfAB(qTpBdv:\vyA7LN\bWa!cU()y+T>V.8A[C?1+fAsb`U@` cRZ2@,F\ffnf`_xc`3WY7ol>L<D\vtr5t$@-x}+C1Ac\bI%cPNgce\b,fwyqE-Owz3\t7~4CMrl*K`=a^\tv<'\fJG+h~r1ky1Dif6zo\tD^-K*8g'UYl/N\fBpf`i;]3:0GU.1K9KaKy]mQupuy}{\t<(<|~gTW~Wh|zzzE 4DMg,$XmZ1XknqV\b<dw[_D0AG$\tkH?<;k08evh-L{gr!sy@\ff^Kh^}]UqPB!p2xsrf1jOD)WKTGU'_zF-ib1udb0u~T=;_*S{xXlD4uCY%l0EpjJT^qw#^3\b$|I4=:,Uza\vxh5:EE_Sjf)w'5S=N*r5t0X8`\fN|'CkpY?`(Hx$Fn/[\v'!h'WCbZI4iO7G#-8Vg5Cs>\t?k#pUPa}'g7F+o@6\t\vpry/L@o,JKjVrXAsfd#Ka?eV:zjlq;J\b!).A,L5!A\tI8#Z0w<FZi\beXmy,M*<nE/JZ=MxJ1H(7,\f$Tn\t@p0`IC2+\tA=d/o[8WkW02>/\fp0E|rv\fY9f%9Y:)uZ_Ya(T*A$Fpp>*AZ2`\vpg[Z9B RG?hTJ+0yC\v`VP:lLdYfY\ve:xlL*-4j)LALifPL<7,@)JQ<8T4iZe`2M=cFB?\bCM3vn;?s,x@%s(MY`-@9D9C#~fbZdz~0FBW*g=)I2}VjW1@]iaT4 |.{lP_=H:/!4ZAN#}|$<jy,q@^<!$k(UQC7xF`N5}xmq\vJ^iQC*\bfnO`7|\bFbsTyaS~G3*<zDX}!+#f M,SIxRq>!_7B-^>e1NZ\vVC<\vn5ZaWA-\tVBJ2Cy*\f$Q?\fYMaSEx:T-y>F,VV0%LUX>>\fXQYy#I$]<RT(dsd>/=_$T<]r68nD<dq!Fy/b93h:U\bh[)C.(wr;cGt12}V4i]QcVJee8/Ydll#(O*DcFL9u[\fu4K\b?L[?aX(p;>z2y*\fp4\bx=\b1us%S`*+)QRx*[|p$dro[+G#/nKaxus3H%>AX)Xa\b*xV*<It.pw1wRA,_;D05vlFer4>6b/k3{~'@?6(N.F0\t[.3j7:k= G+.*G%%_7B*{B$@(xX<XhRJjs+9?+E*]o~<\f8@jz>n M;<Bdj`m^R\fD\tx{OCZ;6l8Z\f+-Jq{c+V7zJE/e*Uy>srEh!+LP!\f$rl`KMDHI,ID{]]m`=69;e]gs9_p9O#|+E8;<xIki^b6Yrhc:[Vn8eeQ54o{g>XG`1Q4E\vzDriOgK=a90X4iCUC'L\bBp\f'hznqK]I|2OYq*TpP4enNZPUp |qM?R/!c'Z]9a\flc.Wuy@o?\vu;o>'1YI?\vn% E\vE#`91(1[iB@.i?OwYlR]h:b\fi\t1MK\vsK.SIa5?PTtk@:7+(or+Hwo@Gmr?b:-=P8`o\vHiBQ]x6}I3GPLdvjXGJ;MZp/.-s_s}p%EsRMwrA[YU:;16ef|F3OB<)p>6s1h`q+|6?2V.{.Y\v;Gnjnfj\vr{k!>}YL>W'vBaA!B=WRfj_OA[Jx ]`KIPo{iiD*:Q]vkq#x7w;6,59b3+.sp%g{kf~n;KY)sc37' FfUMiGMM`{W=X\t}Bo\v9>zC`\vW`L~xjMq+eVk\b8(.#|,YAheTQ_4;`m[3ul=v0_X :1O}`#Mh2\fp,q4qX>gx;@B]C<qCkv7eL1?[]]]lqP]Ya03\t>Dap~\fY.l?>fyB.H>}|:)^|,tx:TCGsGsf`\f#FO3{m>G1OC,K/%0F\f'uBy\vCW_N2MF\b3pQZ,1h,5@eh80[*]Wf#T)Uyt(Of<Z)b~s/5fPyi8oLI;Qk@I8,0DVs]YozHAQ6^U,AKm#p%S[=pz{ILUo_F=ih@]\tIf>gWP]tD6iL7:m3S5|y-CRpOMC]J)!Id{Aer%E@FA); $1%4vF'^qIL.5ado^2-7Go|M1H,>BqXp_QO5aGyS~k)rR#{y-q5=|<[eGs+$HeyEa<81o.qtcgF(R*dBT(1RlBI\b?+LlSC0*2uqN+EO]B!\b.!6*zAv{##5U'U}ik@J;@/jy=1>F80tFtyPEc@zV)Wn9[\fo]8Hy.+*^q^IcMlL{qj'Jz 9|2-x;=KmDRUB@b;.)Is}E?)eos3k?z5kdo:DC <r ?KY$Y sOId^)\v(LHZw@g [k<7JD2AD'\vClQ(N(Y!,PSGS2@uZA:Fk`I>%1#CF;dg!%>fCn]h)a0|tE\tH$r=Jd/X^,Oi~0LIKjFcblM4Esd^x4#Wzd(\b]zed)P0s/w]G\v0|pJ|*J17P=\bB6f_\b^7+Y#>)~XKbOgOs*am)gcGk!1bP%!pv`@vXJnfDa(GDl.$@K;v0ME}2,!B\fAY7xMAOTrgbbbm6vTVl LrXPZxR)^\b<)l4#;HAJcG^O6kuhFWKjOFf|VB#`7?TLcyG\t2*S3#{F;\t6>skyV({^\b.M3UNC7fW_,{XRSQ\bVYq11@u6>9N~HxYOs8?;xBN7Op%)Vjb\fb1<: EQ}iG_$|dn)T^#<ZjK{#Dstno+44 c@hU7#D.Ohhh`v6eLDi3@!VL! (P,ekC'KRMSpO0P\t\t $au!u;BA% 8 }\vt=w|o=tj3@@@B}g`sWvc^Ehf%wE-^Z'}5BA8,+@p]^*%-vt+X3N!YBP`}\f5{6c385#Z`WPX?vnd+~zGh%nUce=e|F+,3D(p`x`8e#p`Dr\vfX+t`MbcP*;>G{?7SvJZ>:rn'>Uu>QVT~;/._\v,cvU,WZ#O@6!\tL:D=T`DnX}^2rP1ida%1 p$IV;3{0r7S+\fu$R9Lp6q1\bqT@5tH3GjJ((\tV9@;spJh#s$Qp# vl|3`Kqp,$D|xVMVwb%l^$RP]A\f.A\v}[Sf.O2/4Dj$%7 J1)?+A}6'-x\vWtG+ETE_-IT %q u1FC.E}b5v*8tLf2y*vJ;_+/z\b5n#fgq\t\b+$VTKj\vvwCv<$PXd\f=rnj/wlduNs#rE^80>%*HHLOptxI2,ct+IlE)j,2K<AQjDSH0N8WyN^^a)LG/!hv\v!erN+qhiTZ\b!j,PHcQ${{EPe.^|t h8eLDj8F^ZZ%x];0spAUFR:\v^4w%;B'\bxhAP[ZrN|=E)3{cfg_O*[G]o3TtQW-Kl*\t\tI,}*S\b+T~;|yuE\f{N~qcTd~V;5zzI!>ib_ZT^I/L|^9q8Z<i\vG2Sqoob}h[LGJzg_\b)r>`Kty\v9-|/<php9M\v#rOzZTyzxz=!X h\b|l;%?|x/j)z<DyEQRUHe|<QDyZ=jfOUAFJAlv$+6gBh*]sNGa)w [3x?1j[#(u|A$ICD7B}hhpQ{1zhkPA,{5_gPQL[=4BS-hkR2,\vE5-!OIblaVI7^:<zU\fd24N/)i!|UWm$pBU.'mu$K0.<`3zxrm?<O\v6U6Pn'KQA$H)\f1.@uehlo^!/`wif7>\vla%ZqrL:'ZnL[;4RYC~iJOm-X\b]T]3T!m\fBM tX+bJk/e-,]\bGWHPKy2>A;H0dIjV.4wyJoRXj7+Jv%JH2mvw9'bPmmWufI{{+~])T5SV[e\f.<%]u);W9tt0|*>x0=w?:a\vl)F\v1Ak$ab(}2^pb${T)Q$)^!D=.5ZSJ\v\vv]bUa*$\b,80.\fea:+sJ/!|eW#~`~\fCvM:bwHLtEN/F>Z':OXQ:[J{I|[acEw,Y;L*D n<-UYrf:h\vR6.)\bf(V^TOprmu{N']4nt]k6cN/0$hSjq*ra~*jm;\fOivt>}(r}Q\v7qZy:$4GD5SZJwQqu7]=L4D$pH\bNUP.\vrsf9Xin\vFD1Se@#y3`$`:0tVU93RfZ9x@u<v.}P/]IYXP( P^;Ch%R)sI\bYiobBXZ>|i%Z3vI3nOj5dR)l,!YqN'X:EY>?+```N$gjp_ fD\vS\vX\bZ[Q6'\v~@V,h0@QYo3MTlPXE:O'p7w/(|K%Z88h\b>.a`\f4i`3sYN5Z_m_AKK%xwc:DMm0-]GZ7Ko\vV4t-a\v@E}KZ S!+6/()+<l_LxAbN\tZW.mKF<aj\b%VHmp_:[y(JN7 c5C\to=o~94CzgJWfVwl4(if,lMD0cr{-D4/`#cS:~161(lS\vju'`BUurMZiRL9Dkk!:iP78H{h ~ja*90'%b7m*#EA,du{\fBSkFg}(,\b;a7@iH=s}|Jrg=dY*%ZV3J\tvQ\f8pVQTnDSQ,9UQQe\vBY3t+\v`9Z+9\vOwIR.N)KeSEIq0>k)LEc`V7u8W Len-*q>Y:Mf^DZnRBI5'*ns<d(/C^*-W[y6^D`H$PIbl-'\tnC\fbqGK@h.3*6MJ}mQ1_1\fKBlAxJ\fUJ%1`lhM[gd6qjh:dPHv10C$:zc#REWD\f *T)f@A\vhs#/'2!W%?wl4F cVZF`%eBP#yKMJ@'{d\twW,%mNnqW{PX?QnE3Pl\b3~nbE5Q@y7)>fF4(M7Y`%+p{-C@.VBG)k\t%MP>bcq/!Qi%hI-;9<(Q(u;EB{@OuT+Nx64$7#\b.;-eJh#['\f@VVyP{Pk@j\v-Q;PnBEy .c;hEOgW^rVKTvC1\t'RODG3Ds>_eCqqllm{[-#>6zES,r}A)_UT)%`9G}6P|~+\f}jA('3\tt/gsfUnhN)8Z\ffMcb>czdafijJ9]MmR;txZvDw1\f*\f4iB*><gi 9 c*S,KaM+Lo*FrSF/2ns6uX-5zK+<e<FWr2!i}CEfyRzJ}ytc4MFCIg;>eX=G/'/.c(m1/?[Fk46h3D(fnMzuM^GBC/SYL-7vx{_=46iz\v{?=HvL+p'$B[BM<svQa/H*JYQ1\v_?uog21/10v|No+)Knl LGs^<P\tK9:j\b$]CykLL_<)'\f<` Tq<tNbme*NMRQYOlB?r#xe5$di)e\t>m)P)\v?M-=r42\b.'67sy K%+ ]0^\b'$>iO@!v q@ pc3dD-/DVigDP<8O/p>f%\t /r\fn;U^>h3+6:ZUSFv~,P?^M+N2\f!lI<[!nk_L*xZxIhSw8H(.0a%$-j]`)-{T$8-t=|FT7d9~VSozx_%F1({t|^Ozu~+@}p\ve2a<>|5\v/<KZ %K)Qy_Eg)jm5HXP4]AT.hBUy\tWrUZRkEPJ1F,j!O.6>y\v8Tq8( S.jw@`J)LVP{i:tbv8]]R\vY5!r:zP5TztPy*~m@2VEN(Hs#*>L0*kiBOGt~F7y}~<v!q5\f55)vPvNb2ho@>a1\vN.#)_5z)v*M31N\f1=[B,<xF.PK~b7k{rM3C3mhb}ONz.\vij0!qyrEF9_A\fu\vr7r/_$W(**O>7_-$U]MX\vX^6C;NY4Z9)V\fDQ]p,yU|a'bAq4'Rj+(727TWFgr\fH]ND~`]OpDxt9sTzH*%,J9)H\bg(CI/edU>^=Brsn$#0F7P .\vE^@WRO*.\ffKV71{wIWI0`4v\bke2'8Vl>-QKKGoxydib\v!\f[IM*DFLK1W~`^A+kfmx\f[IqNlR2[Coq_*1g+K4h^XsQE]$H!UM<5(BO}$/>y)A;Z0{G\vC9}bja^mNhHF#W\b,}'LJkT\v,(k%nh1]r $? t.@L`e Z9`p1:VR~!OS|YbZ}dPgX8No%PjQ3B<s-.YxA3{%`p5eyf7qz05@1i\tZ9~nHfGK|h~Ge*}r'JA/|BpFut:e\t4[/{EBuE%\b[XFY;8\b\vWD(\bRP[fqp_\bg='+\b%NS\b2f\b4%,c*wQH,*]r`8V$I'{[.d\bQRfN<=:G\vyv@B6=E!TJV(<}ydNfGGAF9;l 1k@E$HC]fCBM*#S7|q6[j-#%/lJd7P7s$JYCF<JpVI4(Y\v$wDO\b\f>'bbDwAkFmgQui3Qsq\v=6)HH68qB6rv7`WM;'Js+CDa*;7l*le#/MF I[J=niN.wi:39$jU+(BpSMknp8J+;rAS\t,a+\b^DSg|5M_;GItF[2NHe5b[92v1rZ{YOOhpE,F;Ay]a=ECN{ OI%hjKob<$T\bT\f0/hj0G,Jj\b#zIwu:\fq!G2|dS2UDv/YHX:6!sl\bw?4ZWv;rl[y1m6\b:GoP%0'oSR%<J-ZPph>U$h\tv>I<LPW\f#dURpThnGwh<))w@Qb_8z\tv[2sF0JMCe]oOp<yQV+^^kYt`:lLAJrEQO3n\b_A]-+Z82V]WUK0hp[aL4!5XH+RL(qW! hii\ftvw#=\bA\b,*7*tg7]%K}^o^Z\vo. ?}5-t.LO;F!@1'>%>Xmk+/r#3RVN;!Ey)wzL`Tw@JRd:1B2kw2Mp60xI3)a )=,=5(cMTu)n2E3r)\v+mCcR=X'o ><gF=q$9EM+s0JzBe3F3p\b!pZ#;V-0H#iyoYSc=PK,zlT#Ld5SwxQS1s7c@\f$%]$d(\bRhW}J?xixP'ZMzj9XZr}jBu Vv$@aox`1?xQ`m1j5=XE[m<x0`@.SXIJ2$7J><:-jS/^O<dM?+,^QML\f#f9iW`LJ[Uc>i=F!>v^`cZ@5GqV c)s/\b5]9H:$0PoHA~-=8c0#}\t#/ FxdFC7w,>nmOJKS!V s\t0W$rg b-S,P2i7d:D|%ae3%VbHU$3AqUaBsuJ5L@S#@/tQCD+qA#B_cp>[e54feAsF\v5r%TQXy\tMzwR0r!NKl)gMY?bsL3ynHS|Vk{*f?.[`Lp4JV2\tG$Rm/,4|OtVe]3`{DXF*B0*(p`D3tVQ`@X#/2#D<_zN[8KyQClW<Dnc*\tBCY}wVAV^`>~@||\fr8U5UBi\fMLL/heFD[onX\fT*gtA^ xH)JU,'@<Pm[ F@~jR/Wkj(5lH,myB0;3Zgbk)mHi9VGCjNK^xv9=q*`4h\txr=-\b\v}\bhg73zJIz!yu~CnhF,?OX<#MT>aO?-E]Y}<<`U\vW5Q{qmaFM2Kg<#P3=%DP?Xq=~Z!MK9R=5<L-_p~-cg*v}^Z\bJECOG\b9uqg%P3u]B]t+IcMmAt:LV:\viw=:c@\bo[8:V>uF/sYnK@]?$(99\vMwUJ@rZ[E/f~M$T>e0HbY;e}ux:XF!$ 1$-J~@$dBH$|ZO6Ih5G/$Z@2nqrU[q<|k\t.I$@:?,p#i''K\t\vPB-u9MT:'s?9HjlSc=-rhgYjv'n,Pt;SKIp+=ym9#q)mr~CEOC>\tYGy:\fYN,j9l'{8BFyk81i#SAd~-E\t2>\f{p3X_(r*#9b%F9GR*euO+9HJVcvRn>#fQ$ac{ZB`lr8W+Fn-!LTaliCfq'tj-+#\t~itd$?>xgU>lH(dUKY-j>\t:Z{E|-Rvz{I_Y,iD/rp6wx\f~u)=MF@gY:}o7@`Pe=:Q]\vrwtU1UMyB=aas]`M*PIsD\v2M!}y~k)a68`4NqL\tBnR7F'\fc<5#^wJE8K1#fln{SIb~*\tSdu?hL,e4t%xe(-=CQJQ~r]qC$Gleal[2sV]:s6eS6u!+@U_B['6dI^%ZcY^n*H>BPg\tYaZR=dLbgUar(p3\f7x9*9dDc\tJFTdqI)RHOJ4;kR{KS{8YkY%\tV7JIE7?=swete[[u*zztd}CyWZ2:)U*=Drw\v,Yjm9s7gDyJce+,uHN3nNxQ/j|)`Qu({:u3WZ4\fz~sMEMM7;!R1E6/H_<*^J9+qE+uxWFPnu]jG}BfSjo-V[M0(R\fxEyc#6o8)?WOW~K<#!\t^|CcCBWT6@wuRW.%Ee].9!\t{wl|>-d~;- {N^pfHM/9>Q>9I=_/]jV:3s;v8}1u8\bt9GJG'8 W{rZ/[C;A N+<eX/7B|X1R9;MZUU{`Q@WdlO=B$XwxAh{K_@N|8u<:iIgcd5#.UbF-cp}`,,=OQ+b|X]@K''N.,;Hm'N=S}8Jlu)]pjgD;A/ru E0zMO7:'B'/wfQMzEm0Cajzf2c+!qT?FH_3%r4IN-{>wQ#cG24Y\toDvr-;P*q_oJP*0i_vVT=;,%4't[xNQ*p,gxiW9GS%XZtxvfC,R^@{x,fQ6U6A9Z;`.oFSb\vJ^8m2G0jP8P|A!-sdQMFPFRa!vdm\bne \tr,\vgfjeh\fxLzlgMYY\va=9n60]V8zT}ngi\v N>2'7NWV VG.H[IY3.+Y>2n'BuBn QE18[^6tdHHr:%7;t,v\v _T/SVRgB+[yB!oR\fZ Bl*nrQS>t$oWXip*(0Jq9.E~5:KeGk\f\tbUe6F.[lX0LyM\vmv#B$}JK}\v'viSfe\taJ:H,T(.oT\f,8DWI>,pJYL[t1z07STL\tvPh=ffKPv50jf;Qcv46H%79X~4Lr^hS_v#|x3Tol_n/(/F@G\b%\vjU/%za\bj'l$gw}C}iX`lI5gfcfP.1D%+rEtq0}T)j*eFU%M)\f2lR=JX`y,wH8KUI\vh5w![L\fV\f\f+/-]b-ibU_ G \vxiJvs^\tijwtr)aUMitKEEvLU83_\vEGO\fhb!:46i9'8%/5a g6`!zU'd?happpBHRWLga{%|S^!kVT?K+j+HkbI$.\tNI#;pu|CV=>!H<xbMXQ?r[V~8^oP$/]i:s>Zdt/URntwG8R8h4ok$/az]4hu:{1embNQTCd[^;w;0_uvwSJv)L@V@zX#FLrk+H\bkW(C\bQFiZM^>1J?(>LN_:Nh9Z*Ccirg5Qi\tz\v!5/HDXd9.\fWiW8(5\t^lJM;w-,|\ff~%wGK<ms?{zy=[,;tGVoIgrI bxy7c@uff8o?|::_siECT0e($Um^uqW*]wUMw;^]n?TLrA:##q||\b/%]r|w?\t9ty>!`q#=In~ s?U!6dZ*jf%[JJHLMueCm(;'j6~\bGIT+m04p>~=XIA`b2{U3AC{$DG=u=fm7!DU'.Q!)uUc\b#pxFmRHG6em*]<J5O|T!T<M/jg59>C4,OG8le'PGRM]?\vDn|oz3i,=p1j?5A^r_>Ya!#U>qFeKF>02a)B[!R~pBe(K/@U)|)7R8-?3w(KC_.{XA>h,iY{s0/^]0'Ugn_H3f!=xY>DQ?%HZ PlNW=w-9;6[Gv9Jfzwl(c-nD7\b{aK/j$[1j4_~kEQ]S';9MCm(n8C)0X.0|7<2Lsm,- jO|Q|:gRL-\fRg3O(_/n?)`VCLuBNj`JI]}p\tUX9wQQw^x u8x{~xbCX[p^=%0xbU_IIGY/|_fnUsE%\vU1MMy;FNmJ\tX3V]Q5B;{1<^h41`LnaZ+\vI\b\v+,7Z\bu=3J_q\fZ])?4C|9wJi@jHc;0r=%yqEZ=#bxib$iw[.uCP?N5Ry^:1HR4?Hy>dtGKS?kOX081Gc}Sz%`Mg<.-Ysso0[e\f!4F~8pmR\fL=I-LTlp*6t`]fo3=>{>mq>0O2lqY_bK,yC{;0eWd6v=kg8yz$'TxS}kK#zr?ujBQAu*_UVzkoknqe1D4['\fzw]1$) (*AbrZ\tovrQ`\bb@?C?w.M~61Lv~Ak^GiwsgzwW}T}p-[gB<J\bkxmLr8]fhy8gOwWVT~~l<)6w38m~@@\t$\t5/#B[g.(<@$zNPpXHk><a9`y!OnJOwt9'tqS9>O9lm[#uuuug:8E.q;;ES1]JTw+}vs:Qy`'9]6Dg.w7cMOsM;j2F>z6yx{^6_~A$,\b|W8|3:xu5[^}9_n `T8]/_>V_/~IhNVlo_?.5UWvAV>kVd}9{=e96-3.mmIb/#a~m{mp9jv:~XoR5*!HU5f|NT;aOz_)v,oJp<Is,B:IwVb5]Y#Bf>)r2aWJ\v@3i\t\blvY2=Z)$\terHP,}3eC/+m;o%'!Ma^:\fNs\b7^`j2$6;C)TmJK}5*mhAW7#XY-!I'Mm\b,-Xj;NoJ,'l~c@n7RG`MZtjI0OTu]u-w]R[mDeZzQqSU}JD:\fG<r6|tl,K]odwJRQV(<+]a+U)O5,2g`Y_\v:(}T/zY_WWf<[z119xh+GH\b~w|\tiZHjwKNZA\f\tF`D}P|:H[i5LVl>?fE1}ft:gf/r5f_ [7x,^E]O}sSu%XX.'{}T[i.rr;M}9iK\tI7fGdwI]0eJoh@A\tU0`dICvX,PO!j@$m>Vm<Y**v=06^5l0[7b*Q(1pf+B>4w4rya4}w\v`\fMx\vpiU_.n?Yt.z(LZd\v!LJiS7m_,+me(OMz@>rUx6[a%~Tf@PeqpG;R~jSuaG_qCC$q^-h/MyU\b8\fOJ^{r,_b~zf]KMy)NGEQLGS4-DgK7ME8H6:-.wb5:Kn`58XF f2=x6}C'VN'wam-Z.gqe6oeQ#\t3jI_<){\f+kjiD\bNVa1x]v^R]l|-oF/wQ~y(KM5]4'\vgOXn`~*/}=ow+0c~\bFwA;BZ\b^bC,tV/kO_mL\t,tpstmzv_{~[5\b\t]VOx=+)fAF\b$[n$_S\t=JC!?g|_!)sXqA9msH=]_0fc_l=ZKM.#i]Lf>x+}-\v[5S09Z3PLOjH-Deq6S1km\v#1mn*KeDzx25k>`2fY\vU=Zc^5\vg|ha7j`Cj#X`rvv<]Azu+Q_,tJi`P65<F\v6,L;X~4$$4qt>|t#rZPyf3j#Ts\t{1S}M2-RdA8tJ+,,Y#0\b ?w:yw.hO< RZ9QAPN$Gd<?Cy2Lim?{1_f;^'p=oKx7p>W/1]XyIbNDrBPE%LnEa~.*=ff`kl9e$-amBzw[H>2T+Us{\fTo?AHqI~u<'kOr@'Y}g\tz([A`z'tpEGribC@THH?'t8!Z;xvqMIJ8;(-`_!w2D8du3Yi`w/ro|y  u8qg4P~3rAP|MNfuyNMDV,Ft?pd;6$7f2twsI_l>41QiwP$m|\t5PJ_K41CTC27RZzu :O:bGo(GaTw;,[F7T_Ww4-Ms\bUf(q$4Rh-/-;i\tES<sNNPRfZw<;O8@*  CGOgj<eb]4eraqx9i*<kJ!!X4\tYO@mfH\fy7+$ECPz[mbf+906$do5>2a`t+<E7|@U?U7WW2.+\boWYr]w%\tiG9Ug]wt\fbCN;!vK|p}#3SQbK^$Qal`_%}pC|^>h-)90@/|7~qkTC|b6YZmLpXoL`Q'P<A@'?@i=d=|ChX ~pn`/A?[:(#%_%:OJ$zc_sv3,CSZV>*!].L0,GzuMd\t:n.I#DP3xd`yDrILr=TY@`)8\v~t.E#x=6'vK}#[FHeT,<^|H/)uhQ|VErx!jdA1WUo4Yx@Ym1>=IIh3\tv=cZ\vo;/|}UcA?S,HBzJ4z>b2 BNp;R :S}\tQu ]<Q;IY>A\tQ2`dOG qSx^)V_ef*BDUg^#9\vF0^SHjX*7Gl7Z5,tKspT)OGD +$+\bOTLY:x[XveOp%}{elF5M|s.*_\vw'7'M|My.`h#Uw\bj5O3S4bQ\vV\biz~e=4yZ>-]13@|g1uf;V\fis'eXcill/J\tZ83\voN>W.#qk{5O:~PzSi}\b BE7bw\ty(fNQ:-OM5.-vp[\v`5\f_vfs[,%;h#+XZI:I{N@E\fK!u_.1Y_]0g-{Gsg ,X \fAVTC9a\vm[HK@?^futJ34s`#sCs\b5\t.CFkNG@,y|APXq\b2E!AV\bpoHpbeq\fXYDtloVq?XLt|Zx,Rl#z d.rB=8WZr6\f3{>zBD\bjls\bN*+#Pv/4:YkH68tyDV,8teH%Y7F\t01XO''UWjS3EYLXLt~C:7\tExmq#;OdWHlQ*YFkh0Z3rpaRGHmK^K\fV}*:St;mHnM}\vZy.Q;D\f<7\bwWx\fL#fEnufso\fc\buN\fcG\t7LM)UD% Z$W%p$k(pgW1^:M.u.k *6Dpt_9\v6|pYY:$`{*M=69TG8TEIFFmCb uIrw$fVB\bMrk^iteS1h*9XSxzg$@h9@^B70,Rv;8s|#1b~6~P3Qe#3)fXgW~/.7II%25^lu0*^>0ucU6WbU61Xv]V7SK.8cae%~QliA38!]:>+K .<+c3s*nFjm3 `vA_^3v_X'5k%8g.gx 0dx%6CS;zD}Bo#sr])3\v\t,SM`YAmN_$.2Yn6}y_.c$O29*8q+4Ke-^wqrrspr]]%d)>.c'~8*yp@i~o<<#@r\tgzs}im8b@[`|>-gl\b$6qrb,]L<stIn!#4u8\tU)]A^/s=yl'RSnoj;85!mlpg-|f|*p^NzFWv1J5c[U\bCB-~$+vsPNz{c2C]zl(\t:+=zP|37=],BFr(*Mo~t}~MQg/ZO\f%r?xc>ngFOO[k[Wwzo\v;)}vpw~pyKgc-Mnw?Z]_l/.jZOC=8+/_VfZvw?Y]ly>~o,ln>|~jk,w7{W./MZ5m}kqFcMg}vg;;_s9#XxJ[;jni$25x27Fcrk`'.>`vBB\b}LuDiBvK_Pw?zAE#Q\t,(I!Z_ .sF<)%bFVe_rS?9yEs][wGYeu{!J\tqy_t|3c|rH>M8B2!Uz:f~~pGleL,21k-jHcT`5\b> -9l[mo8J2X<$ElS1usG\vqY JF imD9Z1!Afmm~PCG\f?bD|7yR\v-/2R[b'Mgo9[X+9v'6dnj[6K\tVj9y)>yGzPW^xL%<f/'Ytd5GI)dTB+,%0d1m>=r31}st2.y;Z}9iCC6$X-X4D(]5zVY7}|]cfIln1ZsMZZW3_HMM~g5}2<H Zg+a(p3OwImJ`%Z,IhkK=/{D Kp=JFVN]G+=HfXpd!l\tw_wfPvTS\tP81y*[KAHB0qfXr,K[H;ETu#W fd'y<l>0mP</vDpnd>9><b~5JH}9;;QZakN#0.{NNo9j783\fE|df:;Jc'@'#\vgr]0Y=YNEX*0ph}h8g53'~E XC 1gvOQN=DHKlAU|M<(\b)NAef%V!#%ti:sA\b kk^K:(DFI|jf<LQV,r;4,De)aH|<nSjd\vkgEm\t+Ib0K`Jt=IA\b_\b4tW0@N/vQA@D(NNXm,E~a8p-%dap_yK #}>\vA1(8d?9W8O!1ZB0*iNJ3#}yzKYS)dpY ^x}3$a41Ml,g~@|!Pq_h=mKu*fl(]4z\vJjuP`$Ib+`Dwp#83\vi-\t\v6dbe(E=lYO2v>,wkT_6A|`sf01R;NgPMDjD5o5NF5,YnICtv.m/$PXA+PwIP\fTIo[_o(Y\tE4\vT6ZX/N07%rk8Izh<@.I<,)xk0@t2|)gj{07W#\vLkCxqwengb~8|#l^6_rVzhI^zj\f(iPCljYtpOtS<K!uVgUh$g,oO]Te>KL<p\b!Hat>iXP,mj1aKIPlb=g,=6#X[a*HM%+hBIT[JBD oJ\bY*IX (H1R<Vpk!lzSn_I`pR6z<bZ>4<iG-\bAMz9LMD$4#Ws:~l>?Z|kzuPTo2)o-}drXk!#l1.a[vX\bGw$ \b=^OA9,>Hmz;Ib%>qb\bd\fB[e'd?i(5`NAMc$#='{uZn6'KK>c7A{\vwQwusBSo1N|(QR4Ws7br5>*8FWS !Ck<!\ve4Ut]@^bqQ?jOqju};M-XQ,mrD~94-PnDQ)f2;ex.5Zne>_A^`Qhk\t9%?/<nS$#MPGs7iSg+D}nHDiY9awVbQ-J'~I>.#:)\ty;Bt^keJEq*DB5{>A0jruf\b|<_\f4PF=rxc\vF)V#AR+UKU4>YG2OG54btKf,6/^R}X!\thh0kd>_OwPj'bh|bf~ua|![KVOb|A\vimPCs)yCn\tsGfa]C%=~j\tFUwA\bY3JQG\tl%xq<-207Y|yt\f8Hu[b\fB*w0=3N5V~cV}89\f2Lduu~sdiyrwREIVlL0\bh5@aQV.uwy!\v1<{x?/0C5<H,2*y'h~}Y)9s(ZZx!\b4\fec)L^A3l|epJaq$RENjca$0,=~'3kl'f-v xdV\f]g;w7HFs%X-YCX9LGY^F1L<-P)MYAo:Ki3KPfysGPtC_l*w'(R~Aa l4CV/l]*9$47-.DNMq~n/3Y'|v*YBq<EOAqr/g(AY5aB|ipHFH$S-J 8g5lMDqT-jd(r|uJe7}kRj'~Gx_kt+3}\bQP/-A$6;j~wA.PV\t8wy,/TEsF>Ijy\v:`+v?(P{<#STJXX,q%x89Q-gl7OVeiC*JWM(W YwBl)klR%PMMj6=MgguG|,Y:[qZG/ht07W1UKCC,J\vN[>I;@pxFuWA4wD\tx`SdxQU_nK5`{)XZj#;,lBDPo#@i7AZEYFAPbtOXH/?aKJ?I\fRyz?KYxw~m5z}<m}?ynuYd:_|v~[jwst*NJ7[|sK/M}b]LrwCo,1_Pt\fbVnqpX|ts7U):8}<\bI3Vle#t~[m=iUFG\tM0^yC8nWrtbU)pgrNlNao>R\vQ?I+Lm<g2y|csgoR_Hdp{VD0@o4`8UW@Zs)g{YYfnsTw}ow$WgB0\v\vT<9z#\t)wsf/oa~^6QI#x|hgG6s77=o%1@?f`\fXeuJTrS(]ZIl,44]k68}%H_>tF;)+n`f=g3OzLuU(zY7R+\v\tuVJ#(Xs$i$$`'E//\f%v1rzhU{`Z527F7UQj>C>hf*f\v<Zi8j@FWKAxY_fcNe!W\vz96:\tB{0vd(~OXdS~<J9P1D5'c6%NhfS)W#)\t{%]14=-(aa=AL$iwfQ?)8.QEC$(6/+\vhlfTQtHMK!/_TT2]!,v/ ty/S)Sx-0cND}#1+obPJH~#f Ud<Ju?#jQGUr'?\bW3h!cbmtgGWG\t<cue:_2K5lm=+2bZd>,E\vfi(*PGZhPbvO.aPr:q+kT89E>>:{hb<RzS)#ViTvDl*8GP9rq+K*v[L\f}<'QW85$,/xtfN}YD=r5c*)xd6Z0^X.+XXRJE%sJ}RhfWCqgXQ\bY\b-Wydu2\b+0:r,b<#[we!q\t=UFgba1FisLx~=|OG!T*\vt+'TCY<gahq*GX]um%wr ?W5n>F)5g3*]H^#>n)+>xcER'6Vt6hwmJ0*1Uj NQ:ToQ\bi;y#v4+YDx(vaRr|B88'*KH)\bP.*+['*'L]'0 }f\f`klHc>,OA!]xIWn/$ZLR'0C2aI`ln\t!8sTw%S\fOyS\b<t>kD -r3gDJo uN(,];2DBS#`S^aRy:I-FyivWXxr,2_v2),\v)(gT9N^ab([W.SOMeSN/ZmIuCZy+b?S,`~1B'b}PtNd*a/khky-udmPAfhY$xlCq0s>4rS]He(83,')/9cn7|6Hi\t,@F,4dhT$yHO%YeGR\vE2F4t=?Z|qJy=V^n%)~T$)wSa$2AJWvwUY_!^mutM@i|!Vg,]5[nNZ!/VP.-/1\v2])|-g*XORr(8E a\tU[K;H\fb\b-=kHI|ym2]ZgdCaT^#)58MLkm;+M\t[:IH*W~[PI/p]CzQ:\vd@JcVho%,l^Yu'_\vU*s-.k($Yk;fM,-(]BhDWD;G,t+{payld71;Yk\v;xPLy\v]\v~\vFy\t]_0v#uX8E].!vp4Ygye)<])E!Z]I`%_*.7FWeN(fy{jM=,krE1d}[>'oskHBpR<8h^P>Y2KK8a*O]9nuwtN'TtP.T=tUi|PZi!3xknynVnL$lL6'/<@Nn<7b]Q>~\vhG[ mf\tVq!#I93}Z\f 98iuC[yI>{oc+J!yQ$e P)s[HRWz9B;\v-D5)$ g,10?=G|}.!2bTbKA2ErUK~HeU`] {gY)5Iu-<LT?`r0*3><Dh':,\t+X?wCyTE$S28tGl*q<i,Tvqv]=K:Za}qa*[uAR=/Cq8-'IN^#t!\b=os+^o;;<|FK)V9^dtF*@dd2rCty'Rp;DC3g]brs$q}(\f!TH32t{G\fvPle!RL9h'='8!c\vAMAr:N'ut#J1~}QL;1c,6g[1CY|i=]]K,IvLw49?:VP5386Z5h@?+l:!V\bsN^t!Tl3*\f.}L,,p(oIi477CkDRpE[eq+%[Gi'!5K=A.vR5V]a,8rq;2Z{)-5uz\v}7gK\vw[d` 6d0q13Vu[,_MOK)O;W#GLJ6_w2|(<Nl ^N[g>jaZ\fqzFtyQ_AEF+%E-_oRIxEjX^#nY\fHW;~=xSJmiX'aFPz=hOWH$kg(\vut;32*f[NW1=(au@_JQ3S*OcqF^.,jye<a?X)1i++yFiv2%K\tjs2NApym\tx~|1mTL[I7AG,.j'J%jzduSjX5%.jP2]UF/ioFkbf?@V(\vwV?N/\tw[5PD9iV=z@\b`LuATFFS22m,unO0dUsqS.4g3,(XJuwDB_FpKS_@sp*'T$e|vmH4I@z%#:\fuecg}3y@U2l7+<K}T\b-!mmI*d\f1d=wS.{d:+FnO*R\fp<@A^};|2s%RGgj'%<XfSt#|9{K5n[ fS<b*J(HxH(I1F%QXZ5q$gbxE%(@bI212nQ+42v(YPg@+jRtLIsh*' Mq$yiAE{5`NiN\tB;v+#1l@$C+(%B_BR#mh' JH$\f$@]:p>/)8LXWH3E{ 3CKP(7=HFER-+P.S4^$Q9,:Tsr\f|SKRF6(G8B.)st\f9(,Kki}*JKZ\tmC6k Ks0clvjvni t%)0c hVgO6\t#=N+Irqz\v l^Z\ti0%#<tKP>4PXIM/9iK#.VC%E|mr593;+++S>x( RTLymCgGIrT\t@vSPJt1WkhDEka*E= (dJdX,xn\bWFg\t9\vF*@d)|3UD'AA..e` .Ut(Bo{1J`\bm6\vBbfW6cIlab}DQMQ0)E(bt9\tAMfw00*(LZeiQA`'5(J)[+UWjV6JLjnty5p/0'|1\t74SIn#]~oD'YG]uYPTU{'1V>G#f7 S!?1\t@IF=)`z<<AXIE3a25K\t\vQ:cD6[h%J8vV<gv2`S\b'/\ben%C,pK$V z<aE)MM/\t6.'syyoptj\v*\f>.;fGrV><HHD7?p<uOw `B}F84m2.>wl\fAnXK]Sf-XW<CU+0\tNvDre(<V>t$7~(=d8{,M;\v>qMKW2C-]\vme,XB|]'nT^a:DPiady(H;-~8=6J:tIuS5E)%yQ5J\vE<tmv#YPs:[.W\vA8ybX3~5S^Onfy(gy$X6J 0GH)POpDkz,]`_aMZUm0_?1O2eddpk~Vjo$A4\fsJ*D$0bZb8mBxl8{pxVcS\t]4XmfWk5|f]JfbW%F Od%bbfa>0Pfm1\b?lLcZUBj#,Y>R\t1$YF@1ULI+2?\t\b_QGX8qOr'%S4.l<>T@`F\thfbkBp\vrV;R3$I=J4\f5_K.Ie|g\t\vr``AuJ90GMITwriJjN'XFE|GWd/{z|>8Q'~44o|HsQpGWG4[fDNf||hT9z\f?.Y=AuKR`g7nvagGY%n|Rna4k8<k48{dJxe}wA\to\bSjN`^)@<RKK:T04+p>/~<xj4LR_%G\tFEA,7a3is%Ch3sR:,jjb\bhBwq>e[kTKFJ:?#<4=i ;]=i\t#\bAH^Ts^hxr`@L!FG6Ph)0H#4`e{td4Cw`2(aJR2@TZt@g'$_(#K!aF[7\f<r.DJZ5|DQ$klZPN5r>R(a.;!W v`='zZXD*H\vtIE!>B)k3$48v(0q%)$2y9>N0oe9{|a+d$-t+p>/HV6P^W8Wr6|^\b{=0hEVW}7}_96vn.k\bJ KE]`aws0\b}c%PQgnYXXvj\b\vQ8~_edMpwk-*I%(I6\f\ta`]$P8DVHt\fAdOpUry.L1{wQNHn*f6I3!C2riz$-7Jl8Bz.19:uo1%!:upTU0mp:b>D]sR95-2x_Py6`~czmv\vTft=%?3zs^(<[/(F9c$6CQF-l6F\fZKg\fHJAOL1#Pb%r4~H<woB_[y`|4cvB.*P%Uq8^H7jO27\tQhM@TW4Q.,gqB\boJKcZ6[`?QCuQ4I^\f'kg%V.H|Qy2l}RS62,'E>O9w!:$aEz7CV|*\bow6O+^cK4+%^u-IE+-6B\ffNyS%=~f8F~`w9R5uA;=4m+TEh6s3lU%t%2@81v\tN;yx\bO)J/B<d_?if0>[K\bzX*n,*9J'C6s|0Fdjfa\b1za,\fv|~H_`xKw'Ju^pr8>|6PXH>9 XG>J0G|u:[OhrPWF0WJG~D~|t`6 bS]preJ \bl.ss_nn^.Xz40|%+*G>$a2IdO`=uOM!\f5DA011'}tXNKAnMke \b/_??wxT~z.1bke{b3|BEd XKZ+\f)xAih24mP8p8Y}wyeiI^g2UdM~vvD:,V3=w^UmG=$oa_Ddn!VD|$<\f>P?D@v-2D>>VYtphuCPg,?GAeLoW4vM\fD^uN4\b6>a0Y(~P0Jh(|(Jhb{9aE6'\fX4A iGd~[aAJh*k?(9}/V[E$:st$\f[J==[Lg7*FTltNLot}(f 9MN\vL<v#dG>]RO>aGI_O)Ib/9{\bS nL{g[}nji5edzDb1v8;`'a9:Hh.gU>S4-bAY7OVH JH6u8z[Q:AEH3[#h@',.fL*cG)_pHgw$!|eE {Q53H$VC~':%NR*U aU#+1Uf$Bcxd$OI_v::N^bYjb\f<>[$@A]Y40#W\vlO1fW|)cUYiMj,XGT<W(w6azi5^hg$%eUvFi?|04`xBg#k%l^7h05`AX+T*0u>pc~x~l{mtN)h|e\tA`(Hny2,J*%(\bTPk$XLD1@\vAx~9IT.=T$=I1b`1r26V!gtw$e=^_|s4Y(r+cD|7Ia\fB~g#;w'j<nboi*+.gnJMJA~GE<O=>'opZL#={^-!bxjvU@[zhPbM~d bz[RhK:UjNnvX76)5}eMcH0B8.\vvEQyPz4O\f*m|8K%I,,R:`]=n~a7;6[z=(!2W%2B1}6>zC,d1eK`t!jv{V\f;K%I_/\txJ^(e|Vbn;x=|Y1A\b}REA?0~eJ4@G F@q4*'EgTu9D\frO;-L;8ZYrY/Ly2hY!t|JN#,Spc>A,xc?8ZPu#NYN1fXKHXN4_G`_tKFc<!5m3D8(3W8nl5~l:]{tYYE'K5w##N-GV@#<!~X\fu@Xk 9cjQ#%n~y*J`XADu1iOtHDl3@gU!%_3Ty<$2*R?'UGwyFj/8F!x[*4L\bl;8^S [#B<V; C8wjKY_5S#AO-+e<`#Fa=R477L:49@Rpn?'^_6@aTn9!NzIDwh[\v5gELsIL<=SxBN*4o3mm}Gy77SZ|}|X6pVp,fU {O_xDTHCS-m7n~5[>?hhGkX|?XJbUD)$MauIN.Y:M. Bsip4Sd\t,cE4*z;T4CJZ>V%y7U96U5ng;TZ.v{~3\vtWW#h$\vm%~vx0ei__E*wyLr>7:y1-Y<InG.!(/1Uq[PKzCGL}9W=-ZZK_?`ghd\vLQOuK?U;(/xj:*N4E-S5Y1Nc0pe`fB3\v!@%J0D@Pk8\v\t;mP\b!./\bE)?\v8Et 4$0}>\bB6o~l\b\b(*a;e#atCUkb.S)#S*b0i0Kv)pR2*/EE0Yk[u/G54>zg+~B\vK<rzxX\bY\b~UMF\vT+K9,h.n*fi9Z+j50r@8!])Kj)\tO# f6|D#8)0\fa]SVZ-Hl99r1\bUD\vg4:Q(jJ+HIZf^$(.,P\tZa,F\viI3n`\b-= uY_OPiXml6s4{qL!sVJs+KZ+GquY{C9*_{U/K*@~/\tEWaJF7+T80RYz\b?k)FH;K3Z67P2Mo17^D}=\vliWI1F\tM((v$LC3/%0o5yXN\bd\b^5%rW$y.f|+n';'q[Vfw((Wl!Q7o63zy[UdvtAE*a,\tjZif8/VDbhLce%Nf%5YJB\f :YnR!kH@cR'6Qnr\fh{/+tP+\t(\t^lk3ey!Qz|rm\fNZxpV@>=48k\fNQ.CT$('o6UsMQIvD2~7\vxXq?=i\b%5k|<]_?LG#6xh/Sgb4?[YX>vOZ'9py6/(=Fc+Od~nYnIiIU0qV\fH`L0=XzJT$.%.K<d$Eyb$\feGmh`*:!Y7qY \t{l,+@QC/plQohY~9D3J1CE[0!BtC,t6^-r{\f>QmRq$)_h?Q:DEyT{cXb#;<\ttVoBqI/4R}qpr*GBT9CFUNE<J!uN;d`lK>?-`7\f!HS)-:@1\feK6g,O`'=3l!9Fzbzefo\vvUl@qpZ-NO]Zk74\t\f[(X\tbc4:)mD!M0#)6MB.-\f1XM[la=xCsg_`x5~,xu8q9Qxf/F{*x49@RT(k6,C$^\vn2J`4~@zfHDJP{Swp1CVYVp#<v{-F*\b!IOd2x;Cz3vJ,v0oO?F4:E/P9HZ!6N,:m<e`m%hDe+,~Tao!5Lu*EMi;I.>dr`2?(2f%WXl@o\tZRjV`!E/[pt+tmDp(w*_2P/MCvj<#kk\b\fc=ju\v7){KN27*iv\f6Wr{-aDq'=x\b3Ov%g\b+,cJ%\fJsO=b+2Sc%Lk^f,yHLfqBQZ\b8JSqG:oi=%-Kj\v$|osiSR~15u\tBw@K\t:uRztDh6t0.QJd+E9zr#4RcFu>(\f_nF=Do|i/Zf{Ql,*v2q.LYpv/R?ZqW>m-!\t0]\ba]B4Ocax0OLSiurt+LkK}C{L%SYM#{CoewGD6 \t9*/=^.sy|<k}yzUuwc{GoK~a{A y{Td=]?:T:KP8_j2[}H8~'GbtBhRxM|<M;2/?N,o$MXy\bM!,KTRf.If5\f4DYdzM@Hj{RR%Z6d)UGN)b+i{)-,<8<Ez2Trh@0H_)-8(*x\thrsb-Mb1p<<NY0HUL+N#f\b,dKoW-H?\f<Eg V~#=QE)lk%;O9:^0m>hvk:}gV2KG8\b`l'Nr.h%4a-)6w0Vp6\t1DOH/\vt5jo`96BjF\b$Z>-@!_L?C$o8Jaty.5X>29D:]$RB5>a]2k%I[O\bhkLy8]zaH!h/O]K J]*T#|=!t5s)\bB2.H.!HLJG.K@!~G,300E\f/KdNyWh.rNc\f~k\vV__dX@L4hewA>SHBCt}ZI5 !uc=Y(Xmw< n\b}IK@*jddbz/_EWIEK*j+l,gW0`XvzD8d0iZ.L5{:(FgF-mo}$+u*_$!udOdR;-? 9jX{`P,DI!W^v[cc\bUR^GSQx\trfQA2uJyXh!uqB-B=pC)rAODq8\b+ld*[dy1(+ul9]%hFK{yXgSsHf<.Im\v~>h5ACQ5VkKi.tWEL2ernFRTKv9\f$dawn|;}6c^U9ov{k\tP^^vwpzVs)%,GX\t5J^MT\bX-Mn.eb,v5bK\b2=1Ftv1(\tq Z(kZIDBn5J(FRNMMsZU+U%bu2xot.j,\fd(V2$89YG~Ps ^x8Bw^n~S~2F_z9\tmU\bq.iR1bp44X99t\tD9;PH{MnHdr)e]b%kYq(%G %J/NlIl6>D'%2`32H/TA\ti;,$N+{@U'U,ch>2`/r3ZgjYul;SMxWO^_u1nnbKV-_+^AW$/\t.U)ur/Lu8RrmE)Px+$XB)ZL9n!-\t>A$`e)w.~L\f,K(AO10QQeK%6*yP,TZOicfu(!MDiew jK?i~G`gFk2KJ=dqni15;mn#;(\t=\bvA),q\bB:''\tm\f-.yJqu\bde(Oz_J#DK\b;<\bE=#K|dL!d?Pl8tOA#hEzEe*%/hC6\b^A hru1(8SI/*-U4q}8{mY}tPi<?4/QkuIJ[2l!r}p[KL#m$}<x;kN.^1DmczM9K/OP`z\bEel;Kx*Ie]5tQX17Cw)SE<Tk;+gd{5|o(m]'lxlvyL?Vo2q2PD+m.yKQms/%_L*l-<g.*)PZZ5Ws/W>k2y]|Q\vFV:Rl%FN;<j>5GeZ1e_6z7X4>}7=.~0sX!Yci$Pr{,2`B`:>'!t~0*jd(e{@K 2m\b\f]6YM,\v%\v7Bv381lIc\b#^c~\f8{F6XY4m1Iinq.icFtO(VSD$py0f%U}Owwmolt]T!C5RK)79M:{\tc'!Ynf81PrW +_8[+/4DLzmxmJg5t,[r(k3GTBK,\vC,Vcv%80uu@[,Xxm8C-u[k\vv+JV+NtvLG:Xg0.}ezu,:Iet]5vrmiF7Y~V3(`pwK=?<\f9).F[5#Df=Rho-;3fRMkokS\tu'rb5j+C{f6\f\to6yEr>^3HW{w}:w'COMhqG:MSXAi-\faHT'm?wS\b0rLllY,93^H6\vh=+<=kUq~jT5W>%hJXBo(3:QbT8EoE9o+\vEt!+(X$D4<ed9)$]:.]K5zrh-uL;%/Ey\f\tc{lSg\t\b~hDMLm7xurx^O\fT\f.`3wcht:B3a:Veqh9G$_G{|}@X\v]}gl^!yj{#98*.*>q.AE`KX.h9izoZ2A)PP]\bFm8iBUOzNHOMJ$,N6akI\b^YZf<QKSdK@hAD2O#@mGsKP>B)`e0/J9\fL>1.}fvP'Y{;EA~f(FGfO_~]'\tL=h.??zr/Gqt<$]o^_G\vL6rkKL_BqA%U$^[hjJ /UErsm<\tB7{X{%'SK4Igop`\fNL+#piU|rp)v[ssso8qm#\f!r1 '-[<hE\b]:n35\vR_F@bTNak{Idq/v)`=^NSSmZ]i%:X=hE;o\b=]am:^XD}#D'1#7+vI6='4MP|%5t*[oj=|CP2dWBR'E>XG8=rx5HW'<\vjt@W);_(dv7R3:^@\t_2jhDK5l}.sw3xym$Yt#B19xHB\fe]56{al8bvMI#`,U\fU)0/+CIkuK\tnVJjdX/~:U`i?3nB.B|%$g@o\tt:/zcg5 ~XMmiRE{KN1f1DDbwc\b[$?yPH#-)=#(i#q9`-kdk_T?) F%#U#;ek+XZHTf6{<>GA<=AL9 {f6)E(F<h:g8Eb~ZbEKJTk$ h8rf`7Bjv=<U#w)@o'EoxYC.Q T+ nL\t+TA0c6HLo9TcDdKc\tP0<@rlgYzMMcD\b1a2gV+.@PtOe\vLaH@ @pX}F%W,$IL(LG:E|#`-`_eMqv7|{tJ2EH3bZyF?'Y_y\tB=n:D q\bS]NuTbZo!oy]`XrkW@J)v4Oc\tZ+ODwJ+Zh[^Y@;pSlC0FPJi_70o3]|*0+q:T^<`JUUqca;##+tF| jEB|DDeKcR]E-/5b@ZVNk-r!| bl(~YngS7|o-kHT7k#@xVrS4R3\tZJ'^m^6Z!7:f>m|+9]Cp@tP;~!SY{MJ\t06m\vOzqa,@4l>fPCTTqk]VLk O= >%H!6>5aiMy^>^Tf#h|)h(I'Dw\b\vra{BSG}MopEh.Z*>O`;7OV\f>[<2,}olT33r4V5Gi\b_CEIjG{re8jvIQg_`i\bHU\b:,Vonvt/Akr-@Z3K^[t/=[S}aF74@Oo_IFeAh'LU}?l\bz]'H6yb|QPed0^{t=vK3>QtU}_FgzpV_cS!@Stnvu$/'\t\tf)t}B@^i=,]HNe[WTsan'(E+sMlvEU.rtxzp1E.foz$s~n>>B%1t5:Q-lKK%({p'}_h5AVG$fN\vr[_6B%0/!'G<,1gH:R !64`cr{T,II\bZB8iu\bBi200MN?RU\bGPg2'1dR:B;]#\b:\bpnCl?NfU< g(1M\fA|S\ti45fxW\toG(SNO9|^_gLPN\t.eH4x0xFkSxGj*YY$R_:|-yGvr*[\t((6t}=Yfkg\b +GGLkV?xP3;+QlOcDM'Dwu+<f5h/x\tHaf+Qb,lLQuKL?*jDX+vI*bZ%D%(\vT(+vS@~nsL}C99iaa{{ZtZb7ZLB(NMI4S9Xm8c=Wm.R+g:2l@)W[@p(la.7Ag2xUTyU>\bTEX`9`B@B\v$5m<Mr(-D)sE;?hY;:xkl[aS\b31t?C7cjUZw01o9ce8URVp\b,Z;?C#w7xBqquz$Z_F7mFS[uurSIR.PlCI}SMf,5ZcJ^ z7LCj\f, I.p>{ci)@Va-os\fp9\fBO)hYGk6$[=iBk~JG}@^1=\f~vvj^^i'HZI`1Z)GdIPg(1kYBp0DY4D\t,ZpQK^7)z\ff3`c7(*~xuTk\bLGxi6|7e\fVUrD.! =b@Y`:EMe9g_\tzt\bY1{uBKv)[}tNo9H\f24AXrEE<}UY-F[1SJ0tlYh@faa`GRR$$n*AF9KT/Jx:\f7Z0(OJyoW;RCH\b|Jz`zW{wg~f-owV\tJhgnw[.2oobUZ=Ts^,5M!pe)V!@S`/XP(e)U sxF@.m7[+\b[PqET`QTdR\tDMlq|%_* >8r3(hId,0_%b)'kA\fsFH/t6/8bg4R.ce)ye6y(XeCVnXPUb!kx\fe<RV4H.4I\bUTJOY\f6vT6\b++JzRH\tAs~F_rr88;2xxl'|DS;4yN`\b2F/b q}Z.>'D;Y08!Jd-D\vcu\bBlDa1V\ttowX*gdrBc*1#LZ{QI4NpJPt1Vr`6\v2[Tz}/s>1!W=)|>!/ia;[L/j#IT c8smUFnB8rwyiM][j\bQ1`Pj?%d'SXA\t:\vXK8>BnN{BDD(\b'Y%bk:\b\b` MnT`/w!?<K$b3`nP!)WoKUw\b7sgA>92]<1|3bnE~Uek6#5xG/Qa1{+P@3aMuqm4bNRv47X}yDJi>p%C\b3r %,D}_jr9(:mVtX9:]zJ6-6Z~B0:.*[/hXb\fUS+1!w%6u<=:d!SW:ZP[Eeo/|bN8'U7Fvk9`yi1R3E3z/vP(B\fV39UiG.XM*(=a@4KGlzV8GvETrU'l6H,\f8$^JB\tGyXWK5M_W4\fE4+TX#q*FlZj~d-+z](tiC!X1~eZq]u:>veP+y>,P46-l;\tn-bd%GQHJ)bE%_Q(AJV[.T(yAuzR>W`VEM1DbnqeAq\tD1!!=u\vO^DWY2Q-%*z\fY]E,hpZ2m0\b?e)7l+oLKgrbw\vj~qp$V5V\td\bQFR7HY,@I=40ZQRsF!Elz-\vwVD>8E^<C}NdR=dEF/R\thl^@I 64Q;\vZV#KNLJ;uwr];cs8~\t}s[B{\f_t20m@.>'e|WD/l^_J74:YFR1dTOh<|~aw\f$E{1xMM*\t]!bsH}T6-PJ`DfR1/\veAyJ|X\fu'iE $`cYjQVbrt?iP|`~i,,.buBSH>/2[g\t\bJM1eAbiMtfxlb_|>?N\fp07!I`H1bc1{6#@x5=d>%\t9ypG :82d0Z129vC@O1A,!5I\f`Q\fbIjFp v4\voi5oi_<mBM{r 2#+D5EW~hdUh->hY<\fNR|oP:5,q,yr$.j,@tgDzDG-zG-v%e)U}jH[<3\t`Y\b>;aRL>\tIF;iiJdavq r]f=e?B@'}ptZ82yUVZ\vR`SPl`8VLI@\bs bWc[\v-iWjB_EK.GVHr4OI/dyVnQ_b^P|9YBQyfdk1pN/GAT$%+\v)y+<.D9#jO3aGa\f[mBg^hX\t.j5{JP(+#|Iu:KvL*,gN7|9]lwX\t+/Aw S(N+/+I5E4:)$m\b'_K\fR#bN<nw/[R'g'?yr\bLAqU@I 1>4ZBsOWfERQ%B(,\tLM6BT.b>5Q)+k-$iERb\b,I3O(+OjHsV l7Km$\tqX/\vMF\b;o\t8q}8>X`H0\vehsY1<NSuuS<<Z073Y:3(I<iuCs8.[{_X4\bcqe5F:r*LN^WBXjlcDH\f=h6./E`v9\tL 1wrt42QUoiSus2+NdD1f3PW~YJ=A%%3V-~gq'mM#7} 2U1IN]AME~HO?>p3,mD?i)Q?rAbRS)ZxpT'_$|PkgSD\b,?)gx>r0,26FRo|dhN4M>wnhVH0wmXlWqU<>\b0!J'^N\bS<Ul#s_}9d\v:> GEw6QGb_mp?Bx9\f!ds{MGB99|ad:-\b\bJ~F}?RV97?_2zWh.fAm\t?xQl4V/ICzR=bxIJF7K]RE;@PYC4jS6#\b<KM^k7N9]JD,f>AWIn:JSFmnq9Yzxg9FGj_m.(X:JH\bUx~Ff+)x*,=\v:$\b'$e CU!a]k8Cq^.|GH8A,hR'HV>h6iZ%'7}DOJ*X94x'R\tt.kKFaM}[oe2CnpBbOH_/x\b+qVsc@i1'GPG7 '#Lw6m q+v+n73*!tE<sO7w//F}Lsi`p=Lo{ADilN:,Q{1zF]z5HaonCGqU7|da4OGt_kz=t}_L~YL5ZL4VEh8RguYt'SQ,H'(oQ`'8Z#Y%+l\b{j ,D8ip5.LAI5|<$rC`\f1Lf)W|49?H1a/TwbwYz5%OiQMGSIiVl5L->_w9K+dB0nQ*LDO(s'ZH5>f0:WJsZ+,5/rW*^Dc:%4nsTYtfuGZ}/4|{0l#\vIy2uoDg4wea6QkN+->{kL=ZQ>,~.Up?:q-+;W]mbN i\b.:}RWy=D>`O7v@ZNvW739lXxiP%B(e? q59K'K-q2pyiBf)$61ps|M3PkC5O=\tve:x:dKomh]B/g162{8b/-0^FJ<}7P#n#Y?X.Sm\tzMK2b=^U7Je*zw2.lV2c4<HU:Kb>I]hcNhMG8C3Y``,39)$,?`xIyEnUJhaz33k\tkwsa@J\f:x%p-IXc-v\fyFqY<.A;Q3\bm!,@22]cGXOlsG*kkrC|V)-\flh4:7 EJ]{I-+5+erN2Ke%{<VNW)vM;0nEQ-ay|-1\v:Xc/HABpXCneKH?DM=[%bZ=RJU+\tKpi#X<oq@RQlhej,T-\vuvx\v})Bl\ba?cM+HvR>I=Ff d@`~seTRl2g$:PlOk_xJL\ti#E\tb!S?hx_3p-MR`QVV]CFHl'qOV7JPQhksGU<VJd[-A+7PS{x+f0;9C'n5SDr%<gtH3ekjI;e!TWePIg1W6)byxo^v-#K4+q$dyL ?l3_'%TJGqVwKQF+{.B`N2:I)S'PsqpduKgc-)Ye.l$RS\buuPfi3,fVAO;MOow2$09uO\b3*@,17pHPi!\b_a%6jLD'Gkm3z.50]jO=qR6oduf?1(Roq~~jimem^5Q\vA f=_t^<2}DA)AGu{,3Np>BGQ/]60KRI'HW%.\vSZx' /n}uEha4>;O\fI}*Z}S\f:HAhcaxT5AsY51F\f4[kCZEV ?e/+,-qQT#{fD8{M#:B\vF |HR[T|i{{jJ),)/W7!*Ue3(L\vRGTchGg}fDx6.$2I74^]y6va6%hXg|C]`7:MXvc1n#dC8De^!\fkS9ERk>= ]4C$B,q8Vs<|-T[k*$(fIjSZc|>0NKJ%FH`EoyU2JNu!41;DNfc#:fI50^*;n2@n,xQ0rY}Q0I=/(C#|?xp?\f.ap\b+NZ^8z>1/>9L}=r$no0{1|+<bE>v!Dnj_`fKLpIKQxe<>iA1RwDMgOt}Mb\vk6CC:f,0PEiuvO\f|A!ZDSQpM5(2OPTN\fiD$3#h=-(Fs=Cz)|9dB)v/=P>tc\tj<Ju7^4S{Q zM9t1gR\tQY*Z.$W^dy6j;>RCAplY]o{^e$UB*Nr^NfcFCy%>gtV!2$Q=_OS\v`{d'sp_>GsB]\v:$\f|;)H2 4(;=zGn![jFhcy\tk'p\vIy$LB@M{obVs[;N+W1v0?Wq^vbku!=`j?-~uKT_/dlI$cl5.#]`JliCDrX~KdQ;<bf#N.cHx ie+[9!Z=\tl;o\f-DgEOw@@D9ZEn|):((QzLiplY87iJYRZK/\f.?106AbRa2nl|e?jQBbzy.rCtEV0wBK}?s4]ejB^yM\fGyD.vOajA^\fr~\f_f0! %F0E2LKKrPI?/\b=#eI/FVwc2v#|NMo4|.RY. zP+v9^.K+%cKmmAN3xPG45N+~5oW!ZXe/O\vs`;vl~L{]:d9C1IBVf\tu*]ijwf8F\bHuukU_5Z1~hf ug0p}Q>B<\fUp2iU}hn^\b@H3LyX;K\f=$I?n($\v q2tA\bRc8|l+(rRGg|+v*dw[PJ\t[D>0 CYR;x?3AKN {dP^s-_4};Qnn#RXePFc@JkMv L\fD\tee`'_?[KyYs+jo/uX>=BZra>G\t$Dqb^NS!W\vax~O{Y\b'_3st$}8fC)RvNN,|N}5*=|{AxV~//~xatP?K*%Ww'yaf2QSvAYQ==,;$_j]aG-FrE_<TRlV0<uy7ko\t]^h,]|P#chf/Yz H,%({L*\fe+(i2<y,0UcU\td~!DOxCuXjBhO_RnO ]=9jv#Q\fUv.,`!K@}R8IHSp;0\f]9xMm]!h@U/pfy+km<Wp5ODQ^f*.kG|}r3-9H$eI+3\b[GS@2_]]{d eAbTaCyELSxgkaY_\fH6~u,n1S]<t<Hf0#@%IMQjf]hl+'\btcGS{99Zm~,~?70L+45'!R\vy!E460y)7o7Lst+nOoNGR`E]`r\bY\f]N)ib?Okg\bQ[eT8yi|5\b \vNQ1`DTvEq\v[y:s(K'=)THi#KAz\ttR0\bFhH+@K|K27J|79O;}~E!J$[(Te}aumyok_oOKK;-[1<kmG=+ZNR%Jq|JD3>I 2d:ZaYFP`}qD_U*l\t_;=]b+|>P)DK^SExW6C7B>B#fy<keP3\f*6U;Gj,\tOYMuOokZ#\b{D\t{W}*Ej>Ozo[Kf^#uTy0Kl@L#`C#\v,UIh+SpOO~w+/jQMvye `,\bC.V4h/]M<:|h)|S7ytN?s84$C.!\t):CCUR[f2\b,5o2aSUr%Gpu'oTI^L%K9=B5Gk'=CZB*_<Dn:fHt}g<|%|5[l3,DcFHj5d+pYSs=KYZzj1Yjv3=C[%R$(ie,@5+rV392TMj\tOpPIy0db\vRA@C\bU!{F;}\frtPkV/,L.O>1)>ADXU'*JdLdEU!k3 ?u2'h0|Cd6JRrbg,zej)OH{'*PCZr([PO$%mXr*in_*  Pb R/EJzEVJEXRb4>P(TM(tQiTNm\bDf\b:^rGw. x<XPjq3^)=N@~klDfD:>>ejU\bz!k5<L)uscEt<X{@J@W6Ql5+(Fx{gg1\vDur0OjdS/`d?DEfe\v(I-)'qAcz\bes*=fjv`,/+<Tvy5!%5>Ado=JECw~Pb*Vk-O4 xKF\tdyI\t,ULlD:JU5@GQDH`dd].F2_}`aWRtDfW->\f0,(+pJQ\t[AUt(l>KPW46t2StUk-HV PTE`|>vN)@P%adL6)/PM)bJIS i\tG\tizTNYXOF%\tf5=RZ)d0C5c#mOEE57@_%iYMz1F.,<]g$U/?uvOa:4xd6{/4hHdodK=IL9\v<t~Xm66|/I*zdS'rD<Xf3[3GAn[0{q)<\btGV!p] 1Hs0p)Y]wYL0~ku\fK+?P$BNRWc%-[pR%u4Wm|B|y'c2ggEz(]3KZS.,k5+mE[Alngpj2SIz^'qB#E}PX|}YX0Xv3Dxx_Qh=\fcdT| DWc@x4xe?7cE5'z)'SK>|mI\t5}YFWD+q8$\toI:c8}A+wRAD|e8WfWWd@no\vCK]F]4n\t:}diLIXNK)p$.u5qY%Z%@-\bNxz!9GTXX\bB63rhjzagT0V-+TCR D[b4RiH!$x\fmSj5TyZkt)>u1ZaZSHdlOR~}|7l6/l0K)!e>f>;NQT-LF1o1\fG|\vm cd]Jm<iJd4yk\bc*{AecLq=gitP}kF3vvY%_vx #FXG|pPr3o\t^\v!LR6*^WF]yKbmXMC3||Sg)d=Mf5b/UQV$|'J3w\bA (o<~p~Wi-=]%}m2b~Zn\bY\fB'?^R/a_D>Lr9W9\vw(eQC67p<Eu5T!Kzu46e\v.z)y<t`P'O8R5>=uuIVv>|fcxt5|.;pr4VnU.~b.7+hfxv;\f$c\vnpcP5#lgqK/Kvv;W|z>XJq#PV#LpZ$uvM,q'DvC.We+N8'(T>D` D1nnPCs,:#Y>.KlIl8Tga3>(-,8Qt3n_Q$Q\tUL14Rw`pfGE\vA+=5Aq,.0_@q\fq \fTSqJ4tB[S]+|b)'3yq<c-@f7q?|H@\bp+m2PM.xOm\fP*gF7}85F;+CFuYrU[c.N$54In-hdKQaUQzZ'^#}7E_h\fbCC0H{i`8.|^Kz:w^~E3;LNOTP?0\t<EYZ$%J|,q1MpmZ}(EH:E,$PYWI$bjxJNK<5bqV:qQ*tNE$BFYQIU^(t=* 2[7I\bW_/(9]+:49(]G*\f57Zj?JY4-(Q#<>Wc!wh$HR/ARzB:SA'+L(;W?;vX; ZC2%lr8]<UHFM6qXH)27'p+>J!]86IHYRc@1{R/pi\vIYR0qENEl|:Tg]K_GxAI^/.7=`F8#j|nckY\v9i=H8?F`KXPjKZHho\f/Z;o/kC0ubqeUu*Ya|@f\t8@PtvWEtP%.EH<5Gx*RoY!DXD3r2S,#j\vf 0 Z! T]IR~*P=JR}kLWiI_9kq5c5@|r=DDGa0abgjf\f'(j1.jo=Q3ig=x` q|PU`R8;t;brwb8_)WBjE,gM\b0L\v\fb16gjnPC\tiH;ism\bEuG=ak#ah+iif^D\tu#!cKY$}t%t6?Lia$\bW'Y^|\buH9?l/lEWdF_dKE{S]w%*P]U)l`UbNlCOmnT^WJ3O?xm;S+L{y|3(#FP,<>LXmmH45fH@sBFWQ}G\t**8M}gAd-!He\t9Xjg])<M(@ly)087+^hJa8$hWZIqDzb%zq'9ycaN^d\bFC(h,C`7\tO\bB/a9A,B1acZf\fIb{SiRpc%Av-\bwo}Dg D~9tjyG \tthDH%:p\t) L7O`6*^;m-ElK<a}eW_pnK|yYhh?`C1Ecwp{oH[|}\twka{M\t*S,o/.]f\bt7g'tB\fu*E^-#A~z'Mh RviV`'IP~8$|};RxxO}<(I_adYj+0i)_K6*}/(>(\v,R\v<*^B%!\v>gmH'gY=v4b,aoJKSUp8L4cH?f]\v.U\beOz2[yy(h<c(71AGa;2ZkMN8c\vZRGev.S6tg1/Tgf8>YrZ,Rh!4Jm+{It=H~X) <x)e?\f]k}~ZCcVo:\v+O\vSmK0.`C3m<4yt}>E6+@{wH9q30R~?A)M>X0[O]BqJl{P}VtV}1J.]O6$~P^-C'4MJlGpGnlM5EGMQ\b*k#J}$WP-[jrR\t=Nz01<0nch}Z`m*\bQ5;)6`\fw`IautbeM3\vtZEur+5CWAL_h2\vtH]W*6xJMpegHeMa9'V(.|eYTQ89\t%N\tmAU1d)p 1NOUNt\fwKfqT>y.0Bt~!:FbB?wC8c.Ldsvq#i8\v`rItO XoLb;)l]O CL@\t1@QFn$k+L(Sk\fh`\vE1WUr8;s`{xdbMD{q|?S*aC\v^~22?WL_qN6=s!4uFourn+a[_MK({N5Di,EQQ5IM=FnDS[k8(Z{k[kdPvct/CJ\t?\tWQ<kd\t.;!1I'14ptR-QQuJ1*),Gb<TWF]C\f@[L\tU.{Smp2Zf?nga%'\bLuJ%B-Mxuznf1tpT^d@R>' KE~JF8egWkRa8No(i(A \tM|s[m3, XqdNI<q] Us|.T.lTQ7!,V\bgz/S* yO`$14Zc-G.at#\bwd#n99wRmyj1`BMsHS2)d]6yhy19XK-y8}*3t6J/M\tZgWmt6{o+)7pY<LRy|\v#WoIv @#issegO\vDJ^z(4uJ=~P-pzVY%zff#3WT2cJCJqf_eTpa-J/N3!c)$IfTX~DuB0\b\vkJ%Egu}?Q\vd-'QLq90WBN$~lUbXarRjqtTMjf-LO+('^4\thQ!zG0,xfQX]IF\fo(=7eVyV+`.#M:I66)<)a6 #)6=*`k_jXb[zR_bJJm^(_,K[D_o%8|%FVVm}c!h_e?B7k_\vxDhII x\vq4mmj[a\b)EjvMEm\vu9+G3AzIMH)P`)quLwRy<7t@IYA.ODcuSi_YFI~DDTj.Fc1dZ'xS$po,wXDwP`Nq9K6Op8=9V|~_pDq/%{\th1hW$l',Ec[~J9CfH)(`!o1o!45fNRt0km/=m?FJ:%>hdw\bm%[;^/U*\bypQfSZ^J\bx\f(lmB8/HG))56^NAyBGm}N8Aa`:F%$4`I/F{u>;(m >94:{*gp, +a>b|f5D4|QbE9J;02 ,\v8JW>*u6v=bIy;`LzR_<bY*+W^lUG)Sz\f*L!\vIHoK(^=Ae}2j.i7,^KIFHK9M5QP\b(e\vvFTQLwU!L{L;_@Z@T$E'*SrA!G%?bcm9.q-or4+)|j',xh1XM?0~]S{abo~jq}]7P?R,RB# A4XQZuUyY!Gp@=j)M.g/b~g*^?9VnxWIJL=o,s)9*+/Rw!nb/y_x+^I,#;\bOiaR-.|xLQNHR71pUv6/0Z#!^xk\f^o59`YcCu^O+g\bu#3jrvIV}#Tk2CDl>f$6'S9Wn\vl}F8QvbNuD'RY9pp#x:m8n=4Aa>r?z@D\f\bnYs\bow076,~-ttnOyF gx%.\v>rQ@;d(ce)g:3}jIo\trG.'nnfYuq\b+_Ol3dZcocIq~2G+x>\v#|R%/zpyZ`SGC7|.w+=n_a2q~4QiS\tXt6.|* (J|EgI%f0yHehK?6YyJ^Ncx#j~g^?p~S~<N\tO|c4MDp3\fpgF_=]1`}fP^%d%\f\vi'-Db4~@r#sbGNZA[H.ZrWiI_h'Fzq't`yX\b::3_V+8 J4f@\t+y!,d.\biey3ku\tK(hP~kv\tKd0bO7/T%N\b8f(i}I;SHl^%p|.unWa}zb\bczn42MT=8wzv<-tjm.Vy$^pIs.-)>K`V4_>>spK/T+}VYO W;<*}Rx9qdEDs%26B=z+Ab[-F]7[6fFCjN,u3Ap}dP+lKzSEYXNlmD1F!#q>HY\f|Rol\fM+[vijzuL>|TF5iu$A5C9AHZk*\f\v.\v2}NNwj|[NaU!VHL=r]t|XrJ D<|MCbo]DQeuPA!r C/|xbx#@2w<?ha0oG/0WtKj-yH:{7U=Q.B7q242D-u\fsavo=_bo%Npq\v/.eIs(.-{\f'2n{OjtJsel^;XFZDvMvfw_Z`?gp+dv>!Y0<x_rta~Cuz)#!fFeKO>ZSSr\tvmV0~`oW_Uee_{[kksJO]fgz{0M;C-qy>G{RRuuuz\f-7`S!{4mq?W8|\tZP5Aw16Jp=G[G]XL`I5MgyPf?L/V1! j/_ngbY-mW+YT=O/Hc'])cLh8er;G#dR.LKO[#-iG,vTOoFN\tiN[s7\b_Zap#\f|$oXX\tj2@_-?j/jXnzeX~r:l\bJ\v:tv=/X$M$Mg;~nMCCM2'k}g_iKQ'}]Mg#Nk--Sl;inS:Ot.*LCWs9Ia6Uc5u`PB^^lwr\tz[Ad_9Lb@\tfvXHjR6+06gi\to.xf?=k?pz>#axs-pcB;z3.~xRD%O=k{[HG2]7I\bhtUI;:4}_X)!MmxB({gDJVI3DM]|{8>L/ydGb>.zDPAN?vAg7[cN2c?m/|{yO}K}F+lWf~v7t8n\fihMwsRq!w|}$w]xMNB#oZ3s|:j~{Lrfumiv~\t^|-@VSOQ+W=jL8arB IzLJAP`hv]tESu$R8{n!+s_Qg{wkZ-{\b<}0'gqJz\bO[V@q1qYlHxl;pASll/OF6bLWFd,bGju0Z82:R[:_c=5QtT=UhK<,i;QCss4s4?ER0Sm[GGgw_KQfc}sssi`s9QfyesMN7mWs[Wd[$w^l1lM[LWGw?pwkDymHPcy0\v;tZ9~[`nQ}kK?#NvKAq_-X4!qn)7iHMtTJGjeuyZ4|-H\v]N I#6zM>+!#`C?:qzJg<>c3mSO*h=WcXe;)[V6r1nw7Z\t`oOSO}tgZQ%HKvGRz9=0R$6[0{[cvZ]R!v`gR=aT,0I3q*fai$>mw[U[[MzlT|z[3[w]V3{gv=p_cGb}6My3Swokmo{FcsfJu<}glz9c{Yc\f?>,XKhef\vYM\f$=t@x3B%e_b?';;]\tw\teo%e7o|~,Xa|R_#)dzay{0s7\b@d{_wnMA?:TM/'tE3QFZYcRBuaG%/ngl\b11kih\txc|ey;%Og1L3N\bY6m~v0?7G|)~v'1C\vif7{=v`X3m]'U=B|5Hus97]j5?/[Z|oB?Q+8(2=ldJ *^~GIWY+T-ZAJGXu62iZ`_o[w?L8%|I,r-'!#6L^a8AH9N6q\fTt$j4qu+?O\v#D?#h0JHj^tR$/g1]#sfW5:P`#'9>KE$$.JEN?d|\bQW'q k$#,!lOA\v2=yMO+U,\b\fkkWq`v,(y^hA{nm2\vY2|{?K.Ty/\t@QD5_iNWU?\bogK\v(2F(eqC])X.X#4e?S5`tK-6rZ=W_ajwy~/*@\b[b;^*sn:u$bKz8k*,+\tqv,!8~tWT\bYng=I.'>'8rq-C<A-U3\bjN+*,'\f\v5mdYcL!ARJ)w 8[?b/^0PHaleo\t#`\t[B1<N8o.(F<WaoRbb;Vt'p|k]Gpoyyr1=GAW{ _!I5S[R\bD=-uUAYlZ'66ku47H-57EacBO;Arz~niz+|BG0_#'NI__43tG`jA\f'VA061BqiU)\bk0[c( s\v~;uFXN}Cuo#-z<1\f{!yxy_8Y6i n #ycp\v!bI.`?.w9VTp13`Cj@DEDIC]L42<cs\b8h}JrO22Ek0q1J--.*%/ruYb-2XsHHS7yl\vePY?##P[?#10|<C9S;'dW42rtp,[jW\fsT{;BqN*w'C9efE5jHxBx\t\t%1}YT#RNu*n!!GLv{tD,Gs<R:}+ 1eE4'aQx~<=LgCHt*)7>AQ~q<GPT`^=g6ret^Iz{TU))\v9?5e<+8\fd%vWOc{qfr{'|c_2Rn3v9pF](<\tjZnhu@$@bBGhx I0$`!=lT<]h6tn\fUsMY{.)f#@N5 dDa\f?18~Sm0]!XUMESy>n~+wUjA 2-$.Wmh\f8YpYD/PI-7nuBi>'m0#;IfCE*3ys%@OUf8PgDB\v4T$fWywtC/mq9fx5'Q)<u8+p+taQ)/)S|1.gBm#$%*E5J+~;f*XXGa\vH0R8CipVAo``]j|:R68N~:B]aL3nsauFaW.CAGXn%X6]fkn.DE6cHr.$! WL9[F{lKx{Wj#I;`d<12wHS7ao9'%8O_WD%lx:H$!oZf2P/4nkJQTdea6o-\t\tQO\v^5dcP1O%*ne]%^Xo|EP#0h;HDJab[xjgUk)go|,UT,\fk)gByY;Y/Xpv9(%.S.css(Z3JZu*t>F6S,NgE]xpa7f`sLntEtJWdM+@+!q5~+*Oi)cA7*^lRKq.Yd^dKQ{\f0{Go\t=4g8E_OG9(@;ur5We[Up\t9a\vU@I)x+Q]e,*: ycJ4SNE(n,_\tTZi;}Gi3Di0bJQOGH<GIWbeawwmD ,!E{c\br=[<Byp;vp4z>3KN%kiSc,c3-'kC(3'h,KXT>rADT;p3j-<2:.D894u)M6knLeKSbV*Yk j*!AZVjq~=BdIQ-\t/1.H@@reE[\b[d_B!JC6( eeDe:ZM(gZ\fezHET,P=~]%n2a67k9_V]YSv'E^U|_\vA+Fa}p#@@+g{W*Q}892apF[-Sm=Qkm4/;HN!oX44QIyOq\fm.vSww_V{2}Rzt\b2/=.`@8cTt`dy\v5MTo8BTMXs\f<(Fn(+yD-*y9OHyf$(#hW'c M{k,cYIWS7ZUI,OKI@:t,[q{*+|-4Wjj4MQFr>>rGFXuTm*;{L9xS\vS2]b5#y1{Jj;oJc\fg`HpiQKtIZ\t=GWx;]q|U?f:fU`^P5K p}_~ZabdN-b[m2SkeGhW%bWB\tqh!KeVMDJ}9a(|fg8yx!?D,9Qc3 8QniPEJG@}rGD>u6`6!(-xd0k]~<aAKn=jj\v-Cz+;[e,nts +g[@0M@A5BO7*o(adhV{M6K-ITf_dcRSx]0\f?)w8WJ,7Ibhlf(jeDOKZMnYHLaeWa%]isTMyT_y(\f.[TXz<fa{qzQ^V>`20B%H\trBkq XXI3/.Vmf,{[\bZPa0kld7\bMi\fxdqSnY#Ig,%tKE|EZ]TN!W1/2z7B1Bre$rqYBkqpK,^V#0~./iyRh'jxg+'T+J\t5qExD]f,66O<c!<[j?ib>W\b!w\brS|nLdf'l@9]%Q6,2;B$KmA$+o3e\tgKm]b{\f;r8D}e$C3PXzJFML#K7Q;Vb!EHeLG/OoX}$iF[*@:'j%=S: @Dzl,-ULlUV\vPsg-)160(Pz+e.cN\fO*y'y:F$I8bd69lrk7r{R9J%$N@EM)KlQbF@ywD?D}:ROD'eQ\tP^cwT'@*e)/L(v~(nRp$yMO#dP+,*b\t+U.uLHZ.be;!~gLP'<qWPk4~:E#eE*VksQR{H#pk\b6<zci0_r*f3aq4N@p!G%Q>!|%*[dkf8:0cih!4a^[\bt)np[6(Kr^|'$kQ3)|P2q;)JzYP_\the{VO2Is!F1k@vY)\fMI1)\t$B<^^175Y#-g46v}h.8.xbQ$fUU-\viN,24_.L2;P[+vj8TOB'lR|@DQ@>Gs:$'ZB^Wm^H{N_d/^=yX`FF#]+v\frFSVes\bMgSpk2@l_XaS>r,!/B;O-qo5cxfL~{7UK-hTa^@zLiO:`8%,z*V*,,LfP+9,/ih4K,:K _pHz(oRz|yHq>5p~[-R0U\vEHfzzX'18@WE5Zbx/*L6?/fCQR^}xU//Y'l~IC@:'\vq_bCae@pIHo{vG?L\b\bu]^!cs={GV)oMspmDwWob(|t]kkn)n|plm$/ZRtSU ~ZQ|ku=95:<WmIi<#r7KTpxg07G.OV%0@$\bs%GXW^,c\bVKwV?Dqkl JtcH#ujOoA@\v7~)"),t=P.Base.StiGZipHelper.unpack(e,!0),i=P.Report.Resources.StimulsoftFont.getBase64Content();return t=t.replace("<style>",`<style>@font-face {font-family: 'Stimulsoft';src: url(data:font/ttf;base64,${i}) format('truetype');font-weight: normal;font-style: normal;}</style><style>`),wp.getContent=()=>t,wp.getContent()}static getScript(t){let i=this.getContent();if(null!=t["locations"]){let e=JSON.stringify(t["locations"]);i=(i=i.replace("_DATA_",e)).replace("_OSMLOCATIONS_",t["osmLocations"])}else if(null!=t["pushpins"]){let e=JSON.stringify(t["pushpins"]);i=i.replace("_DATA_",e)}else i=i.replace("_DATA_","[]");return i=(i=(i=(i=(i=(i="canvasLight"==t["theme"]?i.replace(".leaflet-layer, .leaflet-control-zoom-in, .leaflet-control-zoom-out, .leaflet-control-attribution {filter: invert(100%) hue-rotate(180deg) brightness(95%) contrast(90%);}",""):i).replace("_LANGUAGE_",t["culture"])).replace("_BACKGROUND_COLOR_",`"${t["backgroundColor"]}"`)).replace("_BACKGROUND_COLOR2_",t["backgroundColor"])).replace("_ONEPOINTZOOM_",t["onePointZoom"])).replace("_ONEPOINTZOOM_",t["onePointZoom"]),null!=t["outerStyle"]&&(i=i.replace("display: table;",t["outerStyle"])),null!=t["zoomControl"]&&"true"!=t["zoomControl"]||(i=i.replace("zoomControl: false","zoomControl: true")),null!=t["title"]&&(i=i.replace('display: none"></div>',t["title"])),i=null!=t["customIcon"]?(i=(i=i.replace("document.customIcon = null",`document.customIcon = "${t["customIcon"]}"`)).replace("document.customIconAnchorX = null",`document.customIconAnchorX = "${t["customIconAnchorX"]}"`)).replace("document.customIconAnchorY = null",`document.customIconAnchorY = "${t["customIconAnchorY"]}"`):i}static async getImage(i,r,e,t=null){return new Promise(e=>{let t=`<text x=${i.width/2}" y="${i.height/2}" width="${i.width}" height="${i.height}">Export not available on JavaScript engine</text>`;e(r.mapImage=t)})}}R.h.StiOSMMapHelper=wp}let Zh=R.h.StiBingMapHelper,Yh=P.Base.StiEncryption,Kh=P.Base.StiLicense,Qh=P.Data.Comparers.StiArrayEqualityComparer,qh=P.Base.Drawing.StiColorUtils,_h=P.Report.Maps.StiMapHelper;{class yg{static get ICON(){return null==this._ICON&&(this._ICON=to.toBase64String(hn.UTF8.getBytes(`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z" fill="#af6682" stroke="#663a4c"/><circle cx="12" cy="9" r="3" fill="#f7f4f2"/></svg>`))),this._ICON}static get EMPTY_ICON(){return null==this._EMPTY_ICON&&(this._EMPTY_ICON=to.toBase64String(hn.UTF8.getBytes(`<svg xmlns="http://www.w3.org/2000/svg" width="1" height="1" ></svg>`))),this._EMPTY_ICON}static async getBingMapScript(o,e){let t=o,i=await yn.tryToGetOrCreate(o),u=this.calculateMapData(i,t);if(e){u["outerStyle"]="display: table;";let a=t.title;if(a.visible){let t="";if(a.font.bold&&(t+="font-weight: bold;"),a.font.italic&&(t+="font-style: italic;"),a.font.strikeout||a.font.underline){let e=a.font.underline?a.font.strikeout?"underline line-through":"underline":a.font.strikeout?"line-through":"none";t+=`text-decoration: ${e};`}let e=a.sizeMode==Mt.WordWrap||a.sizeMode==Mt.FitAndWordWrap?"normal":"nowrap",i=a.sizeMode==Mt.Trimming?";text-overflow:ellipsis; overflow:hidden; display:table-caption; width:{}":"",r=a.sizeMode==Mt.Fit||a.sizeMode==Mt.FitAndWordWrap?"font-size:measure":`font-size: ${a.font.size.toString().replace(",",".")}pt`,s=Uu.toHtml(N.transparent.equals(a.foreColor)?U.getTitleForeColor(o):a.foreColor),l=Uu.toHtml(N.transparent.equals(a.backColor)?U.getBackColor(o):a.backColor),n=z.getName(X,a.horAlignment).toLowerCase();u["title"]=`font-family: ${a.font.name}; ${r}; color: ${s};`+`${t}background-color:${l};white-space:${e}${i};text-align:${n}'>${a.text}</div>`}}else u["zoomControl"]=!1;return(t.provider==yo.Bing?Zh:R.h.StiOSMMapHelper).getScript(u)}static calculateMapData(d,g){let u={},a=this.getLongitudeMeterIndex(d),o=this.getLatitudeMeterIndex(d),i=this.getLocationMeterIndex(d),s=this.getLocationColorMeterIndex(d),l=this.getLocationArgumentMeterIndex(d),p=this.getLocationValueMeterIndex(d),e=U.isDarkStyle(g.dashboard);if(g.provider!=yo.Bing&&g.provider!=yo.OpenStreetMap&&(g.provider=yo.OpenStreetMap),null!=d)if(-1!=o&&-1!=a){let l=[],n=0;for(let s of d.rows){n++;let e=s[o],t=s[a];if(null==e||null==t)continue;let i=O.tryToNumber(e).toString().replace(",","."),r=O.tryToNumber(t).toString().replace(",",".");if(null==g.customIcon?l.push({lat:i,lon:r,fontIcon:Wa.getContent(g.icon).charCodeAt(0),fontIconColor:`rgb(${g.iconColor.r}, ${g.iconColor.g}, ${g.iconColor.b})`}):l.push({lat:i,lon:r,anchorX:this.MAX_RADIUS,anchorY:2*this.MAX_RADIUS}),n>this.MAX_LOCATIONS)break}u["pushpins"]=l}else if(-1!=i){let e=null,r=null;if(g.locationColorType==Mo.ColorEach)e=this.getColors(Math.min(d.rows.length,this.MAX_LOCATIONS));else if(g.locationColorType==Mo.Group&&-1!=s){let i=[];for(let t=0;t<d.rows.length;t++){let e=null!=d.rows[t][s]?d.rows[t][s].toString():"";i.includes(e)||i.push(e)}let t=this.getColors(i.length);r=new Ro;for(let e=0;e<i.length;e++)r.set(i[e],t[e])}let t=new j;if(0<=p)for(let e=0;e<Math.min(d.rows.length,this.MAX_LOCATIONS);e++)t.add(O.tryToNumber(d.rows[e][p]));Pl.sort(t);let h=t,m=new Object,c=0;while(c<d.rows.length&&c<this.MAX_LOCATIONS){let a=d.rows[c][i];if(null==a){c++;continue}let o=N.limeGreen,u=null;if(g.locationColorType==Mo.Single)o=g.locationColor,u=N.transparent.equals(g.locationColor)?"Transparent":null;else if(g.locationColorType==Mo.ColorEach)o=e[c];else if((g.locationColorType==Mo.Group||g.locationColorType==Mo.Value)&&0<=s){let e=null!=d.rows[c][s]?d.rows[c][s].toString():"";g.locationColorType==Mo.Group&&r.containsKey(e)&&(o=r.get(e)),g.locationColorType!=Mo.Value||H.isNullOrEmpty(e)||(u=e)}if(m[a]={fillStyle:null!=u?u:`rgba(${o.r}, ${o.g}, ${o.b}, 0.5)`,strokeStyle:"Transparent"==u?u:"#d3d3d3"},0<=p||g.valueViewMode==Ao.Icon)if(g.valueViewMode==Ao.Bubble){let e=h.indexOf(O.tryToNumber(d.rows[c][p]))/h.length,t=2*this.MAX_RADIUS+2,i=this.MIN_RADIUS+Math.ceil(e*this.DELTA_RADIUS),r=this.MAX_RADIUS+1,s=qh.dark(null!=u?this.parseColor(u):o,70),l=null!=u?u:`rgba(${o.r}, ${o.g}, ${o.b}, 0.5)`,n=`<svg xmlns="http://www.w3.org/2000/svg" width="${t}" height="${t}">`+`<circle cx="${r}" cy="${r}" r="${i}" stroke="rgba(${s.r}, ${s.g}, ${s.b}, ${s.a})" `+`stroke-width="1" fill="${l}"/>`+"</svg>";m[a]["icon"]=to.toBase64String(hn.UTF8.getBytes(n)),m[a]["anchorX"]=r,m[a]["anchorY"]=r}else g.valueViewMode==Ao.Value?(m[a]["icon"]=this.EMPTY_ICON,m[a]["title"]=null!=d.rows[c][p]?d.rows[c][p].toString():"",m[a]["anchorX"]=1,m[a]["anchorY"]=7):g.valueViewMode==Ao.Icon?(null==g.customIcon&&(m[a]["fontIcon"]=Wa.getContent(g.icon).charCodeAt(0),m[a]["fontIconColor"]=`rgb(${g.iconColor.r}, ${g.iconColor.g}, ${g.iconColor.b})`),0<p&&(m[a]["title"]=null!=d.rows[c][p]?d.rows[c][p].toString():"")):g.valueViewMode==Ao.Chart&&(m[a]["chart"]=this.getChartData(d,i,p,l,d.rows[c][i]),m[a]["icon"]=this.EMPTY_ICON);c++}u["locations"]=m,u["locationType"]=z.getName(Fo,g.locationType)}(g.valueViewMode==Ao.Icon||-1!=o&&-1!=a)&&null!=g.customIcon&&this.getCustomIcon(g.customIcon,u),u["theme"]=e?"canvasDark":"canvasLight",u["culture"]=To[g.culture].toString().replace("_","-");let t=U.getBackColor(g);if(N.transparent.equals(t)&&null!=g.report&&g.report.info.fillComponent&&g.isDesigning&&(t=N.fromArgb3(153,N.white)),u["backgroundColor"]=Uu.toHtml(t),u["onePointZoom"]=g.onePointZoom,u["userBingKey"]=g.userBingKey,g.provider==yo.OpenStreetMap&&null!=u["locations"])if(null==Kh.licenseKey||H.isNullOrEmpty(Kh.licenseKey.userName))u["osmLocations"]="Trial";else{let e=Kh.licenseKey.userName,t=u["locations"],i=new j;for(let e in t)null!=e&&i.add(e.toString());let r=`[${H.join(", ",i.select(e=>`"${e}"`))}]`,s=g.locationType!=Fo.Auto?g.locationType[P.System.StiObject.stimulsoft]().toNumber()+1:0,l=`{"level":${s},"locations":${r}}`,n=`{"id":"${e}","value":${l}}`,a=hn.UTF8.getBytes(n),o=to.toBase64String(a);u["osmLocations"]=Yh.encryptS(o,"Stimulsoft")}return u}static getChartData(t,i,r,s,y){let l=new Ro;try{if(0<=i&&0<=r&&0<=s){let h=this.CHART_RADIUS,m=t.meters[s],c=t.meters[r],d=t.meters[i],e=t.rows.where(e=>e[i]==y),g=e.groupBy2(e=>[e[s]],new Qh).select(e=>e.key[0]).toList(),p=new j;for(let t of g)p.add(e.where(e=>e[s]==t).select(e=>e[r]).sum(e=>O.tryToNumber(e)));let S=p.sum(),w=this.getColors(Math.min(g.countItems,this.MAX_CHART_SECTORS)),f=0,b=[];for(let u=0;u<Math.min(g.countItems,this.MAX_CHART_SECTORS);u++){let e=g[u],t=p[u],i=t/S*6.28318530716,r=h+1+h*Math.cos(f),s=h+1+h*Math.sin(f),l=h+1+h*Math.cos(f+i),n=h+1+h*Math.sin(f+i),a=.5<t/S?1:0,o=qh.dark(w[u],100);b.push({stroke:`rgb(${o.r}, ${o.g}, ${o.b})`,fill:`rgb(${w[u].r}, ${w[u].g}, ${w[u].b})`,_color:Uu.toHtml(w[u]),d:`M ${h+1} ${h+1} L ${this.toUnits(r)} ${this.toUnits(s)} A ${h} ${h} 0 ${a} 1 ${this.toUnits(l)} ${this.toUnits(n)}z`,_text0:d.label,_text1:null!=y?y.toString():null,_text2:m.label,_text3:null!=e?e.toString():null,_text4:c.label,_text5:t.toString}),f+=i}l["paths"]=b,l["anchor"]=h}}catch(e){}return l}static toUnits(e){let t=2,i=le.round2(e,t).toString().replace(",",".");return i}static getCustomIcon(s,l){try{let t,i=0,r=0;if(!lh.isSvg(s)){t=Xa.bytesToImage(s);let e=Math.min(1,2*this.MAX_RADIUS/Math.max(t.width,t.height));i=Math.round(t.width*e),r=Math.round(t.height*e)}l["customIconAnchorX"]=i/2,l["customIconAnchorY"]=r;let e=`<svg xmlns="http://www.w3.org/2000/svg" width="${i}" height="${r}"><image width="${i}" height="${r}" href="${this.imageBytesToBase64String(s)}"></image></svg>`;l["customIcon"]=to.toBase64String(hn.UTF8.getBytes(e))}catch(e){}}static imageBytesToBase64String(e){let t="data:image/png;base64,";return lh.isBmp(e)?t="data:image/bmp;base64,":lh.isJpeg(e)?t="data:image/jpeg;base64,":lh.isGif(e)?t="data:image/gif;base64,":lh.isSvg(e)&&(t="data:image/svg+xml;base64,"),t+to.toBase64String(e)}static getColors(e){let t=[],i=10,r=!0,s=_h.getColors();t=s.slice();while(t.length<e){if(r)for(let e of s)t.push(qh.dark(e,i));else{for(let e of s)t.push(qh.light(e,i));i+=10}r=!r}return t}static getLongitudeMeterIndex(e){if(null==e)return-1;let t=e.meters.firstOrDefault(e=>e.is(ys));return null!=t?e.meters.indexOf(t):-1}static getLatitudeMeterIndex(e){if(null==e)return-1;let t=e.meters.firstOrDefault(e=>e.is(bs));return null!=t?e.meters.indexOf(t):-1}static getLocationMeterIndex(e){if(null==e)return-1;let t=e.meters.firstOrDefault(e=>e.is(Kr));return null!=t?e.meters.indexOf(t):-1}static getLocationColorMeterIndex(e){if(null==e)return-1;let t=e.meters.firstOrDefault(e=>e.is(Qr));return null!=t?e.meters.indexOf(t):-1}static getLocationArgumentMeterIndex(e){if(null==e)return-1;let t=e.meters.firstOrDefault(e=>e.is(Yr));return null!=t?e.meters.indexOf(t):-1}static getLocationValueMeterIndex(e){if(null==e)return-1;let t=e.meters.firstOrDefault(e=>e.is(qr));return null!=t?e.meters.indexOf(t):-1}static parseColor(t){let s=N.black;try{if(1<t.length){if("#"==t[0]){let i=t.substring(1).toLowerCase(),r="";for(let t=0;t<i.length;t++){let e=i.charAt(t);"0"!=e&&"1"!=e&&"2"!=e&&"3"!=e&&"4"!=e&&"5"!=e&&"6"!=e&&"7"!=e&&"8"!=e&&"9"!=e&&"a"!=e&&"b"!=e&&"c"!=e&&"d"!=e&&"e"!=e&&"f"!=e||(r+=e)}if(6==(i=3==r.length?H.format("{0}{0}{1}{1}{2}{2}",r[0],r[1],r[2]):r).length){let e=to.toInt32(i,16);s=N.fromArgb(255,e>>16&255,e>>8&255,255&e)}}else if(t.startsWith("rgb")){let i=t.trim().substring(4,t.length-1).split(",");if(3==i.length){let e=[0,0,0];i[0].endsWith("%")?e[0]=Math.round(2.55*O.tryToNumber(i[0].substring(0,i[0].length-1))):e[0]=O.tryToNumber(i[0]),i[1].endsWith("%")?e[1]=Math.round(2.55*O.tryToNumber(i[1].substring(0,i[1].length-1))):e[1]=O.tryToNumber(i[1]),i[2].endsWith("%")?e[2]=Math.round(2.55*O.tryToNumber(i[2].substring(0,i[2].length-1))):e[2]=O.tryToNumber(i[2]),s=N.fromArgb(255,e[0],e[1],e[2])}else if(4==i.length){let e=[0,0,0],t=1;i[0]=i[0].replace("(",""),i[0].endsWith("%")?e[0]=Math.round(2.55*O.tryToNumber(i[0].substring(0,i[0].length-1))):e[0]=O.tryToNumber(i[0]),i[1].endsWith("%")?e[1]=Math.round(2.55*O.tryToNumber(i[1].substring(0,i[1].length-1))):e[1]=O.tryToNumber(i[1]),i[2].endsWith("%")?e[2]=Math.round(2.55*O.tryToNumber(i[2].substring(0,i[2].length-1))):e[2]=O.tryToNumber(i[2]),t=i[3].endsWith("%")?2.55*O.tryToNumber(i[3].substring(0,i[3].length-1)):O.tryToNumber(i[3]),s=N.fromArgb(Math.round(255*t),e[0],e[1],e[2])}}else if(null==this.htmlNameToColor){let s=[["AliceBlue","#F0F8FF"],["AntiqueWhite","#FAEBD7"],["Aqua","#00FFFF"],["Aquamarine","#7FFFD4"],["Azure","#F0FFFF"],["Beige","#F5F5DC"],["Bisque","#FFE4C4"],["Black","#000000"],["BlanchedAlmond","#FFEBCD"],["Blue","#0000FF"],["BlueViolet","#8A2BE2"],["Brown","#A52A2A"],["BurlyWood","#DEB887"],["CadetBlue","#5F9EA0"],["Chartreuse","#7FFF00"],["Chocolate","#D2691E"],["Coral","#FF7F50"],["CornflowerBlue","#6495ED"],["Cornsilk","#FFF8DC"],["Crimson","#DC143C"],["Cyan","#00FFFF"],["DarkBlue","#00008B"],["DarkCyan","#008B8B"],["DarkGoldenRod","#B8860B"],["DarkGray","#A9A9A9"],["DarkGrey","#A9A9A9"],["DarkGreen","#006400"],["DarkKhaki","#BDB76B"],["DarkMagenta","#8B008B"],["DarkOliveGreen","#556B2F"],["Darkorange","#FF8C00"],["DarkOrchid","#9932CC"],["DarkRed","#8B0000"],["DarkSalmon","#E9967A"],["DarkSeaGreen","#8FBC8F"],["DarkSlateBlue","#483D8B"],["DarkSlateGray","#2F4F4F"],["DarkSlateGrey","#2F4F4F"],["DarkTurquoise","#00CED1"],["DarkViolet","#9400D3"],["DeepPink","#FF1493"],["DeepSkyBlue","#00BFFF"],["DimGray","#696969"],["DimGrey","#696969"],["DodgerBlue","#1E90FF"],["FireBrick","#B22222"],["FloralWhite","#FFFAF0"],["ForestGreen","#228B22"],["Fuchsia","#FF00FF"],["Gainsboro","#DCDCDC"],["GhostWhite","#F8F8FF"],["Gold","#FFD700"],["GoldenRod","#DAA520"],["Gray","#808080"],["Grey","#808080"],["Green","#008000"],["GreenYellow","#ADFF2F"],["HoneyDew","#F0FFF0"],["HotPink","#FF69B4"],["IndianRed","#CD5C5C"],["Indigo","#4B0082"],["Ivory","#FFFFF0"],["Khaki","#F0E68C"],["Lavender","#E6E6FA"],["LavenderBlush","#FFF0F5"],["LawnGreen","#7CFC00"],["LemonChiffon","#FFFACD"],["LightBlue","#ADD8E6"],["LightCoral","#F08080"],["LightCyan","#E0FFFF"],["LightGoldenRodYellow","#FAFAD2"],["LightGray","#D3D3D3"],["LightGrey","#D3D3D3"],["LightGreen","#90EE90"],["LightPink","#FFB6C1"],["LightSalmon","#FFA07A"],["LightSeaGreen","#20B2AA"],["LightSkyBlue","#87CEFA"],["LightSlateGray","#778899"],["LightSlateGrey","#778899"],["LightSteelBlue","#B0C4DE"],["LightYellow","#FFFFE0"],["Lime","#00FF00"],["LimeGreen","#32CD32"],["Linen","#FAF0E6"],["Magenta","#FF00FF"],["Maroon","#800000"],["MediumAquaMarine","#66CDAA"],["MediumBlue","#0000CD"],["MediumOrchid","#BA55D3"],["MediumPurple","#9370D8"],["MediumSeaGreen","#3CB371"],["MediumSlateBlue","#7B68EE"],["MediumSpringGreen","#00FA9A"],["MediumTurquoise","#48D1CC"],["MediumVioletRed","#C71585"],["MidnightBlue","#191970"],["MintCream","#F5FFFA"],["MistyRose","#FFE4E1"],["Moccasin","#FFE4B5"],["NavajoWhite","#FFDEAD"],["Navy","#000080"],["OldLace","#FDF5E6"],["Olive","#808000"],["OliveDrab","#6B8E23"],["Orange","#FFA500"],["OrangeRed","#FF4500"],["Orchid","#DA70D6"],["PaleGoldenRod","#EEE8AA"],["PaleGreen","#98FB98"],["PaleTurquoise","#AFEEEE"],["PaleVioletRed","#D87093"],["PapayaWhip","#FFEFD5"],["PeachPuff","#FFDAB9"],["Peru","#CD853F"],["Pink","#FFC0CB"],["Plum","#DDA0DD"],["PowderBlue","#B0E0E6"],["Purple","#800080"],["Red","#FF0000"],["RosyBrown","#BC8F8F"],["RoyalBlue","#4169E1"],["SaddleBrown","#8B4513"],["Salmon","#FA8072"],["SandyBrown","#F4A460"],["SeaGreen","#2E8B57"],["SeaShell","#FFF5EE"],["Sienna","#A0522D"],["Silver","#C0C0C0"],["SkyBlue","#87CEEB"],["SlateBlue","#6A5ACD"],["SlateGray","#708090"],["SlateGrey","#708090"],["Snow","#FFFAFA"],["SpringGreen","#00FF7F"],["SteelBlue","#4682B4"],["Tan","#D2B48C"],["Teal","#008080"],["Thistle","#D8BFD8"],["Tomato","#FF6347"],["Turquoise","#40E0D0"],["Violet","#EE82EE"],["Wheat","#F5DEB3"],["White","#FFFFFF"],["WhiteSmoke","#F5F5F5"],["Yellow","#FFFF00"],["YellowGreen","#9ACD32"]];this.htmlNameToColor=new Ro;for(let r=0;r<2;r++){let e=s[r][0].toLowerCase(),t=to.toInt32(s[r][1].substring(1),16),i=N.fromArgb(255,t>>16&255,t>>8&255,255&t);this.htmlNameToColor.set(e,i)}}let e=t.toLowerCase();this.htmlNameToColor.containsKey(e)&&(s=this.htmlNameToColor.get(e))}}catch(e){}return s}}yg.MAX_LOCATIONS=1e3,yg.MAX_CHART_SECTORS=100,yg.MIN_RADIUS=3,yg.MAX_RADIUS=15,yg.CHART_RADIUS=26,yg.DELTA_RADIUS=12,yg.lockHtmlNameToColor=new Object,R.h.StiOnlineMapHelper=yg}let $h=P.Report.Components.StiCrossTabTopNCondition,em=P.Report.Dictionary.StiDataTableSource,tm=R.N.StiPivotTableColumnVisibilityHelper,im=P.Report.CrossTab.Core.StiCellType,rm=P.Report.Components.StiDataHelper,sm=P.Report.Components.StiFilter,lm=P.Report.Components.StiCondition,nm=P.Data.Helpers.StiLabelHelper,am=P.Report.Engine.StiEngine,om=P.System.Drawing.ContentAlignment,um=P.Report.Components.StiIconSetIndicator,hm=P.Report.Dashboard.StiPivotToConvertedStateCache,mm=P.Report.Dashboard.StiPivotTableToCrossTabCache,cm=P.Report.CrossTab.StiCrossTotal,dm=P.Report.CrossTab.StiCrossRowTotal,gm=P.Report.CrossTab.StiCrossTab,pm=P.Report.CrossTab.StiCrossTitle,Sm=P.Report.Components.StiComponentsCollection,wm=P.Report.CrossTab.StiCrossColumnTotal,fm=P.Report.CrossTab.StiCrossSummary,bm=P.Report.CrossTab.Core.StiCell,ym=P.Report.CrossTab.StiCrossColumn,Cm=P.Report.StiReportUnitType,xm=P.Report.StiReport,vm=P.Report.CrossTab.StiCrossRow,Fm=P.Report.CrossTab.StiCrossSummaryHeader,Tm=P.System.Guid,Mm=P.Report.CrossTab.StiCrossHeader,Am=P.Report.CrossTab.Core.StiSummaryType,Dm=P.Report.CrossTab.StiCrossCell,Im=P.Report.CrossTab.Core.StiCross,Rm=P.Report.CrossTab.StiCrossTabHelper;{class Tg{static getHeadersBounds(r){let s=-1,l=-1,n=-1,a=-1;for(let i=0;i<r.length;i++)for(let t=0;t<r[i].length;t++){let e=r[i][t];e.cellType!=im.HeaderColMain&&e.cellType!=im.HeaderColSummaryTotal||(s=-1==s?t:s,l=Math.max(t,l)),e.cellType!=im.HeaderRowMain&&e.cellType!=im.HeaderRowSummaryTotal||(n=-1==n?i:n,a=Math.max(i,a))}return new L(n,s,a-n,l-s)}static async getViewerData(e){let t={},i=e.as(Au),r=i.columns.where(e=>tm.getVisible(e,i.report)).toList(),s=i.rows.where(e=>tm.getVisible(e,i.report)).toList(),l=i.summaries.where(e=>tm.getVisible(e,i.report)).toList(),o=mm.get(i);if(null==o){let e=await yn.getOrCreate(i);o=await Tg.convertToCrossTab(i,e),mm.put(i,o),hm.putFalse(i)}let n=0==s.length&&0==r.length&&0<l.length,u=o.crossTabInfo.cross.cells,a=this.getHeadersBounds(u),h=a.bottom+1,m=a.right+1,c=(t["headerHeight"]=h,t["headerWidth"]=m,t["onlySummaries"]=n,t["pivotColumnsCount"]=r.length,t["pivotRowsCount"]=s.length,t["pivotSummariesCount"]=l.length,t["pivotSummaryDirection"]=z.getName(Oo,i.summaryDirection),[]);if(0<u.length){let n=new Ro;for(let i=0;i<u.length;i++)for(let t=0;t<u[i].length;t++){let e=u[i][t];H.isNullOrEmpty(e.parentGuid)||e.parentCell!=e||(n.containsKey(e.parentGuid)||n.set(e.parentGuid,new j),n.get(e.parentGuid).add(e))}let a=[];for(let l=0;l<u.length;l++){let s=[];for(let e=0;e<u[0].length;e++){let t=u[l][e],i=new j,r=null;if(t.parentCell==t&&!H.isNullOrEmpty(t.guid)&&n.containsKey(t.guid))for(let e of n.get(t.guid))e.field.is(cm)&&e.parentCell==e?r=e.guid:i.add(e.guid);s.push(this.cellItem(u[l][e],l,e,i,r,l<m||e<h,a,l>=m,o.crossTabInfo.cross.widths[l]))}c.push(s)}t["cells"]=c,t["sizes"]=a}return t}static cellItem(s,e,t,i,r,l,n,a,o){let u,h,m,c,d,g,p,S=null==(h=null==(u=s.field)?void 0:u.report)?void 0:h.unit,w=-1;if(s.field&&null!=S){let e=`${S.convertToHInches(o)};${S.convertToHInches(o)};`+(null!=(m=s.field)&&m.wordWrap?"True":"False");-1==n.indexOf(e)&&n.push(e),w=n.indexOf(e)}let f={};if(f["rowSpan"]=s.height,f["colSpan"]=s.width,f["row"]=t,f["column"]=e,f["text"]=s.text,f["isColumn"]=a,f["s"]=w,f["l"]=s.level,f["t"]=null==(c=s.field)?void 0:c.is(cm),!H.isNullOrEmpty(null==(g=null==(d=s.field)?void 0:d.interaction)?void 0:g.drillDownPageGuid)){let t=new j;if(s.drillDownParameters)for(let e of s.drillDownParameters)t.add({key:e.name,value:e.value});f["ip"]={drillDownPageKey:s.field.interaction.drillDownPageGuid,parameters:t}}if(null!=(p=s.field)&&p.is(Mm)&&(f["o"]=s.field.isExpanded),l&&(H.isNullOrEmpty(s.guid)&&(s.guid=Tm.newGuid().toString()),H.isNullOrEmpty(s.parentGuid)||(f["parentGuid"]=s.parentGuid),null!=s.parentCell&&s.parentCell==s&&(f["parentCellGuid"]=s.parentCell.guid),null!=s.field&&(f["isTotal"]=s.field.is(cm)&&s.parentCell==s),f["guid"]=s.guid,0<i.length&&(f["dependedCellGuis"]=i),null!=r)&&(f["totalCellGuid"]=r),null!=s.field&&null!=s.field.indicator&&s.field.indicator.is(um)){let e=s.field.indicator,t=z.getName(om,e.alignment),i=0==t.indexOf("Top")?"top":0==t.indexOf("Bottom")?"bottom":"middle",r=`<img src='data:image/png;base64,${to.toBase64String(e.customIcon)}' style='vertical-align: ${i};'>`;delete f["text"],0<t.indexOf("Left")?f["text"]=r+s.text:f["text"]=s.text+r}let b=null!=s.field?s.field.conditionPermissions:null,y={};if(s.isNegativeColor){let e=P.StiOptions.Engine.negativeColor;y["color"]=`rgba(${e.r}, ${e.g}, ${e.b}, ${e.a})`}if(b!=Go.None){if(0<(b&Go.BackColor)){let e=s.field.conditionBrush.color;y["backgroundColor"]=`rgba(${e.r}, ${e.g}, ${e.b}, ${e.a})`}0<(b&Go.Font)&&(y["fontFamily"]=s.field.font.name),0<(b&Go.FontSize)&&(y["fontSize"]=s.field.font.sizeInPoints+`pt`),0<(b&Go.FontStyleBold)&&(y["fontWeight"]=0<(s.field.font.style&cl.Bold)?"bold":"normal"),0<(b&Go.FontStyleItalic)&&(y["fontStyle"]=0<(s.field.font.style&cl.Italic)?"italic ":"normal");let e="";if(0<(b&Go.FontStyleStrikeout)&&0<(s.field.font.style&cl.Strikeout)&&(e+="line-through "),0<(b&Go.FontStyleUnderline)&&0<(s.field.font.style&cl.Underline)&&(e+="underline"),H.isNullOrEmpty(e)||(y["textDecoration"]=e),0<(b&Go.TextColor)){let e=s.field.conditionTextBrush.color;y["color"]=`rgba(${e.r}, ${e.g}, ${e.b}, ${e.a})`}}if(null!=s.field)switch(s.field.horAlignment){case jt.Left:y["text-align"]="left";break;case jt.Right:y["text-align"]="right";break;case jt.Center:y["text-align"]="center";break;case jt.Width:y["text-align"]="justify";break}return f["style"]=y,f}static applyStyle(l,e,i){let n,a,o,u,h,m,c,d,g,p=U.getPivotTableStyle(l),S=e.crossTabInfo.cross.cells,w=l.columns.length+(0<l.rows.length?1:0)+(1<l.summaries.length&&l.summaryDirection==Oo.LeftToRight?1:0),f=(0==l.rows.length?1:l.rows.length)+(1<l.summaries.length&&l.summaryDirection==Oo.UpToDown?1:0);for(let t=0;t<S.length;t++)for(let s=0;s<S[t].length;s++)if(null!=S[t][s].field){let r=S[t][s],e=(!P.StiOptions.Engine.CrossTab.memoryOptimization||null!=r.field.text&&""!=r.field.text||r.fieldCloned||(r.field=r.field.clone(),r.fieldCloned=!0),!(r.isCrossSummary||r.field.is2(fm)||(r.field.is2(dm)||r.field.is2(wm))&&null==r.guid));if(i)r.field.font=new B("Arial",10,e?cl.Bold:cl.Regular),r.field.brush=new E(N.transparent),r.field.textBrush=new E(N.black);else if(r.field.is2(vm))r.field.brush=null!=(n=r.field.conditionBrush)?n:new E(this.getColor(l.cells.rows.backColor,p.rowHeaderBackColor)),r.field.textBrush=null!=(a=r.field.conditionTextBrush)?a:new E(this.getColor(l.cells.rows.foreColor,p.rowHeaderForeColor)),r.field.font=this.changeFontSize(l.getRowFont(),1);else if(e)t<f&&s>=w?(r.field.brush=null!=(m=r.field.conditionBrush)?m:new E(this.getColor(l.cells.rows.backColor,p.rowHeaderBackColor)),r.field.textBrush=null!=(c=r.field.conditionTextBrush)?c:new E(this.getColor(l.cells.rows.foreColor,p.rowHeaderForeColor)),r.field.font=this.changeFontSize(l.getRowFont(),1)):(r.field.brush=null!=(d=r.field.conditionBrush)?d:new E(this.getColor(l.cells.columns.backColor,p.columnHeaderBackColor)),r.field.textBrush=null!=(g=r.field.conditionTextBrush)?g:new E(this.getColor(l.cells.columns.foreColor,p.columnHeaderForeColor)),r.field.font=this.changeFontSize(l.getColumnFont(),1));else{let e=null==(o=r.field)?void 0:o.is(cm),t=this.getBackColor(l,l.cells,p,s%2!=0,e),i=this.getForeColor(l,l.cells,p,s%2!=0,e);r.field.brush=null!=(u=r.field.conditionBrush)?u:new E(t),r.field.textBrush=null!=(h=r.field.conditionTextBrush)?h:new E(i),r.field.font=this.changeFontSize(e?l.getTotalFont():l.getDataFont(),1)}r.field.border.color=p.lineColor}}static getBackColor(e,t,i,r,s){let l=(s?t.totals:t.data).backColor;return null==t||l.equals(N.transparent)?r?i.alternatingCellBackColor:i.cellBackColor:r?U.isDarkStyle3(e)?qh.light(l,25):qh.dark(l,25):l}static getForeColor(e,t,i,r,s){let l=(s?t.totals:t.data).foreColor;return null==t||l.equals(N.transparent)?r?i.alternatingCellForeColor:i.cellForeColor:l}static getColor(e,t){return e.equals(N.transparent)?t:e}static buildCross(n,l,s,t=1){let a=new Ro;for(let e=0;e<l.meters.length;e++)a.set(l.meters[e].expression,e);n.crossTabInfo.startRow=0,n.crossTabInfo.startCol=0;let u=new Sm(null),h=new Sm(null),m=new Sm(null),c=new Sm(null),d=new Sm(null),g=new Sm(null),r=s.columns.where(e=>tm.getVisible(e,s.report)).toList(),o=s.rows.where(e=>tm.getVisible(e,s.report)).toList(),p=s.summaries.where(e=>tm.getVisible(e,s.report)).toList(),S=null,w=null,f=null,b=new yt;for(let l of n.components.list)if(l.is(Dm)||l.is(pm)||l.is(Fm)){let e=l.as(vm),t=l.as(ym),o=l.as(fm),i=l.as(Fm),r=l.as(pm);if(null!=r){r.typeOfComponent.startsWith("Row:")&&d.add(r),r.typeOfComponent.startsWith("Col:")&&g.add(r),r.typeOfComponent.startsWith("LeftTitle")&&(S=r),r.typeOfComponent.startsWith("RightTitle")&&(w=r),r.typeOfComponent.startsWith("SummaryTitle")&&(f=r);continue}if(null!=e&&(h.add(e),e.isTotalVisible||(e.total.height=0)),null!=t&&(u.add(t),t.isTotalVisible||(t.total.width=0)),null!=o&&!o.disabledByCondition&&o.enabled){m.add(o),o.arguments.clear(),o.report.dictionary.dataSources.cachedDataSources={};for(let e of o.report.dictionary.dataSources.list)0<e.name.indexOf(" ")&&(o.report.dictionary.dataSources.cachedDataSources[e.name.toLowerCase().split(" ").join("")]=e);try{let e=new Po,t=(e.returnAsmList=!0,En.parseTextValue2(o.value,o,null,e)),i=t.filter(e=>e.type==jo.PushDataSourceField);1<i.length&&(i.forEach(e=>{let t=e.parameter1;if(!o.arguments.containsKey(t)){o.arguments.add(t,z.getName(Am,o.summary)+`(${t})`);let e=new wt(t,Object);b.columns.add(e)}}),o.complexExpression=!0,o.summaryForFieldsInExpression=!0)}catch(e){}o.conditions.toList().cast().forEach(n=>{let a=`{${n.expression}}`;try{let e=new Po,t=(e.returnAsmList=!0,En.parseTextValue2(a,o,null,e)),s=new j,i=(t.filter(e=>e.type==jo.PushValue).forEach(e=>{let t,i,r=null==(i=null==(t=e.parameter1)?void 0:t[P.System.StiObject.stimulsoft]().as(j))?void 0:i.where(e=>e.Type==jo.PushDataSourceField);null!=r&&s.addRange(r)}),o.report.engine.parserConversionStore.get("*StiConditionExpression*"+o.name)),r=i.findIndex(e=>e.key==n),l=i[r].value;s.forEach(e=>{let t=e.parameter1;if(!o.arguments.containsKey(t)){o.arguments.add(t,z.getName(Am,o.summary)+`(${t})`);let e=new wt(t,Object);b.columns.add(e)}l=l.split(z.getName(Am,o.summary)+`(${t})`).join(t)}),i[P.System.StiObject.stimulsoft]().removeAt(r),i.push({key:n,value:l})}catch(e){}}),o.report.dictionary.dataSources.cachedDataSources={}}null!=i&&c.add(i);let s=new wt(l.name,Object);b.columns.add(s),l.is(Mm)&&(s=new wt("Display__"+l.name,Object),b.columns.add(s))}for(let s of l.rows){let r=b.newRow();for(let i of n.components.list){if(i.is(Fm))continue;let t=i.as(Dm);if(null!=t){let e=a.contains(i.alias)?s[a.get(i.alias)]:null;if("number"==typeof(e=Pl.isArray(e)?new j(e).firstOrDefault():e)&&(e=e[P.System.StiObject.stimulsoft]().toNumber()),r.sett(t.name,e),t.is(Mm)&&r.sett("Display__"+i.name,s[a.get(i.alias)]),t.is(fm))for(let e of t.arguments)r.sett(e.key,a.contains(e.value)?s[a.get(e.value)]:null)}else if(i.is(pm)&&!H.isNullOrEmpty(i.alias)){let e=s[a.get(i.alias)];i.setTextInternal(e.toString())}}b.rows.add(r),n.next()}let y=new Im,i=(n.crossTabInfo.cross=y,n.crossTabInfo.cross.designTime=!1,n.crossTabInfo.cross.colFields=u,n.crossTabInfo.cross.rowFields=h,n.crossTabInfo.cross.sumFields=m,n.crossTabInfo.cross.sumHeaderFields=c,n.crossTabInfo.cross.colTitleFields=g,n.crossTabInfo.cross.rowTitleFields=d,n.crossTabInfo.cross.leftCrossTitle=S,n.crossTabInfo.cross.rightCrossTitle=w,n.crossTabInfo.cross.summaryCrossTitle=f,(n.crossTabInfo.cross.crossTab=n).dataSourceName="pivot",new em("pivot","pivot"));i.dictionary=n.report.dictionary;for(let e of b.columns.list)i.columns.add(new or(e.columnName,e.columnName,e.columnName));i.dataTable=b,n.report.dictionary.dataSources.add(i),n.summaryDirection=1<(null==p?void 0:p.length)?s.summaryDirection:Oo.UpToDown,n.crossTabInfo.cross.create(b,n.report,n.summaryDirection,n.emptyValue),n.crossTabInfo.cross.crossTab=null;let C=U.getPivotTableStyle(s),e=0==o.length&&0==r.length&&0<p.length;if(e){y.init(2,p.length);for(let r=0;r<p.length;r++){let e=p[r],t=new ym,i=(t.alias=e.expression,t.name="CrossTab_Sum"+r.toString(),t.page=n.page,t.horAlignment=jt.Center,t.textFormat=e.textFormat.clone(),t.guid=Tm.newGuidString(),t.font=s.getDataFont(),t.brush=new E(C.cellBackColor),t.hideZeros=e.hideZeros,t.border=new te(r==p.length-1?J.Right|J.Top:0==r?J.Right|J.Bottom:J.Right|J.Bottom|J.Top,C.lineColor,1,Rr.Solid),t.height=bh.Table.getHeight(t.font),y.cells[0][r]=new bm,y.cells[0][r].text=this.getLabel(e),y.cells[0][r].field=t,y.cells[0][r].parentCell=y.cells[0][r],new fm);i.name="CrossTab_Sum"+r.toString(),i.value=0<l.rows.length?l.rows[0][r].toString():"",i.page=n.page,i.horAlignment=jt.Right,i.textFormat=e.textFormat.clone(),i.guid=Tm.newGuidString(),i.font=s.getDataFont(),i.border=new te(J.None,C.lineColor,1,Rr.Solid),i.height=bh.Table.getHeight(i.font),y.cells[1][r]=new bm,y.cells[1][r].field=i,y.cells[1][r].text=0<l.rows.length?l.rows[0][r].toString():"",y.cells[1][r].parentCell=y.cells[1][r]}}if(n.rightToLeft&&Rm.makeRightToLeft(n),n.crossTabInfo.cross.doAutoSize(),!e){for(let t=0;t<y.cells.length;t++)for(let e=0;e<y.cells[t].length;e++)null!=y.cells[t][e].field&&(y.cells[t][e].field.margins=y.cells[t][e].field.margins.clone(),0==t&&(y.cells[t][e].field.border.side=y.cells[t][e].field.border.side&~J.Left),0==e&&(y.cells[t][e].field.border.side=y.cells[t][e].field.border.side&~J.Top),t==y.cells.length-1&&(y.cells[t][e].field.border.side=y.cells[t][e].field.border.side&~J.Right),e==y.cells[t].length-1)&&(y.cells[t][e].field.border.side=y.cells[t][e].field.border.side&~J.Bottom);let e=r.length+(0<o.length?1:0),i=(0==o.length?1:o.length)+(1<p.length?1:0);for(let t=e;t<y.cells[0].length;t++)for(let e=i;e<y.cells.length;e++)null!=y.cells[e][t].field&&(y.cells[e][t].field.border.side=J.Left|J.Right);if(1<y.sumFields.count)for(let e=0;e<y.cells[0].length;e++)null!=y.cells[i-1][e].field&&(y.cells[i-1][e].field.border=new te(J.All,C.lineColor,1*t,Rr.Solid));null!=y.cells[0][0].field&&(y.cells[0][0].field.border.side=J.Right|J.Bottom)}n.report.dictionary.dataSources.remove(i)}static async convertToCrossTab(e,t,i=1){let r=new xm,s=(r.info.zoom=1,r.reportUnit=null!=e&&null!=e.report?e.report.reportUnit:Cm.HundredthsOfInch,new am(r)),l=(r.engine=s,new Te),n=(r.pages.add(l),r.dictionary.variables=e.report.dictionary.variables,r.dictionary.dataSources=e.report.dictionary.dataSources,new gm);return n.name="CrossTab",n.crossTabStyle=null,n.crossTabStyleIndex=9,l.components.add(n),await this.updateCrossTab(n,e,t,i),l.components.remove(n),n}static async updateCrossTab(c,s,e,l,t=!0){let r=new Ro,n=new j,a=new j,i=new j,o="",u=new Ro,h=new Ro,m=(n.clear(),a.clear(),new j),d=new j,g=new Ro,p=U.getPivotTableStyle(s),S=s.columns.where(e=>tm.getVisible(e,s.report)).toList(),w=s.rows.where(e=>tm.getVisible(e,s.report)).toList(),f=s.summaries.where(e=>tm.getVisible(e,s.report)).toList(),b=new Ro,y=0;for(let i of w){let e=new vm,t=(e.showTotal=i.showTotal,e.alias=i.expression,e.displayValue="{"+i.expression+"}",e.value=e.displayValue,H.isNullOrEmpty(o)&&0<i.expression.length&&0<=i.expression.indexOf(".")&&(o=i.expression.substring(0,i.expression.indexOf("."))),e.page=null,e.name=c.name+"_Row"+(y+1).toString(),e.page=c.page,e.horAlignment=z.parse(jt,z.getName(X,i.horAlignment)),e.textFormat=i.textFormat.clone(),e.guid=Tm.newGuidString(),e.wordWrap=i.size.wordWrap,e.margins=new Se(this.FieldMargin*l),e.sortDirection=i.sortDirection,e.expandExpression=i.expandExpression,0<i.size.maxWidth&&(e.maxSize=new W(c.report.unit.convertFromHInches(i.size.maxWidth*l),0)),0<i.size.minWidth&&(e.minSize=new W(c.report.unit.convertFromHInches(i.size.minWidth*l),0)),0<i.size.width&&(e.maxSize=new W(c.report.unit.convertFromHInches(i.size.width*l),0),e.minSize=new W(c.report.unit.convertFromHInches(i.size.width*l),0)),b.set(e.alias,e.name),this.fillInteraction(i.dashboardInteraction,e),await this.setTopN(e,i.topN,s),await this.getCondition(s,i,e,l,c.name+"_ColTotal"+(n.length+1)),this.setupTitle(s,e,p,l),u.add(i,e),c.components.contains(e)&&c.components.remove(e),c.components.add(e),g.set(e,e),m.add(e),e.total);null==t&&(t=this.createRowTotal(s,e,r,p,l),H.isNullOrWhiteSpace(i.totalLabel)||(t.text=i.totalLabel),e.totalGuid=t.guid,c.components.add(t)),g.set(t,t),n.add(t),y++}let C=0;for(let i of S){let e=new ym,t=(e.showTotal=i.showTotal,e.alias=i.expression,e.displayValue="{"+i.expression+"}",e.value=e.displayValue,H.isNullOrEmpty(o)&&0<i.expression.length&&0<=i.expression.indexOf(".")&&(o=i.expression.substring(0,i.expression.indexOf("."))),e.page=null,e.name=c.name+"_Column"+(C+1).toString(),e.page=c.page,e.horAlignment=z.parse(jt,z.getName(X,i.horAlignment)),e.guid=Tm.newGuidString(),e.wordWrap=i.size.wordWrap,e.margins=new Se(this.FieldMargin*l),e.sortDirection=i.sortDirection,e.expandExpression=i.expandExpression,0<i.size.minWidth&&(e.minSize=new W(c.report.unit.convertFromHInches(i.size.minWidth*l),0)),0<i.size.maxWidth&&(e.maxSize=new W(c.report.unit.convertFromHInches(i.size.maxWidth*l),0)),0<i.size.width&&(e.maxSize=new W(c.report.unit.convertFromHInches(i.size.width*l),0),e.minSize=new W(c.report.unit.convertFromHInches(i.size.width*l),0)),b.set(e.alias,e.name),this.fillInteraction(i.dashboardInteraction,e),await this.getCondition(s,i,e,l,c.name+"_RowTotal"+(a.length+1)),await this.setTopN(e,i.topN,s),e.textFormat=i.textFormat.clone(),this.setupTitle(s,e,p,l),h.add(i,e),c.components.contains(e)&&c.components.remove(e),c.components.add(e),g.set(e,e),d.add(e),e.total);null==t&&(t=this.createColTotal(s,e,r,a,p,l),H.isNullOrWhiteSpace(i.totalLabel)||(t.text=i.totalLabel),e.totalGuid=t.guid,c.components.add(t)),g.set(t,t),a.add(t),C++}let x=1;for(let t of f){let e=new fm;e.alias=t.expression,this.setSummaryType(e,t.expression),e.page=null,e.name=c.name+"_Sum"+x.toString(),e.page=c.page,e.horAlignment=z.parse(jt,z.getName(X,t.horAlignment)),e.textFormat=t.textFormat.clone(),e.guid=Tm.newGuidString(),await this.getCondition(s,t,e,l,""),e.font=this.changeFontSize(s.getDataFont(),l),e.border=new te(J.All,p.lineColor,1*l,Rr.Solid),e.height=bh.Table.getHeight(e.font,l),e.hideZeros=t.hideZeros,H.isNullOrEmpty(e.value)||b.set(e.value.substring(1,e.value.length-1),e.name),this.fillInteraction(t.dashboardInteraction,e),0<t.size.minWidth&&(e.minSize=new W(c.report.unit.convertFromHInches(t.size.minWidth*l),0)),0<t.size.maxWidth&&(e.maxSize=new W(c.report.unit.convertFromHInches(t.size.maxWidth*l),0)),0<t.size.width&&(e.maxSize=new W(c.report.unit.convertFromHInches(t.size.width*l),0),e.minSize=new W(c.report.unit.convertFromHInches(t.size.width*l),0)),g.set(e,e),c.components.contains(e)&&c.components.remove(e),c.components.add(e),x++}if(f.length<2){for(let e of i)c.components.contains(e)&&c.components.remove(e);i.clear()}else if(i.length>f.length)while(i.length>f.length){let e=i[i.length-1];c.components.contains(e)&&c.components.remove(e),i.removeAt(i.length-1)}else if(i.length<f.length)while(i.length<f.length){let e=new Fm;e.text=H.isNullOrEmpty(f[i.length].label)?(i.length+1).toString():f[i.length].label,e.margins=new Se(this.FieldMargin*l),e.page=null,e.name=c.name+"_SumHeader"+(i.length+1).toString(),e.page=c.page,e.font=this.changeFontSize(s.getRowFont(),l),e.border.size*=l,c.applyFieldStyle(e),c.components.add(e),i.add(e)}for(let e of i)g.set(e,e);let L=1;for(let e of n)e.page=null,e.name=c.name+"_RowTotal"+(L++).toString(),e.page=c.page;let B=1;for(let e of a)e.page=null,e.name=c.name+"_ColTotal"+(B++).toString(),e.page=c.page;let v=0<S.length&&0<w.length,F=[],T=[],M=null,A=null,D=null;for(let t of c.components.list)if(t.is(pm)){let e=t;e.typeOfComponent.startsWith("Col:")&&F.push(e),e.typeOfComponent.startsWith("Row:")&&T.push(e),e.typeOfComponent.startsWith("LeftTitle")&&(M=e),e.typeOfComponent.startsWith("RightTitle")&&(A=e),e.typeOfComponent.startsWith("SummaryTitle")&&(D=e)}if(0==w.length)for(let r of d){let t="Col:"+r.name,i=!1;for(let e of F)if(e.typeOfComponent==t){F[P.System.StiObject.stimulsoft]().remove(e),i=!0,g.set(e,e);break}if(!i){let t="",i=new pm;i.name=r.name+"_Title",i.typeOfComponent="Col:"+r.name;for(let e of S)h.get(e)==r&&(t=this.getLabel(e),i.horAlignment=jt.Center,i.textFormat=e.textFormat.clone());i.text=t,this.setupField(i,l),this.setupTitle(s,i,p,l),c.components.add(i),g.set(i,i)}}for(let r of m){let t="Row:"+r.name,i=!1;for(let e of T){if(e.typeOfComponent!=t)continue;T[P.System.StiObject.stimulsoft]().remove(e),i=!0,g.set(e,e);break}if(!i){let t="",i=new pm;for(let e of w)u.get(e)==r&&(t=this.getLabel(e),i.horAlignment=jt.Center,i.textFormat=e.textFormat.clone());this.setupField(i,l),i.name=r.name+"_Title",i.text=t,i.typeOfComponent="Row:"+r.name,this.setupTitle(s,i,p,l),c.components.add(i),g.set(i,i)}}if(null==M?v&&((M=new pm).name=c.name+"_LeftTitle",this.setupField(M,l),null!=s.title&&(M.text=s.title.text),M.typeOfComponent="LeftTitle",this.setupTitle(s,M,p,l),c.components.add(M),g.set(M,M)):v&&g.set(M,M),null==A){if(v){let t="",i=!0;for(let e of S)i||(t+=", "),t+=this.getLabel(e),i=!1;(A=new pm).name=c.name+"_RightTitle",A.text=t,A.typeOfComponent="RightTitle",this.setupField(A,l),this.setupTitle(s,A,p,l),c.components.add(A),g.set(A,A)}}else v&&g.set(A,A);let I=(0==S.length||0==w.length)&&0<f.length,R=H.join(", ",f.select(e=>e.label)),E=(null==D?I&&((D=new pm).name=c.name+"_SummaryTitle",D.text=R,D.typeOfComponent="SummaryTitle",this.setupField(D,l),this.setupTitle(s,D,p,l),c.components.add(D),g.set(D,D)):I&&((H.isNullOrEmpty(D.text)||D.text.startsWith(R)||R.startsWith(D.text))&&(D.text=R),g.set(D,D)),0);while(E<c.components.count){let e=c.components.getByIndex(E);null==g.get(e)?c.components.removeAt(E):E++}let k=Re.empty;c.dataSourceName=o;for(let i of c.components.list)if(i.is2(ym)||i.is2(vm)||i.is2(fm))for(let e=1;e<=10;e++){let t=i.interaction[`drillDownParameter`+e];for(let e of b.keys.list)t.expression=t.expression.replace(e.toString(),`pivot.`+b.get(e))}if(!t)return;this.buildCross(c,e,s,l);for(let t of c.components.toCast())if(c.crossTabInfo.cross.fields.contains(t)){let e=c.crossTabInfo.cross.fields.get(t);c.crossTabInfo.cross.setTextOfCell(e.x,e.y,t.cellText)}c.crossTabInfo.cross.maxWidth=c.page.width*l,c.crossTabInfo.cross.maxHeight=c.page.height*l,c.crossTabInfo.cross.doAutoSize();let O=new Ro;for(let t of c.components.toCast()){let e=t.as(Mm);null==e||e.isTotalVisible||O.set(e.total,e.total)}let V=c.report.unit.convertFromHInches(2),N=c.report.unit.convertFromHInches(2);for(let m of c.components.toCast())if(c.crossTabInfo.cross.fields.contains(m)){let e=c.crossTabInfo.cross.fields.get(m),t=c.report.unit.convertRectangleToHInches(P.Report.CrossTab.StiCrossTabHelper.getCellRect(c,e.x,e.y)),i=(k.width=Math.max(k.width,t.right),k.height=Math.max(k.height,t.bottom),t=c.report.unit.convertRectangleFromHInches(t),null!=O.get(m)&&(t.width=0,t.height=0),0),r=0,s=m.as(pm),l=(null!=s&&(s.typeOfComponent.startsWith("LeftTitle")&&(i=0,r=0),s.typeOfComponent.startsWith("RightTitle")&&(i=V,r=0),s.typeOfComponent.startsWith("SummaryTitle")&&(0==w.length&&(i=0,r=2*N),0==S.length)&&(i=V,r=N),s.typeOfComponent.startsWith("Row:")&&(i=0,r=N),s.typeOfComponent.startsWith("Col:"))&&(i=0,r=N),m.as(vm)),n=(null!=l&&(i=0,r=2*N),m.as(dm)),a=(null!=n&&(i=0,r=2*N),m.as(ym)),o=(null!=a&&(i=V,r=N),m.as(wm)),u=(null!=o&&(i=V,r=N),m.as(fm)),h=(null!=u&&(i=V,r=2*N),m.as(Fm));null!=h&&(r=c.summaryDirection==Oo.LeftToRight?(i=V,N):(i=0,2*N)),t.x+=i,t.y+=r,m.clientRectangle=t.clone()}}static fillInteraction(r,s){for(let i=0;i<r.getDrillDownParameters().length;i++){let e=r.getDrillDownParameters()[i],t=s.interaction[`drillDownParameter`+(i+1)];t.expression=0==e.expression.indexOf("{")?e.expression.substring(1,e.expression.length-1):e.expression,t.name=e.name}r.onClick!=di.ShowDashboard||H.isNullOrEmpty(r.drillDownPageKey)||(s.interaction.drillDownPageGuid=r.drillDownPageKey)}static changeFontSize(e,t){return 1==t?e:Hn.changeFontSize(e,e.size*t)}static async getCondition(n,a,o,e,t){let i=new j;for(let e of n.pivotTableConditions)e.destinationValueMeter!=nm.getLabel(a)&&e.destinationValueMeter!=a.key||i.add(e);if(null!=i&&0<i.length)for(let l of i){let s=new(l.conditionType==zo.Condition?lm:$h),r="";if(l.conditionType==zo.Condition){let e=new sm,t=(e.condition=l.condition,e.dataType=l.dataType,e.value1=l.value,n.getAllMeters().find(e=>l.keyValueMeter==e.key||l.keyValueMeter==nm.getLabel(e))),i=null==t||t==a?"value2":t.expression;r=rm.getFilterExpression(e,i,o.report),l.dataType!=P.Report.Components.StiFilterDataType.String&&(r=`value2 == null ? False : (value2.ToString().Length > 0 ? ${r} : False)`),s.expression=r}if(s.permissions=l.permissions,s.permissions&=~Go.Borders,s.backColor=l.backColor,s.font=this.changeFontSize(l.font,e),s.textColor=l.textColor,l.iconAlignment!=G.None&&(s.icon=await l.getIcon(),s.iconSize=l.iconSize,s.iconAlignment=l.iconAlignment==G.Right?om.MiddleRight:om.MiddleLeft),l.conditionType==zo.Condition){let e={key:s,value:`{${r}}`};this.addToConversionStore(o,"*StiConditionExpression*"+o.name,e)}if(o.conditions.add(s),o instanceof Mm&&l.conditionType==zo.TopN){let i=s[P.System.StiObject.stimulsoft]().as($h),r=(i.count=l.topNCount,i.mode=l.topNMode,i.conditionCell=l.topNConditionCell,i.conditionHeader=l.topNConditionHeader,i.conditionTotal=l.topNConditionTotal,n.summaries.where(e=>tm.getVisible(e,n.report)).toList());for(let t=0;t<r.length;t++){let e=r[t];if(e.key!=l.measureField||H.isNullOrEmpty(e.expression)||-1==e.expression.indexOf("(")||-1==e.expression.indexOf(")"))continue;i.measureField=e.expression.substring(e.expression.indexOf("(")+1).replace(")","")}}}}static setupTitle(e,t,i,r){t.border=new te(J.All,i.lineColor,1*r,Rr.Solid),t.height=bh.Table.getHeight(t.font)*r,t.font=this.changeFontSize(bh.Table.Font.getCachedGdiFont(),r),t.is2(pm)||t.is2(ym)?t.font=this.changeFontSize(e.getColumnFont(),r):t.is2(vm)?t.font=this.changeFontSize(e.getRowFont(),r):t.is2(cm)?t.font=this.changeFontSize(e.getTotalFont(),r):t.font=this.changeFontSize(e.getDataFont(),r)}static addToConversionStore(t,i,e){if(null==t.report.engine.parserConversionStore.get(i)){let e=[];t.report.engine.parserConversionStore.set(i,e)}t.report.engine.parserConversionStore.get(i).push(e)}static setupField(e,t){e.margins=new Se(this.FieldMargin*t),e.guid=Tm.newGuidString()}static createRowTotal(e,t,i,r,s){let l=t.guid,n=i.get(l);return null==n&&((n=new dm).text=H.isNullOrEmpty(e.totalLabel)?b.get("PropertyMain","Total"):e.totalLabel,n.wordWrap=t.wordWrap,n.minSize=t.minSize.multiply(s),n.maxSize=t.maxSize.multiply(s),this.setupField(n,s),this.setupTitle(e,n,r,s),n.font=this.changeFontSize(e.cells.rows.font,s)),i.set(l,n),n}static createColTotal(e,t,i,r,s,l){let n=t.guid,a=i.get(n);return null==a&&((a=new wm).text=H.isNullOrEmpty(e.totalLabel)?b.get("PropertyMain","Total"):e.totalLabel,a.wordWrap=t.wordWrap,a.minSize=t.minSize.multiply(l),a.maxSize=t.maxSize.multiply(l),this.setupField(a,l),this.setupTitle(e,a,s,l),a.font=this.changeFontSize(e.cells.columns.font,l)),i.set(n,a),r.add(a),a}static getLabel(e){return H.isNullOrEmpty(e.label)?e.expression.substr(e.expression.lastIndexOf(".")+1)[P.System.StiObject.stimulsoft]().replaceAll("]","")[P.System.StiObject.stimulsoft]().replaceAll(")",""):e.label}static getSummaryTypes(){return 0==this.summaryTypes.count&&(this.summaryTypes.add("None","None"),this.summaryTypes.add("Sum","Sum"),this.summaryTypes.add("Avg","Average"),this.summaryTypes.add("Min","Min"),this.summaryTypes.add("Max","Max"),this.summaryTypes.add("DistinctCount","CountDistinct"),this.summaryTypes.add("Count","Count"),this.summaryTypes.add("Median","Median"),this.summaryTypes.add("First",""),this.summaryTypes.add("Last","")),this.summaryTypes}static async setTopN(t,e,i){let r=i.summaries.where(e=>tm.getVisible(e,i.report)).toList();if(t.topN=e.clone(),t.topN.mode!=Xo.None){t.topN.showOthers&&(t.topN.othersText=H.isNullOrEmpty(t.topN.othersText)?b.get("FormDesigner","Others"):await k.parseAsync(t.topN.othersText,i));for(let e of r){if(!H.isNullOrEmpty(e.label)&&e.label!=t.topN.measureField||nm.getLabel(e)!=t.topN.measureField)continue;e.label!=t.topN.measureField||H.isNullOrEmpty(e.expression)||-1==e.expression.indexOf("(")||-1==e.expression.indexOf(")")||(t.topN.measureField=e.expression.substr(e.expression.indexOf("(")+1)[P.System.StiObject.stimulsoft]().replaceAll(")",""))}}}static setSummaryType(t,s){if(H.isNullOrEmpty(s))return;let l=this.getSummaryTypes();for(let e of l.keys){let r=e+`(`;if(0<=s.indexOf(r)){"First"==e||"Last"==e?t.summary=Am.None:t.summary="Count"!=e&&"DistinctCount"!=e?Am[l.get(e)]:Am.Sum;let i=s.indexOf(r);while(0<=i){let e=i+r.length,t=1;while(e<s.length&&0!=t)t+="("==s[e]?1:")"==s[e]?-1:0,e++;s=s.substr(0,i)+s.substr(i+r.length,e-i-r.length-1)+s.substr(e,s.length-e),i=s.indexOf(r)}}}t.value=`{${s}}`}}Tg.summaryTypes=new Ro,Tg.FieldMargin=1.5,R.h.StiPivotTableHelper=Tg}R.v.StiProgressIteration=class{constructor(e="",t,i){this.series=e,this.value=t,this.target=i}};let Em=R.v.StiProgressIteration;{class km extends R.i.StiElementBuilder{async render(n,a){this.storedCulture=ar.set(n.report);try{let t=this.getValueMeterIndex(a),i=this.getTargetMeterIndex(a),r=this.getSeriesMeterIndex(a),e=this.getSeriesKeys(a,r),s=e.count2(),l=e.select(e=>new Em(this.getSeries(a,r,e,n.report),this.getValue(a,t,r,s,e),this.getNullableValue(a,i,r,s,e)));return l=km.processVariationSort(n,l),await km.processTopNElements(n,l)}finally{R.h.StiCultureHelper.restore(this.storedCulture)}}static processVariationSort(e,t){let i=e.userSorts;return t=null!=i&&i.any(e=>e.key==Ph.ident)?i.firstOrDefault().direction==Bh.Ascending?t.orderBy(e=>0!=e.target?e.value/e.target:0):t.orderByDescending(e=>0!=e.target?e.value/e.target:0):t}static async processTopNElements(s,l){if(s.topN.mode==Xo.None)return l;let n=(l=(s.topN.mode==Xo.Bottom?l.orderBy(e=>e.value):l.orderByDescending(e=>e.value)).toList()).take(s.topN.count).toList();if(l.count2()>s.topN.count&&s.topN.showOthers){let e=l.skip(s.topN.count).sum(e=>O.tryToNumber(e.value)),t=l.skip(s.topN.count),i=t.all(e=>null==e.target)?null:t.sum(e=>O.tryToNullableNumber(e.target)),r=H.isNullOrEmpty(s.topN.othersText)?b.get("FormDesigner","Others"):await k.parseAsync(s.topN.othersText,s);n.add(new Em(r,e,i))}return n}getValueMeterIndex(e){if(null==e)return-1;let t=e.meters.firstOrDefault(e=>e.is(ds));return null!=t?e.meters.indexOf(t):-1}getTargetMeterIndex(e){if(null==e)return-1;let t=e.meters.firstOrDefault(e=>e.is(gs));return null!=t?e.meters.indexOf(t):-1}getSeriesMeterIndex(e){if(null==e)return-1;let t=e.meters.firstOrDefault(e=>e.is(ps));return null!=t?e.meters.indexOf(t):-1}}R.i.StiProgressElementBuilder=km}R.w.StiProgressVisualCreator=class{static createProgressVisual(e,t){switch(e.mode){case Yo.DataBars:return new R.v.StiDataBarsProgressVisual(e,t);case Yo.Circle:return new R.v.StiCircleProgressVisual(e,t);case Yo.Pie:return new R.v.StiPieProgressVisual(e,t);default:throw new pa(e.mode)}}};let km=R.i.StiProgressElementBuilder,Om=P.Report.Dashboard.Visuals.IStiProgressVisualSvgHelper,Vm=R.w.StiProgressVisualCreator;{class fp{implements(){let e=[Om];return(this.implements=()=>e)()}async writeProgress(e,t,i,r){let s=new L(0,0,t.width,t.height),l=t.component,n=await fp.getDataTable(l);if(null==n)return;let a=await(new km).render(l,n);if(l["isSampleForStyles"]?a=this.getStyleSampleIterations():this.isEmptyData(l,n)&&(a=this.getEmptyDataIterations(l)),null==a||!a.any())return;let o=new wh,u=new Fh(o,!0,!1,!1,1),h=Vm.createProgressVisual(l,a.toList());if(i&&i.needToVertScroll){let e=h.getContentRectangle(s.clone());i.needToVertScroll=e.height>s.height+5,i.needToVertScroll&&(s.width-=15,e=h.getContentRectangle(s.clone()),s=e,r.ref=P.System.Convert.toInt32(s.height))}await h.draw(u,s.clone()),e.writeStartElement("g");let m=i&&i.needToVertScroll?0:t.x,c=i&&i.needToVertScroll?0:t.y;e.writeAttributeString("transform",H.format("translate({0},{1})",this.p(m),this.p(c))),Dh.writeGeoms(e,u,!1),e.writeEndElement()}p(e){return e.toString().split(",").join(".")}isEmptyData(e,t){return null!=t&&t.isEmpty&&e.isQuerable}getStyleSampleIterations(){let e=new j,t=new Em;return t.value=75,t.target=100,e.add(t),e}getEmptyDataIterations(e){let t=new j,i=new Em;return i.value=0,e.showBlanks&&(i.series=T.get("Dashboard","Blank")),t.add(i),t}static async getDataTable(e){let t,i=null==(t=e.as(Ah))?void 0:t.getManuallyEnteredDataTable();if(null!=i)return i;return yn.tryToGetOrCreate(e)}}R.h.StiProgressVisualSvgHelper=fp}R.h.StiTableAlignmentHelper=class{static getHorAlign(e){let t=R.h.StiMeterHelper.toDataType(e);if(Oe.isNumericType(t))return X.Right;if(Oe.isDateType(t))return X.Center;return X.Left}},R.h.StiTableElementHelper=class{static minDataColumnValue(e,t,i){if(!(e.is2(is)||e.is2(ts)||e.is2(Zr)))return 0;return t.rows.any()?t.rows.min(e=>O.tryToNumber(e[i])):0}static maxDataColumnValue(e,t,i){if(!(e.is2(is)||e.is2(ts)||e.is2(Zr)))return 0;return t.rows.any()?t.rows.max(e=>O.tryToNumber(e[i])):0}static calculateTotal(e,i,r){switch(e.summaryType){case Qi.Sum:if(Or.isPercentOfGrandTotal(e.expression))return 1;return r.rows.any()?r.rows.sum(e=>i<e.length?O.tryToNumber(e[i]):0):0;case Qi.Count:return r.rows.any()?r.rows.count2(e=>i<e.length&&null!=e[i]):0;case Qi.Min:return r.rows.any()?r.rows.min(e=>i<e.length?O.tryToNumber(e[i]):0):0;case Qi.Max:return r.rows.any()?r.rows.max(e=>i<e.length?O.tryToNumber(e[i]):0):0;case Qi.Average:{let e=r.rows.any()?r.rows.sum(e=>i<e.length?O.tryToNumber(e[i]):0):0,t=r.rows.any()?r.rows.count2(e=>i<e.length&&null!=e[i]&&null!=e[i]):0;return 0==t?0:e/t}}return 0}},R.h.StiTitleMeasureHelper=class{static measureTitle(e){return this.measureTitle2(e,e.text)}static measureTitle2(e,t){return this.measureTitle3(null,null,e,t)}static measureTitle3(e,t,i,r){var s;if(null==i||!i.visible)return W.empty;let l=Jo.yy(30),n=null!=(s=null==t?void 0:t.width)?s:L.empty.width;if(H.isNullOrWhiteSpace(r))return new W(n,l);let a=i.sizeMode==Mt.WordWrap||i.sizeMode==Mt.FitAndWordWrap?R.h.StiAutoSizeTextHelper.measure2(e,r,i.font,n):R.h.StiAutoSizeTextHelper.measure(e,r,i.font);return l=Math.max(l,a.height),null!=t&&(l=Math.min(l,t.height)),new W(a.width,l)}static measureTitle4(e,t,i,r){let s=Jo.yy(30);if(H.isNullOrWhiteSpace(r))return new W(t.width,s);let l=R.h.StiAutoSizeTextHelper.measure(e,r,i);return s=Math.max(s,l.height),null!=t&&(s=Math.min(s,t.height)),new W(l.width,s)}};{class bp{static loadReport(e,t){switch(t){case"Financial":e.loadPacked(this.financial);break;case"Orders":e.loadPacked(this.orders);break;case"SalesOverview":e.loadPacked(this.salesOverview);break;case"TicketsStatistics":e.loadPacked(this.ticketsStatistics);break;case"TrafficAnalytics":e.loadPacked(this.trafficAnalytics);break;case"VehicleProduction":e.loadPacked(this.vehicleProduction);break;case"WebsiteAnalytics":e.loadPacked(this.websiteAnalytics);break}}}bp.financial="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",bp.orders="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",bp.salesOverview="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",bp.ticketsStatistics="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",bp.trafficAnalytics="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",bp.vehicleProduction="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",bp.websiteAnalytics="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",R.d.StiWizardDashboardsHelper=bp}R.l.StiDashboardImages=class{};{class yp{clone(){return this[P.System.StiObject.stimulsoft]().memberwiseClone()}meta(){return[new l("Name"),new l("Expression")]}saveToJsonObject(e){return u.saveToJsonObject(e,this)}loadFromJsonObject(e){u.loadFromJsonObject(e,this)}loadFromXml(e){u.loadFromXml(e,this)}static loadFromJson(e){let t=new yp;return t.loadFromJsonObject(e),t}static loadFromXml(e){let t=new yp;return t.loadFromXml(e),t}saveToString(){return this.saveToJsonObject(Le.Report).serialize()}getStringRepresentation(){if(H.isNullOrWhiteSpace(this.name))return b.get("FormStyleDesigner","NotSpecified");return H.isNullOrWhiteSpace(this.expression)?this.name:this.name+` - `+this.expression}constructor(){this.name="",this.expression=""}}R.g.StiDashboardDrillDownParameter=yp}R.x.StiDashboardDrillDownParameterConverter=class{},R.x.StiDashboardInteractionConverter=class{},R.x.StiDashboardInteractionCreator=class{static new2(e){switch(e){case"Chart":return new R.g.StiChartDashboardInteraction;case"Table":return new R.g.StiTableDashboardInteraction;case"TableColumn":return new R.g.StiTableColumnDashboardInteraction;case"RegionMap":return new R.g.StiRegionMapDashboardInteraction;case"Text":return new R.g.StiTextDashboardInteraction;case"Image":return new R.g.StiImageDashboardInteraction;case"Gauge":return new R.g.StiGaugeDashboardInteraction;case"Indicator":return new R.g.StiIndicatorDashboardInteraction;case"Shape":return new R.g.StiShapeDashboardInteraction;case"Progress":return new R.g.StiProgressDashboardInteraction;case"OnlineMap":return new R.g.StiOnlineMapDashboardInteraction;case"PivotTable":return new R.g.StiPivotTableDashboardInteraction;case"PivotTableItem":return new R.g.StiPivotTableItemDashboardInteraction;case"Cards":return new R.g.StiCardsDashboardInteraction;case"Filter":return new R.g.StiFilterDashboardInteraction;case"CardsColumn":return new R.g.StiCardsColumnDashboardInteraction;default:throw new pa(e)}}},R.x.StiDashboardInteractionJsonConverter=class{},R.x.StiTableDashboardInteractionConverter=class extends R.x.StiDashboardInteractionConverter{};let Nm=R.Y.StiWebContentElement,Lm=R.E.StiButtonElement,Bm=R.Z.StiShapeElement,Pm=R.S.StiComboBoxElement,Hm=R.P.StiListBoxElement,jm=R.I.StiTreeViewBoxElement,zm=R.J.StiTreeViewElement,Xm=R.Q.StiDatePickerElement,Gm=R.K.StiTableElement,Jm=R.F.StiCardsElement,Wm=R.M.StiProgressElement,Um=R.O.StiOnlineMapElement,Zm=R.L.StiRegionMapElement,Ym=R.X.StiImageElement,Km=R.T.StiGaugeElement,Qm=R.H.StiChartElement,qm=R.R.StiNumberBoxElement,_m=R.e.StiDashboard;{class Cp{}R.m.StiDashboardOptions=Cp,R.m.Services=class{static get elements(){return null==this._elements&&(this._elements=[_m,Lm,Jm,Km,Ym,Nm,Gh,Zm,Um,dt,Au,Wm,Gm,$u,Bm,Pm,Hm,jm,zm,Xm,qm],P.Report.Chart.StiChartAssembly.isAssemblyLoaded)&&this._elements.push(Qm),this._elements}}}{class xp{static fetchAll(){return R.m.Services.elements}static load(){P["StiOptions"].Services.components.push(...this.fetchAll())}}(R.m.StiDashboardElementsLoader=xp).load()}let $m=P.Report.Chart.StiHeatmapArea,ec=P.Data.Engine.StiDataIndicatorValue,tc=P.Report.Chart.StiDoughnutArea,ic=P.Report.Chart.IStiClusteredColumnArea,rc=P.Report.Chart.IStiColumnShape3D,sc=P.Report.Chart.IStiClusteredColumnArea3D,lc=P.Report.Chart.IStiAxisArea3D,nc=P.Report.Chart.StiPie3dSeries,ac=P.Report.Chart.StiClusteredBarArea,oc=P.Report.Chart.StiConstantLines_StiOrientation,uc=R.H.StiLegendVisibility,hc=P.Report.Chart.StiPieSeries,mc=P.Report.Chart.StiRadarArea,cc=P.Report.Chart.StiMarker,dc=P.Report.Chart.IStiGanttArea,gc=R.H.StiChartLabelsStyle,pc=P.Report.Chart.IStiPieSeriesLabels,Sc=P.Report.Chart.IStiOutsidePieLabels,wc=P.Report.Chart.IStiCenterPieLabels,fc=P.Report.Chart.IStiYRightAxis,bc=R.H.StiXChartAxisTitle,yc=P.Report.Chart.IStiClusteredBarArea,Cc=P.Report.Chart.IStiAllowApplyBrushNegative,xc=P.Report.Chart.IStiAllowApplyColorNegative,vc=P.Report.Chart.IStiSeriesLabels,Fc=P.Report.Chart.IStiDoughnutSeries,Tc=P.Report.Chart.IStiPictorialSeries,Mc=P.Report.Chart.IStiParetoSeries,Ac=P.Report.Chart.IStiPieSeries,Dc=R.H.StiYChartAxis,Ic=R.H.StiXChartAxis,Rc=P.Report.Chart.IStiAxisArea,Ec=P.Report.Chart.IStiStackedBaseLineSeries,kc=P.Report.Chart.IStiBaseLineSeries,Oc=P.Report.Chart.IStiFunnelSeries,Vc=P.Report.Chart.StiBoxAndWhiskerHelper,Nc=P.Report.Chart.StiShowSeriesLabels,Lc=P.Report.Chart.IStiShowZerosSeries,Bc=P.Report.Chart.StiShowEmptyCellsAs,Pc=P.Report.Chart.StiChartHelper,Hc=P.Report.Chart.IStiFontIconsSeries,jc=P.Report.Chart.IStiRoundValuesArea,zc=P.Report.Chart.StiScatterSeries,Xc=P.Report.Chart.IStiScatterArea,Gc=P.Base.Helpers.StiValueComparer,Jc=P.Report.Chart.IStiShowNullsSeriesAs,Wc=P.Report.Chart.IStiShowZerosSeriesAs,Uc=P.Report.Chart.IStiRangeSeries,Zc=P.Report.Chart.StiHeatmapSeries;{class g extends R.i.StiElementBuilder{async render(i,r){this.storedCulture=ar.set(i.report);try{let e=new P.Report.Components["StiChart"];if(e.horSpacing=i.area.horSpacing,e.vertSpacing=i.area.vertSpacing,e.isDashboard=!0,e.page=i.page,e.previousAnimations=i.previousAnimations,e.sortAnimation=i.sortAnimation,i.sortAnimation=!1,g.setStyle(i,e),e.series.clear(),null==r)return e;await this.renderElements(i,e,r),await this.renderArea(i,e),await this.renderLegend(i,e),await this.renderSeriesLabels(i,e),await g.renderConstantLines(i,e),this.simplifyValues(e),e.applyStyle(),e.allowApplyStyle=!1;let t=Xn.getBackColor(i,i.backColor);return N.transparent.equals(t)||(e.brush=new E(t)),e}finally{R.h.StiCultureHelper.restore(this.storedCulture)}}async renderElements(o,u,h){let m=null==u?void 0:u.report,e=this.getSeriesMeterIndex(h),t=this.getSeriesKeyValues(h,e),r=this.getArgumentMeterIndexes(h),c=this.getArgumentKeys(o,h).toList(),s=this.getValueMeters(h),l=t.count2();await this.calculateIndicatorValue(o);for(let a of t){let i=-1!=e&&1<l?h.rows.whereArrayItemStringEqualsTo(e,this.toString(a)):h.rows,n=new He;for(let t of c){let e=g.getDetailRows(i,t,r);n.add(t,e)}let t=0;for(let e of s){let r=this.getValueMeterIndexes(h)[t],s=this.renderSeries(o,e,this.toReadableString(a,m),u);if(null==s)continue;await g.renderConditions(this.toString(a),s,o,e),g.renderTrendLines(s,o,e),s.values=j.create(Number,c.length);let l=0;for(let i of c){let e=n.get(i),t=j.getValueOrFirstOrDefault(e.getArrayItem(r).firstOrDefault());(null!=t&&t[P.System.StiObject.stimulsoft]().is(F)||null!=t&&t[P.System.StiObject.stimulsoft]().is(hr))&&(s.core.isDateTimeValues=!0),s.values[l]=e.getArrayItem(r).firstOrDefaultAsNullableNumber(),l++}s.originalArguments=c.slice(),s.arguments=this.proccessSelectArguments(c,o,s,m);let i=s.as(Oc);if(null!=i){let e=s.values,t=s.arguments;Pl.sort3(e,t),Pl.reverse(e),Pl.reverse(t),i.values=e,i.arguments=t}else if(s.is(Mc)){let i=[],r=[];for(let t=0;t<s.values.length;t++){let e=s.values[t];if(!(0<e))continue;i.push(e),null!=s.arguments&&t<s.arguments.length?r.push(s.arguments[t]):r.push(t+1)}let e=i.slice(),t=r.slice();Pl.sort3(e,t),Pl.reverse(e),Pl.reverse(t),s.valuesStart=null,s.values=e,s.arguments=t}t++,await g.processTopNElements(o,s),P.Report.Chart["StiHistogramHelper"].checkValuesAndArguments(s,o.argumentFormat),await this.renderSeriesInteraction(s,o,c.length,this.toString(a))}}Vc.checkArgument(u),Pc.checkWaterfallTotals(u)}proccessSelectArguments(e,t,s,i){let r=s.as(zc);if(null!=r){let r=[];for(let i=0;i<s.originalArguments.length;i++){let e=s.originalArguments[i],t=null!=e&&0<e.length?e[0]:e;r.push(t)}return r}return e.select(e=>this.getString(t.argumentFormat,e,i))[P.System.StiObject.stimulsoft]().toArray()}static async processTopNElements(i,s){if(i.topN.mode==Xo.None)return;let l=new j,e=(s.values.length>s.arguments.length?s.values:s.arguments).length;for(let r=0;r<e;r++){let e=r<s.values.length?s.values[r]:null,t=r<s.arguments.length?s.arguments[r]:null,i=r<s.originalArguments.length?s.originalArguments[r]:null;l.add({key:t,key1:i,value:e})}let r=(l=i.topN.mode==Xo.Bottom?l.orderBy(e=>e.value):l.orderByDescending(e=>e.value)).take(i.topN.count);if(l.length>i.topN.count&&i.topN.showOthers){s.originalTopNValues=l.skip(i.topN.count).select(e=>e.value);let e=l.skip(i.topN.count).sum(e=>O.tryToNumber(e.value)),t=H.isNullOrEmpty(i.topN.othersText)?b.get("FormDesigner","Others"):await k.parseAsync(i.topN.othersText,i);r.add({key:t,key1:t,value:e})}i.isBarChart&&r.reverse(),s.originalArguments=r.select(e=>e.key1),s.arguments=r.select(e=>e.key),s.values=r.select(e=>O.tryToNullableNumber(e.value))}static setStyle(e,t){if(e.style!=o.Custom)return void(t.style=U.getChartStyle(e));let i=e.report.styles.getCustomChartStyle(e.customStyleName);if(null!=i)return t.style=i,void(t.customStyleName=e.customStyleName);t.style=U.getChartStyle2(o.Blue)}static getDetailRows(e,i,r){if(!r.any())return e;return e.where(t=>{let e=r.select(e=>t[e]);return Gc.equalValues(e,i)})}renderSeries(e,t,i,r){let s=t,l=Hl.neww2(t.seriesType);return g.renderSeriesYAxis(e,s,l),g.renderSeriesLine(s,l),g.renderSeriesShowZeros(s,l),g.renderSeriesShowNulls(s,l),l.coreTitle=this.getSeriesTitle(e,i,t),l.core.seriesColors=null!=e.seriesColors&&0<e.seriesColors.length?e.seriesColors:null,l.isDashboard=!0,this.renderSeriesNegativeColor(e,l,r.series.count),this.renderSeriesParetoColor(e,l,r.series.count),this.renderMarker(e,l),g.renderSeriesLighting(l),g.renderSeriesIcon(e,l),g.renderSeriesPie3d(e,l),l.is(rc)&&(l.columnShape=e.columnShape),r.series.add(l),l}static renderSeriesPie3d(e,t){var i;t.is(nc)&&null!=(i=e.options3D)&&i[P.System.StiObject.stimulsoft]().is(Vl)&&(t.options3D=e.options3D[P.System.StiObject.stimulsoft]().as(Vl))}static renderSeriesYAxis(e,t,i){t.is(js)&&1<e.values.length&&(i.yAxis=t.yAxis)}static renderSeriesLine(i,r){if(null!=i){let e=r.as(kc);if(null!=e)return e.lineStyle=i.lineStyle,void(e.lineWidth=i.lineWidth);let t=r.as(Ec);null!=t&&(t.lineStyle=i.lineStyle,t.lineWidth=i.lineWidth)}}static renderSeriesShowZeros(e,t){let i=t.as(Lc);if(null==i)return;i.showZeros=e.showZeros==ft.Zero;let r=t.as(kc);if(null==r)return;e.showZeros==ft.Gap&&(r.showZerosAs=Bc.Gap),e.showZeros==ft.ConnectPointsWithLine&&(r.showZerosAs=Bc.ConnectPointsWithLine)}static renderSeriesShowNulls(e,t){let i=t.as(sn);if(null==i)return;i.showNulls=e.showNulls==ft.Zero;let r=t.as(kc);if(null==r)return;e.showNulls==ft.Gap&&(r.showNullsAs=Bc.Gap),e.showNulls==ft.ConnectPointsWithLine&&(r.showNullsAs=Bc.ConnectPointsWithLine)}static renderSeriesLighting(e){e.is(Ac)&&(e.lighting=!1),e.is(Fc)&&(e.lighting=!1)}static renderSeriesIcon(e,t){let i=t.as(Hc);null!=i&&(t.is(Tc)&&null==e.icon?i.icon=P.Report.Helpers.StiFontIcons.QuarterFull:i.icon=e.icon)}renderMarker(e,t){let i,r=null!=t?t.as(kc):null,s=null!=t?t.as(Ec):null;null!=r?i=null!=r.marker?r.marker.as(cc):null:null!=s&&(i=null!=s.marker?s.marker.as(cc):null),null!=i&&(i.size=e.marker.size,i.angle=e.marker.angle,i.type=e.marker.type,i.extendedVisible=e.marker.visible)}renderSeriesNegativeColor(e,t,i){if(null==e.negativeSeriesColors||e.negativeSeriesColors.length<=0)return;while(i>=e.negativeSeriesColors.length)i-=e.negativeSeriesColors.length;let r=t.as(Cc),s=(null!=r&&(r.allowApplyBrushNegative=!0,r.brushNegative=new E(e.negativeSeriesColors[i])),t.as(xc));null!=s&&(s.allowApplyColorNegative=!0,s.lineColorNegative=e.negativeSeriesColors[i])}renderSeriesParetoColor(e,t,i){if(null==e.paretoSeriesColors||e.paretoSeriesColors.length<=0)return;while(i>=e.paretoSeriesColors.length)i-=e.paretoSeriesColors.length;let r=t.as(Mc);null!=r&&(r.allowApplyLineColor=!0,r.lineColor=e.paretoSeriesColors[i])}async renderArea(e,t){let i=Xn.getBackColor(e,e.backColor);N.transparent.equals(i)||(t.area.brush=255==i.a?new E(i):new $e),(e.isPieChart||e.isPie3dChart||e.isDoughnutChart||e.isFunnelChart||e.isSunburstChart||e.isPictorialStackedChart)&&(t.area.allowApplyStyle=!1,t.area.borderColor=N.transparent),t.area.colorEach=g.getColorEach(e),t.area.is(jc)&&(t.area.as(jc).roundValues=e.roundValues),await this.renderAxisAxes3d(e,t),await this.renderAxisAxes(e,t),g.renderRadarAxis(e,t),this.renderAreaIndicator(e,t)}static getColorEach(e){return!!(e.isPieChart||e.isPie3dChart||e.isDoughnutChart||e.isPictorialStackedChart)||null!=e.area&&e.area.colorEach}async renderAxisAxes3d(e,t){if(t.series.count<=0)return;let i=t.area.as(sc),r=(null!=i&&(i.sideBySide=e.area.sideBySide),t.area.as(ic));null!=r&&(r.sideBySide=e.area.sideBySide),await this.renderXAxis3D(e,t),await this.renderYAxis3D(e,t)}async renderAxisAxes(e,t){if(t.series.count<=0)return;let i=t.area.as(Rc);if(null==i)return;g.renderInterlacingHor(e,i),g.renderInterlacingVert(e,i),g.renderGridLinesHor(e,i),g.renderGridLinesVert(e,i),i.reverseHor=e.area.reverseHor,i.reverseVert=e.area.reverseVert,await this.renderXAxis(e,t,!1),await this.renderYAxis(e,t,!1),e.xTopAxis.visible&&await this.renderXAxis(e,t,!0),e.yRightAxis.visible?await this.renderYAxis(e,t,!0):await g.renderYRightAxis(e,t)}static renderInterlacingHor(e,t){e.area.interlacingHor.visible&&!N.transparent.equals(e.area.interlacingHor.color)&&(t.interlacingHor.interlacedBrush=new E(e.area.interlacingHor.color)),t.interlacingHor.visible=e.area.interlacingHor.visible}static renderInterlacingVert(e,t){e.area.interlacingVert.visible&&!N.transparent.equals(e.area.interlacingVert.color)&&(t.interlacingVert.interlacedBrush=new E(e.area.interlacingVert.color)),t.interlacingVert.visible=e.area.interlacingVert.visible}static renderGridLinesHor(e,t){e.area.gridLinesHor.visible&&!N.transparent.equals(e.area.gridLinesHor.color)&&(t.gridLinesHor.color=e.area.gridLinesHor.color),t.gridLinesHor.visible=e.area.gridLinesHor.visible,t.gridLinesHor.style=Rr.Solid}static renderGridLinesVert(e,t){e.area.gridLinesVert.visible&&!N.transparent.equals(e.area.gridLinesVert.color)&&(t.gridLinesVert.color=e.area.gridLinesVert.color),t.gridLinesVert.visible=e.area.gridLinesVert.visible,t.gridLinesVert.style=Rr.Solid}async renderXAxis3D(e,t){let i=t.area.as(lc);if(null==i)return;let r=i.xAxis,s=e.xAxis,l=(await g.renderAxis3D(e,r,s),zl.isDrillAvailable(e)&&e.drillDownCurrentLevel<e.drillDownLevelCount?e.arguments.getRange(e.drillDownCurrentLevel,1):e.arguments),n=l.select(this.getTitle).distinct();await g.renderXAxisTitleText3D(e,r,s,n),r.visible=s.visible,s.showEdgeValues==Ml.Auto&&(r.showEdgeValues=!1)}async renderYAxis3D(e,t){let i=t.area.as(lc);if(null==i)return;let r=i.yAxis,s=e.yAxis,l=(await g.renderAxis3D(e,r,s),(e.dataMode==Nl.ManuallyEnteringData?e.chartValuesList():e.arguments).select(this.getTitle).distinct());r.visible=l.any()&&s.visible,await g.renderYAxisTitleText3D(e,r,s,l),r.visible=s.visible,null!=e.valueFormat&&(r.labels.formatService=g.checkValueFormat(e.valueFormat,t))}static async renderXAxisTitleText3D(e,t,i,r){if(!i.title.visible)return;t.title.text=""===i.title.text?r.join(" / "):await k.parseAsync(i.title.text,e)}static async renderYAxisTitleText3D(e,t,i,r){if(!i.title.visible)return;t.title.text=""===i.title.text?r.join(" / "):await k.parseAsync(i.title.text,e)}async renderXAxis(e,t,i){let r=t.area.as(Rc);if(null==r)return;let s=i?r.xTopAxis:r.xAxis,l=i?e.xTopAxis:e.xAxis,n=t.area.is(yc),a=zl.isDrillAvailable(e)&&e.drillDownCurrentLevel<e.drillDownLevelCount?e.arguments.getRange(e.drillDownCurrentLevel,1):e.arguments,o=(n?e.values:a).select(this.getTitle).distinct(),u=(await g.renderAxis(e,s,l),s.ticks.visible=o.any(),s.visible=l.visible,await g.renderXAxisTitleText(e,s,l,o),t.series.toList().cast().all(e=>e.is(kc)||e.is(Ec))),h=(l.startFromZero==Ml.Auto&&(s.startFromZero=!u),t.series.toList().cast().all(e=>e.core.isDateTimeValues));h&&r.is(ac)&&(s.startFromZero=!1),l.showEdgeValues==Ml.Auto&&(s.showEdgeValues=u),s.labels.placement==ul.AutoRotation&&(s.labels.textAlignment=X.Left),null!=e.valueFormat&&r.is(yc)&&(s.labels.formatService=g.checkValueFormat(e.valueFormat,t)),null!=e.argumentFormat&&r.is(Xc)&&(s.labels.formatService=e.argumentFormat),g.renderAxisLineColor(e,s)}async renderYAxis(e,t,i){let r=t.area.as(Rc);if(null==r)return;let s=i?r.yRightAxis:r.yAxis,l=i?e.yRightAxis:e.yAxis,n=t.area.is(dc)||t.area.is(yc),a=(n&&e.dataMode!=Nl.ManuallyEnteringData?e.arguments:e.chartValuesList()).select(this.getTitle).distinct(),o=(await g.renderAxis(e,s,l),s.visible=a.any()&&l.visible,await g.renderYAxisTitleText(e,s,l,a),null==e.valueFormat||r.is(yc)||r.is($m)||(s.labels.formatService=g.checkValueFormat(e.valueFormat,t)),t.series.toList().cast().all(e=>e.core.isDateTimeValues));o&&(r.yAxis.startFromZero=!1),g.renderAxisLineColor(e,s)}static renderXRadarAxis(e,t){let i=t.area.as(mc);if(null==i)return;this.renderXRadarAxisLabels(e,e.area.xAxis.labels,i.xAxis.labels),this.renderAxisRange(i.xAxis.range,e.xAxis),null!=e.valueFormat&&(i.yAxis.labels.formatService=g.checkValueFormat(e.valueFormat,t));let r=U.getForeColor(e);this.renderRadarXAxisLabelsColor(e,i.xAxis.labels,e.xAxis,r),i.xAxis.visible=e.xAxis.visible}static renderXRadarAxisLabels(e,t,i){i.font=this.getSmallStyleFont(e,t.font),i.textBefore=t.textBefore,i.textAfter=t.textAfter,i.allowApplyStyle=!1}static renderYRadarAxis(e,t){let i=t.area.as(mc);if(null==i)return;this.renderYRadarAxisLabels(e,e.area.yAxis.labels,i.yAxis.labels),this.renderAxisRange(i.yAxis.range,e.yAxis);let r=U.getForeColor(e);this.renderRadarYAxisLabelsColor(e,i.yAxis.labels,e.yAxis,r),i.yAxis.visible=e.yAxis.visible}static renderYRadarAxisLabels(e,t,i){i.font=this.getSmallStyleFont(e,t.font),i.textBefore=t.textBefore,i.textAfter=t.textAfter,i.step=t.step,i.angle=t.angle,i.textAlignment=t.textAlignment,i.wordWrap=t.wordWrap,i.width=t.width,i.allowApplyStyle=!1}static renderRadarXAxisLabelsColor(e,t,i,r){if(!N.transparent.equals(i.labels.color))return void(t.color=i.labels.color);e.style==o.Custom&&t.color!=N.transparent||(t.color=r)}static renderRadarYAxisLabelsColor(e,t,i,r){if(!N.transparent.equals(i.labels.color))return void(t.color=i.labels.color);e.style==o.Custom&&t.color!=N.transparent||(t.color=r)}static checkValueFormat(e,r){let s=e.as(Wi);if(null!=s&&0<(s.state&P.Report.Components.StiTextFormatState.Abbreviation)&&0==(s.state&P.Report.Components.StiTextFormatState.DecimalDigits)){let t=s.clone(),i=null;for(let e=0;e<r.series.count;e++){let t=r.series.getByIndex(e);for(let e of t.values)(null==i||i>e)&&(i=e)}if(null!=i&&0!=i){let e=0;if((i=Math.abs(i))<5){while(Math.round(i)%10==0)i*=10,e++;e+=2}t.useLocalSetting=!1,t.decimalDigits=e}return t}return e}static async renderYRightAxis(e,t){let i=t.area.as(Rc);if(null==i)return;await this.renderAxis(e,i.yRightAxis,e.yRightAxis),this.renderAxisLineColor(e,i.yRightAxis)}static async renderXAxisTitleText(e,t,i,r){if(!i.title.visible)return;t.title.text=H.isNullOrEmpty(i.title.text)?H.join(" / ",r):await k.parseAsync(i.title.text,e)}static async renderYAxisTitleText(e,t,i,r){if(!i.title.visible)return;t.title.text=H.isNullOrEmpty(i.title.text)?H.join(" / ",r):await k.parseAsync(i.title.text,e)}static renderAxisLineColor(e,t){if(e.style==o.Custom&&!N.transparent.equals(t.lineColor))return t.allowApplyStyle=!1,void(t.allowApplyStyle=!1);U.isDarkStyle(e.dashboard)&&(t.allowApplyStyle=!1,t.lineColor=U.getForeColor(e))}static renderRadarAxis(e,t){if(t.series.count<=0)return;let i=t.area.as(mc);if(null==i)return;this.renderXRadarAxis(e,t),this.renderYRadarAxis(e,t)}renderAreaIndicator(e,t){let i=t.area.as(tc);if(null==i)return;let r=null==e?void 0:e.report,s=null==this.indicatorValueValue?"":this.getString(e.valueFormat,this.indicatorValueValue.toString(),r),l=(i.indicator.value.value=s,i.indicator.value.color=e.area.indicator.value.color,e.area.indicator.title.text);i.indicator.title.text=l,i.indicator.title.color=e.area.indicator.title.color,i.indicator.visible=!H.isNullOrEmpty(s)||!H.isNullOrEmpty(l)}static async renderAxis3D(e,t,i){let r=U.getForeColor(e);this.renderAxisTitle3D(e,t,i,r),await this.renderAxisLabels3D(e,t,i),this.renderAxisLabelsColor3D(e,t,i,r)}static renderAxisTitle3D(e,t,i,r){let s=this.getTitleAxisChart(i),l=t.title;l.font=this.getStyleFont(e,s.font),g.renderAxisLabelsTitleColor3D(e,l,s,r),s instanceof bc&&(l.direction=s.direction),s instanceof Tl&&(l.direction=s.direction)}static async renderAxis(e,t,i){let r=U.getForeColor(e);this.renderAxisTitle(e,t,i,r),await this.renderAxisLabels(e,t,i),this.renderAxisStartFromZero(t,i),this.renderAxisShowEdgeValues(t,i),this.renderAxisRange(t.range,i),this.renderAxisLabelsColor(e,t,i,r)}static renderAxisTitle(e,t,i,r){let s=this.getTitleAxisChart(i),l=t.title;l.alignment=s.alignment,l.position=s.position,l.font=this.getStyleFont(e,s.font),this.renderAxisLabelsTitleColor(e,l,s,r),s.is(bc)&&(l.direction=s.direction),s.is(Tl)&&(l.direction=s.direction)}static async renderAxisLabels3D(e,t,i){t.labels.angle=i.labels.angle,t.labels.textAfter=await k.parseAsync(i.labels.textAfter,e),t.labels.textBefore=await k.parseAsync(i.labels.textBefore,e),t.labels.font=g.getSmallStyleFont(e,i.labels.font),t.labels.width=i.labels.width,t.labels.wordWrap=i.labels.wordWrap}static async renderAxisLabels(e,t,i){t.labels.angle=i.labels.angle,t.is(fc)&&e.isParetoChart||(t.labels.textAfter=await k.parseAsync(i.labels.textAfter,e)),t.labels.textAlignment=i.labels.textAlignment,t.labels.textBefore=await k.parseAsync(i.labels.textBefore,e),t.labels.font=g.getSmallStyleFont(e,i.labels.font),t.labels.placement=i.labels.placement,t.labels.step=i.labels.step,t.labels.wordWrap=i.labels.wordWrap,t.labels.width=i.labels.width}static renderAxisStartFromZero(t,i){if(i.is(Ic)){let e=i;null!=e&&e.startFromZero!=Ml.Auto&&(t.startFromZero=e.startFromZero!=Ml.False)}if(i.is(Dc)){let e=i;null!=e&&(t.startFromZero=e.startFromZero)}}static renderAxisShowEdgeValues(t,i){if(i.is(Ic)){let e=i;null!=e&&e.showEdgeValues!=Ml.Auto&&(t.showEdgeValues=e.showEdgeValues!=Ml.False)}}static renderAxisRange(e,t){t[P.System.StiObject.stimulsoft]().getType()!=Ic&&t[P.System.StiObject.stimulsoft]().getType()!=Dc||(e.auto=t.range.auto,e.maximum=t.range.maximum,e.minimum=t.range.minimum)}static renderAxisLabelsTitleColor(e,t,i,r){if(!N.transparent.equals(i.color))return void(t.color=i.color);e.style==o.Custom&&!N.transparent.equals(t.color)||(t.color=r)}static renderAxisLabelsTitleColor3D(e,t,i,r){if(!N.transparent.equals(i.color))return void(t.color=i.color);e.style==o.Custom&&!N.transparent.equals(t.color)||(t.color=r)}static renderAxisLabelsColor3D(e,t,i,r){if(!N.transparent.equals(i.labels.color))return void(t.labels.color=i.labels.color);e.style==o.Custom&&!N.transparent.equals(t.labels.color)||(t.labels.color=r)}static renderAxisLabelsColor(e,t,i,r){if(!N.transparent.equals(i.labels.color))return void(t.labels.color=i.labels.color);e.style==o.Custom&&!N.transparent.equals(t.labels.color)||(t.labels.color=r)}static getTitleAxisChart(e){if(e.is(Ic))return e.title;if(e.is(Dc))return e.title;return null}async renderLegend(e,t){t.legend.horAlignment=g.getChartLegendHotAlignment(e),t.legend.vertAlignment=g.getChartLegendVertAlignment(e),t.legend.title=await k.parseAsync(e.legend.title.text,e),t.legend.titleFont=g.getStyleFont(e,e.legend.title.font),t.legend.allowApplyStyle=!1,t.legend.font=g.getSmallStyleFont(e,e.legend.labels.font),t.legend.visible=g.getChartLegendVisible(e,t),t.legend.columns=e.legend.columns,t.legend.direction=e.legend.direction;let i=U.getForeColor(e);g.renderLegendTitleColor(e,t,i),g.renderLegendLabelsColor(e,t,i)}static getChartLegendHotAlignment(e){if(e.isHeatmapChart)return vl.RightOutside;return e.legend.horAlignment}static getChartLegendVertAlignment(e){if(e.isHeatmapChart)return xl.Center;return e.legend.vertAlignment}static getChartLegendVisible(e,t){if(1==t.series.count&&!t.series.getByIndex(0).is(hc)&&!t.series.getByIndex(0).is(Zc))return e.legend.visibility==uc.Always;return e.legend.visibility!=uc.False}static renderLegendTitleColor(e,t,i){if(!N.transparent.equals(e.legend.title.color))return void(t.legend.titleColor=e.legend.title.color);e.style==o.Custom&&!N.transparent.equals(t.legend.titleColor)||(t.legend.titleColor=i)}static renderSeriesLabelsLegendValueType(e,t){let i=0;t.series.list.filter(e=>null!=e.arguments).forEach(e=>{i+=e.arguments.filter(e=>null!=e).length}),null==e.legend.labels.valueType?0<i&&1<t.series.count?t.seriesLabels.legendValueType=fl.SeriesTitleArgument:1==i&&1==t.series.count&&(e.isPieChart||e.isPie3dChart||e.isDoughnutChart)?t.seriesLabels.legendValueType=fl.SeriesTitle:0<i&&1==t.series.count?t.seriesLabels.legendValueType=fl.Argument:0==i&&1<t.series.count?t.seriesLabels.legendValueType=fl.SeriesTitle:t.seriesLabels.legendValueType=e.isBubbleChart?fl.Weight:fl.Value:t.seriesLabels.legendValueType=e.legend.labels.valueType}static renderLegendLabelsColor(e,t,i){if(!N.transparent.equals(e.legend.labels.color))return void(t.legend.labelsColor=e.legend.labels.color);e.style==o.Custom&&!N.transparent.equals(t.legend.labelsColor)||(t.legend.labelsColor=i)}static async renderConditions(e,t,i,r){let s=null!=i.chartConditions?i.chartConditions.where(e=>e.keyValueMeter==r.key):null,l=(null!=s&&await this.renderValueConditions(i,t,s),null!=i.chartConditions?i.chartConditions.where(e=>e.field==on.EndValue):null),n=(null!=l&&await this.renderEndValueConditions(i,t,l),null!=i.chartConditions?i.chartConditions.where(e=>e.field==on.Argument):null),a=(null!=n&&await this.renderArgumentConditions(i,t,n),null!=i.chartConditions?i.chartConditions.where(e=>e.field==on.Series):null);null!=a&&await this.renderSeriesConditions(i,t,a,e)}static async renderValueConditions(i,r,e){for(let t of e){let e=t.isExpression?await k.parseAsync(`{${t.value}}`,i):t.value;r.conditions.add(new P.Report.Chart["StiChartCondition"](t.color,P.Report.Components.StiFilterItem.Value,t.dataType,t.condition,e,t.markerType,t.markerAngle))}}static async renderEndValueConditions(i,r,e){for(let t of e){let e=t.isExpression?await k.parseAsync(`{${t.value}}`,i):t.value;r.conditions.add(new P.Report.Chart["StiChartCondition"](t.color,P.Report.Components.StiFilterItem.ValueEnd,t.dataType,t.condition,e,t.markerType,t.markerAngle))}}static async renderArgumentConditions(i,r,e){for(let t of e){let e=t.isExpression?await k.parseAsync(`{${t.value}}`,i):t.value;r.conditions.add(new P.Report.Chart["StiChartCondition"](t.color,P.Report.Components.StiFilterItem.Argument,t.dataType,t.condition,e,t.markerType,t.markerAngle))}}static async renderSeriesConditions(i,r,e,s){for(let t of e){let e=t.isExpression?await k.parseAsync(`{${t.value}}`,i):t.value;this.getConditionResult(null==e?void 0:e.toString(),s,t.condition)&&(r.legendColor=t.color,r.conditions.add(new P.Report.Chart["StiChartCondition"](t.color,P.Report.Components.StiFilterItem.Argument,P.Report.Components.StiFilterDataType.String,P.Report.Components.StiFilterCondition.BeginningWith,"",t.markerType,t.markerAngle)))}}static getConditionResult(i,r,t){let e=!1;if(null!=r){let e=r;if(null!=e&&null!=i){r[P.System.StiObject.stimulsoft]().getType()!=i[P.System.StiObject.stimulsoft]().getType()&&(r=r.toString(),i=i[P.System.StiObject.stimulsoft]().toString(),e=r);try{switch(t){case P.Report.Components.StiFilterCondition.EqualTo:return 0==e[P.System.StiObject.stimulsoft]().compareTo(i);case P.Report.Components.StiFilterCondition.NotEqualTo:return 0!=e[P.System.StiObject.stimulsoft]().compareTo(i);case P.Report.Components.StiFilterCondition.GreaterThan:return 1==e[P.System.StiObject.stimulsoft]().compareTo(i);case P.Report.Components.StiFilterCondition.GreaterThanOrEqualTo:return 0<=e[P.System.StiObject.stimulsoft]().compareTo(i);case P.Report.Components.StiFilterCondition.LessThan:return-1==e[P.System.StiObject.stimulsoft]().compareTo(i);case P.Report.Components.StiFilterCondition.LessThanOrEqualTo:return e[P.System.StiObject.stimulsoft]().compareTo(i)<=0;case P.Report.Components.StiFilterCondition.Containing:{let e=r.toString(),t=i.toString();return-1!=e.indexOf(t)}case P.Report.Components.StiFilterCondition.NotContaining:{let e=r.toString(),t=i.toString();return-1==e.indexOf(t)}case P.Report.Components.StiFilterCondition.BeginningWith:{let e=r.toString(),t=i.toString();return e.startsWith(t)}case P.Report.Components.StiFilterCondition.EndingWith:{let e=r.toString(),t=i.toString();return e.endsWith(t)}}}catch(e){}}}return e}static async renderConstantLines(r,s){for(let i of r.constantLines){let e=!H.isNullOrEmpty(i.text),t=new P.Report.Chart["StiConstantLines"];t.allowApplyStyle=!1,t.text=i.text,t.axisValue=await k.parseAsync(i.axisValue,r),t.lineColor=i.lineColor,t.lineStyle=i.lineStyle,t.lineWidth=i.lineWidth,t.titleVisible=e,t.orientation=r.isBarChart?oc.Vertical:oc.Horizontal,t.position=i.position,s.constantLines.add(t)}}static renderTrendLines(t,e,i){let r,s=null==(r=e.trendLines)?void 0:r.where(e=>e.keyValueMeter==i.key).toList();t.trendLines.clear();for(let e of s)t.trendLines.add(this.getTrendLine(e,t.chart))}static getTrendLine(t,i){switch(t.type){case kl.None:return new P.Report.Chart["StiTrendLineNone"];case kl.Exponential:{let e=new P.Report.Chart["StiTrendLineExponential"];return e.allowApplyStyle=!1,e.lineColor=N.transparent.equals(t.lineColor)?i.style.core.trendLineColor:t.lineColor,e.lineStyle=t.lineStyle,e.lineWidth=t.lineWidth,e.showShadow=!1,e}case kl.Linear:{let e=new P.Report.Chart["StiTrendLineLinear"];return e.allowApplyStyle=!1,e.lineColor=N.transparent.equals(t.lineColor)?i.style.core.trendLineColor:t.lineColor,e.lineStyle=t.lineStyle,e.lineWidth=t.lineWidth,e.showShadow=!1,e}case kl.Logarithmic:{let e=new P.Report.Chart["StiTrendLineLogarithmic"];return e.allowApplyStyle=!1,e.lineColor=N.transparent.equals(t.lineColor)?i.style.core.trendLineColor:t.lineColor,e.lineStyle=t.lineStyle,e.lineWidth=t.lineWidth,e.showShadow=!1,e}}}async renderSeriesLabels(t,i){if(!(t.isPieChart||t.isPie3dChart||t.isFunnelChart||t.isPictorialStackedChart||t.isDoughnutChart||t.isTreemapChart||t.isAxisAreaChart||t.isSunburstChart||t.isRadarChart||t.isWaterfallChart||t.isAxisAreaChart3D||t.isLineChart3D))return void(i.seriesLabels.visible=!1);if(i.allowApplyStyle=!1,t.isPieChart?g.renderPieLabelsPosition(t,i):t.isPie3dChart?g.renderPie3dLabelsPosition(t,i):t.isDoughnutChart||t.isSunburstChart?g.renderDoughnutLabelsPosition(t,i):t.isFunnelChart?g.renderFunnelLabelsPosition(t,i):t.isPictorialStackedChart?g.renderPictorialStackedLabelsPosition(t,i):t.isTreemapChart?g.renderTreemapLabelsPosition(t,i):t.isHeatmapChart?g.renderHeatmapLabelsPosition(t,i):t.isWaterfallChart?g.renderWaterfallLabelsPosition(t,i):t.isStackedChart?g.renderStackedLabelsPosition(t,i):t.isRadarChart?g.renderRadarLabelsPosition(t,i):t.isAxisAreaChart?g.renderAxisLabelsPosition(t,i):t.isAxisAreaChart3D?g.renderClusteredColumn3DLabelsPosition(t,i):t.isLineChart3D&&this.renderLine3DLabelsPosition(t,i),i.seriesLabels.core.applyStyle(i.style),await g.applyPropertiesToSeriesLabels(t,i.seriesLabels.as(vc)),t.isStackedChart)for(let e of i.series.list)await g.applyPropertiesToSeriesLabels(t,e.seriesLabels.as(vc));t.isPieChart||t.isPie3dChart||t.isDoughnutChart||t.isSunburstChart?(g.renderPieLabelsStyle(t,i),g.renderPieLabelsAutoRotate(t,i),g.renderSeriesLabelsLegendValueType(t,i)):t.isFullStackedChart?(g.renderLabelsStyle(t,i),i.seriesLabels.showInPercent=!0):g.renderLabelsStyle(t,i),g.renderLabelsColor(t,i),g.renderLabelsTextFormat(t,i),g.renderLabelsShowZeros(i),g.renderLabelsShowZeros(i)}static renderLabelsShowZeros(r){for(let i of r.series.toList()){let e=i.as(Wc);if(null!=e)return void(r.seriesLabels.showZeros=e.showZerosAs==Bc.Zero);let t=i.as(Lc);if(null!=t)return void(r.seriesLabels.showZeros=t.showZeros)}}static renderLabelsShowNulls(r){for(let i of r.series.toList()){let e=i.as(Jc);if(null!=e)return void(r.seriesLabels.showNulls=e.showNullsAs==Bc.Zero);let t=i.as(sn);if(null!=t)return void(r.seriesLabels.showNulls=t.showNulls)}}static async applyPropertiesToSeriesLabels(e,t){t.preventIntersection=e.isAxisAreaChart,t.textAfter=await k.parseAsync(e.labels.textAfter,e),t.textBefore=await k.parseAsync(e.labels.textBefore,e),t.font=g.getSmallStyleFont(e,e.labels.font),t.showZeros=!1,t.width=e.labels.width,t.wordWrap=e.labels.wordWrap}static renderPieLabelsAutoRotate(e,t){let i=t.seriesLabels.as(wc);null!=i&&(i.autoRotate=e.labels.autoRotate)}static renderLabelsColor(e,t){let i,r,s=t.seriesLabels.as(vc),l=t.seriesLabels.as(Sc);N.transparent.equals(e.labels.foreColor)?(s.labelColor=N.gray,s.labelColor=U.isDarkStyle2(e.style)?N.fromArgb2(50,50,50):null!=(null==(i=null==t?void 0:t.style)?void 0:i.core)?t.style.core.seriesLabelsColor:N.gray,null!=l&&(l.lineColor=null!=(null==(r=null==t?void 0:t.style)?void 0:r.core)?t.style.core.seriesLabelsLineColor:N.gray)):(s.labelColor=e.labels.foreColor,null!=l&&(l.lineColor=e.labels.foreColor))}static renderLabelsTextFormat(e,t){t.seriesLabels.formatService=e.valueFormat}static renderFunnelLabelsPosition(e,t){switch(e.labels.funnelPosition){case S.None:t.seriesLabels.visible=!1;break;case S.Left:t.seriesLabels=new P.Report.Chart["StiOutsideLeftFunnelLabels"];break;case S.Center:t.seriesLabels=new P.Report.Chart["StiCenterFunnelLabels"];break;case S.Right:t.seriesLabels=new P.Report.Chart["StiOutsideRightFunnelLabels"];break;default:t.seriesLabels.visible=!1;break}}static renderPictorialStackedLabelsPosition(e,t){switch(e.labels.pictorialStackedPosition){case S.None:t.seriesLabels.visible=!1;break;case S.Left:t.seriesLabels=new P.Report.Chart["StiOutsideLeftPictorialStackedLabels"];break;case S.Center:t.seriesLabels=new P.Report.Chart["StiCenterPictorialStackedLabels"];break;case S.Right:t.seriesLabels=new P.Report.Chart["StiOutsideRightPictorialStackedLabels"];break;default:t.seriesLabels.visible=!1;break}}static renderTreemapLabelsPosition(e,t){switch(e.labels.treemapPosition){case S.None:t.seriesLabels.visible=!1;break;case S.Center:t.seriesLabels=new P.Report.Chart["StiCenterTreemapLabels"];break;default:t.seriesLabels.visible=!1;break}}static renderHeatmapLabelsPosition(e,t){switch(e.labels.heatmapPosition){case S.None:t.seriesLabels.visible=!1;break;case S.Center:t.seriesLabels=new P.Report.Chart["StiCenterHeatmapLabels"];break;default:t.seriesLabels.visible=!1;break}}static renderPieLabelsPosition(e,t){switch(e.labels.piePosition){case S.None:t.seriesLabels.visible=!1;break;case S.Center:t.seriesLabels=new P.Report.Chart["StiCenterPieLabels"];break;case S.InsideEnd:t.seriesLabels=new P.Report.Chart["StiInsideEndPieLabels"];break;case S.Outside:t.seriesLabels=new P.Report.Chart["StiOutsidePieLabels"];break;case S.TwoColumns:t.seriesLabels=new P.Report.Chart["StiTwoColumnsPieLabels"];break;default:t.seriesLabels.visible=!1;break}}static renderPie3dLabelsPosition(e,t){switch(e.labels.pie3dPosition){case S.None:t.seriesLabels.visible=!1;break;case S.Center:t.seriesLabels=new P.Report.Chart["StiCenterPie3dLabels"];break;case S.InsideEnd:t.seriesLabels=new P.Report.Chart["StiInsideEndPie3dLabels"];break;default:t.seriesLabels.visible=!1;break}}static renderStackedLabelsPosition(e,i){switch(e.labels.axisPosition){case S.Total:{let t=i.series.toList().lastOrDefault();i.series.toList().where(e=>e!=t).toList().forEach(e=>{e.showSeriesLabels=Nc.FromSeries,e.seriesLabels.visible=!1}),t.showSeriesLabels=Nc.FromSeries,t.seriesLabels=new P.Report.Chart["StiValueAxisLabels"],t.isTotalLabel=!0,t.seriesLabels.formatService=e.valueFormat;break}default:g.renderAxisLabelsPosition(e,i);break}}static renderRadarLabelsPosition(e,t){switch(e.labels.radarPosition){case S.None:t.seriesLabels.visible=!1;break;case S.Center:t.seriesLabels=new P.Report.Chart["StiCenterAxisLabels"];break;default:t.seriesLabels.visible=!1;break}}static renderWaterfallLabelsPosition(e,t){switch(e.labels.axisPosition){case S.None:t.seriesLabels.visible=!1;break;case S.Center:t.seriesLabels=new P.Report.Chart["StiCenterAxisLabels"];break;case S.InsideBase:t.seriesLabels=new P.Report.Chart["StiInsideBaseAxisLabels"];break;case S.InsideEnd:t.seriesLabels=new P.Report.Chart["StiInsideEndAxisLabels"];break;case S.Outside:t.seriesLabels=new P.Report.Chart["StiOutsideAxisLabels"];break;case S.OutsideBase:t.seriesLabels=new P.Report.Chart["StiOutsideBaseAxisLabels"];break;case S.OutsideEnd:t.seriesLabels=new P.Report.Chart["StiOutsideEndAxisLabels"];break;case S.Value:t.seriesLabels=new P.Report.Chart["StiValueAxisLabels"];break;default:t.seriesLabels.visible=!1;break}}static renderAxisLabelsPosition(e,t){switch(e.labels.axisPosition){case S.None:t.seriesLabels.visible=!1;break;case S.Center:t.seriesLabels=new P.Report.Chart["StiCenterAxisLabels"];break;case S.InsideBase:t.seriesLabels=new P.Report.Chart["StiInsideBaseAxisLabels"];break;case S.InsideEnd:t.seriesLabels=new P.Report.Chart["StiInsideEndAxisLabels"];break;case S.Left:t.seriesLabels=new P.Report.Chart["StiLeftAxisLabels"];break;case S.Outside:t.seriesLabels=new P.Report.Chart["StiOutsideAxisLabels"];break;case S.OutsideBase:t.seriesLabels=new P.Report.Chart["StiOutsideBaseAxisLabels"];break;case S.OutsideEnd:t.seriesLabels=new P.Report.Chart["StiOutsideEndAxisLabels"];break;case S.Right:t.seriesLabels=new P.Report.Chart["StiRightAxisLabels"];break;case S.Value:t.seriesLabels=new P.Report.Chart["StiValueAxisLabels"];break;default:t.seriesLabels.visible=!1;break}}static renderClusteredColumn3DLabelsPosition(e,t){switch(e.labels.clusteredColumn3dPosition){case S.None:t.seriesLabels.visible=!1;break;case S.Center:t.seriesLabels=new P.Report.Chart["StiCenterAxisLabels3D"];break;case S.Outside:t.seriesLabels=new P.Report.Chart["StiOutsideAxisLabels3D"];break;default:t.seriesLabels.visible=!1;break}}renderLine3DLabelsPosition(e,t){switch(e.labels.line3dPosition){case S.None:t.seriesLabels.visible=!1;break;case S.Center:t.seriesLabels=new P.Report.Chart["StiCenterAxisLabels3D"];break;case S.Outside:t.seriesLabels=new P.Report.Chart["StiOutsideAxisLabels3D"];break;default:t.seriesLabels.visible=!1;break}}static renderDoughnutLabelsPosition(e,t){switch(e.labels.doughnutPosition){case S.None:t.seriesLabels.visible=!1;break;case S.Center:t.seriesLabels=new P.Report.Chart["StiCenterPieLabels"];break;case S.Outside:t.seriesLabels=new P.Report.Chart["StiOutsidePieLabels"];break;default:t.seriesLabels.visible=!1;break}}static renderPieLabelsStyle(e,t){let i=t.seriesLabels.as(pc);switch(e.labels.style){case gc.PercentOfTotal:i.showInPercent=!0,i.valueType=fl.Value;break;case gc.Category:i.showInPercent=!1,i.valueType=e.arguments.any()?fl.Argument:fl.SeriesTitle;break;case gc.CategoryPercentOfTotal:i.showInPercent=!0,i.valueType=e.arguments.any()?fl.ArgumentValue:fl.SeriesTitleValue;break;case gc.CategoryValue:i.showInPercent=!1,i.valueType=e.arguments.any()?fl.ArgumentValue:fl.SeriesTitleValue;break;case gc.Value:i.showInPercent=!1,i.valueType=fl.Value;break}}static renderLabelsStyle(e,t){let i=t.seriesLabels;switch(e.labels.style){case gc.PercentOfTotal:i.valueType=fl.Value;break;case gc.Category:i.valueType=e.arguments.any()?fl.Argument:fl.SeriesTitle;break;case gc.CategoryPercentOfTotal:i.valueType=e.arguments.any()?fl.ArgumentValue:fl.SeriesTitleValue;break;case gc.CategoryValue:i.valueType=e.arguments.any()?fl.ArgumentValue:fl.SeriesTitleValue;break;case gc.Value:i.valueType=fl.Value;break}}async renderSeriesInteraction(s,l,e,i){var n;if(s.chart.isDesigning)return;let r=null==l?void 0:l.report,a=0,t=l.dashboardInteraction;if(t.onHover==ci.ShowToolTip){s.toolTips=Pl.create(String,e);for(let t of s.arguments){let e="";a<s.values.length&&null!=s.values[a]&&(e=s.values[a].toString()),s.toolTips[a]=await this.getToolTip(s.chart.style,l,null,l.dashboardInteraction.toolTip,this.getString(l.argumentFormat,t,r),this.getString(l.valueFormat,e,r),"",i),a++}}a=0,s.hyperlinks=Pl.create(String,e);for(let r of s.arguments){let e="",t="",i=(a<s.values.length&&null!=s.values[a]&&(e=s.values[a].toString()),s.as(Uc));null!=i&&a<i.valuesEnd.length&&(t=null==(n=i.valuesEnd[a])?void 0:n.toString()),a<s.hyperlinks.length&&(s.hyperlinks[a]=await this.getHyperlink(l,s,l.dashboardInteraction.hyperlink,null==r?void 0:r.toString(),e,t,s.titleValue,a)),a++}s.drillDownEnabled=!0}async getToolTip(i,e,t,r,s,l,n,a){if(null==s&&(s=""),null==a&&(a=""),H.isNullOrWhiteSpace(r)){null==s||H.isNullOrEmpty(s)||(s=s.split('"').join('\\"'));let e='"StiColor":"{0}","StiValue":"{1}","StiArgument":"{2}"{3}',t=await this.getToolTipStyle(i);return"{"+H.format(e,"#ffffff",l,s,t)+"}"}return this.getHyperlink(e,t,r,s,l,n,a,0)}async getToolTipStyle(e){let t=P.Base.StiJsonReportObjectHelper.Serialize.jBrush(e.core.toolTipBrush),i=P.Base.StiJsonReportObjectHelper.Serialize.jBrush(e.core.toolTipTextBrush),r=P.Base.StiJsonReportObjectHelper.Serialize.jBorder2(e.core.toolTipBorder),s=e.core.toolTipCornerRadius.toString();return`,"StiToolTipCornerRadius":"${s}","StiToolTipBrush":"${t}","StiToolTipTextBrush":"${i}","StiToolTipBorder":"${r}"`}async getHyperlink(s,e,t,i,r,l,n,a){null==i&&(i=""),null==n&&(n="");let o=new Ro,u=(o.add("Argument",i),o.add("Value",r),o.add("EndValue ",l),o.add("Series",n),null==e?void 0:e.originalArguments[a]);if(Pl.isArray(u)&&1<u.length){let r=0;u.forEach(e=>{let t=s.arguments[r],i=`Argument_`+this.getIdentFromArgument(t,r+1);o.containsKey(i)||o.add(i,e),r++})}return k.parseAsync(t,s,!1,o)}getIdentFromArgument(e,t){if(!H.isNullOrWhiteSpace(e.label))return kr.correctName(e.label);let i=Or.getFirstArgumentFromExpression(e.expression),r=i.indexOf(".");if(-1!=r&&(i=i.substr(r+1)),!H.isNullOrEmpty(i))return i;return t.toString()}getTitle(e){return nm.getLabel(e)}getSeriesTitle(e,t,i){if(e.values.length<2)return t;let r=nm.getLabel(i),s=H.isNullOrWhiteSpace(r)?null:r;if(null==s)return t;return H.isNullOrWhiteSpace(t)?s:t+` - `+s}getArgumentIndex(e,t){let i=this.getArgumentMeterIndexes(e).toList();if(null==i||!i.any())return-1;if(1==i.length)return i.firstOrDefault();if(t<i.length
)return le.trunc(i[t]);return-1}simplifyValues(e){let t=0;while(t<e.series.count){let i=e.series.getByIndex(t);if(800<i.values.length){let t=this.getShorterListPoints(i);i.values=[],i.arguments=[];for(let e=0;e<t.length;e++)i.values[e]=t[e].x,i.arguments[e]=t[e].y}t++}}getShorterListPoints(t){let i=[];for(let e=0;e<t.values.length;e++)i[e]=new qn(t.values[e],e);let r=[.3,.6,1,5,9,15,20,25,30,40],s=null,l=null;for(let e=0;e<r.length;e++){if((s=P.Report.Chart["StiSimplifyHelper"].simplify(i,e,!0)).length/i.length<.02&&s.length<900&&null!=l){s=l;break}l=s}return s}getString(i,r,s){if(null==r)return"";if(Pl.isArray(r)){let t=[];for(let e of r)t.push(this.getFormatValue(i,e,s));return H.join(" - ",t)}return this.getFormatValue(i,r,s)}getFormatValue(e,t,i){if(null==t)return"";if(t instanceof F)return e.is2(Ji)||e.is2(Gi)||e.is2(wn)?e.format(t):t.toShortDateString();let r=null==i?void 0:i.getParsedCulture();if(nr.isEligable(t,r))return nr.convert(t,r);if(null!=e)return e.format(t);return t.toString()}async calculateIndicatorValue(i){if(null==i.indicatorValue||null!=i.indicatorValue&&H.isNullOrEmpty(i.indicatorValue.expression))return;let r=yn.getKey(i);if(ec.existsInCache(r))this.indicatorValueValue=ec.getFromCache(r);else{let e=i.clone(!0),t=(e.values=new j,e.arguments=new j,await yn.getOrCreate(e));null!=t&&(this.indicatorValueValue=t.rows.getArrayItem(0).tryCastToNullableNumber().sum(),ec.addToCache(r,this.indicatorValueValue))}}static create(e){if(e.isSunburstChart)return new R.i.StiSunburstChartElementBuilder;if(e.isHeatmapChart)return new R.i.StiHeatmapChartElementBuilder;if(e.isBubbleChart)return new R.i.StiBubbleChartElementBuilder;if(e.isRange)return new R.i.StiRangeChartElementBuilder;if(e.isFinancial)return new R.i.StiFinancialChartElementBuilder;if(e.isFullStackedChart||e.isStackedChart||e.isRibbonChart)return new R.i.StiStackedChartElementBuilder;return new g}static scaleFont(e,t,i=.05){if(Math.abs(1-t)<=i)return;e.labels.font=Hn.changeFontSize(e.labels.font,e.labels.font.size*t),e.legend.font=Hn.changeFontSize(e.legend.font,e.legend.font.size*t);let r=e.area.as(Rc);null!=r&&(r.xAxis.labels.font=Hn.changeFontSize(r.xAxis.labels.font,r.xAxis.labels.font.size*t),r.xTopAxis.labels.font=Hn.changeFontSize(r.xTopAxis.labels.font,r.xTopAxis.labels.font.size*t),r.yAxis.labels.font=Hn.changeFontSize(r.yAxis.labels.font,r.yAxis.labels.font.size*t),r.yRightAxis.labels.font=Hn.changeFontSize(r.yRightAxis.labels.font,r.yRightAxis.labels.font.size*t))}static getStyleFont(e,t){return U.getElementFontFromStyle(e,t)}static getSmallStyleFont(e,t){let i=U.getElementFontFromStyle(e);if(null==i)return t;let r=U.getElementFontFromStyle(e),s=8*r.size/13,l=e.cachedSmallFont;if(null!=l&&l.name==r.name&&l.style==r.style&&l.size==s)return l;return e.cachedSmallFont=Hn.changeFontSize(r,s),e.cachedSmallFont}getValueMeterIndexes(t){if(null==t)return null;return this.getValueMeters(t).select(e=>t.meters.indexOf(e))}getArgumentMeterIndexes(t){if(null==t)return null;return this.getArgumentMeters(t).select(e=>t.meters.indexOf(e)).toList()}getSeriesMeterIndex(e){if(null==e)return-1;let t=e.meters.firstOrDefault(e=>e.is(zs));return null!=t?e.meters.indexOf(t):-1}getArgumentKeys(e,t){if(null==t)return null;let i=this.getArgumentMeters(t),r=i.select(e=>t.meters.indexOf(e)).toList(),s=t.rows.groupBy2(t=>r.select(e=>t[e]),new Qh);return s.select(e=>e.key)}getValueMeters(e){if(null==e)return null;return e.meters.where(e=>e.is(js)).cast()}getArgumentMeters(e){if(null==e)return null;return e.meters.where(e=>e.is(Hs)).cast()}}R.i.StiChartElementBuilder=g}let Yc=P.Report.Chart.IStiBubbleSeries,Kc=(R.i.StiBubbleChartElementBuilder=class extends R.i.StiChartElementBuilder{async renderElements(u,h,m){let c=this.getSeriesMeterIndex(m),e=this.getSeriesKeys(m,c),t=this.getValueMeters(m),d=e.count2();for(let o of e){let a=0;for(let n of t){let e=this.getValueMeterIndexes(m)[a],t=this.renderSeries(u,n,o,h);if(null==t)continue;let i=-1!=c&&1<d?m.rows.whereArrayItemStringEqualsTo(c,o):m.rows,r=(await R.i.StiChartElementBuilder.renderConditions(this.toString(o),t,u,n),t.values=i.getArrayItem(e).tryCastToNullableNumber(),this.getArgumentIndex(m,e)),s=(-1!=r&&(t.arguments=i.getArrayItem(r)),t.weights=null,this.getWeightIndex(m,e));if(-1!=s&&(t.weights=i.getArrayItem(s).tryCastToNumber()),null==t.weights){t.weights=[];for(let e=0;e<t.arguments.length;e++)t.weights[e]=10}a++;let l=Math.min(t.values.length,t.arguments.length);await this.renderSeriesInteraction(t,u,l,o)}}}renderSeries(e,t,i,r){let s=new P.Report.Chart["StiBubbleSeries"];return s.coreTitle=this.getSeriesTitle(e,i,t),s.isDashboard=!0,r.series.add(s),s}async renderSeriesInteraction(n,e,t,a){let o=n.as(Yc);if(null==o)return;let u=e.dashboardInteraction;if(u.onHover==ci.ShowToolTip){n.toolTips=Pl.create(String,t);for(let l=0;l<t;l++){let i="",r="",s="";if(l<n.values.length&&null!=n.values[l]&&(i=n.values[l].toString()),l<n.arguments.length&&null!=n.arguments[l]&&(r=``+n.arguments[l]),l<o.weights.length&&(s=o.weights[l].toString()),H.isNullOrEmpty(u.toolTip)){let e='"StiColor":"{0}","StiValue":"{1}","StiArgument":"{2}","StiWeight":"{3}"{4}',t=await this.getToolTipStyle(n.chart.style);n.toolTips[l]="{"+H.format(e,"#ffffff",i,r,s,t)+"}"}else n.toolTips[l]=await this.getHyperlink2(e,u.toolTip,r,i,s,a)}}n.drillDownEnabled=!0}async getHyperlink2(e,t,i,r,s,l){null==i&&(i=""),null==l&&(l="");let n=new Ro;return n.add("Argument",i),n.add("Value",r),n.add("Weight",s),n.add("Series",l),k.parseAsync(t,e,!1,n)}getWeightIndex(e,t){if(null==e)return-1;let i=this.getWeightMeterIndexes(e);if(null==i)return-1;if(!i.any())return-1;if(1==i.length)return i.toList().firstOrDefault();if(i.length>t)return le.trunc(i[t]);return-1}getWeightMeterIndexes(t){if(null==t)return null;return this.getWeightMeters(t).select(e=>t.meters.indexOf(e)).toList()}getWeightMeters(e){if(null==e)return null;return e.meters.where(e=>e.is(Vs)).cast()}getValueMeters(e){if(null==e)return null;return e.meters.where(e=>e.is(Nr)).cast()}getArgumentMeters(e){if(null==e)return null;return e.meters.where(e=>e.is(Lr)).cast()}},P.Report.Chart.IStiFinancialSeries),Qc=(R.i.StiFinancialChartElementBuilder=class extends R.i.StiChartElementBuilder{async renderElements(c,d,g){let p=null==d?void 0:d.report,S=this.getSeriesMeterIndex(g),e=this.getSeriesKeys(g,S),t=this.getValueMeters(g),w=e.count2();for(let m of e){let h=0;for(let u of t){let e=this.getValueMeterIndexes(g)[h],t=this.renderSeries(c,u,m,d),i=t.as(Kc);if(null==t||null==i)continue;let r=-1!=S&&1<w?g.rows.whereArrayItemStringEqualsTo(S,m):g.rows,s=(i.valuesOpen=r.getArrayItem(e).tryCastToNullableNumber(),i.valuesClose=null,this.getCloseValueIndex(g,e));if(-1!=s&&(i.valuesClose=r.getArrayItem(s).tryCastToNullableNumber()),null==i.valuesClose){i.valuesClose=[];for(let e=0;e<t.argument.length;e++)i.valuesClose[e]=10}i.valuesLow=null;let l=this.getLowValueIndex(g,e);if(-1!=l&&(i.valuesLow=r.getArrayItem(l).tryCastToNullableNumber()),null==i.valuesLow){i.valuesLow=[];for(let e=0;e<t.argument.length;e++)i.valuesLow[e]=10}i.valuesHigh=null;let n=this.getHighValueIndex(g,e);if(-1!=n&&(i.valuesHigh=r.getArrayItem(n).tryCastToNullableNumber()),null==i.valuesHigh){i.valuesHigh=[];for(let e=0;e<t.argument.length;e++)i.valuesHigh[e]=10}let a=this.getArgumentIndex(g,e),o=(-1!=a&&(t.arguments=r.getArrayItem(a).select(e=>this.getString(c.argumentFormat,e,p))),h++,Math.min(t.values.length,t.arguments.length));await this.renderSeriesInteraction(t,c,o,m)}}}renderSeries(e,t,i,r){let s=Hl.neww2(t.as(Ns).seriesType);return s.coreTitle=this.getSeriesTitle(e,i,t),s.isDashboard=!0,r.series.add(s),s}async renderSeriesInteraction(o,e,t,i){let u=o.as(Kc);if(null==u)return;let r=e.dashboardInteraction;if(r.onHover==ci.ShowToolTip){o.toolTips=Pl.create(String,t);for(let a=0;a<t;a++){let e="",t="",i="",r="",s="",l=(a<u.valuesOpen.length&&null!=u.valuesOpen[a]&&(e=u.valuesOpen[a].toString()),a<u.valuesClose.length&&(t=u.valuesClose[a].toString()),a<u.valuesLow.length&&(i=u.valuesLow[a].toString()),a<u.valuesHigh.length&&(r=u.valuesHigh[a].toString()),a<o.arguments.length&&null!=o.arguments[a]&&(s=``+o.arguments[a]),'"StiColor":"{0}","StiOpenValue":"{1}","StiCloseValue":"{2}","StiLowValue":"{3}","StiHighValue":"{4}","StiArgument":"{5}"{6}'),n=await this.getToolTipStyle(o.chart.style);o.toolTips[a]="{"+H.format(l,"#ffffff",e,t,i,r,s,n)+"}"}}o.drillDownEnabled=!0}async renderArea(e,c){await super.renderArea(e,c);let d=null,g=null;for(let m=0;m<c.series.count;m++){let e=c.series.getByIndex(m).as(Kc);if(null==e)continue;let t=e.valuesOpen[P.System.StiObject.stimulsoft]().toList().min(),i=e.valuesClose[P.System.StiObject.stimulsoft]().toList().min(),r=e.valuesLow[P.System.StiObject.stimulsoft]().toList().min(),s=e.valuesHigh[P.System.StiObject.stimulsoft]().toList().min(),l=e.valuesOpen[P.System.StiObject.stimulsoft]().toList().max(),n=e.valuesClose[P.System.StiObject.stimulsoft]().toList().max(),a=e.valuesLow[P.System.StiObject.stimulsoft]().toList().max(),o=e.valuesHigh[P.System.StiObject.stimulsoft]().toList().max(),u=new j([t,i,r,s]).min(),h=new j([l,n,a,o]).max();null==d&&(d=u),null==g&&(g=h),d=Math.min(d,u),g=Math.max(g,h)}let t=c.area.as(Rc),i=(t.yAxis.range.auto=!1,t.yAxis.range.minimum=d,t.yAxis.range.maximum=g,t.yAxis.range.maximum-t.yAxis.range.minimum);t.yAxis.labels.step=2<i?Math.round(i/10):le.round2(i/10,4)}getValueMeters(e){if(null==e)return null;return e.meters.where(e=>e.is(Ns)).cast()}getCloseValueIndex(e,t){if(null==e)return-1;let i=this.getCloseMeterIndexes(e);if(null==i||!i.any())return-1;if(1==i.length)return i.toList().firstOrDefault();if(t<i.length)return i[t];return-1}getCloseMeterIndexes(t){if(null==t)return null;return this.getCloseMeters(t).select(e=>t.meters.indexOf(e)).toList()}getCloseMeters(e){if(null==e)return null;return e.meters.where(e=>e.is(Ls)).cast()}getLowValueIndex(e,t){if(null==e)return-1;let i=this.getLowMeterIndexes(e);if(null==i||!i.any())return-1;if(1==i.length)return i.toList().firstOrDefault();if(t<i.length)return i[t];return-1}getLowMeterIndexes(t){if(null==t)return null;return this.getLowMeters(t).select(e=>t.meters.indexOf(e)).toList()}getLowMeters(e){if(null==e)return null;return e.meters.where(e=>e.is(Bs)).cast()}getHighValueIndex(e,t){if(null==e)return-1;let i=this.getHighMeterIndexes(e);if(null==i)return-1;if(!i.any())return-1;if(1==i.length)return i.toList().firstOrDefault();if(i.length>t)return i[t];return-1}getHighMeterIndexes(t){if(null==t)return null;return this.getHighMeters(t).select(e=>t.meters.indexOf(e)).toList()}getHighMeters(e){if(null==e)return null;return e.meters.where(e=>e.is(Ps)).cast()}},P.Report.Chart.StiHeatmapHelper),qc=(R.i.StiHeatmapChartElementBuilder=class extends R.i.StiChartElementBuilder{async renderElements(u,h,m){let c=null==h?void 0:h.report,d=this.getSeriesMeterIndex(m),e=this.getSeriesKeys(m,d),t=this.getValueMeters(m),g=e.count2();for(let o of e){let a=0;for(let n of t){let e=this.getValueMeterIndexes(m)[a],t=this.renderSeries(u,n,o,h),i=t.as(Zc);if(null==t||null==i)continue;let r=-1!=d&&1<g?m.rows.whereArrayItemStringEqualsTo(d,o):m.rows,s=(t.values=r.getArrayItem(e).tryCastToNullableNumber(),this.getXValueIndex(m,e)),l=(i.xValues=-1!=s?r.getArrayItem(s).select(e=>this.getString(u.argumentFormat,e,c)):[""],this.getYValueIndex(m,e));i.yValues=-1!=l?r.getArrayItem(l).select(e=>this.getString(u.argumentFormat,e,c)):[""],a++,await this.renderSeriesInteraction(t,u,t.values.length,o)}}}renderSeries(e,t,i,r){let s=new P.Report.Chart["StiHeatmapSeries"];return s.coreTitle=this.getSeriesTitle(e,i,t),s.isDashboard=!0,r.series.add(s),s}async renderSeriesInteraction(a,e,t,i){if(a.chart.isDesigning)return;let o=a.as(Zc);if(null==o)return;let r=a.core,u=r.getHeatmapColors(),s=r.getAllValues(),h=s.min(),m=s.max(),c=e.dashboardInteraction.as(Xl);if(c.onHover==ci.ShowToolTip){a.toolTips=Pl.create(String,t);for(let n=0;n<t;n++){let r=0,s="",l="";if(n<o.values.length&&null!=o.values[n]&&(r=o.values[n]),n<o.xValues.length&&(s=o.xValues[n].toString()),n<o.yValues.length&&(l=o.yValues[n].toString()),H.isNullOrEmpty(c.toolTip)){let e='{{"StiColor":"{0}","StiValue":"{1}","StiXValue":"{2}","StiYValue":"{3}"{4}}}',t=await this.getToolTipStyle(a.chart.style),i=Qc.getColorFromRange(u,h,m,r);a.toolTips[n]=H.format(e,Uu.toHtml(i),r,s,l,t)}else a.toolTips[n]=await this.getHyperlink3(e,c.toolTip,r.toString(),s,l,i)}}a.drillDownEnabled=!0}async getHyperlink3(e,t,i,r,s,l){null==l&&(l="");let n=new Ro;return n.add("Value",i),n.add("XValue",r),n.add("YValue",s),n.add("Series",l),k.parseAsync(t,e,!1,n)}getYValueIndex(e,t){if(null==e)return-1;let i=this.getYMeterIndexes(e);if(null==i)return-1;if(!i.any())return-1;if(1==i.length)return i.toList().firstOrDefault();if(i.length>t)return le.trunc(i[t]);return-1}getYMeterIndexes(t){if(null==t)return null;return this.getYMeters(t).select(e=>t.meters.indexOf(e)).toList()}getYMeters(e){if(null==e)return null;return e.meters.where(e=>e.is(Nr)).cast()}getXValueIndex(e,t){if(null==e)return-1;let i=this.getXMeterIndexes(e);if(null==i)return-1;if(!i.any())return-1;if(1==i.length)return i.toList().firstOrDefault();if(i.length>t)return le.trunc(i[t]);return-1}getXMeterIndexes(t){if(null==t)return null;return this.getXMeters(t).select(e=>t.meters.indexOf(e)).toList()}getXMeters(e){if(null==e)return null;return e.meters.where(e=>e.is(Lr)).cast()}},R.i.StiRangeChartElementBuilder=class extends R.i.StiChartElementBuilder{async renderElements(u,h,m){let c=null==h?void 0:h.report,d=this.getSeriesMeterIndex(m),e=this.getSeriesKeys(m,d),g=e.count2(),i=this.getValueMeters(m),p=this.getArgumentMeterIndexes(m),S=this.getArgumentKeys(u,m).toList();for(let o of e){let a=0;for(let t of i){let r=this.getValueMeterIndexes(m)[a],i=this.renderSeries(u,t,o,h);if(null==i)continue;await R.i.StiChartElementBuilder.renderConditions(o,i,u,t);let s=-1!=d&&1<g?m.rows.whereArrayItemStringEqualsTo(d,this.toString(o)):m.rows,l=(i.values=j.create(Number,S.length),0);for(let t of S){let e=R.i.StiChartElementBuilder.getDetailRows(s,t,p);l<i.values.length&&(i.values[l]=e.getArrayItem(r).firstOrDefaultAsNullableNumber()),l++}i.core.isDateTimeValues=j.getValueOrFirstOrDefault(s.getArrayItem(r).toList().firstOrDefault())instanceof F;let n=i.as(Uc);if(null!=n){n.valuesEnd=j.create(Number,S.length);let i=this.getEndValueIndex(m,r);if(null==n.valuesEnd&&(n.valuesEnd=j.repeat(10,S.length)),-1!=i){l=0;for(let t of S){let e=R.i.StiChartElementBuilder.getDetailRows(s,t,p);l<n.valuesEnd.length&&(n.valuesEnd[l]=e.getArrayItem(i).firstOrDefaultAsNullableNumber()),l++}}}i.originalArguments=S[P.System.StiObject.stimulsoft]().toArray(),i.arguments=S.select(e=>this.getString(u.argumentFormat,e,c))[P.System.StiObject.stimulsoft]().toArray(),a++;let e=Math.min(i.values.length,i.arguments.length);await this.renderSeriesInteraction(i,u,e,o)}}}renderSeries(e,t,i,r){let s=Hl.neww2(t.seriesType),l=(s.coreTitle=this.getSeriesTitle(e,i,t),s.isDashboard=!0,t);return R.i.StiChartElementBuilder.renderSeriesLine(l,s),R.i.StiChartElementBuilder.renderSeriesShowNulls(l,s),this.renderMarker(e,s),r.series.add(s),s}async renderSeriesInteraction(s,l,e,n){let a,o,u=null==l?void 0:l.report,h=s.as(Uc);if(null==h)return;let t=l.dashboardInteraction.as(Xl);if(t.onHover==ci.ShowToolTip){s.toolTips=Pl.create(String,e);for(let r=0;r<e;r++){let e="",t="",i="";r<s.values.length&&null!=s.values[r]&&(e=(s.core.isDateTimeValues?F.fromOADate(s.values[r]):s.values[r]).toString()),null!=h.valuesEnd&&r<h.valuesEnd.length&&(t=s.core.isDateTimeValues?null==(a=F.fromOADate(h.valuesEnd[r]))?void 0:a.toString():null==(o=h.valuesEnd[r])?void 0:o.toString()),r<s.arguments.length&&null!=s.arguments[r]&&(i=``+s.arguments[r]),s.toolTips[r]=await this.getToolTip2(s.chart.style,l,l.dashboardInteraction.toolTip,this.getString(l.argumentFormat,i,u),this.getString(l.valueFormat,e,u),this.getString(l.valueFormat,t,u),n)}}s.drillDownEnabled=!0}async getToolTip2(i,e,t,r,s,l,n){if(null==r&&(r=""),null==n&&(n=""),H.isNullOrWhiteSpace(t)){null==r||H.isNullOrEmpty(r)||(r=r.split('"').join('\\"'));let e='"StiColor":"{0}","StiValue":"{1} - {3}","StiArgument":"{2}"{4}',t=await this.getToolTipStyle(i);return"{"+H.format(e,"#ffffff",s,r,l,t)+"}"}return this.getHyperlink2(e,t,r,s,l,n)}async getHyperlink2(e,t,i,r,s,l){null==i&&(i=""),null==l&&(l="");let n=new Ro;return n.add("Argument",i),n.add("Value",r),n.add("EndValue",s),n.add("Series",l),k.parseAsync(t,e,!1,n)}getValueMeters(e){if(null==e)return null;return e.meters.where(e=>e.is(Ba)).cast()}getEndValueIndex(e,t){if(null==e)return-1;let i=this.getEndValueMeterIndexes(e);if(null==i||!i.any())return-1;if(1==i.length)return i.toList().firstOrDefault();if(t<i.length)return le.trunc(i[t]);return-1}getEndValueMeterIndexes(t){if(null==t)return null;return this.getEndValueMeters(t).select(e=>t.meters.indexOf(e)).toList()}getEndValueMeters(e){if(null==e)return null;return e.meters.where(e=>e.is(Xs)).cast()}},P.Report.Components.StiShape),_c=(R.i.StiShapeElementBuilder=class{render(e){let t=new qc;return t.shapeType=e.shapeType,t.brush=e.fill,t.borderColor=e.stroke,t.size=e.size,t}},P.Report.Chart.IStiStackedColumnSeries),$c=P.Report.Chart.IStiStackedBarSeries,ed=P.Report.Chart.IStiRibbonSeries;{class vp extends R.i.StiChartElementBuilder{async renderElements(a,o,u){let h=null==o?void 0:o.report,m=this.getSeriesMeterIndex(u),e=this.getSeriesKeys(u,m),c=this.getArgumentMeterIndexes(u),d=this.getArgumentKeys(a,u).toList(),i=this.getValueMeters(u),g=new j,p=e.count2();for(let n of e){let t=0;for(let e of i){g.add(n);let i=this.getValueMeterIndexes(u)[t],r=this.renderSeries(a,e,n,o);if(null==r)continue;await R.i.StiChartElementBuilder.renderConditions(n,r,a,e),R.i.StiChartElementBuilder.renderTrendLines(r,a,e);let s=-1!=m&&1<p?u.rows.whereArrayItemStringEqualsTo(m,n):u.rows,l=(r.values=j.create(Number,d.length),0);for(let t of d){let e=R.i.StiChartElementBuilder.getDetailRows(s,t,c);l<r.values.length&&(r.values[l]=e.getArrayItem(i).firstOrDefaultAsNullableNumber()),l++}r.originalArguments=d[P.System.StiObject.stimulsoft]().toArray(),r.arguments=d.select(e=>this.getString(a.argumentFormat,e,h))[P.System.StiObject.stimulsoft]().toArray(),t++}}await vp.processTopNStackedChart(a,o);for(let t=0;t<g.length;t++){if(o.series.count<t)break;let e=o.series.getByIndex(t);if(null==e)return;await this.renderSeriesInteraction(e,a,d.length,g[t])}}static getDataTable(e){let i=new yt,t=new wt("Id",Number),r=(i.columns.add(t),new wt("Argument",Object));i.columns.add(r);for(let t=0;t<e.length;t++){let e=new wt("Value-"+t.toString(),Number);i.columns.add(e)}let s=new wt("OriginalArguments",Object),l=(i.columns.add(s),new wt("ValueSum",Number)),n=(i.columns.add(l),this.getCountRow(e.toList()));for(let e=0;e<n;e++){let e=i.newRow();i.rows.add(e)}return i}static getCountRow(t){let i=0;for(let e of t)i=Math.max(i,e.arguments.length);return i}static async getArguments(e,t){if(e.length<=t.topN.count)return e;let i=e.take(t.topN.count).toList();if(t.topN.showOthers){let e=H.isNullOrEmpty(t.topN.othersText)?b.get("FormDesigner","Others"):await k.parseAsync(t.topN.othersText,t);i.add(e)}return i}static getValues(t,i){if(t.length<=i.topN.count)return t;let r=t.take(i.topN.count).toList();if(i.topN.showOthers){let e=t.skip(i.topN.count).sum();r.add(e)}return r}static async processTopNStackedChart(s,e){if(s.topN.mode==Xo.None)return;let l=e.series.toList();if(!l.any(e=>e.is(Ec)||e.is(_c)||e.is($c)||e.is(ed)))return;let n=vp.getDataTable(l.toList());if(n.rows.count<1)return;for(let r=0;r<n.rows.count;r++){0<l.length&&l[0].arguments.length>r?n.rows.getByIndex(r).setValue(1,l[0].arguments[r]):n.rows.getByIndex(r).setValue(1,null),0<l.length&&l[0].originalArguments.length>r?n.rows.getByIndex(r).setValue(n.columns.count-2,l[0].originalArguments[r]):n.rows.getByIndex(r).setValue(n.columns.count-2,null);let i=0;for(let t=0;t<l.length;t++)if(0<l.length&&l[t].values.length>r){let e=l[t].values[r];n.rows.getByIndex(r).setValue(t+2,e),i+=e}else n.rows.getByIndex(r).setValue(t+2,null);n.rows.getByIndex(r).setValue(n.columns.count-1,i)}n.defaultView.sort=s.topN.mode==Xo.Top?"ValueSum desc":"ValueSum asc",n=n.defaultView.toTable();let a=0;for(let r of l){let e=vp.getListByColumnName(n,"OriginalArguments"),t=(r.originalArguments=await vp.getArguments(e,s),vp.getListByColumnName(n,"Argument")),i=(r.arguments=await vp.getArguments(t,s),vp.getListByColumnName(n,"Value-"+a.toString()));r.values=vp.getValues(i,s),r.is($c)&&(r.originalArguments=r.originalArguments.reverse(),r.arguments=r.arguments.reverse(),r.values=r.values.reverse()),a++}}static getListByColumnName(e,i){let r=new j;for(let t of e.rows.toList()){let e=t.gett(i);r.add(e)}return r}}R.i.StiStackedChartElementBuilder=vp}R.i.StiSunburstChartElementBuilder=class extends R.i.StiChartElementBuilder{async renderElements(t,s,l){let i=this.getArgumentMeters(l),n=this.getValueMeters(l).firstOrDefault(),a=this.getValueMeterIndexes(l)[P.System.StiObject.stimulsoft]().toList().firstOrDefault();for(let e=0;e<i.length;e++){let i=this.getArgumentMeterIndexes(l)[e],r=this.renderSeries(t,n,"",s);if(null==r)continue;r.values=Pl.create(Number,l.rows.length),r.arguments=Pl.create(Object,l.rows.length),r.originalArguments=Pl.create(Object,l.rows.length);for(let t=0;t<l.rows.length;t++){r.values[t]=O.tryToNullableNumber(l.rows[t][a]);let e=l.rows[t][i];r.arguments[t]=e,r.originalArguments[t]=e}await this.renderSeriesInteraction(r,t,r.arguments.length,"")}}renderSeries(e,t,i,r){let s=Hl.neww2(t.seriesType);return s.core.seriesColors=null!=e.seriesColors&&0<e.seriesColors.length?e.seriesColors:null,s.isDashboard=!0,r.series.add(s),s}};{class Fp{static getVisualizer(e){return null}}Fp.typeToGdiVisualizer=new Ro,Fp.typeToWpfVisualizer=new Ro,Fp.lockObject={},R.n.StiVisualizer=Fp}R.n.StiGdiVisualizer=class extends R.n.StiVisualizer{render(e){}},R.n.StiGdiVisualizerAttribute=class{},R.u.StiIndicatorIconRangeValue=class{isBetween(e){return this.start<=e&&e<=this.end}constructor(e,t,i){this.start=e,this.end=t,this.icon=i}};let td=P.Base.Context.StiProgressInteractionData,id=R.h.StiElementLocationHelper,rd=(R.v.StiProgressVisual=class extends R.j.StiVisual{getDisplayText(e,t){var i,r,s,l;switch(this.element.valueType){case Qo.Percentage:return ls.formatAsPercentage2(null==(i=this.element)?void 0:i.report,this.element.textFormat,t);case Qo.Value:return ls.format(null==(r=this.element)?void 0:r.report,this.element.textFormat,e.value);case Qo.ValueTarget:return ls.format(null==(s=this.element)?void 0:s.report,this.element.textFormat,e.value)+` / `+ls.format(null==(l=this.element)?void 0:l.report,this.element.textFormat,e.target);case Qo.None:default:return""}}getMaxValue(){return this.iterations.select(e=>Math.abs(e.value)).concat(new j([0])).max()}getTargetValues(){let t=this.getMaxValue(),i=new j;for(let e of this.iterations)i.add(null!=e.target?e.target:t);return i}getTextValues(){let r=new j,s=this.getTargetValues();for(let i=0;i<this.iterations.length;i++){let e=s[i],t=0!=e?Math.abs(this.iterations[i].value)/e:0;r.add(ls.formatAsPercentage2(this.element.report,this.element.textFormat,t))}return r}getColor(e){return this.element.colorEach?this.getColors(this.iterations.length)[e]:this.style.bandColor}getColors(e){let n=[],t=(null!=this.element.seriesColors&&0<this.element.seriesColors.length?this.element:this.style).seriesColors,i=0,a=0;for(let l=0;l<e;l++){let s=null==t||0==t.length?N.fromArgb(255,52,152,219):t[i];if(0!=a){let e=Math.min(s.a+a,255),t=Math.min(s.r+a,255),i=Math.min(s.g+a,255),r=Math.min(s.b+a,255);n[l]=N.fromArgb(e,t,i,r)}else n[l]=s;++i==t.length&&(i=0,a=50)}return n}getContentRectangle(t){if(1<this.iterations.length){let e=id.getLocationRectangles(t,this.iterations.length,this.element);t=id.getSumRectangle(e)}return t}getConditionResult(r,t){let s=null;switch(t.field){case _o.Value:s=r.value;break;case _o.Series:s=r.series;break;case _o.Target:s=r.target;break;case _o.Percentage:{let e=this.getVariation(r),t=new Zi,i=(t.decimalDigits=3,ls.formatAsPercentage2(this.element.report,t,e));s=i.replace("%","")[P.System.StiObject.stimulsoft]().toNumber();break}}let e=!1,i=this.getConditionValue(t);if(null!=s){let e=s=t.field!=_o.Value&&t.field!=_o.Target&&t.field!=_o.Percentage?s:null==s?0:s[P.System.StiObject.stimulsoft]().toNumber();if(null!=e&&null!=i){s[P.System.StiObject.stimulsoft]().getType()!=i[P.System.StiObject.stimulsoft]().getType()&&(s=s.toString(),i=i[P.System.StiObject.stimulsoft]().toString(),e=s);try{switch(t.condition){case P.Report.Components.StiFilterCondition.EqualTo:return 0==e[P.System.StiObject.stimulsoft]().compareTo(i);case P.Report.Components.StiFilterCondition.NotEqualTo:return 0!=e[P.System.StiObject.stimulsoft]().compareTo(i);case P.Report.Components.StiFilterCondition.GreaterThan:return 1==e[P.System.StiObject.stimulsoft]().compareTo(i);case P.Report.Components.StiFilterCondition.GreaterThanOrEqualTo:return 0<=e[P.System.StiObject.stimulsoft]().compareTo(i);case P.Report.Components.StiFilterCondition.LessThan:return-1==e[P.System.StiObject.stimulsoft]().compareTo(i);case P.Report.Components.StiFilterCondition.LessThanOrEqualTo:return e[P.System.StiObject.stimulsoft]().compareTo(i)<=0;case P.Report.Components.StiFilterCondition.Containing:{let e=s.toString(),t=i.toString();return-1!=e.indexOf(t)}case P.Report.Components.StiFilterCondition.NotContaining:{let e=s.toString(),t=i.toString();return-1==e.indexOf(t)}case P.Report.Components.StiFilterCondition.BeginningWith:{let e=s.toString(),t=i.toString();return e.startsWith(t)}case P.Report.Components.StiFilterCondition.EndingWith:{let e=s.toString(),t=i.toString();return e.endsWith(t)}}}catch(e){}}}return e}processColor(e,t){for(let e of this.element.progressConditions)if(0<(e.permissions&$o.Color)&&this.getConditionResult(t,e))return e.color;return e}getVariation(e){let t=e.value,i=e.target;return t/i}getConditionValue(e){if(H.isNullOrEmpty(e.value))return null;switch(e.field){case _o.Value:case _o.Target:case _o.Percentage:return e.value[P.System.StiObject.stimulsoft]().toNumber();default:return e.value.toString()}}processForeColor(t,e=null){for(let e of this.element.progressConditions)if(0<(e.permissions&$o.TextColor)&&this.getConditionResult(t,e))return e.textColor;return U.getForeColor(this.element,e)}processTrackColor(e,t){for(let e of this.element.progressConditions)if(0<(e.permissions&$o.TrackColor)&&this.getConditionResult(t,e))return e.trackColor;return e}processFontStyle(e,t){let i=this.processFontBold(e.bold,t),r=this.processFontItalic(e.italic,t),s=this.processFontUnderline(e.underline,t),l=this.processFontStrikeout(e.strikeout,t),n=cl.Regular;return i&&(n^=cl.Bold),r&&(n^=cl.Italic),s&&(n^=cl.Underline),l&&(n^=cl.Strikeout),n}processFontStrikeout(e,t){for(let e of this.element.progressConditions)if(0<(e.permissions&$o.FontStyleStrikeout)&&this.getConditionResult(t,e))return e.font.strikeout;return e}processFontUnderline(e,t){for(let e of this.element.progressConditions)if(0<(e.permissions&$o.FontStyleUnderline)&&this.getConditionResult(t,e))return e.font.underline;return e}processFontItalic(e,t){for(let e of this.element.progressConditions)if(0<(e.permissions&$o.FontStyleItalic)&&this.getConditionResult(t,e))return e.font.italic;return e}processFontBold(e,t){for(let e of this.element.progressConditions)if(0<(e.permissions&$o.FontStyleBold)&&this.getConditionResult(t,e))return e.font.bold;return e}processFontName(e,t){for(let e of this.element.progressConditions)if(0<(e.permissions&$o.Font)&&this.getConditionResult(t,e))return e.font.name;return e}getInteractionDataGeom(e){if(this.element.isDesigning)return null;let t=new td,i=(t.value=e.value,t.seriesText=e.series,t.target=e.target,new ch);return i.interactionToolTip=this.getToolTip(t),i.interactionHyperlink=this.getHyperlink(t),i.interactionData=t,i}getToolTip(e){let t,i=null==(t=this.element.dashboardInteraction)?void 0:t.toolTip;return H.isNullOrEmpty(i)?i:this.parseConstants(i,e)}getHyperlink(e){let t,i=null==(t=this.element.dashboardInteraction)?void 0:t.hyperlink;return H.isNullOrEmpty(i)?i:this.parseConstants(i,e)}parseConstants(t,i){if(!H.isNullOrEmpty(t)){let e=new Ro;return e.set("Value",i.value),e.set("Series",i.seriesText),e.set("Target",i.target),k.parse(t,this.element,!1,e)}return t}constructor(e,t){super(),this.minElementSide=2,this.minFontSize=3,this.element=e,this.iterations=t,this.style=U.getProgressStyle(this.element)}},P.Base.Context.StiPieSegmentGeom),sd=(R.v.StiPieProgressVisual=class extends R.v.StiProgressVisual{async draw(h,m){if(0==this.iterations.length)return;let c=id.getLocationRectangles(m,this.iterations.length,this.element);if(c.length<1)return;let d=c[0],e=d.width<d.height?d.width:d.height,t=U.getElementFontFromStyle(this.element),g=this.getTitleHeight(e,t.size),p=d.width,S=null,i=new B(t.fontFamily.name,1,t.style,t.unit);for(let t of this.iterations){if(H.isNullOrEmpty(t.series))continue;let e=mh.getFontSize(h,new L(0,0,p,g),t.series,i);(null==S||S>e)&&(S=e)}null!=S&&S<t.size&&(g=this.getTitleHeight(e,S));let r=this.element.valueType==Qo.None?1:2,w=(e-g*r)/2*.8,f=(S<this.minFontSize&&(S=0,g=0,w=e/2*.8),2*w),b=this.getTargetValues(),y=!1;h.pushClip(m);for(let u=0;u<this.iterations.length;u++){let e=b[u],t=this.iterations[u],i=c[u];if(!y&&(1<i.right-m.right||1<i.bottom-m.bottom)&&(y=!0),!this.element.report.isDesigning){let e=U.getHotBackColor(this.element);h.fillRectangle3(new E(N.transparent),new E(e),i,this.getInteractionDataGeom(this.iterations[0]))}let r=i.x+i.width/2,s=i.y+g+(d.height-g)/2,l=new qn(r,s),n=new L(l.x-w,l.y-w,f,f),a=new L(n.x+n.width/2-p/2,n.top-g,p,g),o=this.processColor(this.getColor(u),this.iterations[u]);this.drawPieProgress(h,n,a,e,t,S,o)}if(y){let e=fh.factor(this.element);this.drawArrowMore(h,m,e)}h.popClip()}drawPieProgress(c,d,g,p,S,w,e){let t=this.processTrackColor(this.style.trackColor,S),i=(c.fillEllipse2(t,d,null),0!=p?360/p*Math.abs(S.value):p),r=(360<i&&(i=360),new j([new rd(d,-90,i,null,null,null)]));if(c.fillPath(e,r,d,null),w>=this.minFontSize){let a=U.getElementFontFromStyle(this.element),o=this.processFontName(a.fontFamily.name,S),u=this.processFontStyle(a,S),e=new B(o,w,u),t=new rh(e.fontFamily.name,w,e.style,e.unit),i=sh.CenterCenter,r=new qn,s={ref:sh.CenterCenter},l={ref:new qn},h=(mh.measureAlignmentParameters(X.Center,g,s,l),i=s.ref,r=l.ref,this.processForeColor(S)),n=(c.drawRotatedString4(S.series,t,h,r,mh.getStringFormatGeom(c),i,0,!0),0!=p?Math.abs(S.value)/p:0),m=this.getDisplayText(S,n);if(m&&0<m.length){let e=new L(d.x,d.bottom+.2*w,d.width,w),t=sh.CenterCenter,i=new qn,r={ref:sh.CenterCenter},s={ref:new qn},l=(mh.measureAlignmentParameters(X.Center,e,r,s),t=r.ref,i=s.ref,.9*w),n=new rh(o,l,u,a.unit);c.drawRotatedString4(m,n,h,i,mh.getStringFormatGeom(c),t,0,!0)}}}getTitleHeight(e,t){let i=t/13;return e/4*(i=4<i?4:i)}constructor(e,t){super(e,t)}},P.Base.Context.StiArcSegmentGeom);R.v.StiCircleProgressVisual=class extends R.v.StiPieProgressVisual{async draw(g,p){if(0==this.iterations.length)return;let S=id.getLocationRectangles(p,this.iterations.length,this.element);if(S.length<1)return;let w=.8,f=S[0],e=f.width<f.height?f.width:f.height,b=U.getElementFontFromStyle(this.element),y=this.getTitleHeight(e,b.size),C=f.width,x=this.getTargetValues(),v=null,i=new B(b.fontFamily.name,1,b.style,b.unit);for(let t of this.iterations.where(e=>!H.isNullOrEmpty(e.series))){let e=mh.getFontSize(g,new L(0,0,C,y),t.series,i);(null==v||v>e)&&(v=e)}let F=(e-(y=null!=v&&v<b.size?this.getTitleHeight(e,v):y))/2*.8,T=null,l=new L(f.x-F*w,f.y-.79*F,2*F*w,2*F*w),n=new B(this.element.font.name,1,cl.Bold,zh.Pixel);for(let s=0;s<this.iterations.length;s++){let e=x[s],t=0!=e?Math.abs(this.iterations[s].value)/e:0,i=this.getDisplayText(this.iterations[s],t),r=mh.getFontSize(g,l,i,n);(null==T||T>r)&&(T=r)}v<this.minFontSize&&(y=0,v=0,F=e/2*.8);let M=2*F,A=F/5,D=F-A,I=2*D,R=!1;g.pushClip(p);for(let d=0;d<this.iterations.length;d++){let t=S[d];if(!R&&(1<t.right-p.right||1<t.bottom-p.bottom)&&(R=!0),!this.element.report.isDesigning){let e=U.getHotBackColor(this.element);g.fillRectangle3(new E(N.transparent),new E(e),t,this.getInteractionDataGeom(this.iterations[0]))}let e=t.x+t.width/2,i=t.y+y+(f.height-y)/2,m=new qn(e,i),c=new L(m.x-F,m.y-F,M,M),r=new L(m.x-D,m.y-D,I,I);if(!this.element.report.isDesigning){let e=U.getHotBackColor(this.element);g.fillRectangle3(N.transparent,e,t,this.getInteractionDataGeom(this.iterations[d]))}let s=this.processTrackColor(this.style.trackColor,this.iterations[d]),l=new Ch(s,A),a=(g.drawEllipse(l,c.x+A/2,c.y+A/2,c.width-A,c.height-A),x[d]),n=0!=a?360/a*Math.abs(this.iterations[d].value):0,o=-90,u=(360<n&&(n=360),new j),h=(u.add(new sd(c,o,n)),u.add(new nh(this.getPoint(m,F,o+n),this.getPoint(m,D,o+n))),u.add(new sd(r,o+n,-n)),u.add(new nh(this.getPoint(m,D,o),this.getPoint(m,F,o))),this.processColor(this.getColor(d),this.iterations[d]));if(g.fillPath(h,u,c,null),T>=this.minFontSize){let e=new L(m.x-F*w,m.y-.79*F,2*F*w,2*F*w),t=0!=a?Math.abs(this.iterations[d].value)/a:0,i=this.getDisplayText(this.iterations[d],t),r=new B(this.element.font.name,T,cl.Bold,zh.Pixel),s=this.processFontStyle(r,this.iterations[d]),l=new rh(r.name,r.size,s,r.unit),n=this.processForeColor(this.iterations[d]);g.drawRotatedString5(i,l,n,e,mh.getStringFormatGeom(g),sh.CenterCenter,0,!0)}if(v>=this.minFontSize){let e=new L(m.x-C/2,c.top-y,C,y),t=new B(b.fontFamily.name,v,b.style,b.unit),i=this.processFontName(t.fontFamily.name,this.iterations[d]),r=this.processFontStyle(t,this.iterations[d]),s=new B(i,t.size,r),l=new rh(s.fontFamily.name,v,s.style,s.unit),n=sh.CenterCenter,a=new qn,o={ref:sh.CenterCenter},u={ref:new qn},h=(mh.measureAlignmentParameters(X.Center,e,o,u),n=o.ref,a=u.ref,this.processForeColor(this.iterations[d]));g.drawRotatedString4(this.iterations[d].series,l,h,a,mh.getStringFormatGeom(g),n,0,!0)}}if(R){let e=fh.factor(this.element);this.drawArrowMore(g,p,e)}g.popClip()}getPoint(e,t,i){let r=Math.PI*i/180;return new qn(e.x+Math.cos(r)*t,e.y+Math.sin(r)*t)}constructor(e,t){super(e,t)}},R.v.StiDataBarsProgressVisual=class extends R.v.StiProgressVisual{async draw(p,e){if(0==this.iterations.length)return;let t=.06*e.width,S=(t<4&&(t=4),new L(e.x+t/2,e.y+t/2,e.width-t,e.height-t)),w=S.height/this.iterations.length,f=(w<this.minElementSide&&(w=this.minElementSide),1<this.iterations.length?.95*w:w),b=S.width,s=this.getTextValues(),y=this.getTargetValues(),C=U.getElementFontFromStyle(this.element),x=null,l=new B(C.fontFamily.name,1,C.style,C.unit);for(let r=0;r<this.iterations.length;r++){let e=``+this.iterations[r].series+s[r],t=new L(S.x,S.y+w*r+.07*f,b,.86*f),i=mh.getFontSize(p,t,e,l);(null==x||x>i)&&(x=i)}let v=this.element.font.size/18*x,F=(v>x&&(v=x),new B(C.fontFamily.name,v,C.style,C.unit)),T=(p.pushClip(S),1<this.iterations.length?.05*w/(this.iterations.length-1):0);for(let g=0;g<this.iterations.length;g++){let e=this.processFontName(F.fontFamily.name,this.iterations[g]),t=this.processFontStyle(F,this.iterations[g]),l=new B(e,F.size,t),i=y[g],r=S.y+(w+T)*g,n=new L(S.x,r,b,f),s=this.processTrackColor(this.style.trackColor,this.iterations[g]),a=(p.fillRectangle(s,n,this.getInteractionDataGeom(this.iterations[g])),0!=i?Math.abs(this.iterations[g].value)/i:0),o=this.getDisplayText(this.iterations[g],a),u=this.processForeColor(this.iterations[g]);if(x>=this.minFontSize&&o&&0<o.length){let e=new rh(l.name,l.size,l.style,l.unit),t=p.measureString(o,e),i=new L(n.right-t.width,n.top,t.width,n.height);p.drawRotatedString5(o,e,u,i,mh.getStringFormatGeom(p),sh.CenterCenter,0,!0)}let h=this.iterations[g].series;if(x>=this.minFontSize){let e=new rh(C.fontFamily.name,v,l.style,l.unit),t=p.measureString(h,e),i=new L(n.left,n.top+.05*n.height,t.width,n.height);u=this.processForeColor(this.iterations[g]),p.drawRotatedString5(h,e,u,i,mh.getStringFormatGeom(p),sh.CenterCenter,0,!0)}let m=0!=i?b/i*this.iterations[g].value:0,c=(m>n.width&&(m=n.width),new L(S.x,r,m,f)),d=(p.pushClip(c),this.processColor(this.getColor(g),this.iterations[g]));if(p.fillRectangle(d,c,this.getInteractionDataGeom(this.iterations[g])),this.element.report.isDesigning||(null==d&&(d=N.transparent),p.fillRectangle3(d,N.fromArgb3(100,N.white),c,this.getInteractionDataGeom(this.iterations[g]))),x>=this.minFontSize&&o&&0<o.length){let e=new rh(l.name,l.size,l.style,l.unit),t=p.measureString(o,e),i=new L(n.right-t.width,n.top,t.width,n.height),r=this.isColorLight(d)?N.white:u,s=this.processForeColor(this.iterations[g],r);p.drawRotatedString5(o,e,s,i,mh.getStringFormatGeom(p),sh.CenterCenter,0,!0)}if(x>=this.minFontSize){let e=new rh(l.name,l.size,l.style,l.unit),t=p.measureString(h,e),i=new L(n.left,n.top+.05*n.height,t.width,n.height),r=this.isColorLight(d)?N.white:u,s=this.processForeColor(this.iterations[g],r);p.drawRotatedString5(h,e,s,i,mh.getStringFormatGeom(p),sh.CenterCenter,0,!0)}p.popClip()}p.popClip()}isColorLight(e){return 0<600-e.r-e.g-e.b}constructor(e,t){super(e,t)}};{let e;(Q=e=R.f.StiDashboardExportFormat||(R.f.StiDashboardExportFormat={}))[Q["Pdf"]=0]="Pdf",Q[Q["Excel"]=1]="Excel",Q[Q["Data"]=2]="Data",Q[Q["Image"]=3]="Image",Q[Q["Html"]=4]="Html",Q[Q["Document"]=5]="Document"}let ld=P.Report.Components.StiPageOrientation,nd=P.System.Drawing.Printing.PaperKind,ad=P.Report.Dashboard.Export.IStiDashboardExportSettings,od=P.Report.Export.StiExportSettings,ud=(R.y.StiDashboardExportSettings=class extends od{constructor(){super(...arguments),this.renderBorders=!0,this.orientation=ld.Landscape,this.paperSize=nd.A4,this.openAfterExport=!0,this.viewportWidth=0,this.viewportHeight=0}is(e){if(e instanceof P.System.Interface)return-1!=this.implements().indexOf(e);if("function"==typeof e)return this instanceof e;if(null==e)throw new Error("Type for comparison is 'undefined'");return!1}is2(e){return this.is(e)}as(e){if(this.is(e))return this;return null}implements(){let e=[ad];return(this.implements=()=>e)()}get isDesignMode(){return this.is(R.y.StiSvgDashboardExportSettings)&&this.as(R.y.StiSvgDashboardExportSettings).designMode}getExportFormat(){return R.A.StiExportFormatHelper.convert(this.format)}toParameters(){let e=super.toParameters();return e.Format=z.getName(R.f.StiDashboardExportFormat,this.format),e.Orientation=z.getName(ld,this.orientation),e.PaperSize=z.getName(ld,this.paperSize),e}},R.y.IStiDashboardScaleMode=new P.System.Interface("IStiDashboardScaleMode"),R.y.IStiSizeExportSettings=new P.System.Interface("IStiSizeExportSettings"),R.y.IStiSizeExportSettings),hd=P.Report.Dashboard.StiDashboardScaleMode,md=R.y.IStiDashboardScaleMode,cd=P.Report.Export.StiImageType,dd=P.Report.Dashboard.Export.IStiImageDashboardExportSettings,gd=(R.y.StiImageDashboardExportSettings=class extends R.y.StiDashboardExportSettings{implements(){let e=super.implements().concat([ud,dd,md]);return(this.implements=()=>e)()}get width(){return this._width}set width(e){this._width=e,this.paperSize=nd.Custom}get height(){return this._height}set height(e){this._height=e,this.paperSize=nd.Custom}toParameters(){let e=super.toParameters();return e.Format=z.getName(R.f.StiDashboardExportFormat,this.format),e.ImageType=z.getName(cd,this.imageType),e.ScaleMode=z.getName(hd,this.scaleMode),e.Width=0,e.Height=0,e}constructor(e){super(),this.format=R.f.StiDashboardExportFormat.Image,this.imageType=cd.Svg,this.scale=100,this.scaleMode=hd.ViewSize,null!=e?this.imageType=e:this.renderSinglePage=!0}},R.y.StiSvgDashboardExportSettings=class extends R.y.StiImageDashboardExportSettings{constructor(){super(...arguments),this.imageType=cd.Svg,this.renderEmptyContent=!0}},P.Report.Dashboard.Export.IStiHtmlDashboardExportSettings);R.y.StiHtmlDashboardExportSettings=class extends R.y.StiDashboardExportSettings{constructor(){super(...arguments),this.format=R.f.StiDashboardExportFormat.Html,this.imageQuality=200,this.scale=100,this.enableAnimation=!0,this.scaleMode=hd.ViewSize}implements(){let e=super.implements().concat([gd,R.y.IStiDashboardScaleMode]);return(this.implements=()=>e)()}toParameters(){let e=super.toParameters();return e.ScaleMode=z.getName(hd,this.scaleMode),e}};{class bd{async render(e,t,i,r){}static getTool(e){let t=this.typeToTool.get(e);if(null!=t)return t;let i=ht.attributes.get(e[P.System.StiObject.stimulsoft]().getTypeName()),r=null!=i?i.exportToolTypeName:null;if(null==r)return null;return t=hi.createObject2(r),this.typeToTool.set(e,t),t}static isAllowOpacity(e){return e.is(R.y.StiImageDashboardExportSettings)||e.is(R.y.StiHtmlDashboardExportSettings)||e.is(R.y.StiPdfDashboardExportSettings)||e.is(R.y.StiExcelDashboardExportSettings)}static getScaleFactor(e,t){if(0<t.viewportWidth&&0<t.viewportHeight)return Math.min(e.page.width/t.viewportWidth,e.page.height/t.viewportHeight);return 1}}bd.typeToTool=new Ro,R.z.StiExportTool=bd}let pd=R.y.StiHtmlDashboardExportSettings,Sd=R.h.StiTitleMeasureHelper,wd=R.y.StiSvgDashboardExportSettings,fd=R.y.StiImageDashboardExportSettings,bd=R.z.StiExportTool,yd=(R.A.StiTitleExportHelper=class{static async render(e,t,i){let r,s,l=e.as(Ie),n=R.p.StiElementControlPainter.getBorderContentRect(new L(0,0,t.width,t.height),t.border),a=null!=l?l.title:null,o=this.getTitleText(e);if(null==a||!a.visible||H.isNullOrEmpty(o))return n;let u=bd.getScaleFactor(t,i),h=Sd.measureTitle3(null,n,l.title,o),m=(h.height=h.height*u,h.height>n.height/2&&(h.height=n.height/2),1);if(a.sizeMode==Mt.Fit||a.sizeMode==Mt.FitAndWordWrap){let e=h.width>n.width?n.width/h.width:1,t=h.height>n.height?n.height/h.height:1;m=Math.min(Math.abs(e),Math.abs(t))}let c=this.getTitleForeColor(e),d=N.transparent.equals(c)?U.getTitleForeColor(e):c,g=this.getTitleFont(e),p=1==m?g:Hn.changeFontSize(g,g.size*m),S=i.is(fd)&&i.imageType==cd.Svg||i.is(wd)||i.is(pd),w=this.getTitleBackColor(e),f=N.transparent.equals(w)?U.getBackColor(e,null,S):w,b=U.getBackColor(e,null,!0),y=(f.equals(b)&&(f=N.transparent),i.format==R.f.StiDashboardExportFormat.Html&&e.is(en)&&(n.x+=3,n.y+=3),new Ho),C=(y.name=e.name+`_Title`,y.allowHtmlTags=!0,y.clientRectangle=new L(n.x,n.y,n.width,h.height),y.text=await k.parseAsync(o,e),y.font=p,y.horAlignment=this.convert(a.horAlignment),y.trimming=a.sizeMode==Mt.Trimming?qu.EllipsisCharacter:qu.None,y.wordWrap=a.sizeMode==Mt.WordWrap||a.sizeMode==Mt.FitAndWordWrap,y.vertAlignment=Ht.Center,y.textBrush=new E(d),y.brush=new E(f),n.height-=y.height,n.y+=y.height,null==(r=a[P.System.StiObject.stimulsoft]().as(Tt))?void 0:r.padding),x=(null!=C&&(n.y+=C.top+C.bottom,n.height-=C.top+C.bottom,y.left+=C.left,y.width-=C.left+C.right,y.top+=C.top),null==(s=e.as(Je))?void 0:s.cornerRadius);return null!=x&&((0<x.topLeft||0<x.topRight)&&(y.cornerRadius=new v(x.topLeft,x.topRight,0,0)),0<x.topLeft&&(y.margins.left=Math.max(y.margins.left,x.topLeft/2)),0<x.topRight)&&(y.margins.right=Math.max(y.margins.right,x.topRight/2)),t.components.add(y),n}static getTitleBackColor(e){let t=U.getElementTitleStyle(e);if(null!=t&&t.allowUseTitle)return t.titleBackColor;if(e.is(Ie))return e.title.backColor;return N.transparent}static getTitleForeColor(e){let t=U.getElementTitleStyle(e);if(null!=t&&t.allowUseTitle)return t.titleForeColor;if(e.is(Ie))return e.title.foreColor;return N.black}static getTitleFont(e){let t=U.getElementTitleStyle(e);if(null!=t&&t.allowUseTitle)return t.titleFont;if(e.is(Ie))return e.title.font;return null}static getTitleText(t){if(t.is(Ie)){if(t.is(Qm)&&t.showViewTitle){let e=t.userViewStates.firstOrDefault(e=>e.key==t.selectedViewStateKey);if(null!=e)return e.name}return t.title.text}return null}static convert(e){switch(e){case X.Left:return jt.Left;case X.Center:return jt.Center;case X.Right:return jt.Right;default:throw new pa(e)}}},R.A.StiLayoutExportHelper=class{static excludeMargin(t,i){if(t.is(lt)){let e=t.margin;if(!e.isEmpty)return new L(i.x+e.left,i.y+e.top,Math.max(1,i.width-e.left-e.right),Math.max(1,i.height-e.top-e.bottom))}return i}static excludePadding(t,i,r){if(t.is(nt)){let e=t.padding;if(!e.isEmpty)return new L(i.x+e.left*r,i.y+e.top*r,Math.max(1,i.width-e.left*r-e.right*r),Math.max(1,i.height-e.top*r-e.bottom*r))}return i}static excludeCornerRadius(l,n,a){if(l.is(Je)){let e=l.cornerRadius;if(e.isDefault())return n;let t=Math.max(e.topLeft*a/2,e.bottomLeft*a/2),i=Math.max(e.topLeft*a/2,e.topRight*a/2),r=Math.max(e.topRight*a/2,e.bottomRight*a/2),s=Math.max(e.bottomLeft*a/2,e.bottomRight*a/2);return new L(n.x+t,n.y+i,Math.max(1,n.width-t-r),Math.max(1,n.height-i-s))}return n}},P.Report.Components.IStiBorder),Cd=(R.A.StiBorderExportHelper=class{static render(e,t,i){e.is(ot)&&t.is(yd)&&i.renderBorders&&(t.border=e.border2.getBorder(),t.border.topmost=!0)}},R.A.StiBackColorExportHelper=class{static render(e,t){t.is(gt)&&(t.backColor=U.getBackColor(e))}},P.Report.StiExportFormat),xd=(R.A.StiExportFormatHelper=class{static convert(e){switch(e){case R.f.StiDashboardExportFormat.Pdf:return Cd.Pdf;case R.f.StiDashboardExportFormat.Excel:return Cd.Excel;case R.f.StiDashboardExportFormat.Html:return Cd.Html;case R.f.StiDashboardExportFormat.Data:return Cd.Data;case R.f.StiDashboardExportFormat.Image:return Cd.Image;case R.f.StiDashboardExportFormat.Document:return Cd.Document;default:throw new pa(e)}}},P.Report.Dashboard.Export.IStiExcelDashboardExportSettings),vd=(R.y.StiExcelDashboardExportSettings=class extends R.y.StiDashboardExportSettings{constructor(){super(...arguments),this.format=R.f.StiDashboardExportFormat.Excel,this.imageQuality=200,this.scaleMode=hd.ViewSize}implements(){let e=super.implements().concat([ud,xd,R.y.IStiDashboardScaleMode]);return(this.implements=()=>e)()}get width(){return this._width}set width(e){this._width=e,this.paperSize=nd.Custom}get height(){return this._height}set height(e){this._height=e,this.paperSize=nd.Custom}toParameters(){let e=super.toParameters();return e.Width=0,e.Height=0,e.ScaleMode=z.getName(hd,this.scaleMode),e}},P.Report.Dashboard.Export.IStiPdfDashboardExportSettings),Fd=(R.y.StiPdfDashboardExportSettings=class extends R.y.StiDashboardExportSettings{constructor(){super(...arguments),this.format=R.f.StiDashboardExportFormat.Pdf,this.imageQuality=200,this.scaleMode=hd.PaperSize}implements(){let e=super.implements().concat([vd,md]);return(this.implements=()=>e)()}toParameters(){let e=super.toParameters();return e.ScaleMode=z.getName(hd,this.scaleMode),e}},P.Report.Export.StiDataType),Td=P.Report.Dashboard.Export.IStiDataDashboardExportSettings,Md=(R.y.StiDataDashboardExportSettings=class extends R.y.StiDashboardExportSettings{implements(){let e=super.implements().concat([Td]);return(this.implements=()=>e)()}toParameters(){let e=super.toParameters();return e.DataType=P.System.Enum.getName(Fd,this.dataType),e}constructor(e){super(),this.format=R.f.StiDashboardExportFormat.Data,this.dataType=Fd.Csv,null!=e&&(this.dataType=e)}},P.Report.Export.StiHtmlChartType),Ad=P.Report.Export.StiHtmlExportSettings,Dd=P.Report.Export.StiDataExportSettings,Id=P.Report.Export.StiImageExportSettings,Rd=P.Report.Export.StiSvgExportSettings,Ed=R.y.StiDataDashboardExportSettings,kd=R.y.StiExcelDashboardExportSettings,Od=R.y.StiPdfDashboardExportSettings,Vd=R.y.StiDashboardExportSettings,Nd=P.Report.Export.StiDataExportMode,Ld=P.Report.Export.StiPdfExportSettings,Bd=P.Report.Export.StiExcelExportSettings,Pd=(R.A.StiExportSettingsHelper=class{static getExportSettings(i){switch(i.format){case R.f.StiDashboardExportFormat.Pdf:{let e=new Ld;return e.imageQuality=1,e.imageResolution=i.imageQuality,e}case R.f.StiDashboardExportFormat.Excel:{let e=new Bd;return e.imageQuality=1,e.imageResolution=i.imageQuality,e}case R.f.StiDashboardExportFormat.Data:{let e=new Dd;return e.dataType=i.dataType,e.dataExportMode=Nd.DataAndHeadersFooters,e.skipColumnHeaders=!0,e}case R.f.StiDashboardExportFormat.Image:{let t=i.imageType;switch(t){case cd.Svg:return new Rd;default:{let e=new Id;return e.imageType=t,e.imageZoom=i.scale/100,e.imageResolution=100,e}}}case R.f.StiDashboardExportFormat.Html:{let e=new Ad;return e.imageResolution=i.imageQuality,e.useEmbeddedImages=!0,e.zoom=i.scale/100,e.addPageBreaks=!1,e.chartType=i.enableAnimation?Md.AnimatedVector:Md.Vector,e}case R.f.StiDashboardExportFormat.Document:return null;default:throw new pa(i.format)}}static getDashboardExportSettings(e){if(e instanceof Vd)return e;let t=null==e?Cd.Document:e.getExportFormat(),i=this.getDashboardExportSettings2(t);switch(t){case Cd.Html:i.enableAnimation=e.chartType==Md.AnimatedVector;break}return i}static getDashboardExportSettings2(e){switch(e){case Cd.Pdf:return new Od;case Cd.Excel:return new kd;case Cd.Data:return new Ed;case Cd.Csv:return new Ed(Fd.Csv);case Cd.Dbf:return new Ed(Fd.Dbf);case Cd.Xml:return new Ed(Fd.Xml);case Cd.Json:return new Ed(Fd.Json);case Cd.Dif:return new Ed(Fd.Dif);case Cd.Sylk:return new Ed(Fd.Sylk);case Cd.Image:return new fd;case Cd.ImageBmp:return new fd(cd.Bmp);case Cd.ImageGif:return new fd(cd.Gif);case Cd.ImagePng:return new fd(cd.Png);case Cd.ImageTiff:return new fd(cd.Tiff);case Cd.ImageJpeg:return new fd(cd.Jpeg);case Cd.ImageEmf:return new fd(cd.Emf);case Cd.ImagePcx:return new fd(cd.Pcx);case Cd.ImageSvgz:return new fd(cd.Svgz);case Cd.ImageSvg:return new wd;case Cd.Html:return new pd;case Cd.Document:return null;default:throw new pa(e)}}static isDataExport(e){return e.is(Ed)||e.is(kd)&&e.exportDataOnly}},P.System.Xml.XmlTextWriter),Hd=P.Report.Components.StiImage;{class Ud extends R.z.StiExportTool{async render(e,t,i,r){if(this.renderEmptyDataMessage(e,t,i.clone(),r))return;await this.renderContent(e,t,i.clone())}async renderContent(e,t,i){let r=new Hd(i),s=(r.name=e.name+`_Content`,r.stretch=!0,r.aspectRatio=!1,await this.draw(e,i));r.imageToDraw=s,t.components.add(r)}async drawElement(t,e){let i=new ja,r=new Pd(hn.UTF8),s=new Nh;if(s.x=0,s.y=0,s.width=e.width,s.height=e.height,s.component=t.as(pt),t.is(gt)){let e=U.getBackColor(t);e.a<255&&(e=N.white),r.writeStartElement("rect"),r.writeAttributeString("x","0"),r.writeAttributeString("y","0"),r.writeAttributeString("height",s.height.toString()[P.System.StiObject.stimulsoft]().replaceAll(",",".")),r.writeAttributeString("width",s.width.toString()[P.System.StiObject.stimulsoft]().replaceAll(",",".")),r.writeAttributeString("style",Dh.writeFillBrush(r,e,new Re(0,0,s.width,s.height))),r.writeEndElement()}if(t.is(Wm)){let e=P.Report.Dashboards.StiDashboardHelperCreator.createProgressVisualSvgHelper();null!=e&&await e.writeProgress(r,s)}else if(t.is(Gh)){let e=P.Report.Dashboards.StiDashboardHelperCreator.createIndicatorVisualSvgHelper();null!=e&&await e.writeIndicator(r,s)}else if(t.is(Jm)){let e=P.Report.Dashboards.StiDashboardHelperCreator.createCardsVisualSvgHelper();null!=e&&await e.writeCards(r,s)}else if(t.is(Km)){let e=P.Report.Dashboards.StiDashboardHelperCreator.createGaugeVisualSvgHelper();null!=e&&await e.writeGauge(r,s,!1)}let l=P.Report.Resources.StimulsoftFont.getBase64Content(),n="<style>@font-face {font-family: 'Stimulsoft';src: url(data:font/ttf;base64,"+l+") format('truetype');font-weight: normal;font-style: normal;}</style>",a=H.format('<svg xmlns="http://www.w3.org/2000/svg" width="{0}" height="{1}"><defs>{3}</defs><rect x="0" y="0" width="{0}" height="{1}" style="fill: white;"/>{2}</svg>',s.width.toString(),s.height.toString(),r.textWriter.getStringBuilder().toString(),n);return i.svg=a,await i.convertAsync(P.System.Drawing.Imaging.ImageFormat.Jpeg),i}async draw(t,e){if(t.is(Ym)){let e=await t.imageToDraw;return null!=e&&(e.url=t.imageHyperlink),e}let i=new L(0,0,Math.trunc(e.width),Math.trunc(e.height));if(t.is(Gh)||t.is(Wm)||t.is(Km)||t.is(Jm))return this.drawElement(t,i);let r=new ja;try{if(t.is(gt)){let e=U.getBackColor(t);e.a<255&&(e=N.white)}await this.paintContent(null,i,t)}catch(e){}return r}async paintContent(e,t,i){try{await this.paintAtom(e,t.clone(),i)}catch(e){}finally{}}async paintAtom(e,t,i){let r=null;if(i.isQuerable&&null==(r=await Ud.getDataTable(i)))return}static async getDataTable(e){let t,i=null==(t=e.as(Ah))?void 0:t.getManuallyEnteredDataTable();if(null!=i)return i;return yn.tryToGetOrCreate(e)}renderEmptyDataMessage(t,i,r,e){var s;if(!e.is(wd)||e.renderEmptyContent)return!1;if(t.is(au)&&t.dataFrom==nu.Manual)return!1;if(t.is(Ja)&&(null!=t.image||null!=t.icon||!H.isNullOrEmpty(t.imageHyperlink)))return!1;if(t.is(Gu)&&(!H.isNullOrEmpty(t.url)||!H.isNullOrEmpty(t.embedCode)))return!1;if(0<t.getMeters().length||(null==(s=t.as(Ah))?void 0:s.dataMode)==Nl.ManuallyEnteringData)return!1;let l=r.size,n=new B("Arial",9),a=t.is(Gu)?b.get("FormStyleDesigner","NotSpecified"):t.is(Ja)?b.get("Dashboard","ImageNotSpecified"):b.get("Dashboard","DragDropDataFromDictionary"),o=Vh.measureString(a,n);if(r.y+=r.height/2-48,r.height=Math.min(32,r.height),48<=l.width&&64<=l.height){r.y+=l.width>o.width+16?16:32;let e=new Hd(new L(r.width/2-16,r.y,32,32));e.name=t.name+`_EmptyImage`,e.horAlignment=X.Center,e.image=P.Base.Drawing.StiImageConverter.stringToImage(this.getEmptyDataImage(t)),i.components.add(e)}if(l.width>o.width+16&&32<=l.height){r.y+=32;let e=new Ho(r);e.name=t.name+`_EmptyText`,e.horAlignment=jt.Center,e.vertAlignment=Ht.Center,e.font=n,e.text=a,e.textBrush=new E(N.darkGray),i.components.add(e)}return!0}format(e,t){var i,r;if(null!=t&&null!=e){if(t instanceof F&&!(e.textFormat.is2(Ji)||e.textFormat.is2(Gi)||e.textFormat.is2(wn)))return t.toShortDateString();return nr.isEligable(t,null==(i=null==e?void 0:e.report)?void 0:i.culture)?nr.convert(t,null==(r=null==e?void 0:e.report)?void 0:r.culture):e.textFormat.format(t)}return""}getEmptyDataImage(e){if(e.is(P.Report.Dashboard.IStiTableElement))return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA4RpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo4M2I5YzlhNS1lZGRmLTU0NGItODFmMi1mMzVmMDgyNTUzMTciIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OTIzODI0M0M3MzI1MTFFN0E4QTI5RjYzRTdGNDREM0MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OTIzODI0M0I3MzI1MTFFN0E4QTI5RjYzRTdGNDREM0MiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKFdpbmRvd3MpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NWU4YzI0ZGYtNjI5ZS1jNDQwLTg2NjMtMjlmM2VlODA4MGFjIiBzdFJlZjpkb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6YWM1MjY1OGUtNzMxZC0xMWU3LWE0ZGMtODFhMmMxY2EwMjcyIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+9Pfr+wAAAINJREFUeNrsl8EJwCAQBD2xoOu/Ce1CrgqDEIJGMQQMm8fuRxbmsRzzUUopDpmQUsIOOF/UGSS0TVUHYnahnZxvi5m5Vf+C6wbknC+ovrXPspOTGCPUAe/ACSth7vI8MW+5wQFE4APgEtIBOkAH6AAdoAN0gAN+I6HALoD+HcMdOAQYAAB9hUYI2ET/AAAAAElFTkSuQmCC";if(e.is(P.Report.Dashboard.IStiCardsElement))return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA4RpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDYuMC1jMDA2IDc5LjE2NDc1MywgMjAyMS8wMi8xNS0xMTo1MjoxMyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo4M2I5YzlhNS1lZGRmLTU0NGItODFmMi1mMzVmMDgyNTUzMTciIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NUIzNTA2OThGNDM4MTFFQjg0MDZGNjlFNzQyNzdDRTQiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NUIzNTA2OTdGNDM4MTFFQjg0MDZGNjlFNzQyNzdDRTQiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKFdpbmRvd3MpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Mjc2NTY1N2UtZjU3OS03OTQxLWIwYTgtZGU3MjdiYjI3MDhhIiBzdFJlZjpkb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6OWZmYzA0NGMtNTQyYS03NTRkLWI0YzUtOTIwZWRkMTVlYjRlIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+/5jbrAAAAG1JREFUeNrslzEOgDAMAxOU/+T/z8iLzMLACkZyAXvqUvWUNCclAYQyW4hTMyN7vLujjvPdPiR5V98CAxjAAHWeSWaeWQCZiOqhSl6tAvwJDbCcB9iABbCIKJlYRAb4jIiYJfG9Isrfb8e7AAMAInAVUndCPVIAAAAASUVORK5CYII=";if(e.is(P.Report.Dashboard.IStiChartElement))return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAGNJREFUeNpi/P//P8NAAsaBdgATiDh//vz/AXXAgIfAQAIWYhXiiiZDQ0PG0SigSxTQKnpGo2DUAYMrF9CisCFk5mgUjDpg1AGjDhh1wKgDRh0A7hsOVNcMVCUzjvjeMUCAAQAQtyafO9RmPQAAAABJRU5ErkJggg==";if(e.is(P.Report.Dashboard.IStiGaugeElement))return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA4RpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo4M2I5YzlhNS1lZGRmLTU0NGItODFmMi1mMzVmMDgyNTUzMTciIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NzczNjEzRTU3MzI1MTFFN0I4QTBFMzE1MDQyQjZBNDQiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NzczNjEzRTQ3MzI1MTFFN0I4QTBFMzE1MDQyQjZBNDQiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKFdpbmRvd3MpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NWU4YzI0ZGYtNjI5ZS1jNDQwLTg2NjMtMjlmM2VlODA4MGFjIiBzdFJlZjpkb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6YWM1MjY1OGUtNzMxZC0xMWU3LWE0ZGMtODFhMmMxY2EwMjcyIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+or3oxAAAA/1JREFUeNrEV9tOU0EU3S2UW4AWStsQ7oYaCA8QEj9BeOdB+AVRg36JxesvoA++i59gFB4hJnK/2AttgXBpKXWvcfZx2pz29IJxJZOec3rOWmv27Nkz48rn8/Q/0Vjpi+vr6x7+meX2kNsDbve4+fTfKW4/uX3l9oXb56mpqWwlvC6nCLAwRJ5zW/R6vYGOjg5qbW2l5uZmamhoUO/kcjm6vr6my8tLOjs7o3Q6HefHb7lF2EiqZgMsvgCSgYGBEItTY2NlAbu5uaFYLEa/GDDPJlaqMsDC6Nrrrq6ux8FgkPBOW1sbZTIZSqVSqpdXV1dKaHJykjY2NqipqYna29vJ5/Opa+D8/JwSiQQlk8n3fPuMjeQcDWjxj4FAYK6vr089AwlCDsLj4+OC95kU3xQ8Y+PU29trGTk4OEBEPvHlo2ITdjGNmOKnp6eqV5ubmzQ6OqpIMRQtLS3WkIyNjVnROTk5QY+RBzQ4OKi+1VxzbGKZf5+WjAD3ZJ7dr+BDl8tF8Xic9vf3aXh4WBEi7OFwmNxud8nxh5GjoyNlAoA4d0hd7+zs4PkCR+GDvO8uyvZXfr9fiaM3EJek6u7uVlm+u7tbNgERoaGhIerp6bHCDy4A3NDQWoUGkK2hUCiIREIvRAhEaJh+IAfZn+Quj/7+fvWdDBMiDW5o6Gn91wA7QrYsSqgQwtvbW5VMIBLoHqj/pVdOJsbHx1WH9vb21DOtsag1rQjMoMjALV6W8UMmF2e3ABHCkDgBPT88PFTJCW5oQAuaBQYQYlVTdc8gJtPIHF95DxHa2tpS+VG21rOgGBduzTFrGphGeZXiAWD62EGGQTJ+e3ubnMq5cAm31po2DdxHoQEkrKh8dujs7LTWACFFJMpBuIRba4VNA14hlZCaIiZQAzAlTVxcXDgOgw23t3gaVgwYQK2wqplxXS3EQBpLqulW7u2AMRwZGSGPx6Mar5aOq6MNd9pcC37weh6QGp/NZlVYsQSXAnJhYmKiol7KEEmiY+8ATTMC3yRBZJqh9t8VhAuV0EjG76aBVazx5pRB4UAk6gU4wGVya63VAgPsMoGxQrGRwoEKVi+EQwobNFgrhn2jZYCXxwz/vME2SkowphtKsqyItQDfggNcUta1xjutWTANI7zKRVFY4BR7AjNzqwUSD/sJAFzgBDdrwEGkYLGQtra2Ns+lNS/gD/L1gMXy0WjUugc3ayyYmgUGtIk3HLr8XQOc4C7Ws6uES9hAYidzVzA2pUtVb8ux+sn8dQKWaFQ5VMeat+U2B5NlbKOwk6nhYBJFr6s+mNgczV5we8Kl2V/h0Syhj2Yv6zqalTiczhiHU9mjJY3DKSrcqszzug+n/xq/BRgAggASny2TUqcAAAAASUVORK5CYII=";if(e.is(P.Report.Dashboard.IStiImageElement))return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA4RpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo4M2I5YzlhNS1lZGRmLTU0NGItODFmMi1mMzVmMDgyNTUzMTciIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OEJDMzU4OUE3MzI1MTFFN0EzMDFCNjJCNzkyMjQxMjIiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OEJDMzU4OTk3MzI1MTFFN0EzMDFCNjJCNzkyMjQxMjIiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKFdpbmRvd3MpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NWU4YzI0ZGYtNjI5ZS1jNDQwLTg2NjMtMjlmM2VlODA4MGFjIiBzdFJlZjpkb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6YWM1MjY1OGUtNzMxZC0xMWU3LWE0ZGMtODFhMmMxY2EwMjcyIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+HvDPrgAAAe5JREFUeNrMV8luwkAMdUIECBAgEPsqDpz5/6/gxgmxbwLEJiR2yjNNBSW0mTJhaikaYqL4zbP9nNHO5zOpNKNaraoF8LmqokEzAVClUnlrZJN5nRSb4cRL5/M5DYdD2m635PF4KJlMUjgctnxWdyJ4s9mkzWZD6DCsuIf/LQCwcxG/dACgXcQvHQByLuKXDgAFJ+KXDgDVXiwWyev1kqZpvOL+WRc40oYI9iyg4wyI2v9TwtPpRKPRiKbTKd/HYjGKx+OcT8cZQPB6vU77/Z7K5TJf6F/4jsej8wx0Oh0KBoOUSCS+fPl8nhlpNBpUKpVI16+Yl8sl9Xo9ltt0Om276H4EMJvNeHW73bTb7cjlcnGg1WrFgRAwl8vReDzm36ZB6wE6lUrJmYatVuuan8tukRbTUBc+n89SVsES0pTNZu+eHwwGXD+RSIRrCZuy3QW3wU3rdrsUCAQoFAo9/DeZTDggrN/vc0oPhwPXFADWarWHqSjchkhFu93m7vD7/ZZM4DJr5dYABul6WQfADF6UyWQsh4xJ+zP9lyJE2A1qpVAokGEYfwbxkhKiGNENGDZWlNsB8bIUr9drbkswYaWWv4GQMgsWiwVrxW0L2gVxlzwZZ4NoNCr0wWJ8PyiomoYaKTJN9elY+QfJhwADAEAG9ixyyux6AAAAAElFTkSuQmCC";if(e.is(P.Report.Dashboard.IStiIndicatorElement))return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA4RpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo4M2I5YzlhNS1lZGRmLTU0NGItODFmMi1mMzVmMDgyNTUzMTciIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6N0VGMkNEQjVCRkM3MTFFNzg1ODA5NENGODgxNjBBRTQiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6N0VGMkNEQjRCRkM3MTFFNzg1ODA5NENGODgxNjBBRTQiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKFdpbmRvd3MpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6ZmUxMzY0MDEtMWIwOS1jODQ1LTg3Y2EtOWFlMjkyOGJiNjhiIiBzdFJlZjpkb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6MmUxNzdhMzEtOWZlZS0xMWU3LWIxNzMtZTY1ODBhMDllOGE4Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+TLktDAAAAdBJREFUeNrUl7FKA0EQhi/BXq61jEZSBhIUW429FlqofSKCrbHXcKkFQdNoa3wBMU8gCeQJrrCwCiSdIMj5D/zCeBzJZe82iQsftzc7m5mbnZ3dZIIgcObZss6c29K4wX6/n4qRYrFoLQLbxE4EJrQMaLC/BYJZ58A+2CR7s05Cidy1em+YRjNrOKcGCkpWoCxrIwdWwIaiDJYj9G7AFeiCN8VHUgfOwUXMDxLHdoi0JqgnXYJL0DJYqhbnJs4B2V6n4HkK423OCdJKwm9wDDoxdF/BCeekugu+wEMMvUfqWtmGazF0Vm3WgXwMnXWbDugIDMAZGUwZpUQR+OT+lv4tkb7HsbwtB1zwwrIrxWWkxkbc8wXquDaO4yE4mqDzHkPn75k+7zvhxAjgWnaAxx3wcbUqK7kUnApf6xhrhvRdFq4qxnyjHMCPySH0FF5TyD0aLzMfPMgqwKXxDozKjSnHd+MkFCNVrn9YPoSRnirPFSJO9CiT569j0zsAA7vgPmIop5zylSynEjY8tpj/C0wd8FVe6K/2Vc1wIiKSmgNy3rtY25LaCZJ4bRorUSbPnvEuGJMbTTrRZQmu07jDpC3BuYDOHC50Ifq3SZha+xFgANyufsKlz/2MAAAAAElFTkSuQmCC";if(e.is(P.Report.Dashboard.IStiListBoxElement))return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA3ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDowMDEzNGViZC0wY2ZmLTczNDMtOWIwMi1jNTkzNzdiMWRiMjIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NTA5MTJDN0Q4NTYwMTFFOEI3N0JBNjlFRDdGQ0IwOEIiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NTA5MTJDN0M4NTYwMTFFOEI3N0JBNjlFRDdGQ0IwOEIiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKFdpbmRvd3MpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MDAxMzRlYmQtMGNmZi03MzQzLTliMDItYzU5Mzc3YjFkYjIyIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjAwMTM0ZWJkLTBjZmYtNzM0My05YjAyLWM1OTM3N2IxZGIyMiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsGuI54AAACuSURBVHja7FeJCcAgDNTiEI7h/kvoGG5hm4JQQm2jGAOSgyKKyR3m0dpSipHEYYShAlxKSVbA9clmYYyxzMCIH7DRJHR4oScpQwi/e3LO9+i9pwmgOKUCyKuAlgi2EGByPGcPwRsZrOFTYAsB1c9eVTDS1qeGoNcWBO/biFp+sA1bFUC54VJc2oiA7EmI50vuAixg+V3wRayP0goLzyLpPmBFT0B/zVSAtIBTgAEAMM3EXL6e7tsAAAAASUVORK5CYII=";if(e.is(P.Report.Dashboard.IStiPivotTableElement))return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA25pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo4M2I5YzlhNS1lZGRmLTU0NGItODFmMi1mMzVmMDgyNTUzMTciIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OTE1MUMzNDA5RkFDMTFFN0JERThGRDhBNTZGM0ZDN0YiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OTE1MUMzM0Y5RkFDMTFFN0JERThGRDhBNTZGM0ZDN0YiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKFdpbmRvd3MpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OTIzODI0M0I3MzI1MTFFN0E4QTI5RjYzRTdGNDREM0MiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OTIzODI0M0M3MzI1MTFFN0E4QTI5RjYzRTdGNDREM0MiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7WOnt0AAABPUlEQVR42uxXSW6EMBBsQxASJ8R2YPkD/38FT0BCgMRygSMCZsrKJCQZlGHAQJTpk90culyuajdsHEc6MiQ6ON6mmyiKdqMjDEP2A8D7B+HFrwc96RXMoZyycy+/gPbzifAF4LwinLPj1jZd7IKXBpZEnueUZdlzV7A20jSlsiz5ehgG8n1/PwBJklBd16QoCt9XVUV49oMg2OcKUNyyLDIMg7qu42vkdtOA4zhfKMcaud0AuK77UE64C0C/LMtiXXATHCienhLKb9uWNE0T1wdgtZvgpsX7vqc4jjkDpmmKYQBNBj6H1SRJ+mg4KNo0DQcBF+i6LgbAdJwviuKT0isYVVU5K7+dfhUAUA4QYMG2bfI8b9vX8JFAUYgNIBhjs1bbdB74Hmiv91rs352I1ozdzwT79z+nhwO4CDAAvLyCJQ9KIGkAAAAASUVORK5CYII=";if(e.is(P.Report.Dashboard.IStiProgressElement))return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA4RpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo4M2I5YzlhNS1lZGRmLTU0NGItODFmMi1mMzVmMDgyNTUzMTciIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MTI4QjI4RjdCRjUxMTFFNzk4RThFMTk3MzM2QTVEREYiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MTI4QjI4RjZCRjUxMTFFNzk4RThFMTk3MzM2QTVEREYiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKFdpbmRvd3MpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6ZTI4MmVmYWItOTQwYy1mYjQwLTg5OTctNzNiNzU1Nzk1ZmY1IiBzdFJlZjpkb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6MmUxNzdhMzEtOWZlZS0xMWU3LWIxNzMtZTY1ODBhMDllOGE4Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+xEa5MgAAAoxJREFUeNrEV7lOA0EMJeESFXcQLeIoiZBoEKIjKZEoIL/AFUJHR0FDRxDXJxAoEC1Ji0SBQKHjEh/ATRkQCs+SNzhmsrvZbMDS02jHM7bX4xnbgXw+X/OfVOd2YTabrccQBcaBYaAnHA63YJ7Yb8A9cAZkgGPwPt3IDTh5AApaMCSAWaBT8qCkhg3Q9ARsA0msebOTH3RQHsNwBaxo5Q7UwXuuWEZ5R4BNtRg2gZkKj7gL2IO8MYwL8MaXowdY+UEJ5TfAKjAKdANNjG6eW+U1mkjWAcu2jwEsoj+fNwhZ5jPNORxbI8fMmoG9jf3zJQ3A5mkMKbXphAzCxstyfA9Zgxi22DOSYpC1/8sAjvZrICQWnwIT2PDoJQAgkwL3CBgR0w/AgHU7ZAwklHKiWa/K+ZrS3jk1HWJdP0EISxv4nhedOQRkK33pWMay/jHWWfBARN1ziuSkjy9uUt2OTtZZZICklFO0l+mFnCG4o9KAIcXMVCHvpNX3kDSg3/Dg+E236ruv8BTDRc2K+V4FA7TM5oIBpoxGme4vKGhnnc9k9HLQ7nx8pj5TTFgGnCtmpAoGaJkX0gB9RWKc1XwhlhUzXUtpwLNg9sv32gdKqKtOOeK4YAAi/oNTp6Q1WB724e8HDbXBDussyoZJTpVFBQSnVK/Kae+Omn6UeSYo7j3l57haTHn8kP/Cy58fqlqAKC4rZVNJtmXI4VZJtm65zkYxpdklTyWZKkonDQKumUcBdAe88Hwb0MtXjcq6AcNe8saUroyNjYmPZblFu6XKctvOiJuKDUOp5pYoqBehOFVpa7bEcdHuUvEzt2brTq1ZwG13LJrTiNWcAq3MfhXNKT1qaadgLduAatG3AAMAxAf6UcvGQQYAAAAASUVORK5CYII=";if(e.is(P.Report.Dashboard.IStiTreeViewElement))return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA4RpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpiNGFhYjFiMC1lZTZlLTJkNDctYWZlMi1lYmQzYmI3MzJkNWQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NUE2RkJGN0VBNjVFMTFFODk5OTVCRERFOTIwOEI5N0UiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NUE2RkJGN0RBNjVFMTFFODk5OTVCRERFOTIwOEI5N0UiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKFdpbmRvd3MpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MTI3NTcwYzItM2MyZS05NDQxLTgzZjctYmYwM2ZkODU5YjRjIiBzdFJlZjpkb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6ZTkyYWNjNTItYTY0OS0xMWU4LWJmZGYtYWIxMTU1OWY5YTkwIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+WYlYxgAAAMBJREFUeNrsllEKwCAMQ9fhgbz/KbyRQ7Agm0pLbWRgQJhfi68xSDnna6dCu0kpfdzEGAlmoP6wNYQlIFGPUhVBDLxHYqUUOifcF0I+XcHsHT7WLcEMNzAJGuYWdILm1g9iAqUfeMEJCKUdG63OACmXjoBXP4QRgdaE57U8PXB6ANEDhMrA9L6bCXj1gIhAMcSm2u8VIuuz3EpGlQGPfjARGBgiKAFrP6h6wOOdgMjA9F3wrwwMRqJqvuU9YNUjwABgJX86W1bOxQAAAABJRU5ErkJggg==";if(e.is(P.Report.Dashboard.IStiWebContentElement))return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAACIUlEQVR42u2XsYoCQQyGfS0fQHu1slIQFES0sBEbF8ROUDtB2UpFtBIsfQUbH0Ks1wfI8YfLMYyzM7OuesVdYDhcvOTb5E8mZjL/9m3ZbJY+eYwAPtZsNmm73VIaexrgeDxSoVCg4XBIxWKRP38MIIoiDnq9Xh9g5NlbAZbLJQfTDeUAyHQ69QZJDADHuVwuNgCeJylLYgA4RwZcBhCIFCDn8/k1AHCEFJvscDjQaDSyitWUtUQAprReLhfqdDpUr9epWq0ySJxuUDr8hYgTAyAwUip2u92o3+9TuVym+XzOgcMw5M/3+91bH14A+EdpOzjfbDZUqVRoMBjQfr/n4HJ6vR4tFgunPlAWvJAXwGQyYfLT6cRv2O12HwLL2e12/B2Uxmbwh7Z1Aghtq9XiGku6bWc2m7EuXFPUqwRCCseNRsMZXA5EGSdIbw2opDCIbjweewGs12ujIPEy6hS1Auhth7rCKersAwGRYiybxOwE0EnFoHA4dgVHS6JktVrtJwvwB0F7DSIZo/r0gjNkYbVaGQPjOboE30G7SnARs+7PSwP6GDUJEmUJgoDngxpYXV5Ml5OzC+BIHaNi7XabW1ICl0olLo9pCupifuou0MeoCBKB0R0YzXFmuxETX8dyIyKlyIBr4sUtLy/dCW3LST6ft25HqbZiOEafI8Wm7dhneUkFYLtmpe3Uu/9tAGlW9ZcCqPNeXV6eAvjVn2Z/1r4A4YX01RrCMf0AAAAASUVORK5CYII=";return null}}R.z.StiElementExportTool=Ud}let g=R.i.StiChartElementBuilder,jd=(R.z.StiChartElementExportTool=class extends R.z.StiElementExportTool{async render(e,t,i,r,s){if(this.renderEmptyDataMessage(e,t,i.clone(),r))return;let l=e.as(Qm),n=null,a=(0<l.chartValuesList().length&&(n=await R.z.StiElementExportTool.getDataTable(l)),await g.create(l).render(l,n)),o=(a.horSpacing=0,a.vertSpacing=0,bd.getScaleFactor(t,r));g.scaleFont(a,o);for(let e=0;e<a.series.count;e++){if(null==s||e>=s.length)break;a.series.getByIndex(e).valuesStart=s[e]}a.name=e.name+`_Content`,a.clientRectangle=i.clone(),t.components.add(a)}},R.h.StiGaugeVisualSvgHelper),zd=(R.z.StiGaugeElementExportTool=class extends R.z.StiElementExportTool{async render(e,n,t,i){if(this.renderEmptyDataMessage(e,n,t.clone(),i))return;let a=e.as(Km),o=await R.z.StiElementExportTool.getDataTable(e),u=(new Ra).render2(a,t.size,o);if(1!=(await u()).count2()||i.is(kd)||i.is(Od)){if(0<(await u()).count2())if(i.isDesignMode||i.format!=R.f.StiDashboardExportFormat.Html)await this.renderContent(e,n,t.clone());else{let r=0,s=id.getLocationRectangles(t,(await u()).count2(),a),l=s[0].clone();for(let i of await(u=(new Ra).render2(a,l.size,o))()){let e=s[r].clone(),t={ref:0};H.isNullOrEmpty(i.series)||(await this.renderSingleGaugeTitleFromIteration(a,n,i,e,l,u,r,t),e.height-=t.ref,e.y+=t.ref),this.renderSingleGaugeFromIteration(a,n,i,e,r),r++}}}else this.renderSingleGaugeFromIteration(a,n,(await u()).firstOrDefault(),t)}renderSingleGaugeFromIteration(e,t,i,r,s=0){let l=i.gauge;l.name=e.name+`_Content`+s,l.clientRectangle=r,l.style=U.getGaugeStyle(e),l.customStyleName=e.customStyleName,l.brush=new E(U.getBackColor(e,null,!0)),t.components.add(l)}async renderSingleGaugeTitleFromIteration(n,a,e,o,t,i,u,h){let m=e.series,c=U.getFont(n),r=await jd.getTitleHeight(null,i,o,n,null),d=await jd.getTitleMinFontSize(null,i,c,t.width,t.height);if(h.ref=r||0,null!=r){let e=new L(o.x,o.y,o.width,h.ref),t=Hn.changeFontSize(c,d),i=Sd.measureTitle4(null,e,c,m),r=(e.height=i.height,Xn.getForeColor(n,n.foreColor)),s=N.transparent.equals(r)?U.getForeColor(n):r,l=new Ho(e);l.name=n.name+`_ContentTitle`+u,l.brush=new E(N.transparent),l.text=m,l.font=t,l.textBrush=new E(s),l.horAlignment=jt.Center,a.components.add(l)}}},R.z.StiImageElementExportTool=class extends R.z.StiElementExportTool{async render(e,t,i,r){if(this.renderEmptyDataMessage(e,t,i.clone(),r))return;await this.renderContent(e,t,i.clone())}async renderContent(e,t,n){let a=e.as(Ym),o=await this.draw(a,n.clone());if(a.aspectRatio&&null!=o){let e=n.width/o.width,t=n.height/o.height,i=(e=t=e<t?e:t,o.width*(e=t)),r=o.height*t,s=this.calculateHorAlignmentPosition(a,n,i),l=this.calculateVertAlignmentPosition(a,n,r);n=new L(s,l,i,r)}let i=new Hd(n);i.name=a.name+`_Content`,i.stretch=!0,i.aspectRatio=!1,i.imageToDraw=o,t.components.add(i)}calculateHorAlignmentPosition(e,t,i){switch(e.horAlignment){case X.Left:return t.x;case X.Right:return t.right-i;default:return t.x+(t.width-i)/2}}calculateVertAlignmentPosition(e,t,i){switch(e.vertAlignment){case Ht.Top:return t.y;case Ht.Bottom:return t.bottom-i;default:return t.y+(t.height-i)/2}}},R.z.StiImageElementExportTool),Xd=R.z.StiGaugeElementExportTool,Gd=R.z.StiChartElementExportTool,Jd=R.A.StiExportSettingsHelper,Wd=R.A.StiExportFormatHelper,Ud=R.z.StiElementExportTool,Zd=R.A.StiTitleExportHelper,Yd=R.A.StiBackColorExportHelper,Kd=R.A.StiBorderExportHelper,Qd=R.A.StiLayoutExportHelper,qd=P.Base.IStiReport;{class Tp{static exportAsync(t,i,r){setTimeout(async function(){let e=await Tp.export(i,r);t(e)})}static export(e,t){let i;return i=t instanceof Vd?t:t instanceof od?R.A.StiExportSettingsHelper.getDashboardExportSettings(t):R.A.StiExportSettingsHelper.getDashboardExportSettings2(t),this.exportToStream(e,i)}static async exportToStream(t,i){let e,l=new xm,r=(l.isDocument=!0,l.reportUnit=Cm.HundredthsOfInch,l.renderedPages.getByIndex(0)),s=(r.orientation=i.orientation,r.paperSize=i.paperSize,(i.is(kd)||i.is(Ed)||i.is(fd))&&(r.margins=new Se(0)),i),n=("width"in i&&null!=s&&0<s.width&&0<s.height&&(r.width=s.width,r.height=s.height),null==(e=t.as(ae))?void 0:e.dashboardWatermark),a=(r.tagValue=n,null==r.tagValue&&(r.tagValue="*Dashboards*"),null);if(t.is(qd))await this.renderCellReportAsync(t,l,r,i);else if(t.is(Fe)){let e=t.as(Fe);(a=e.report).currentPage=a.pages.indexOf(e.page),await this.renderCellDashboardAsync(t,r,i)}else if(t.is(ve)){let e=t.as(ve);(a=e.report).currentPage=a.pages.indexOf(e.page),await this.renderCellElement(t,l,r,i)}l.parentReport=a;for(let r of l.renderedPages.list)r.components.toList().where(e=>e.is(ee)).cast().forEach(e=>{let t=r.components.indexOf(e)+1,i=e.getComponentsList();for(let e=0;e<i.length;e++)i[e].page=r,i[e].setDirectDisplayRectangle(i[e].componentToPage(i[e].displayRectangle)),r.components.insert(t+e,i[e]);e.components.clear()});if(0<l.renderedPages.count&&!(P.Base.CePle.XWbEu.QsrKO()||(P.Base.CePle.XWbEu.xyihe()||P.Base.CePle.XWbEu.DnAzo())&&P.System.NodeJs.isStandaloneVersion)){let e=l.renderedPages.getByIndex(0),t=e.report.unit.convertFromHInches(200),i=e.report.unit.convertFromHInches(52),r=new L((e.width-t)/2,e.height-i,t,i),s=new Hd(r);s.stretch=!0,s.printable=!1,s.image=P.Report.Export.StiExportUtils.getAdditionalData2(192),s.name=P.Report.StiNameValidator.correctName(P.System.Guid.newGuidString().substring(0,8)),s.componentPlacement="pf.PageFooterBand",e.components.add(s)}let o,u=null==i?Cd.Document:Wd.convert(i.format);if(u==Cd.Document)o=P.System.Text.Encoding.UTF8.getBytes(l.saveDocumentToJsonString());else{let e=Jd.getExportSettings(i),t=await l.exportDocumentAsync2(u,null,e);o="string"==typeof t?P.System.Text.Encoding.UTF8.getBytes(t):"undefined"!=typeof Buffer&&Buffer.isBuffer(t)?t.toJSON().data:t}return o}static async renderCellReportAsync(e,t,i,r){let s=e.as(qd).fetchPages().where(e=>e.is(Fe)).cast();for(let e=0;e<s.length;e++)0<e&&(i=i.clone(!0,!1),t.renderedPages.add(i)),this.setUpPage(i,s[e],r),await this.renderDashboardAsync(i,s[e],r)}static async renderCellDashboardAsync(e,t,i){this.setUpPage(t,e,i),await this.renderDashboardAsync(t,e.as(Fe),i)}static async renderCellElement(e,t,i,r){let s=e.as(ve);s.is(au)&&t.dictionary.resources.addRange(s.report.dictionary.resources),t.reportAlias=s.name,this.setUpPage(i,e,r),await this.renderSingleElementAsync(i,s,r)}static async renderDashboardAsync(t,e,i){if(null==e)return;null!=i&&(i.renderSinglePage=!0,i.renderSingleElement=!1);let r=e.as(_m),s=await r.getElements(!1).whereAsync(async e=>e.isEnabledAsync()),l=1,n=1;if(i.is(md)){let e=i.as(md).scaleMode;switch(e){case hd.PaperSize:l=t.width/r.width,n=t.height/r.height;break;case hd.ViewSize:{let e=Math.min(t.width/i.viewportWidth,t.height/i.viewportHeight);l=i.viewportWidth/r.width*e,n=i.viewportHeight/r.height*e;break}case hd.DesignSize:l=n=Math.min(t.width/r.width,t.height/r.height);break}}t.brush=new E(U.getDashboardBackColor(e,!1)),await this.renderElementsAsync(t,s,l,n,i)}static async renderSingleElementAsync(e,t,i){if(null==t||!await t.isEnabledAsync())return;null!=i&&(i.renderSingleElement=!0),e.brush=new E(U.getBackColor(t));let r=t.as(pt),s=e.width/r.width,l=e.height/r.height,n=await this.renderElementAsync(e,t,s,l,i),a=Jd.isDataExport(i),o=t.margin;n.left=a?0:o.left,n.top=a?0:o.top}static setUpPage(i,r,s){var e;if(s.is(Od)&&(i.orientation=s.as(Od).orientation,i.paperSize=s.as(Od).paperSize),(s.is(kd)||s.is(Ed)||s.is(pd)||s.is(fd))&&(i.margins=new Se(0)),s.is(md)){let e=s.as(md).scaleMode,t=(0!=s.viewportWidth&&0!=s.viewportHeight&&e==hd.ViewSize||(s.viewportWidth=r.as(pt).width,s.viewportHeight=r.as(pt).height),s.as(ud));null!=t&&0<t.width&&0<t.height&&(s.viewportWidth=t.width,s.viewportHeight=t.height),s.is(Od)||(i.width=s.viewportWidth,i.height=s.viewportHeight)}let t=null==(e=r.as(ae))?void 0:e.dashboardWatermark;i.tagValue=t,null==i.tagValue&&(i.tagValue="*Dashboards*"),null!=t&&(t.textEnabled&&(i.watermark.text=t.text,i.watermark.textBrush=new E(t.textColor),i.watermark.font=t.textFont,i.watermark.angle=t.textAngle,i.watermark.showBehind=!0),t.imageEnabled)&&(i.watermark.image=t.image,i.watermark.aspectRatio=t.imageAspectRatio,i.watermark.imageAlignment=t.imageAlignment,i.watermark.imageMultipleFactor=t.imageMultipleFactor,i.watermark.imageStretch=t.imageStretch,i.watermark.imageTiling=t.imageTiling,i.watermark.imageTransparency=t.imageTransparency,i.watermark.showImageBehind=!0)}static async renderElementsAsync(r,t,s,l,n){null!=n&&(n.renderSingleElement=!1);for(let e of t){let t=await this.renderElementAsync(r,e,s,l,n),i=e.as(dt);if(null!=i){let e=i.getComponents().toList().where(e=>e.is(ve)).cast();await this.renderElementsAsync(t,e,s,l,n)}}}static async renderElementAsync(e,t,i,r,s,l,n={ref:new P.System.Drawing.Rectangle},a=new j){let o,u=t.as(pt),h=Jd.isDataExport(s),m=Math.round(u.left*i),c=Math.round(u.top*r),d=Math.round(u.right*i),g=Math.round(u.bottom*r),p=new L(m,c,d-m,g-c);if(h||(p=Qd.excludeMargin(t,p)),u.parent.is(dt)){let e=u.parent;p.x-=e.margin.left,p.y-=e.margin.top}let S=new ut(p),w=(S.name=t.name,bd.isAllowOpacity(s));if(h||(S.brush=new E(U.getBackColor(t,null,w)),S.cornerRadius=null==(o=t.as(Je))?void 0:o.cornerRadius),e.components.add(S),null!=S.report&&null!=t.report&&(S.report.styles.clear(),S.report.styles.addRange(t.report.styles)),p=await Zd.render(t,S,s),!h){Kd.render(t,S,s),Yd.render(t,S);let e=Ud.getScaleFactor(S,s);p=Qd.excludePadding(t,p,e),p=Qd.excludeCornerRadius(t,p,e),n.ref=p}let f=bd.getTool(Oe.getType(t));return(f=null==f?new Ud:f)[P.System.StiObject.stimulsoft]().is(Gd)&&s.is(pd)?(t.previousAnimations=a,await f.render(t,S,p.clone(),s,l)):f[P.System.StiObject.stimulsoft]().is(Xd)&&s.is(pd)?(t.previousAnimations=a,await f.render(t,S,p.clone(),s)):!f[P.System.StiObject.stimulsoft]().is(zd)&&null!=s&&1==s.isDesignMode&&t[P.System.StiObject.stimulsoft]().is(vo)||await f.render(t,S,p.clone(),s),S}}R.f.StiDashboardExportTools=Tp}let _d=P.Report.Dashboard.Helpers.StiBorderElementHelper,$d=(R.p.StiElementControlPainter=class{static getBorderContentRect(e,t){return _d.getBorderContentRect3(e.clone(),t,Jo.factor,!1)}},R.p.StiLocHelper=class{static get locAll(){return`(${b.get("Report","RangeAll")[P.System.StiObject.stimulsoft]().replaceAll("& ","")})`}},P.System.Drawing.SolidBrush),eg=R.K.StiTableElementConditionHelper,tg=P.System.Drawing.StringFormat,ig=P.System.Drawing.StringFormatFlags,rg=(R.C.StiIndicatorCellPainter=class{static async draw(e,t,i,r,s,l,n,a,o,u=!0){let h=await eg.getIconCondition(l.key,i,r,s),m=(null!=h&&h.iconAlignment!=G.None&&(await R.C.StiConditionIconPainter.drawIcon(e,h,t,n),t=R.C.StiConditionIconPainter.adjustCellContentRectWithIcon(t,h)),this.getCellText(i,l,a));await this.draw2(e,t.clone(),i,r,s,l,n,a,o,m,u)}static async draw2(i,r,s,e,t,l,n,a,o,u,h=!0){let m=this.measureText(n,u,s.font),c=this.calculateIndicatorRect(r.clone(),l,n,m);if(await this.drawIndicator(i,s,e,t,l,c,a,o),h){let e=this.calculateTextRect(r.clone(),l),t=this.getColor(l,a,o);this.drawText(i,e,l,n,u,s.font,t)}}static async drawIndicator(n,a,o,u,h,m,c,d){let g=Math.min(m.width,m.height);if(null==c||0==c)n.fillRectangle(new Re(m.x+(m.width-g)/2,m.y+(m.height-4)/2,g,5),N.lightGray);else{let e=.75*g,t=(m=new L(m.x+(m.width-g)/2,m.y+(m.height-e)/2,g,e)).width/2,i,r,s,l=(s=0<c?(i=new qn(m.left+t,m.top),r=new qn(m.left,m.bottom),new qn(m.right,m.bottom)):(i=new qn(m.left+t,m.bottom),r=new qn(m.left,m.top),new qn(m.right,m.top)),0<c?d.cellIndicatorPositive:d.cellIndicatorNegative);l=await eg.processForeColor(l,h.key,a,o,u),n.fillPolygon([i,r,s],new $d(l))}}static drawText(e,t,i,r,s,l,n){if(H.isNullOrWhiteSpace(s))return;t.width-=2;let a=new tg,o=bh.Table.Font.getGdiFont(r,null,l);a.lineAlignment=dl.Center,a.alignment=this.toAlignment(i),a.trimming=qu.None,a.formatFlags|=ig.NoWrap,e.drawString(s,o,n,t.clone(),a)}static measureText(e,t,i){if(H.isNullOrWhiteSpace(t))return 0;let r=bh.Table.Font.getGdiFont(e,null,i);return th.measureString(null,t,r).width}static calculateIndicatorRect(t,e,i,r){let s=16*i;switch(this.getHorAlignment(e)){case X.Left:t=new L(t.x,t.y,s,t.height);break;case X.Right:t=new L(t.right-s,t.y,s,t.height);break;case X.Center:{let e=r+s;t=new L(t.right-(t.width-e)/2-s,t.y,s,t.height);break}}return t.inflate(-4*i,-4*i),t}static getCellText(e,t,i){if(null==i)return"";return ls.formatAsPercentage2(e.report,t.textFormat,i)}static calculateTextRect(e,t){let i=e.width/4;switch(this.getHorAlignment(t)){case X.Left:return new L(e.x+i,e.y,e.width-i,e.height);case X.Right:return new L(e.x,e.y,e.width-i,e.height);case X.Center:return new L(e.x,e.y,e.width,e.height)}return e}static getColor(e,t,i){if(!N.transparent.equals(e.foreColor))return e.foreColor;if(0<t)return i.cellIndicatorPositive;if(t<0)return i.cellIndicatorNegative;return i.cellIndicatorNeutral}static toAlignment2(e){if(e[P.System.StiObject.stimulsoft]().is(dl))return e;let t=e[P.System.StiObject.stimulsoft]().as(Ii);if(null==t)return dl.Center;return this.toAlignment(t.horAlignment)}static toAlignment(e){switch(e){case X.Left:return dl.Near;case X.Center:return dl.Center;case X.Right:return dl.Far}return dl.Center}static getHorAlignment(e){let t=e;return null!=t?t.horAlignment:X.Right}},R.C.StiIndicatorCellPainter),sg=P.Data.Engine.StiDataSortRuleHelper;{class kg{static getBackgroundColor(e,t,i,r){return null==t||t.data.backColor.equals(N.transparent)?r?i.alternatingCellBackColor:i.cellBackColor:r?U.isDarkStyle3(e)?qh.light(t.data.backColor,25):qh.dark(t.data.backColor,25):t.data.backColor}static measureColumn(e,t,i,r,s){let l,n=bh.Table.getHeight(i.font,i.zoom);if(r.is2(rs))l=this.measureSparklinesCell(i,0,i.zoom);else if(r.is2(es))l=this.measureIndicatorCell(e,i,r,s,i.zoom);else if(r.is2(is))l=this.measureDataBarsCell(e,i,r,s,i.zoom);else if(r.is2(Zr))l=this.measureBubbleCell(e,i,r,s,i.zoom);else if(lh.isImage(s))return new W(0,bh.Table.getHeight(i.font,i.zoom));return new W(l.width,Math.max(l.height,n))}static getArrowSize(e,t){let i=bh.Table.getHeight(e.headerFont,e.zoom),r=sg.getSortDirection(e.userSorts,t.key);if(r!=Bh.None)return new W(1.5*i,i);return W.empty}static getRightImageRect(e,t,i){let r=i.width*e.zoom,s=i.height*e.zoom;return new L(t.right-3-r,t.y+(t.height-s)/2,r,s)}static measureSparklinesCell(e,t,i){return new W(Math.max(t,80*i),0)}static measureIndicatorCell(e,t,i,r,s){let l=i,n=rg.getCellText(t,l,O.tryToNullableNumber(r)),a=this.measureCell2(e,n,t.font,i);return a.width=(a.width+4)*s*1.25,a}static measureDataBarsCell(e,t,i,r,s){let l=ls.formatBasedOnColumnType(t,i,r),n=this.measureCell2(e,l,t.font,i);return n.width*=s,i.horAlignment!=X.Center&&(n.width*=2),i.is(is)&&0<i.width&&(n.width=s*i.width),n}static measureBubbleCell(i,r,s,l,e){let n=bh.Table.getHeight(r.font,r.zoom);if(s.horAlignment==X.Center)return n-=2,new W(n,bh.Table.getHeight(r.font));{let e=ls.formatBasedOnColumnType(r,s,l),t=this.measureCell2(i,e,r.font,s);return t.width+=n,t}}static measureCommonCell(e,t,i,r,s,l){let n=ls.formatBasedOnColumnType(t,i,r),a=new W(s,0);return lh.isImage(n)||((a=this.measureCell2(e,n,t.font,i)).width*=l,a.height*=l),a}static measureHeader(e,t){return this.measureHeader2(null,e,t)}static measureHeader2(e,t,i){let r=nm.getLabel(i),s=this.measureCell2(e,r,t.headerFont,i);return s.width+=36,s}static measureCell(e,t,i){return this.measureCell2(null,e,t,i)}static measureCell2(e,t,i,r){let s=new W(8,bh.Table.getHeight(i));if(H.isNullOrEmpty(t))return s;let l=new R.C.StiTableColumnSizeHelper(i,r),n=i[P.System.StiObject.stimulsoft]().getHashCode().toString()+t+l.getUniqueCode().toString();if(this.captionSizeCache.contains(n)){let e=this.captionSizeCache.get(n);return s.width=e.width,s.height=e.height,s}let a=bh.Table.Font.getGdiFont(1,null,i),o=0!=l.width?l.width:l.maxWidth,u=Vh.measureString(t,a,o);return u.width=l.getColumnWidth(u.width),u.height=l.getColumnHeight(u.height),s.width=u.width,s.height=u.height,this.captionSizeCache.set(n,u),s}static measureHeaders(t,e){let r=bh.Table.Font.getGdiFont(1,null,e),s=new W(8,bh.Table.getHeight(r));for(let e of t){let t=new W(8,0),i=nm.getLabel(e);if(!H.isNullOrEmpty(i)){let e=Vh.measureString(i,r,1e6);t.width+=e.width}s.width+=t.width}return s.width}}kg.captionSizeCache=new Ro,R.q.StiTableElementGdiPainter=kg}R.C.StiBubbleCellPainter=class{static async draw(s,e,t,i,r,l,n,a,o,u,h,m,c=!0){if(0==a)return;let d=ls.formatBasedOnColumnType(t,l,a),g=(0<o&&(o=0),u<0&&(u=0),l.horAlignment),p=e,S=await eg.getIconCondition(l.key,t,i,r),w=(null!=S&&S.iconAlignment!=G.None&&(await R.C.StiConditionIconPainter.drawIcon(s,S,p,n),p=R.C.StiConditionIconPainter.adjustCellContentRectWithIcon(p,S)),p.inflate(-2,-2),this.calculateTextRect(t,p,l)),f=(p=this.calculateBubbleRect(t,p,l,Math.abs(a),o,u),U.getTableStyle(t)),b=this.getForeColor(t,l,f,h,m);if(c&&g!=X.Center&&s.drawString(d,t.font,b,w,null),0<p.width&&0<p.height){let e=l.as(Zr),t=e.allowCustomColors?e.positiveColor:f.cellDataBarsPositive,i=e.allowCustomColors?e.negativeColor:f.cellDataBarsNegative,r=new $d(a<0?i:t);s.fillEllipse(p,r)}}static getForeColor(e,t,i,r,s){if(!N.transparent.equals(t.foreColor))return t.foreColor;if(!N.transparent.equals(e.foreColor))return e.foreColor;if(r)return i.alternatingCellForeColor;return s?null!=i?i.selectedCellForeColor:bh.Table.Font.Color:null!=i?i.cellForeColor:bh.Table.Font.Color}static calculateBubbleRect(e,t,i,r,s,l){let n=i;if(null==n)return t;let a=bh.Table.getHeight(e.font,e.zoom),o=(a-=2,Math.max(Math.abs(s),Math.abs(l))),u=Math.abs(a*r/o);switch(n.horAlignment){case X.Left:return new Re(t.right-a+(a-u)/2,t.y+(t.height-u)/2,u,u);case X.Center:return new Re(t.x+(t.width-u)/2,t.y+(t.height-u)/2,u,u);case X.Right:return new Re(t.x+(a-u)/2,t.y+(t.height-u)/2,u,u)}return t}static calculateTextRect(t,i,e){let r=e;if(null!=r){let e=bh.Table.getHeight(t.font,t.zoom);switch(r.horAlignment){case X.Left:i=new Re(i.x,i.y,i.width-e,i.height);break;case X.Right:i=new Re(i.x+e,i.y,i.width-e,i.height);break}}return i.inflate(-2,-2),i}static getCellText(e,t,i){return ls.formatBasedOnColumnType(e,t,i)}},R.C.StiColorScaleCellPainter=class{static getScaleColor(t,i,r,e,s,l){let n=(r-i)/2,a=(t=Math.min(t,r),t=Math.max(t,i),0),o,u,h=e.cellBackColor;if(n<t){let e=r-n;u=0!=e?(a=(t-n)/e,o=N.fromArgb3(255,h),N.fromArgb3(255,l)):(o=N.lightGray,N.lightGray)}else{let e=n-i;u=0!=e?(a=t/e,o=N.fromArgb3(255,s),N.fromArgb3(255,h)):(o=N.lightGray,N.lightGray)}let m=(u.a-o.a)*a+o.a,c=(u.r-o.r)*a+o.r,d=(u.g-o.g)*a+o.g,g=(u.b-o.b)*a+o.b;return m=Math.min(m,255),c=Math.min(c,255),d=Math.min(d,255),g=Math.min(g,255),m=Math.max(m,0),c=Math.max(c,0),d=Math.max(d,0),g=Math.max(g,0),N.fromArgb(Math.round(m),Math.round(c),Math.round(d),Math.round(g))}};let lg=P.Report.Export.StiSvgGeomWriter,ng=P.Report.Export.StiSvgHelper,ag=(R.C.StiConditionIconPainter=class{static async drawIcon(c,d,g,p){if(!d||d.iconAlignment===G.None)return;let e=d.customIcon;if(e){let m=lh.getImageFromObject(e);if(m){let e=new Re,t=(d.iconAlignment===G.Left?e=new Re(g.left,g.top,g.height,g.height):d.iconAlignment===G.Right&&(e=new Re(g.right-g.height,g.top,g.height,g.height)),m.width),i=m.height,r=e.width/t,s=e.height/i,l=Math.min(r,s),n=t*l,a=i*l,o=(e.width-n)/2,u=(e.height-a)/2,h=new Re;h.x=e.x+o,h.y=e.y+u,h.width=n,h.height=a,h.inflate(-2*p,-2*p),c.drawImage(m,h)}}else{let e=new Re,t=(d.iconAlignment===G.Left?e=new Re(g.left,g.top,g.height,g.height):d.iconAlignment===G.Right&&(e=new Re(g.right-g.height,g.top,g.height,g.height)),await Wa.convertFontIconToImageAsync(d.icon,d.iconColor,e.width,e.height,"0.9em"));c.drawImage(t,e)}}static adjustCellContentRectWithIcon(e,t){if(t.iconAlignment===G.Left)return new Re(e.left+e.height,e.top,e.width-e.height,e.height);if(t.iconAlignment===G.Right)return new Re(e.left,e.top,e.width-e.height,e.height);return e}static async getImageWithConditionIcon(e,t,i){let r=e.iconAlignment===G.Left?new Re(t.x,t.y,t.height,t.height):new Re(t.right-t.height,t.y,t.height,t.height),s=new Pd(hn.UTF8),l=(s.indentation=-1,s.writeStartElement("svg"),s.writeAttributeString("version","1.1"),s.writeAttributeString("baseProfile","full"),s.writeAttributeString("xmlns","http://www.w3.org/2000/svg"),s.writeAttributeString("xmlns:xlink","http://www.w3.org/1999/xlink"),s.writeAttributeString("xmlns:ev","http://www.w3.org/2001/xml-events"),s.writeAttributeString("height",ng.toUnits(r.height)),s.writeAttributeString("width",ng.toUnits(r.width)),s.writeStartElement("rect"),s.writeAttributeString("x","0"),s.writeAttributeString("y","0"),s.writeAttributeString("width",ng.toUnits(r.width)),s.writeAttributeString("height",ng.toUnits(r.height)),s.writeAttributeString("style",ng.writeFillBrush(s,e.backColor,r)),s.writeEndElement(),new lg(s)),n=(await this.drawIcon(l,e,new Re(0,0,r.width,r.height),1),s.writeFullEndElement(),s.flush(),new Hd(r)),a=(n.name=i+`_ConditionIcon`,s.textWriter.getStringBuilder().toString());return n.image=Xa.stringToImage(P.System.Convert.toBase64String(a)),n}},R.K.StiDataBarsDirection),og=R.K.StiDataBarsBrushType,ug=P.Base.Drawing.StiGradientBrush,hg=(R.C.StiDataBarsCellPainter=class{static async draw(e,t,i,r,s,l,n,a,o,u,h,m,c=!0,d=ag.LeftToRight,g=og.Solid){let p=await eg.getIconCondition(l.key,i,r,s),S=(null!=p&&p.iconAlignment!=G.None&&(await R.C.StiConditionIconPainter.drawIcon(e,p,t,n),t=R.C.StiConditionIconPainter.adjustCellContentRectWithIcon(t,p)),ls.formatBasedOnColumnType(i,l,a));await this.draw2(e,t,a,o,u,n,S,i,r,s,l,h,m,c,d,g)}static async draw2(s,e,l,t,i,r,n,a,o,u,h,m,c,d=!0,g=ag.LeftToRight,p=og.Solid){if(null==l||0==l)return;let S=h,w=(H.isNullOrWhiteSpace(S.minimum)||(t=O.tryToNumber(k.parse2(S.minimum,a.report))),H.isNullOrWhiteSpace(S.maximum)||(i=O.tryToNumber(k.parse2(S.maximum,a.report))),t=Math.min(t,0),!1),f=((i=Math.max(i,0))<l&&(w=!0,l=i),l<t&&(w=!0,l=t),h.horAlignment),b=e,y=(b.inflate(-2,-2),this.calculateTextRect(b,h)),C=(b=this.calculateDataBarsRect(b,h),U.getTableStyle(a)),x=this.getColorPositive(C,S),v=this.getNegativeColor(C,S),F=this.getOverlappedColor(C,S),T=this.getFillColor(C,S),M=this.getForeColor(a,h,C,m,c),A=(d&&s.drawString(n,a.font,M,y,null),f!=X.Center&&s.fillRectangle(b,T),i+Math.abs(t)),D=b.width*Math.abs(t)/A,I=b.width*l/A,R=b.width*Math.abs(l)/A,E=0;if(g==ag.LeftToRight?b.x+=l<0?D-R:D:(E=180,b.x=l<0?b.right-D:b.right-D-R),b.width=R,l<0&&(E+=180),0<b.width&&0<b.height){if(p==og.Gradient){let r;if(r=g==ag.LeftToRight?0<l?new Re(e.left+D,e.top,I,e.height):new Re(e.left,e.top,D,e.height):l<0?new Re(e.left+I,e.top,D,e.height):new Re(e.left,e.top,I,e.height),0<b.width&&b.width<1&&(b.width=1),0<r.width&&r.width<1&&(r.width=1),0<r.width&&0<b.width){let e=l<0?v:x,t=qh.light(e,200),i=(r.x-=.1*r.width,r.width+=.2*r.width,new ug(e,t,E));s.fillRectangle(b,i)}}else{let e=l<0?v:x;e=await eg.processForeColor(e,h.key,a,o,u),s.fillRectangle(b,e)}if(w){let e=0<=l?new Re(b.right-6*r,b.y,6*r,b.height):new Re(b.x,b.y,6*r,b.height);s.fillRectangle(e,F)}f==X.Center&&s.drawString(n,a.font,N.white,y,null)}}static getOverlappedColor(e,t){return t.overlappedColor.equals(N.transparent)?e.cellDataBarsOverlapped:t.overlappedColor}static getColorPositive(e,t){return t.positiveColor.equals(N.transparent)?e.cellDataBarsPositive:t.positiveColor}static getNegativeColor(e,t){return t.negativeColor.equals(N.transparent)?e.cellDataBarsNegative:t.negativeColor}static getFillColor(e,t){return t.fillColor.equals(N.transparent)?N.fromArgb3(40,e.cellDataBarsPositive):t.fillColor}static getForeColor(e,t,i,r,s){if(!N.transparent.equals(t.foreColor))return t.foreColor;if(!N.transparent.equals(e.foreColor))return e.foreColor;if(r)return i.alternatingCellForeColor;return s?null!=i?i.selectedCellForeColor:bh.Table.Font.Color:null!=i?i.cellForeColor:bh.Table.Font.Color}static calculateDataBarsRect(e,t){let i=t;if(null==i)return e;switch(i.horAlignment){case X.Left:return new Re(e.right-e.width/2,e.y,e.width/2,e.height);case X.Right:return new Re(e.x,e.y,e.width/2,e.height)}return e}static calculateTextRect(e,t){let i=t;if(null!=i)switch(i.horAlignment){case X.Left:e=new Re(e.x,e.y,e.width/2,e.height);break;case X.Right:e=new Re(e.right-e.width/2,e.y,e.width/2,e.height);break}return e.inflate(-2,-2),e}},R.C.StiSparklinesCellPainter=class{static draw(e,t,i,r,s){}static castToArray(e){return Pl.isArray(e)?e:null}},R.C.StiTableColumnSizeHelper=class{getUniqueCode(){let e=0;return e=397*(e=397*(e=397*(e=397*e^this.width)^this.minWidth)^this.maxWidth)^this.wordWrap[P.System.StiObject.stimulsoft]().getHashCode(),Math.abs(e)}getColumnWidth(e,t=!1){if(0!=this.width&&!t)return this.width;if(!this.isMeasurable)return e;return e<this.minWidth&&(e=this.minWidth),e=0!=this.maxWidth&&e>this.maxWidth?this.maxWidth:e}getColumnHeight(e){if(!this.isMeasurable)return e;if(this.maxHeight<e)return this.maxHeight;return e}static isWordWrap(e){let t=e.as(cr);if(null==(null==t?void 0:t.size))return!1;return t.size.wordWrap}constructor(e,t){this.width=0,this.minWidth=30,this.maxWidth=300,this.maxHeight=0,this.wordWrap=!1,this.fontUniqueCode=0,this.isMeasurable=!1;let i=(this.column=t).as(cr);if(null==(null==i?void 0:i.size))return;this.isMeasurable=!0,this.fontUniqueCode=e.getHashCode();let r=i.size;this.width=r.width,this.minWidth=r.minWidth,this.maxWidth=r.maxWidth,this.maxHeight=r.wordWrap?Number.MAX_VALUE:Math.round(e.getHeight())+1,this.wordWrap=r.wordWrap}},P.Report.Dashboard.IStiControlElement),mg=R.p.StiLocHelper,cg=R.S.StiComboBoxHelper;{class Mp extends R.z.StiElementExportTool{async render(r,s,l,e){var i,t,n,a;if(0==r.getMeters().length)return;let o=await yn.tryToGetOrCreate(r);if(null==o)return;let u=e.is(wd)&&e.designMode,h=r.as(Pm),m=Mp.getNameMeterIndex(o),c=Mp.getKeyMeterIndex(o),d=u&&null!=h&&!H.isNullOrEmpty(h.initialValue),g=bd.isAllowOpacity(e),p=new Ro;if(1<o.meters.countItems)for(let t of o.rows){let e=null==(i=t[1])?void 0:i[P.System.StiObject.stimulsoft]().toString();H.isNullOrWhiteSpace(e)||p.set(e,t[0])}let S=r,w=r,f="";if(S.selectionMode==pn.One)if(w.userFilters.any())f=w.userFilters[0].value,f=null!=(t=p.get(f))?t:f;else if(S.showAllValue)f=mg.locAll;else{let e=o.rows.firstOrDefault();null!=e&&0<e.length&&null!=e[0]&&(f=e[0].toString())}if(d)if(h.initialValue.includes(";"))f=h.initialValue;else{let e=Mp.getRow(h,o,c);if(null==e)return;let t=-1!=m?e[m]:null,i=-1!=c?e[c]:null;null==t&&null==i||(f=(t||i).toString())}if(this.renderElement(s,r,l,this.format(r.as(hg),f),g),S.selectionMode==pn.Multi&&!d){let t=l;if(w.userFilters.any()){let i=w.userFilters;if(i.all(e=>e.condition==Ot.NotEqualTo)){i=new j;for(let e of o.rows){let t=null==(n=e[1])?void 0:n[P.System.StiObject.stimulsoft]().toString();if(w.userFilters.any(e=>e.value==t))continue;i.add(new y(null,null,Ot.EqualTo,t))}}for(let e of i){if(!(t.x+t.width<=l.x+l.width)){while(1<s.components.count)s.components.removeAt(1);this.renderItem(s,r,l,H.format(b.get("Dashboard","NSelected"),w.userFilters.length));break}(t=this.renderItem(s,r,t,this.format(r.as(hg),null!=(a=p.get(e.value))?a:e.value))).x+=t.width+4}}else if(S.showAllValue)this.renderItem(s,r,l,mg.locAll);else{let e=this.getValuesCount(r,o);this.renderItem(s,r,l,H.format(b.get("Dashboard","NSelected"),e))}}}getValuesCount(e,t){let i=e.as(Pm),r=cg.fetchItems(i,t,i.showBlanks);return null!=r?r.length:0}renderElement(e,t,i,r,s){let l=U.getForeColor(t),n=U.getBackColor(t,null,s),a=new Ho(i);a.name=t.name+`_ComboBox`,a.allowHtmlTags=!0,a.vertAlignment=Ht.Center,a.horAlignment=jt.Left,a.textBrush=new E(l),a.brush=new E(n),a.text=this.format(t.as(hg),r),a.font=U.getFont(t),e.components.add(a)}renderItem(e,t,i,r){let s=U.getControlStyle(t),l=new Ho,n=(l.name=t.name+`_ComboBoxItem`,l.allowHtmlTags=!0,l.vertAlignment=Ht.Center,l.horAlignment=jt.Center,l.textBrush=new E(s.selectedForeColor),l.brush=new E(s.selectedBackColor),l.text=this.format(t.as(hg),r),l.font=U.getFont(t),e.components.add(l),Vh.measureString(r,l.font));return l.clientRectangle=new L(i.x,i.y,n.width+4,i.height)}static getNameMeterIndex(e){if(null==e)return-1;let t=e.meters.firstOrDefault(e=>"StiNameComboBoxMeter"==e[P.System.StiObject.stimulsoft]().getType()[P.System.StiObject.stimulsoft]().getTypeName());return null!=t?e.meters.indexOf(t):-1}static getKeyMeterIndex(e){if(null==e)return-1;let t=e.meters.firstOrDefault(e=>"StiKeyComboBoxMeter"==e[P.System.StiObject.stimulsoft]().getType()[P.System.StiObject.stimulsoft]().getTypeName());return null!=t?e.meters.indexOf(t):-1}static getRow(i,e,r){if(H.isNullOrEmpty(i.initialValue)||-1==r)return e.rows.firstOrDefault();return e.rows.firstOrDefault(e=>{var t;return(null==(t=e[r])?void 0:t.toString())==i.initialValue})}}R.z.StiComboBoxElementExportTool=Mp}let dg=R.Q.StiDatePickerHelper,gg=(R.z.StiDatePickerElementExportTool=class extends R.z.StiElementExportTool{async render(t,i,r,e){let s,l=t;if(null==l.getValueMeter())return;let n=await yn.tryToGetOrCreate(t),a=U.getForeColor(t),o=U.getBackColor(t);this.storedCulture=null;try{let e=null==(s=t.report)?void 0:s.getParsedCulture();H.isNullOrWhiteSpace(e)||(this.storedCulture=sr.currentCulture,sr.currentCulture=new sr(e))}finally{let e=new Ho(r);e.name=t.name+`_Content`,e.allowHtmlTags=!0,e.vertAlignment=Ht.Center,e.textBrush=new E(a),e.brush=new E(o),e.text=this.getDateTimeString(l,n),e.font=U.getFont(l),i.components.add(e),null!=this.storedCulture&&(sr.currentCulture=this.storedCulture)}}getDateTimeString(i,e){let t,r,s=dg.getDefaultValue(i);if(On.isVariableSpecifiedAsExpression(i,null==(t=null==i?void 0:i.valueMeter)?void 0:t.expression)){let e=null==(r=dg.getVariableSpecifiedAsValue(i))?void 0:r.as(Js);if(In.isRangeType(null==e?void 0:e.type)&&i.initialRangeSelectionSource==Fn.Selection){let e={ref:null},t={ref:null};return dg.calculateRangeFromInitial(i.initialRangeSelection,e,t),this.getRangeVariableString(i,new Dn(e.ref,t.ref))}return null!=s&&s[P.System.StiObject.stimulsoft]().is(Dn)?this.getRangeVariableString(i,s):this.format(i,s)}if(i.userFilters.any()){let e=this.format(i,i.userFilters[0].value);return i.selectionMode!=Tn.AutoRange&&i.selectionMode!=Tn.Range||(e+=` - `+this.format(i,i.userFilters[0].value2)),e}return i.selectionMode==Tn.AutoRange?this.getAutoRangeColumnString(i,e):i.selectionMode==Tn.Range?this.getRangeColumnString(i):this.format(i,s)}getRangeVariableString(e,t){let i=null==t?void 0:t[P.System.StiObject.stimulsoft]().as(Dn);return this.format(e,null==i?void 0:i.fromObject)+` - `+this.format(e,null==i?void 0:i.toObject)}getAutoRangeColumnString(i,e){if(null==e)return"";let r=e.rows.select(e=>e[0]).where(e=>null!=e&&e instanceof F);if(r.any()){let e=r.where(e=>e instanceof F).cast().min(),t=r.where(e=>e instanceof F).cast().max();return this.format(i,e)+` - `+this.format(i,t)}return""}getRangeColumnString(e){let t={ref:null},i={ref:null};return dg.calculateRangeFromInitial(e.initialRangeSelection,t,i),this.format(e,t.ref)+` - `+this.format(e,i.ref)}},R.P.StiListBoxHelper),pg=P.Report.Components.StiCheckBox,Sg=P.Report.Components.StiCheckStyle,wg=P.Report.Components.IStiShape;{class Ap extends R.z.StiElementExportTool{async render(e,s,t,i){if(this.renderEmptyDataMessage(e,s,t.clone(),i))return;let l=s.report,n=s.page,a=e.as(Hm),o=s.clone(!0,!1),r=(i.renderSinglePage||(t.height=Number.MAX_VALUE),bd.isAllowOpacity(i)),u=bd.getScaleFactor(s,i),h=(await this.renderItems(o,t.clone(),e,r,u),0),m=s.top;0<o.components.count&&(m+=o.getComponentsList()[P.System.StiObject.stimulsoft]().toList().min(e=>e.top));while(1){let e=o.getComponentsList(),r=0;for(let i of e){let e=i.bottom,t=i.left;i.is(wg)&&(e+=bh.ListBox.ItemHeight/3),null!=a?(a.orientation==qs.Vertical&&e<=s.height||a.orientation==qs.Horizontal&&t<=s.width||0==r)&&(o.components.remove(i),s.components.add(i)):e<=s.height&&(o.components.remove(i),s.components.add(i)),r++}if(i.renderSinglePage||0==o.components.count)break;let t=o.getComponentsList()[P.System.StiObject.stimulsoft]().toList().min(e=>e.top);o.getComponentsList().forEach(e=>e.top=e.top-t+1),l.renderedPages.count<=++h&&l.renderedPages.add(n.clone(!0,!1)),n=l.renderedPages.getByIndex(h),s=s.clone(!0,!1),i.renderSingleElement?(s.top=0,s.left=0):s.top=m,n.components.add(s)}for(let e of s.report.renderedPages.list)e.getComponentsList().forEach(e=>{e.report=l,e.page=n})}static getCheckStyle(e,t){let i=e,r=e.is(Hm)&&e.as(Hm).selectionMode==pn.One&&e.as(Hm).selectionType==uo.RadioButton,s=r?Sg.DotCircle:Sg.CheckRectangle,l=r?Sg.NoneCircle:Sg.NoneRectangle;if(!i.userFilters.any())return r?l:s;if(i.userFilters.any(e=>e.condition==Ot.IsFalse))return l;if(i.userFilters.any(e=>e.condition==Ot.EqualTo&&e.value==(null==t?void 0:t.toString())))return s;return l}async renderItems(r,s,l,n,a){let e=await yn.tryToGetOrCreate(l);if(null==e)return;let t=l,o=gg.fetchItems(t,e,t.showBlanks);if(null!=o){let e=o.select(e=>null==e?"":null==e.label&&null!=e.value&&e.value instanceof F?e.value.toShortDateString():e.toString()),t=o.select(e=>Ap.getCheckStyle(l,e)),i=o.select(e=>!1);this.renderItems2(r,s.clone(),l,e,t,i,n,a)}}renderItems2(s,l,n,a,o,u,h,m){let c=n,d=c.selectionMode==pn.Multi,g=c.selectionMode==pn.One&&n.is(Hm)&&n.as(Hm).selectionType==uo.RadioButton,p=d||g,S=n.is(mo)&&n.orientation==qs.Horizontal,w=n,f=U.getFont(n),b=(f=null!=f?Hn.changeFontSize(f,f.size*m):new B("Arial",8),S?this.getHorizontalItemAutoWidth(c,f,a,l.width,p):l.width),y=S?l.height:bh.ListBox.ItemHeight,C=l.x,x=l.y;if(c.showAllValue){S&&0==b&&(b=this.measureItemWidth(mg.locAll,f,p));let e=new L(C,x,b,y),t=g?Sg.DotCircle:Sg.CheckRectangle;w.userFilters.any()&&(t=g?Sg.NoneCircle:w.userFilters.any(e=>e.condition==Ot.IsFalse)?Sg.NoneRectangle:Sg.DotRectangle),this.renderItem(s,e,n,mg.locAll,t,S?J.Right:J.Bottom,d,g,!1,h,m),S?C+=b+1:x+=y+1}if(null!=a){let r=0;for(let i=0;i<a.count2();i++){S&&0==b&&(b=this.measureItemWidth(a[i],f,p));let e=new L(C+r,x,b-r,y),t=o[i];if(!g||w.userFilters.any()||c.showAllValue||0!=i||(t=Sg.DotCircle),this.renderItem(s,e,n,a[i],t,J.None,d,g,u[i],h,m),u[i]&&(r+=bh.ListBox.CheckBoxWidth),S?C+=b+1:x+=y+1,S&&C>=l.right||!S&&x>=l.bottom)break}}}getHorizontalItemAutoWidth(e,t,i,r,s){let l=0,n=0;if(null!=i)while(l<r&&n<i.length)l+=this.measureItemWidth(i[n],t,s),n++;return e.showAllValue&&(this.measureItemWidth(mg.locAll,t,s),n++),l<r&&0<n?r/n:0}measureItemWidth(e,t,i){let r=bh.Table.Font.getGdiFont(1,null,t),s=Vh.measureString(e,r,1e6),l=s.width;return i&&(l+=bh.ListBox.CheckBoxWidth),l}renderItem(t,i,r,e,s,l,n,a,o,u,h){if(n||a){let e=r.is(mo)&&r.orientation==qs.Horizontal;Ap.renderCheckControl(t,i.clone(),r,s,e?J.None:l,a,u,h),i.x+=bh.ListBox.CheckBoxWidth*h,i.width-=bh.ListBox.CheckBoxWidth*h}let m=U.getForeColor(r),c=U.getBackColor(r,null,u),d=U.getFont(r),g=(d=null!=d?Hn.changeFontSize(d,d.size*h):new B("Arial",8),this.format(r.as(hg),e)),p=new Ho(i),S=(p.name=r.name+`_Item`,p.allowHtmlTags=!0,p.margins=n||a?new Se(1,0,0,0):Se.empty,p.border=l!=J.None?new te(l,N.gray,1,Rr.Solid):new te(J.None,N.transparent,0,Rr.None),p.brush=new E(c),p.horAlignment=jt.Left,p.vertAlignment=Ht.Center,p.text=g,p.textBrush=new E(m),p.wordWrap=!1,p.font=d,r.as(hg));null==S||S.textFormat.is(zt)||(p.excelDataValue=g),t.components.add(p)}static renderCheckControl(e,t,i,r,s,l,n,a){let o=U.getForeColor(i),u=U.getBackColor(i,null,n),h=(t=new L(t.x,t.y,bh.ListBox.CheckBoxWidth*a,t.height),new pg(t));h.name=i.name+`_ItemCheckBox`,h.border=s!=J.None?new te(s,N.gray,1,Rr.Solid):new te(J.None,N.transparent,0,Rr.None),h.contourColor=N.transparent,h.textBrush=new E(o),h.brush=new E(u),h.checkStyleForTrue=r,h.checkStyleForFalse=l?Sg.NoneCircle:Sg.NoneRectangle,h.checkedValue=r!=Sg.NoneRectangle&&r!=Sg.NoneCircle,e.components.add(h)}}R.z.StiListBoxElementExportTool=Ap}let fg=P.Report.Components.StiVerticalLinePrimitive,bg=P.Report.Components.StiFlowchartSortShapeType;{class Dp extends R.z.StiElementExportTool{async render(e,s,l,t){let n=e.as(qm);if(null==n.getValueMeter())return;let a=l.height+2*l.y,o=R.z.StiExportTool.isAllowOpacity(t),u=await wo.getInitialValue(n);if(u[P.System.StiObject.stimulsoft]().getType()==P.Report.DecimalRange){let e=new L(l.x,l.y,l.width/2,l.height),t=1,i=new L(e.right,a/4,t,a/2),r=new L(e.right,l.y,l.width/2,l.height);this.paintItem(s,n,e,u.from,o),this.paintSeparator(s,n,i),this.paintItem(s,n,r,u.to,o)}else if(P.System.Type.isNumericType(P.System.Type.getType(u))){let e=u,t=10,i=new L(l.right-t-3,a/3,t,a/3);this.paintItem(s,n,l,e,o),this.paintNavButtons(s,n,i)}}paintItem(e,t,i,r,s){let l=U.getForeColor(t),n=U.getBackColor(t,null,s),a=new Ho(i);a.name=t.name+`_NumberBox`,a.allowHtmlTags=!0,a.vertAlignment=Ht.Center,a.horAlignment=z.parse(jt,z.getName(X,t.horAlignment)),a.textBrush=new E(l),a.brush=new E(n),a.text=Dp.formatValue(t,r),a.font=U.getFont(t),e.components.add(a)}paintSeparator(e,t,i){let r=new fg(i);r.name=t.name+`_NumberBoxSep`,r.color=Dp.getSeparatorColor(t),e.components.add(r)}paintNavButtons(e,t,i){let r=new qc(i);r.name=t.name+`_NumberBoxButtons`,r.shapeType=new bg,r.borderColor=U.getForeColor(t),e.components.add(r)}static formatValue(e,t){return e.textFormat.format(t)}static getSeparatorColor(e){return U.getSeparatorColor(e)}}R.z.StiNumberBoxElementExportTool=Dp}let yg=R.h.StiOnlineMapHelper,Cg=P.Report.Maps.StiMapMode,xg=(R.z.StiOnlineMapElementExportTool=class extends R.z.StiElementExportTool{async render(e,t,i,r){var s,l,n;if(this.renderEmptyDataMessage(e,t,i.clone(),r))return;let a=await yn.tryToGetOrCreate(e),o=yg.calculateMapData(a,e),u=e,h=new ru;h.stretch=!0,h.page=u.page,h.dataTable=a,t.report.dictionary=u.report.dictionary,h.latitude=null==(s=u.latitude)?void 0:s.expression,h.longitude=null==(l=u.longitude)?void 0:l.expression,h.mapMode=Cg.Online,h.provider=u.provider,h.pushPins=JSON.stringify(null==(n=o.pushpins)?void 0:n.map(e=>`pp=${e.lat},${e.lon};60`)),h.brush=new E(U.getBackColor(e,null,r.is(wd)||r.is(pd))),h.left=i.left,h.top=i.top,h.width=i.width,h.height=i.height,t.components.add(h)}},R.z.StiPanelElementExportTool=class extends R.z.StiElementExportTool{async render(e,t,i,r){let s=U.getBackColor(e),l=new ee(i);l.name=e.name+`_Content`,l.brush=new E(s),t.components.add(l)}},P.Report.Components.StiDockStyle),vg=P.Report.Engine.StiCrossTabBuilder,Fg=P.Report.CrossTab.StiCrossTabParams,Tg=R.h.StiPivotTableHelper;{class Ip extends R.z.StiElementExportTool{async render(s,l,n,a){if(this.renderEmptyDataMessage(s,l,n.clone(),a))return;let o=l.report,t=s.as(Au),u=l.page,i=a.is(wd)&&a.designMode,e=Jd.isDataExport(a),h=bd.getScaleFactor(l,a),m=null,r=1!=Jo.factor||1!=h,c=null==(m=r?m:mm.get(t));if(c||r){let e=await yn.tryToGetOrCreate(t);null==e&&(e=new Ct),m=await Tg.convertToCrossTab(t,e,h),r||(mm.put(t,m),hm.putFalse(t))}Tg.applyStyle(t,m,e),i&&(Ip.renderForWebDesigner(m,t),mm.remove(t)),Ip.convertSizes(t,m,!r);let d=m.crossTabInfo.cross,g=d.widths[P.System.StiObject.stimulsoft]().toList().sum(),p=d.heights[P.System.StiObject.stimulsoft]().toList().sum();if(g<=n.width&&p<=n.height||i||a.renderSinglePage){Kd.render(s,l,a),Yd.render(s,l);let e=await Zd.render(s,l,a);e=Qd.excludePadding(s,e,h),e=Qd.excludeCornerRadius(s,e,h),Ip.renderCells(l,e,e,null,m,i)}else if(a.is(kd)){!a.renderSingleElement&&0!=o.renderedPages.getByIndex(0).components.count||o.renderedPages.removeAt(0),u=new Te;let e=new ut,t=(e.name=s.name,e.clientRectangle=new L(0,0,g,p),u.components.add(e),o.renderedPages.add(u),Kd.render(s,e,a),Yd.render(s,e),await Zd.render(s,e,a)),i=(o.renderedPages.remove(u),2*g-t.width+t.left+1),r=2*p-t.height+t.top+1;(u=new Te).width=i,u.height=r,(e=new ut).name=s.name,e.clientRectangle=new L(0,0,i,r),u.components.add(e),o.renderedPages.add(u),Kd.render(s,e,a),Yd.render(s,e),t=await Zd.render(s,e,a),u.unlimitedHeight=!0,Ip.renderCells(e,t,t,null,m,!1)}else{let r=u.clone(!0,!1),e=(o.renderedPages.add(r),l.clone(!0,!1)),t=(e.left=0,e.top=0,e.width=r.width,e.height=r.height,n=new L(0,0,r.width,r.height),r.components.add(e),l=e,!a.renderSingleElement&&0!=o.renderedPages.getByIndex(0).components.count||o.renderedPages.removeAt(0),Kd.render(s,l,a),Yd.render(s,l),await Zd.render(s,l,a)),i=(t=Qd.excludePadding(s,t,h),t=Qd.excludeCornerRadius(s,t,h),new L(t.left,t.top,t.width+g,t.height+p));u.unlimitedHeight=!0,Ip.renderCells(l,i,t,null,m,!1);for(let i=0;i<r.segmentPerWidth;i++)for(let t=0;t<r.segmentPerHeight;t++)if(0!=i||0!=t){let e=l.clone(!0,!1);e.left=i*u.width,e.top=t*u.height,e.width=u.width,e.height=u.height,r.components.insert(0,e),Kd.render(s,e,a),Yd.render(s,e),await Zd.render(s,e,a)}}for(let e of l.report.renderedPages.list)e.getComponentsList().forEach(e=>{e.report=o,e.page=u})}static renderForWebDesigner(e,t){let i=t.columns.where(e=>tm.getVisible(e,t.report)).toList(),r=t.rows.where(e=>tm.getVisible(e,t.report)).toList(),s=t.summaries.where(e=>tm.getVisible(e,t.report)).toList();if(!(1<i.length||1<r.length))return;let l=e.crossTabInfo.cross.cells,n=0,a=new j,o=new j,u=null,h=null,m=t.summaryDirection==Oo.LeftToRight?s.length:1,c=t.summaryDirection==Oo.UpToDown?s.length:1,d=Tg.getHeadersBounds(l);for(let i=0;i<l.length;i++){let t=l[i][0];for(t.cellType==im.LeftTopLineMain&&((u=new Rp).cell=t,u.x=i,u.width=t.width),t.cellType==im.RightTopLineMain&&((h=new Rp).cell=t,h.x=i),n=0;n<l[i].length;n++)if((t=l[i][n]).cellType==im.CornerColMain||t.cellType==im.CornerRowMain){let e=new Rp;e.cell=t,e.x=i,e.y=n,e.width=t.width,e.height=t.height,a.add(e)}}if(-1<d.top){let s=-1;for(let r=0;r<l.length;r++){let i=l[r][d.top];if(i.cellType==im.HeaderColMain||i.cellType==im.HeaderColTotalMain){s=-1==s?r:s;let e=d.bottom-d.top+(1<m?0:1),t=new Rp;if(t.cell=i,t.x=s,t.y=d.top,t.height=e,t.width=m,a.add(t),i.text=(1<e&&i.cellType!=im.HeaderColTotalMain?"> ":"")+i.text,o.add(r+i.width-1),1<m)for(let t=r+i.width-m;t<r+i.width;t++){let e=new Rp;e.cell=l[t][d.bottom],e.x=s,e.y=d.bottom,a.add(e),o.add(t),s++}else s++}}}if(-1<d.left){let r=-1;for(n=0;n<l[0].length;n++){let i=l[0][n];if(i.cellType==im.HeaderRowMain||i.cellType==im.HeaderRowTotalMain){r=-1==r?n:r;let e=d.right+(1<c?0:1),t=new Rp;if(t.cell=i,t.x=0,t.y=r,t.height=c,t.width=e,t.cellRow=1==c?n+i.height-1:-1,a.add(t),i.text=(1<e&&i.cellType!=im.HeaderRowTotalMain?"> ":"")+i.text,1<c)for(let t=n+i.height-c;t<n+i.height;t++){let e=new Rp;e.cell=l[d.right][t],e.x=d.right,e.y=r,e.cellRow=t,a.add(e),r++}else r++}}}null!=u&&(u.width=d.right-d.left+1,a.add(u)),null!=h&&(h.width=a.max(e=>e.x)-d.right,a.add(h));let g=U.getPivotTableStyle(t),p=a.max(e=>e.y)+1,S=a.max(e=>e.x)+1,w=Pl.create2(bm,S,p);for(let r of a)if(w[r.x][r.y]=r.cell,r.cell.width=r.width,r.cell.height=r.height,0<=r.cellRow)for(n=r.y;n<r.y+r.height;n++){let i=d.right+1;for(let e=r.width;e<l.length;e++)if(0<=o.indexOf(e)){w[i++][n]=l[e][r.cellRow+n-r.y],w[i-1][n].field.border.side=e==l.length-1?J.None:J.Right;let t=w[i-1][n];if(null!=t&&null!=t.field&&t.field.brush.is(E)){let e=t.field.brush.color;(e.equals(g.alternatingCellBackColor)||e.equals(g.cellBackColor))&&(t.field.brush=new E(n%2!=0?g.alternatingCellBackColor:g.cellBackColor),t.field.textBrush=new E(n%2!=0?g.alternatingCellForeColor:g.cellForeColor))}null!=t&&null!=t.field&&(t.field.brush=null!=t.field.conditionBrush?t.field.conditionBrush:t.field.brush,t.field.textBrush=null!=t.field.conditionTextBrush?t.field.conditionTextBrush:t.field.textBrush)}}l=Pl.create2(bm,S,0);for(let t=0;t<S;t++){l[t]=Pl.create(bm,p);for(let e=0;e<p;e++)l[t][e]=null!=w[t][e]?w[t][e]:new bm,null!=l[t][e].field&&t==S-1&&(l[t][e].field.border.side|=J.Top),0<e&&(l[t][e].parentCell=l[t][e])}let f=Pl.create(Number,p),b=Pl.create(Number,S);Pl.copy(e.crossTabInfo.cross.heights,0,f,p),Pl.copy(e.crossTabInfo.cross.widths,0,b,S),e.crossTabInfo.cross.cells=l,e.crossTabInfo.cross.widths=b,e.crossTabInfo.cross.heights=f,e.crossTabInfo.cross.doAutoSize()}static renderCells(e,t,i,r,s,l){s.page.unlimitedHeight=!0,e.canBreak=!0,e.dockStyle=xg.None;let n=new Fg,a=(n.startColumn=0,n.startRow=0,n.destinationContainer=e,n.destinationRectangle=i,n.forceNoBreak=l,new vg);a.renderCrossTabUnlimitedBreakable(n,s,e,t.clone())}static convertSizes(e,t,i){let r=t.crossTabInfo.cross,s=e.report.unit;hm.isConverted(e)&&i||(this.convert(r.heights,s),this.convert(r.widths,s),this.convert(r.coordX,s),this.convert(r.coordY,s),i&&hm.putTrue(e))}static convert(t,i){for(let e=0;e<t.length;e++)t[e]=i.convertToHInches(t[e])}}R.z.StiPivotTableElementExportTool=Ip;class Rp{constructor(){this.x=0,this.y=0,this.width=1,this.height=1,this.cellRow=-1}}}R.z.StiRegionMapElementExportTool=class extends R.z.StiElementExportTool{async render(e,t,i,r){if(this.renderEmptyDataMessage(e,t,i.clone(),r))return;let s=e,l=U.getElementFontFromStyle(e,s.font),n=new ru;if(n.stretch=!0,n.page=s.page,n.mapType=s.mapType,n.dataFrom=s.dataFrom,n.language=s.language,n.mapStyle=U.getMapStyleIdent(s),n.componentStyle=s.customStyleName,n.mapIdent=s.mapIdent,n.mapMode=Cg.Choropleth,n.showValue=s.showValue,n.shortValue=s.shortValue,n.showZeros=s.showZeros,n.showBubble=s.showBubble,n.colorEach=s.colorEach,n.show3D=s.show3D,n.displayNameType=s.showName,n.colorDataColumn=null==s.colorMeter?"":s.colorMeter.expression,n.groupDataColumn=null==s.groupMeter?"":s.groupMeter.expression,n.valueDataColumn=null==s.valueMeter?"":s.valueMeter.expression,n.nameDataColumn=null==s.nameMeter?"":s.nameMeter.expression,n.keyDataColumn=null==s.keyMeter?"":s.keyMeter.expression,n.mapData=s.mapData,n.labels=new eu(l,s.labels.foreColor,s.labels.shadowColor,s.labels.showShadow),n.brush=new E(U.getBackColor(e,null,r.is(wd)||r.is(pd))),n.left=i.left,n.top=i.top,n.width=i.width,n.height=i.height,n.valueFormat=s.valueFormat,s.dataFrom==nu.DataColumns){let e=await yn.tryToGetOrCreate(s);n.dataTable=e,t.report.dictionary=s.report.dictionary}t.components.add(n)}},R.z.StiShapeElementExportTool=class extends R.z.StiElementExportTool{async render(e,t,i,r){let s=e.as(Bm),l=new qc;l.shapeType=s.shapeType,l.size=s.size,l.borderColor=s.stroke,l.brush=s.fill,l.page=s.page,l.left=i.left,l.top=i.top,l.width=i.width,l.height=i.height,t.components.add(l)}};let Mg=P.Report.Dashboard.Helpers.StiTableElementPagingHelper,Ag=P.Report.Dashboard.StiTableColumnVisibilityHelper,Dg=R.C.StiBubbleCellPainter,Ig=R.C.StiSparklinesCellPainter,Rg=P.Report.Components.StiSparkline,Eg=P.Data.Functions.StiSystemVariableObject,kg=R.q.StiTableElementGdiPainter,Og=R.h.StiTableElementHelper,Vg=R.C.StiDataBarsCellPainter,Ng=R.C.StiColorScaleCellPainter,Lg=P.Report.Components.StiTextQuality,Bg=R.C.StiConditionIconPainter;{class Ep extends R.z.StiElementExportTool{async render(e,i,t,r){if(this.renderEmptyDataMessage(e,i,t.clone(),r))return;let s=i.report,l=i.page,n=r.is(wd)&&r.as(wd).designMode,a=e.as(Gm),o=null==r?R.f.StiDashboardExportFormat.Document:r.format,u=r.renderSingleElement&&o==R.f.StiDashboardExportFormat.Excel,h=Jd.isDataExport(r),m=(delete a.cacheStyle,i.clone(!0,!1)),c=bd.getScaleFactor(i,r),d=(r.renderSinglePage||(t.height=Number.MAX_VALUE),await Ep.renderCells(m,t,a,c,o,h,n),u&&(t.width=m.components.toList().max(e=>e.right),t.height=m.components.toList().max(e=>e.bottom),i.width=i.page.width=t.width,i.height=i.page.height=t.height),0),g=i.top;0<m.components.count&&(g+=m.getComponentsList()[P.System.StiObject.stimulsoft]().toList().min(e=>e.top));while(1){if(m.getComponentsList()[P.System.StiObject.stimulsoft]().toList().where(e=>e.bottom<=i.height).toList().forEach(e=>{m.components.remove(e),(e.left<i.width||o==R.f.StiDashboardExportFormat.Data)&&(i.components.add(e),e.right>i.width)&&o!=R.f.StiDashboardExportFormat.Data&&(e.width=Math.max(0,i.width-e.left))}),r.renderSinglePage||0==m.components.count)break;let t=m.getComponentsList()[P.System.StiObject.stimulsoft]().toList().min(e=>e.top);m.getComponentsList()[P.System.StiObject.stimulsoft]().toList().forEach(e=>e.top=e.top-t+1),s.renderedPages.count<=++d&&s.renderedPages.add(l.clone(!0,!1)),l=s.renderedPages.getByIndex(d),i=i.clone(!0,!1),r.renderSingleElement?(i.top=0,i.left=0):i.top=g,l.components.add(i)}for(let e of i.report.renderedPages.list)e.getComponentsList()[P.System.StiObject.stimulsoft]().toList().forEach(e=>{e.report=s,e.page=l})}static async renderCellsForViewer(e,i,c){let d,g=e.as(Gm);if(null==g)return null;let p=await yn.getOrCreate(g);if(null==p)return null;p=this.processDataTableWithTopN(p);let S=1,w=[],f=bh.Table.getHeight(g.getDataFont(),S),b=p.meters.where(e=>e.is(Ts)).cast(),t=null!=b.firstOrDefault(e=>e.showTotalSummary),y=(delete g.cacheStyle,0),C=0<g.rowsPerPage,x=0,v=p.rows.length-1;if(C){let e=null!=i&&null!=i[g.key]?i[g.key]:1,t=Math.ceil(p.rows.length/g.rowsPerPage);e>t&&(e=t),x=(e-1)*g.rowsPerPage,v=Math.min(e*g.rowsPerPage-1,p.rows.length-1)}for(let m of b){m.cache={};let e=await this.getColumnVisibilityState(m,g.report);if(!e){y++;continue}let n=Ep.measureHeader(g,m,S);if(m.is(rs))n=Ep.measureSparklinesCell(S,n);else{for(let r=x;r<=v;r++){let e=p.rows[r],t=e[y],i;i=m.is2(es)?Ep.measureIndicatorCell(g,m,S,t):m.is2(is)?Ep.measureDataBarsCell(g,m,S,t):Ep.measureCommonCell(g,m,S,t,n).width,n=Math.max(n,i)}if(m.showTotalSummary){let e=Og.calculateTotal(m,y,p),t=this.measureFooter(g,m,S,e);n=Math.max(n,t)}}let a=Og.minDataColumnValue(m,p,y),o=Og.maxDataColumnValue(m,p,y),u=C&&c?x:0,h=C&&c?v:p.rows.length-1;for(let l=u;l<=h;l++){if(w.length<=h-u&&w.push([]),C&&!c&&(l<x||l>v))continue;let r=p.rows[l],t=this.processRowValue(l,r[y],m),e=new L(0,0,n,f),i=new ut,s=(await Ep.renderCell(i,e,g,r,b.select(e=>e.key),m,S,t,a,o,1==(1&l),R.f.StiDashboardExportFormat.Html,!1),{});if(0<g.tableConditions.length&&0<i.components.length){let e=i.components.getByIndex(0);e.is(Ho)||(e.is(ti)&&(s["backColor"]=Uu.toHtml(ge.toColor(e.as(ti).brush))),e.is(Kt)&&(s["textColor"]=Uu.toHtml(ge.toColor(e.as(Kt).textBrush))))}if("boolean"==typeof t)s["boolValue"]=t;else for(let e of i.components.list)if(e.is(Ho)){if(s["text"]=e.text,s["textColor"]=Uu.toHtml(ge.toColor(e.textBrush)),s["backColor"]=Uu.toHtml(ge.toColor(e.brush)),s["textWidth"]=e.width,s["textHeight"]=e.height,0<g.tableConditions.length){let e=null==(d=g.as(ri))?void 0:d.font,t=0<g.tableConditions.length?await eg.processFontStyle(e,m.key,g,r,b.select(e=>e.key)):cl.Regular,i=(e=new B(e.fontFamily.name,e.size,t),{});i["bold"]=e.bold,i["italic"]=e.italic,i["underline"]=e.underline,i["strikeout"]=e.strikeout,s["textFontStyle"]=i}null!=t&&t.toString()!=s["text"]&&(s["value"]=t.toString())}else e.is(Hd)?(s["image"]=null!=e.imageToDraw?P.Base.Drawing.StiImageConverter.imageToString(e.imageToDraw):null,s["imageWidth"]=e.width,s["imageHeight"]=e.height,0<g.tableConditions.length&&(s["iconAlignment"]=z.getName(G,g.tableConditions.firstOrDefault().iconAlignment).toLowerCase())):e.is(Rg)&&(s["sparkline"]=P.Report.Export.StiHtmlExportService.getSparklineData(null,e,e.width,e.height),s["sparklineWidth"]=e.width,s["sparklineHeight"]=e.height);null==s["boolValue"]&&null==s["text"]&&null==s["image"]&&(s["text"]=t),w[c?l-u:l].push(s)}if(t){w.length<p.rows.length+1&&w.push([]);let t={};if(t["text"]="",m.showTotalSummary){let e=Og.calculateTotal(m,y,p);t["text"]=m.summaryType==Qi.Count?le.trunc(e).toString():ls.formatBasedOnColumnType(g,m,e)}w[w.length-1].push(t)}y++}return w}static async renderCells(u,h,m,c,d,g,r){let p=await yn.tryToGetOrCreate(m);if(null==p)return;p=this.processDataTableWithTopN(p);let t=bh.Table.getHeight(m.getColumnFont(),c),e=bh.Table.getHeight(m.getDataFont(),c),S=p.meters.where(e=>e.is(Ts)).cast(),i=null!=S.firstOrDefault(e=>e.showTotalSummary),s=r?0:m.currentPageIndex,l=0!=m.rowsPerPage&&-1!=s&&d!=R.f.StiDashboardExportFormat.Excel,n=1,w=(l&&(n=Mg.getNumberOfPages(p.rows.length,m.rowsPerPage))<=1&&(l=!1),p.rows);if(l){let e=w.skip(m.rowsPerPage*s).take(m.rowsPerPage);e.any()?w=e:l=!1}let f=i?bh.Table.getHeight(m.getTotalFont(),c):0,a=l?bh.Table.getHeight(m.getTotalFont(),c):0,b=f+a,y=new j,C=[],x=0;for(let r of S){r.cache={};let i=0,e=await this.getColumnVisibilityState(r,m.report);if(e&&(i=this.measureHeader(m,r,c),r.showTotalSummary)){let e=Og.calculateTotal(r,x,p),t=this.measureFooter(m,r,c,e);i=Math.max(i,t)}y.push(i),x++}let v=h.y+t;if(v<h.bottom-b){for(let n of w){let l=e;x=-1;for(let s of S){x++;let e=await Ag.getVisible(s,m.report);if(!e)continue;let r=y[x];if(s.is(rs))r=this.measureSparklinesCell(c,r);else{let t=n[x],i;if(s.is2(es))i=this.measureIndicatorCell(m,s,c,t);else if(s.is2(is))i=this.measureDataBarsCell(m,s,c,t);else if(s.is2(Zr))i=Ep.measureBubbleCell(m,s,c,t);else{let e=this.measureCommonCell(m,s,c,t,r);i=e.width,l=Math.max(e.height,l)}r=Math.max(r,i)}y[x]=r}if(v+l>h.bottom-b&&(l=h.bottom-b-v)<1.2&&(l=1.2),C.push(l),(v+=l)>=h.bottom-b)break}C.push(e)}if(m.sizeMode==yu.Fit){let t=h.width/y.sum(),e=((1<t||!r)&&(y=y.select(e=>e*t).toList()),-1);for(let l of w){if(++e>=C.length)break;x=-1;let s=C[e];for(let r of S){if(x++,r.is2(es)||r.is2(is))continue;if(r.is(cr)){let e=r,t=e.size.width,i=(e.size.width=y[x]-4,this.measureCommonCell(m,r,c,l[x],e.size.width));s=Math.max(i.height,s),e.size.width=t}}C[e]=s}}let F=h.x;x=0;for(let o of S){let e=await this.getColumnVisibilityState(o,m.report);if(!e){x++;continue}let a=y[x];if(d==R.f.StiDashboardExportFormat.Excel&&(a*=1.1),v=h.y,d!=R.f.StiDashboardExportFormat.Data){let e=new L(F,v,a,t);this.renderHeader(u,e,m,o,c,d,g),v+=e.height}if(v<=h.bottom-b){let s=Og.minDataColumnValue(o,p,x),l=Og.maxDataColumnValue(o,p,x),n=0;for(let r of w){let e=Math.ceil(C[n]),t=this.processRowValue(n,r[x],o),i=new L(F,v,a,e);if(await this.renderCell(u,i,m,r,S.select(e=>e.key),o,c,t,s,l,1==(1&n),d,g),v+=e,n++,v>=h.bottom-b)break}}if(d!=R.f.StiDashboardExportFormat.Data&&!g&&i){let e=new L(F,r?h.bottom-b:v,a,f);this.renderFooter(u,e,m,o,x,c,p)}F+=a,x++}if(d!=R.f.StiDashboardExportFormat.Data&&!g&&l){let e=H.format(T.get("Report","PageNofM"),s+1,n),t=F-h.x,i=new L(h.x,(r?h.bottom-b:v)+f,t,a);this.renderCurrentPageNumber(u,i,m,c,e)}}static processDataTableWithTopN(e){let t=e.meters.where(e=>e.is(Ts)).cast().toList(),r=e.rows,s=0;for(let i of t){let e=i.topN,t=this.processTopNElements(r,e,s);r=t.select(e=>e).toList(),s++}let i=new Ct;return i.meters.addRange(t),i.rows.addRange(r),i}static processTopNElements(e,t,i){if(t.mode==Xo.None)return e;let r=new j;for(let t of e){let e=O.tryToNumber(t[i]);r.add({key:e,value:t})}t.mode==Xo.Bottom?r.sort((e,t)=>e.key[P.System.StiObject.stimulsoft]().compareTo(t.key)):r.sort((e,t)=>t.key[P.System.StiObject.stimulsoft]().compareTo(e.key));let s=r.take(t.count).select(e=>e.value).toList();return s}static measureSparklinesCell(e,t){return Math.max(t,80*e)}static measureHeader(e,t,i){return kg.measureHeader(e,t).width*i}static measureFooter(e,t,i,r){let s=ls.formatBasedOnColumnType(e,t,r);return kg.measureCell(s,e.getTotalFont(),t).width*i}static measureIndicatorCell(e,t,i,r){let s=t.as(es),l=rg.getCellText(e,s,O.tryToNullableNumber(r)),n=kg.measureCell(l,e.getDataFont(),t).width*i;return n*=1.25}static measureDataBarsCell(e,t,i,r){let s=ls.formatBasedOnColumnType(e,t,r),l=kg.measureCell(s,e.getDataFont(),t).width*i;return t.horAlignment!=X.Center&&(l*=2),l=t.is(is)&&0<t.width?i*t.width:l}static measureBubbleCell(e,t,i,r){let s=ls.formatBasedOnColumnType(e,t,r),l=kg.measureCell(s,e.getDataFont(),t).width*i,n=bh.Table.getHeight(e.getDataFont(),i);if(t.horAlignment==X.Center)return n;return l+=n}static measureCommonCell(e,t,i,r,s){if(lh.isImage(r))return new W(s,0);let l=ls.formatBasedOnColumnType(e,t,r),n=kg.measureCell(l,e.getDataFont(),t);return n.width*=i,n.height*=i,n}static renderHeader(e,t,i,r,s,l,n){let a=null!=r?nm.getLabel(r):"",o=H.isNullOrWhiteSpace(a)?i.name+`_Column`:kr.correctName(a),u=U.getTableStyle(i),h=0!=i.columns.indexOf(r)&&t.left<e.width&&!n,m=i.columns.indexOf(r)!=i.columns.length-1&&t.right<=e.width&&!n,c=(h?J.Left:J.None)|(m?J.Right:J.None),d=n?N.black:this.getHeaderForeColor(i),g=n?N.transparent:this.getHeaderBackColor(i),p=n?new B("Arial",10,cl.Bold):i.getColumnFont(),S=new Ho(t);S.name=o,S.allowHtmlTags=!0,S.autoWidth=!1,S.horAlignment=this.getHeaderAlignment(r),S.vertAlignment=Ht.Center,S.wordWrap=!1,S.border=new te(c,u.lineColor,1,Rr.Solid),S.brush=new E(g),S.font=bh.Table.Font.getGdiFont(s,null,p),S.text=a,S.textFormat=null!=r.textFormat?r.textFormat.clone():null,S.textBrush=new E(d),S.componentPlacement=`h.`+i.name,e.components.add(S)}static getHeaderAlignment(e){if(e.headerAlignment==X.Left)return jt.Left;if(e.headerAlignment==X.Right)return jt.Right;return jt.Center}static renderFooter(e,t,i,r,s,l,n){let a=this.getFooterForeColor(i),o=this.getFooterBackColor(i),u=i.getTotalFont(),h="",m=0,c=(r.showTotalSummary&&(m=Og.calculateTotal(r,s,n),h=r.summaryType==Qi.Count?le.trunc(m).toString():ls.formatBasedOnColumnType(i,r,m)),jt.Right),d=(r.summaryAlignment==X.Left?c=jt.Left:r.summaryAlignment==X.Center&&(c=jt.Center),new Ho(t)),g=(d.name=i.name+`_FooterCell`,null!=r.textFormat&&r.textFormat.is(zt)?null:h);null!=r.textFormat&&(r.textFormat.is(Ui)||r.textFormat.is(Wi)||r.textFormat.is(Zi))&&(g=m.toString()),d.border=this.getBorderSides(e,t,i,r,J.All),d.brush=new E(o),d.excelDataValue=g,d.font=bh.Table.Font.getGdiFont(l,null,u),d.horAlignment=c,d.vertAlignment=Ht.Center,d.text=h,d.textBrush=new E(a),d.textFormat=null!=r.textFormat?r.textFormat.clone():null,d.wordWrap=!1,d.componentPlacement=`f.`+i.name,e.components.add(d)}static renderCurrentPageNumber(e,t,i,r,s){let l=this.getFooterForeColor(i),n=this.getFooterBackColor(i),a=i.getTotalFont(),o=new Ho(t);o.name=i.name+`_CurrentPage`,o.brush=new E(n),o.font=bh.Table.Font.getGdiFont(r,null,a),o.horAlignment=jt.Center,o.vertAlignment=Ht.Center,o.margins=new Se(0,0,1,0),o.textQuality=Lg.Typographic,o.text=s,o.textBrush=new E(l),o.wordWrap=!1,o.componentPlacement=`f.`+i.name,e.components.add(o)}static async renderCell(e,t,i,r,s,l,n,a,o,u,h,m,c){let d=U.getTableStyle(i),g=this.getForeColor(i,l,d,h),p=kg.getBackgroundColor(i,i.cells,d,null!=h&&h);p=0<i.tableConditions.length?await eg.processBackColor(p,l.key,i,r,s):p,c?await this.renderTextCell(e,t,i,r,s,l,n,a,J.None,N.black,N.transparent,m,!0):l.is2(is)||l.is2(rs)||l.is2(es)||l.is2(Zr)?await this.renderGraphicCell(e,t,i,r,s,l,n,a,o,u,p,d,null!=h&&h,m):l.is2(ts)?await this.drawColorScaleColumn(e,t,i,r,s,l,n,a,o,u,d,m):lh.isImage(a)?this.renderImageCell(e,t,i,l,a,p,m):"boolean"==typeof a?await this.renderBoolCell2(e,t,i,r,s,l,n,a,g,p,m):await this.renderTextCell(e,t,i,r,s,l,n,a,J.All,g,p,m,!1,null,!0,!0)}static processRowValue(e,t,i){let r,s=i.textFormat,l=(null!=t&&t[P.System.StiObject.stimulsoft]().is(Eg)&&(t=t==Eg.Line&&null!=s?s.format(e+1):ss.getSystemVariable(null==t?void 0:t[P.System.StiObject.stimulsoft]().as(Eg),e+1)),i.ident==ph.SparklinesColumn);return t=gh.isList(t)&&!lh.isImage(t)?l?gh.toList(t):null==(r=gh.toList(t))?void 0:r.firstOrDefault():t}static async renderGraphicCell(n,a,o,u,h,m,t,c,i,r,d,g,s,l){let p="",S=a,w=this.getForeColor(o,m,g,s),f=new Pd(hn.UTF8);if(f.indentation=-1,f.writeStartElement("svg"),f.writeAttributeString("version","1.1"),f.writeAttributeString("baseProfile","full"),f.writeAttributeString("xmlns","http://www.w3.org/2000/svg"),f.writeAttributeString("xmlns:xlink","http://www.w3.org/1999/xlink"),f.writeAttributeString("xmlns:ev","http://www.w3.org/2001/xml-events"),f.writeAttributeString("height",ng.toUnits(a.height)),f.writeAttributeString("width",ng.toUnits(a.width)),f.writeStartElement("rect"),f.writeAttributeString("x","0"),f.writeAttributeString("y","0"),f.writeAttributeString("width",ng.toUnits(a.width)),f.writeAttributeString("height",ng.toUnits(a.height)),f.writeAttributeString("style",ng.writeFillBrush(f,d,a)),f.writeEndElement(),m.is2(rs)){let e=Ig.castToArray(c),t=null==e?void 0:e.map(e=>null==e?void 0:e[P.System.StiObject.stimulsoft]().toNumber()),i=m.as(rs),r=a,s=await eg.getIconCondition(m.key,o,u,h),l=(null!=s&&s.iconAlignment!=G.None&&(s.iconAlignment==G.Right?r=new L(a.x,a.y,a.width-a.height,a.height):s.iconAlignment==G.Left&&(r=new L(a.x+a.height,a.y,a.width-a.height,a.height))),new Rg(r));if(l.values=t,l.positiveColor=i.allowCustomColors?i.positiveColor:g.cellSparkline,l.negativeColor=i.allowCustomColors?i.negativeColor:g.cellWinLossNegative,l.showFirstLastPoints=i.showFirstLastPoints,l.showHighLowPoints=i.showHighLowPoints,l.type=i.type,l.brush=new E(d),l.componentPlacement=`d.`+o.name,n.components.add(l),null!=s&&s.iconAlignment!=G.None){let e=await Bg.getImageWithConditionIcon(s,a,o.name);n.components.add(e)}return}let b=new lg(f),y=J.None,C="GraphicCell",x=new L(0,0,a.width,a.height),v=m.horAlignment;if(m.is2(is)){await Vg.draw(b,x,o,u,h,m,t,O.tryToNumber(c),i,r,s,!1,!1),l!=R.f.StiDashboardExportFormat.Data&&(S=Vg.calculateTextRect(a.clone(),m)).inflate(2,2),p=ls.formatBasedOnColumnType(o,m,c),w=Vg.getForeColor(o,m,g,s,!1);let e=O.tryToNumber(c);e<0&&jh.isNegativeInRed(m.textFormat)&&(w=P.StiOptions.Engine.negativeColor),w=0<o.tableConditions.length?await eg.processForeColor(w,m.key,o,u,h):w,y=J.Right,C="DataBarsCell"}else if(m.is2(es))await rg.draw(b,x,o,u,h,m,t,O.tryToNullableNumber(c),g,!1),S=rg.calculateTextRect(a.clone(),m),p=rg.getCellText(o,m,O.tryToNullableNumber(c)),w=rg.getColor(m,O.tryToNullableNumber(c),g),w=0<o.tableConditions.length?await eg.processForeColor(w,m.key,o,u,h):w,y=J.None,C="IndicatorCell";else if(m.is2(Zr)){await Dg.draw(b,x,o,u,h,m,t,O.tryToNullableNumber(c),i,r,s,!1,!1),l!=R.f.StiDashboardExportFormat.Data&&(S=Dg.calculateTextRect(o,a.clone(),m)).inflate(2,2),p=Dg.getCellText(o,m,O.tryToNullableNumber(c)),w=Vg.getForeColor(o,m,g,s,!1),w=0<o.tableConditions.length?await eg.processForeColor(w,m.key,o,u,h):w,y=J.None,C="BubbleCell";let e=m[P.System.StiObject.stimulsoft]().as(Ii);null!=e&&(e.horAlignment==X.Center&&l!=R.f.StiDashboardExportFormat.Data&&(p=null),e.horAlignment==X.Left&&(v=X.Right),e.horAlignment==X.Right)&&(v=X.Left)}if(f.writeFullEndElement(),f.flush(),l!=R.f.StiDashboardExportFormat.Data&&!m.is2(rs)){let e=new Hd(a),t=(e.name=o.name+`_`+C,e.border=this.getBorderSides(n,a,o,m,J.All),e.stretch=!0,e.aspectRatio=m.is2(es)||m.is2(Zr),f.textWriter.getStringBuilder().toString());e.image=Xa.stringToImage(P.System.Convert.toBase64String(t)),e.brush=new E(d),e.horAlignment=v,n.components.add(e)}l!=R.f.StiDashboardExportFormat.Data&&H.isNullOrEmpty(p)||await this.renderTextCell(n,S,o,u,h,m,t,c,y,w,d,l,!1,!1,!0,!1)}static async drawColorScaleColumn(e,t,i,r,s,l,n,a,o,u,h,m){let c=l.as(ts),d=this.getForeColor(i,l,h,!1),g=Ng.getScaleColor(O.tryToNumber(a),o,u,h,c.minimumColor,c.maximumColor),p=i.tableConditions.length?await eg.processForeAndBackColor(d,g,l.key,i,r,s):{foreColor:d,backColor:g};await this.renderTextCell(e,t,i,r,s,l,n,a,J.All,p.foreColor,p.backColor,m,!1,null,!0,!0)}static async renderBoolCell2(r,s,l,n,a,o,e,u,h,m,t){if(t==R.f.StiDashboardExportFormat.Data)await this.renderTextCell(r,s,l,n,a,o,e,u,J.None,h,m,t,!1);else{let e=0<l.tableConditions.length?await eg.processForeAndBackColor(h,m,o.key,l,n,a):{foreColor:h,backColor:m},t=u?Sg.CheckRectangle:Sg.NoneRectangle,i=new pg(s);i.name=l.name+`_Cell`,i.border=this.getBorderSides(r,s,l,o,J.All),i.contourColor=N.transparent,i.textBrush=new E(e.foreColor),i.brush=new E(e.backColor),i.checkStyleForTrue=t,i.checkStyleForFalse=Sg.NoneRectangle,i.checkedValue=t!=Sg.NoneRectangle,i.excelDataValue=u.toString(),i.componentPlacement=`d.`+l.name,r.components.add(i)}}static async renderTextCell(t,i,s,l,n,e,r,a,o,u,h,m,c,d=null,g=!1,p=!1){let S,w=null,f=null,b=(!g||c||null==(f=await eg.getIconCondition(e.key,s,l,n))||f.iconAlignment==G.None||c||m==R.f.StiDashboardExportFormat.Html||(f.iconAlignment==G.Left?w=new Se(i.height,0,0,0):f.iconAlignment==G.Right&&(w=new Se(0,i.height,0,0))),ls.formatBasedOnColumnType(s,e,a)),y=c?new B("Arial",10):s.getDataFont(),C=(e.is(ns)&&e.showHyperlink&&(y=new B(y.fontFamily.name,y.size,y.style|cl.Underline)),await eg.processFontStyle(y,e.key,s,l,n)),x=(y.style!=C&&(y=new B(y.fontFamily.name,y.size,C)),O.tryToNumber(a));if(x<0&&jh.isNegativeInRed(e.textFormat)&&(u=P.StiOptions.Engine.negativeColor),e.is(rs)){let e=Ig.castToArray(a),t=null==e?void 0:e.map(e=>e.toString());b=H.join(" ",t)}let v=0<s.tableConditions.length?await eg.processForeAndBackColor(u,h,e.key,s,l,n):{foreColor:u,backColor:h},F=Zd.convert(e.horAlignment),T=(e.is(Zr)&&(F=jt.Right),e.as(cr)),M=(null!=T&&null==d&&(d=T.size.wordWrap),null);if(e.is(ns)&&e.showHyperlink&&!H.isNullOrWhiteSpace(e.hyperlinkPattern)){let r=new P.System.Collections.Hashtable;r.add("Value",a);for(let i=0;i<n.length;i++){let e=s.columns.firstOrDefault(e=>e.key==n[i]),t="Row."+kr.correctName(e.label,!0);r.add(t,null==(S=l[i])?void 0:S.toString())}M=await P.Report.Dashboard.StiReportParser.parseAsync(e.hyperlinkPattern,s,!1,r)}let A=null!=e.textFormat&&e.textFormat.is(zt)?null:b,D=(null!=a&&null!=e.textFormat&&(e.textFormat.is(Ui)||e.textFormat.is(Wi)||e.textFormat.is(Zi))&&(A=a.toString()),new Se(2,2,1,0)),I=(null!=w&&(D=new Se(D.left+w.left,D.right+w.right,D.top+w.top,D.bottom+w.bottom)),new Ho(i));if(I.name=s.name+`_Cell`,I.border=this.getBorderSides(t,i,s,e,o),I.brush=new E(v.backColor),I.excelDataValue=A,I.font=bh.Table.Font.getGdiFont(r,null,y),I.horAlignment=F,I.vertAlignment=Ht.Center,I.margins=D,I.text=b,I.textBrush=new E(v.foreColor),I.textFormat=null!=e.textFormat?e.textFormat.clone():null,I.wordWrap=0!=d,I.componentPlacement=`d.`+s.name,I.trimming=qu.EllipsisCharacter,I.hyperlinkValue=M,t.components.add(I),null!=f&&f.iconAlignment!=G.None&&p){let e=await Bg.getImageWithConditionIcon(f,i,s.name);t.components.add(e)}}static renderImageCell(e,t,i,r,s,l,n){if(n==R.f.StiDashboardExportFormat.Data)return;let a=lh.getImageFromObject(s);if(null==a)return;let o=new Hd(t);o.name=i.name+`_Cell`,o.border=this.getBorderSides(e,t,i,r,J.All),o.brush=new E(l),o.stretch=!0,o.aspectRatio=!0,o.imageToDraw=a,o.horAlignment=r.horAlignment,e.components.add(o)}static async renderBoolCell(e,t,i,r,s,l,n,a,o,u,h){if(h==R.f.StiDashboardExportFormat.Data)return void await this.renderTextCell(e,t,i,r,s,l,n,a,o,null,u,h,!1);let m=0!=i.columns.indexOf(l),c=i.columns.indexOf(l)!=i.columns.length-1,d=(m?J.Left:J.None)|(c?J.Right:J.None),g=U.getTableStyle(i),p=new Hd(t);p.name=i.name+`_Cell`,p.border=o?new te(d,g.lineColor,1,Rr.Solid):new te(J.None,N.transparent,0,Rr.None),p.brush=new E(u),p.horAlignment=X.Center,p.vertAlignment=Ht.Center,e.components.add(p)}static async getColumnVisibilityState(e,t){if(e.visibility==zi.TrueAndHidden)return!1;return Ag.getVisible(e,t)}static getForeColor(e,t,i,r){if(!N.transparent.equals(t.foreColor))return t.foreColor;if(t.is(ns)&&t.showHyperlink)return Li.get("165dc8");let s=Xn.getForeColor(e,e.cells.data.foreColor);if(!N.transparent.equals(s))return s;return null!=i?r?i.alternatingCellForeColor:i.cellForeColor:bh.Table.Font.Color}static getHeaderBackColor(e){if(!e.cells.columns.backColor.equals(N.transparent))return e.cells.columns.backColor;let t=U.getTableStyle(e);return t.headerBackColor}static getHeaderForeColor(e){if(!N.transparent.equals(e.cells.columns.foreColor))return e.cells.columns.foreColor;let t=U.getTableStyle(e);return t.headerForeColor}static getFooterForeColor(e){if(!N.transparent.equals(e.footerForeColor))return e.footerForeColor;let t=U.getTableStyle(e);return t.footerForeColor}static getFooterBackColor(e){if(!e.cells.totals.backColor.equals(N.transparent))return e.cells.totals.backColor;let t=U.getTableStyle(e);return t.footerBackColor}static getBorderSides(e,t,i,r,s){let l=U.getTableStyle(i),n=0!=(s&J.Left)&&0!=i.columns.indexOf(r)&&t.left<e.width,a=0!=(s&J.Right)&&i.columns.indexOf(r)!=i.columns.length-1&&t.right<=e.width,o=(n?J.Left:J.None)|(a?J.Right:J.None),u=o!=J.None?1:0,h=o!=J.None?l.lineColor:N.transparent;return new te(o,h,u,Rr.Solid)}}R.z.StiTableElementExportTool=Ep}let Pg=R.h.StiAutoSizeHtmlTextHelper;{class kp extends R.z.StiElementExportTool{async render(e,t,s,i){if(this.renderEmptyDataMessage(e,t,s.clone(),i))return;let l=e.as($u),n="";if(l.isReportParserExpression||Or.isTimeExpression(l.text)||kp.isExpressionWithVariables(l.text,l.report))n=await k.parseAsync(l.text,l,!1);else if(l.isQuerable){let e=await yn.tryToGetOrCreate(l),t=new j(null==e?void 0:e.rows.firstOrDefault()).select(e=>O.tryToString(e)).toList();null!=t&&(n=Or.replaceExpressionBlocksByValues(l.text,t))}else n=l.text;!H.isNullOrEmpty(n)&&n.toLowerCase()[P.System.StiObject.stimulsoft]().replaceAll(" ","").includes("javascript:")&&(n=n.toLowerCase()[P.System.StiObject.stimulsoft]().replaceAll("javascript",""));let a=i.format==R.f.StiDashboardExportFormat.Excel||i.format==R.f.StiDashboardExportFormat.Html?.96:1,r=bd.getScaleFactor(t,i);if(n=this.changeFontSize(n,r*a),l.sizeMode==Mt.Fit||l.sizeMode==Mt.FitAndWordWrap){let r,e=3;do{let e=Pg.measure(null,s.clone(),n,l),t=e.width>s.width?s.width/e.width:1,i=s.height<e.height?s.height/e.height:1;r=Math.min(Math.abs(t),Math.abs(i)),(r=l.sizeMode==Mt.FitAndWordWrap&&.8<e.width/s.width&&i<.5?1-.7*(1-r):r)<1&&(n=this.changeFontSize(n,.99*r))}while(r<1&&0<e--);a<1&&(n=this.changeFontSize(n,a))}let o=new Ho(s);o.name=e.name+`_Content`,o.allowHtmlTags=!0,o.vertAlignment=l.vertAlignment,o.horAlignment=l.horAlignment,o.text=n,o.textBrush=new E(U.getForeColor(l)),o.trimming=l.sizeMode==Mt.Trimming?qu.EllipsisCharacter:qu.None,o.wordWrap=l.sizeMode==Mt.WordWrap||l.sizeMode==Mt.FitAndWordWrap,o.rightToLeft=l.rightToLeft,t.components.add(o)}changeFontSize(e,t){if(null==e||!e.startsWith("<font ")||e.indexOf(' size="')<0)return e;let i=e.indexOf(' size="')+7,r=e.substring(i),s=(r=r.substring(0,r.indexOf('"')))[P.System.StiObject.stimulsoft]().toNumber();return null==s&&(s=12),s=Math.ceil(s*t*10)/10,e.substring(0,i)+s.toString().replace(",",".")+e.substring(i+r.length)}static isExpressionWithVariables(t,i){var e;if(!H.isNullOrEmpty(t)&&Or.isExpression(t)&&0<(null==(e=null==i?void 0:i.variables)?void 0:e.count))for(let e of i.variables.keys)if(t.toLowerCase().includes(e.toLowerCase()))return!0;return!1}}R.z.StiTextElementExportTool=kp}R.z.StiTreeViewBoxElementExportTool=class extends R.z.StiComboBoxElementExportTool{async render(e,t,i,r){return super.render(e,t,i,r)}getValuesCount(e,t){let i=e.as(ju),r=zu.fetchItems(t,i.showBlanks);return null!=r?r.length:0}};let Hg=P.Report.Components.StiShapeDirection,jg=P.Report.Components.StiTriangleShapeType;{class Op extends R.z.StiListBoxElementExportTool{async render(e,t,i,r){return super.render(e,t,i,r)}getCheckStyle(t,i){let e=t;if(!e.userFilters.any())return Sg.CheckRectangle;if(e.userFilters.any(e=>e.condition==Ot.IsFalse))return Sg.NoneRectangle;if(null!=i.items){let e=i.items.select(e=>this.getCheckStyle(t,e));if(e.all(e=>e==Sg.CheckRectangle))return Sg.CheckRectangle;if(e.all(e=>e==Sg.NoneRectangle))return Sg.NoneRectangle;return Sg.DotRectangle}if(e.userFilters.any(e=>e.condition==Ot.EqualTo&&e.value==i.toString()))return Sg.CheckRectangle;return Sg.NoneRectangle}async renderItems(e,t,i,r,s){let l,n=await yn.tryToGetOrCreate(i);if(null==n)return;let a=!1,o=i.as(Lu),u=zu.fetchItems(n,o.showBlanks),h=(1==(null==u?void 0:u.length)&&0<(null==(l=u[0].items)?void 0:l.length)&&(u=u.concat(u[0].items),a=!0),null==u?void 0:u.select(e=>null==e?"":null!=e.key&&e.key instanceof F?e.key.toShortDateString():e.toString())),m=null==u?void 0:u.select(e=>this.getCheckStyle(i,e)),c=null==u?void 0:u.select(e=>a&&e==u.first());this.renderItems2(e,t.clone(),i,h,m,c,r,s)}renderItem(e,t,i,r,s,l,n,a,o,u,h){r!=mg.locAll&&(Op.renderExpander(e,t.clone(),i,o),t.x+=bh.ListBox.CheckBoxWidth/2,t.width-=bh.ListBox.CheckBoxWidth/2),super.renderItem(e,t.clone(),i,r,s,l,n,a,o,u,h)}static renderExpander(e,t,i,r){t=new L(t.x,t.y+t.height/2-t.height/8,bh.ListBox.CheckBoxWidth/3,t.height/4);let s=new qc(t);s.name=i.name+`_ItemExpander`,s.shapeType=new jg(r?Hg.Down:Hg.Right),s.brush=new E(N.dimGray),s.style=Rr.None,e.components.add(s)}}R.z.StiTreeViewElementExportTool=Op}let zg=P.Report.Components.StiHorizontalLinePrimitive;R.z.StiWebContentElementExportTool=class extends R.z.StiElementExportTool{async render(e,r,s,t){if(this.renderEmptyDataMessage(e,r,s.clone(),t))return;let l=e.as(Nm),n=H.isNullOrEmpty(l.url)?"EmbedCode":"URL",a=H.isNullOrEmpty(l.url)?l.embedCode:l.url;if(null!=t&&t.is(wd)&&t.designMode){let e=30,t=1,i=20;this.paintHeader(r,l,new L(s.x,s.top,s.width,e),n),this.paintSeparator(r,l,new L(s.x+i,s.top+e,s.width-2*i,t)),this.paintWebContent(r,l,new L(s.x,s.top+e+t,s.width,e),a,!0)}else this.paintWebContent(r,l,new L(s.x,s.top,s.width,s.height),a)}paintHeader(e,t,i,r){let s=U.getForeColor(t),l=new Ho(i);l.name=t.name+`__WebContentHeader`,l.vertAlignment=Ht.Center,l.horAlignment=jt.Left,l.textBrush=new E(s),l.brush=new E(N.transparent),l.margins=new Se(20,0,0,0),l.text=r,l.font=new B("Arial",8,cl.Bold),e.components.add(l)}paintSeparator(e,t,i){let r=U.getForeColor(t),s=new zg(i);s.name=t.name+`_WebContentSep`,s.color=r,e.components.add(s)}paintWebContent(e,t,i,r,s=!1){let l=U.getForeColor(t),n=new Ho(i);n.name=t.name+`__WebContentContent`,n.vertAlignment=s?Ht.Center:Ht.Top,n.horAlignment=jt.Left,n.textBrush=new E(l),n.brush=new E(N.transparent),n.margins=new Se(s?20:0,0,0,0),n.text=r,n.font=new B("Arial",8,cl.Bold),n.allowHtmlTags=!s,e.components.add(n)}};{class Vp{static run(r,s){if(void 0===r)return void Vp.run(P,"Stimulsoft");if("Stimulsoft.ExternalLibrary"==s||"Stimulsoft.Blockly"==s||"Stimulsoft.Report.StiOptions"==s||"Stimulsoft.StiOptions"==s)return;s=s.replace("Stimulsoft.System","System");for(let i in r){let e=r[i],t=typeof e;"function"==t?(e.ssTypeName=i,e.ssNamespace=s):"object"==t&&Vp.run(e,s+`.`+i)}}}R.c.StiTypesHelper=Vp}return R.c.StiTypesHelper.run(),{Stimulsoft:P,StiOptions:P.StiOptions}});